define("scripts/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e.javascript="javascript",e.typescript="typescript"})(n=t.LangType||(t.LangType={})),t.GLOBAL_SOCPE="global",t.JAVA_GLOBAL_API="JavaGlobalAPI.d.ts",t.JAVA_SCOPE_API="JavaScopeAPI.d.ts",t.TABLE_API="TableAPI.d.ts",t.JS_API="JSAPI.d.ts",t.TYPE_DEFS="sn_typedef.d.ts",t.CURRENT_API="CurrentAPI.d.ts",t.libES5Path="vs/language/typescript/lib/lib-ts",t.libES6Path="vs/language/typescript/lib/lib-es6-ts",t.TS_DECLARATION="ts_definition",t.DECLARATION_DATA_PATH="../scripts/metadata/snapi.json",t.DECLARATION_TABLE_PATH="/api/now/table/ts_definition",t.FIELD_DECLARATION="typedeclaration",t.FIELD_SOURCEMAP="typesourcemap",t.FIELD_TS_SCRIPT="tsscript",t.FIELD_SCRIPT="script",t.EL_TS_EDITOR="ts_editor",t.EL_JS_EDITOR="js_editor",t.EL_TS_DECL="ts_decl",t.EL_TS_SOURCEMAP="ts_sourcemap",t.EL_THEME_SELECT="themeselect",t.EL_SCOPE_SELECT="scope-select",t.EL_SCRIPT_RUNNER="script-runner",t.EL_SCRIPT_OUTPUT="script-output";var i;(function(e){e.sys_script_include="sys_script_include",e.ts_definition="ts_definitions"})(i=t.TableNames||(t.TableNames={}))}),define("scripts/eslintConfig",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;(function(e){e[e.off=0]="off",e[e.warn=1]="warn",e[e.error=2]="error"})(n=t.ruleSetting||(t.ruleSetting={})),t.eslintConfig={parserOptions:{ecmaVersion:5,sourceType:"script",ecmaFeatures:{}},rules:{"constructor-super":2,"for-direction":2,"getter-return":2,"no-case-declarations":2,"no-class-assign":2,"no-compare-neg-zero":2,"no-cond-assign":2,"no-console":2,"no-const-assign":2,"no-constant-condition":2,"no-control-regex":2,"no-debugger":2,"no-delete-var":2,"no-dupe-args":2,"no-dupe-class-members":2,"no-dupe-keys":2,"no-duplicate-case":2,"no-empty":2,"no-empty-character-class":2,"no-empty-pattern":2,"no-ex-assign":2,"no-extra-boolean-cast":2,"no-extra-semi":2,"no-fallthrough":2,"no-func-assign":2,"no-global-assign":2,"no-inner-declarations":2,"no-invalid-regexp":2,"no-irregular-whitespace":2,"no-mixed-spaces-and-tabs":2,"no-new-symbol":2,"no-obj-calls":2,"no-octal":2,"no-redeclare":2,"no-regex-spaces":2,"no-self-assign":2,"no-sparse-arrays":2,"no-this-before-super":2,"no-unexpected-multiline":2,"no-unreachable":2,"no-unsafe-finally":2,"no-unsafe-negation":2,"no-unused-labels":2,"no-unused-vars":2,"no-useless-escape":2,"require-yield":2,"use-isnan":2,"valid-typeof":2,semi:2,"semi-spacing":2,"semi-style":2,eqeqeq:2,"eol-last":2,"default-case":2,"consistent-return":2,camelcase:2,"no-else-return":2,"no-eq-null":2,"no-eval":2,"no-extend-native":2,"no-extra-bind":2,"no-self-compare":2,"no-unused-expressions":2},env:{browser:!0}}});var __extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t};define("scripts/siParser",["require","exports","scripts/eslintConfig"],function(e,t,n){"use strict";function i(){var e=/\`(.*?)(\$\$\{[^\{]+(?=\})\})(.*?)\`/g;return e}function s(e,t){var n=m.declare+m.space+m.namespace+m.space+t+m.blockOpen+m.newline;return n+=e+m.newline+m.blockClose,n}function a(e,t){var n=m.interface+m.space+t+m.blockOpen+m.newline;return n+=e,n+=m.newline+m.blockClose,n}function o(e,t,n){function s(e){return!(e.type!=u.ExpressionStatement)&&!(e.expression.type!=u.AssignmentExpression)&&e.expression.left.property&&e.expression.left.property.name=="prototype"}var a=p(e,t,n,!1),r=n.split(".");n=r[r.length-1];for(var o=0,l;o<t.body.length;o++)if(l=t.body[o],l.type==u.VariableDeclaration){if(1==l.declarations.length&&l.declarations[0].id.name!=n){t.body[o]=null;continue}for(var d=0;d<l.declarations.length;d++)l.declarations[d].id.name!=n&&(l.declarations[d]=null)}else if(l.type==u.FunctionDeclaration){if(l.id.name!=n){t.body[o]=null;continue}}else if(s(l))l.expression.left.object.name!=n&&(t.body[o]=null);else if(l.type==u.ExpressionStatement&&l.expression&&l.expression.type==u.CallExpression){if(l.expression.callee&&l.expression.callee.object&&"gs"==l.expression.callee.object.name&&"include"==l.expression.callee.property.name){t.body[o]=null;continue}}else if(l.type==u.ExpressionStatement&&l.expression.type==u.AssignmentExpression){if(l.expression.left.type==u.Identifier&&l.expression.left.name==n)continue;if(l.expression.left.type!=u.MemberExpression){t.body[o]=null;continue}if(l.expression.left.object&&l.expression.left.object.name!=n){t.body[o]=null;continue}}}function p(e,t,n,i){function s(e){if(!i)return{fieldType:m.any,paramTypes:{},returnType:m.any};e="/*"+e+"*/";var t=m.any,n=m.any,s={},a=e.split("\n"),r=a.map(function(e){return e.trim()}),o;if(o=k.parse(r.join("\n")),0<o.length)for(var p=o[0],l=0,d=p.tags,c;l<d.length;l++)if(c=d[l],c.type&&0!=c.type.length){var g=c.tag;"param"==g?s[c.name]=c.optional?"?: "+c.type:": "+c.type:"returns"==g||"return"==g?n=c.type:"type"==g&&!!c.type&&(t=c.type)}return{fieldType:t,paramTypes:s,returnType:n}}function a(e){for(var t=[],n=0,a;n<e.length;n++)if(a=e[n],a.type==u.ExpressionStatement&&a.expression&&a.expression.type==u.AssignmentExpression&&"="==a.expression.operator&&a.expression.left&&a.expression.left.type==u.MemberExpression&&a.expression.left.object&&a.expression.left.object.type==u.ThisExpression){var r={fieldType:m.any,paramTypes:{},returnType:m.any};if(i&&!!a.leadingComments&&0<a.leadingComments.length){var o=a.leadingComments[0].value;r=s(o)}var p="",l=m.any;a.expression.left.property.type==u.Identifier?(p=a.expression.left.property.name,a.expression.right.type==u.Literal&&(l=typeof a.expression.right.value)):a.expression.left.property.type==u.Literal&&(p=a.expression.left.property.value,a.expression.right.type==u.Literal&&(l=typeof a.expression.right.value)),i&&r.fieldType!=m.any&&(l=r.fieldType);var d={name:p,value:l};t.push(d)}return t}void 0===i&&(i=!1);var r="",o=new I(e,n);return{getMetaInfo:function(){return o},getSimpleName:function(){var e=n.split(".");return 0==e.length?"":e[e.length-1]},isSingleFunctionExported:function(e,t,n){return!(e.type!=n||1!=t.body.length)||this.isAnonymousTypeExported(e,t,u.FunctionExpression)},isAnonymousTypeExported:function(e,t,i){var s=n.split("."),a=s[s.length-1];return!(e.type!=u.VariableDeclaration&&e.type!=u.ExpressionStatement||e.type!=u.ExpressionStatement||e.expression.type!=u.AssignmentExpression||e.expression.left.type!=u.Identifier||e.expression.left.name!=a||e.expression.right.type!=i)},anonymousDeclaration:function(t,a,p){var l=p.split("."),d=l[l.length-1],c="";if(t.type==u.VariableDeclaration||t.type==u.ExpressionStatement){if(t.type==u.ExpressionStatement&&t.expression.type==u.AssignmentExpression&&t.expression.left.type==u.Identifier&&t.expression.left.name==d){if(this.isAnonymousTypeExported(t,a,u.CallExpression)){r=d;var g=this.getBaseClassInfo();return c=m.class+m.space+d,g.name&&(c+=m.space+m.extends+m.space+g.name,o.setBaseName(g.name)),c+=m.blockOpen+m.newline,c}if(this.isAnonymousTypeExported(t,a,u.ObjectExpression));else if(this.isAnonymousTypeExported(t,a,u.FunctionExpression)){console.log("anonymous function expression");for(var f=m.function+m.space+this.getSimpleName(),y=t.expression.right.params,h=m.functionOpen,C=0;C<y.length;C++)h+=y[C].name+m.colon+m.any,C!=y.length&&(h+=m.comma);return h+=m.functionClose,o=new A(e,n,h),m.function+m.space+this.getSimpleName()+h+m.semicolon}}}else if(this.isSingleFunctionExported(t,a,u.FunctionDeclaration)){var T={fieldType:m.any,paramType:{},returnType:m.any};if(t.leadingComments&&1==t.leadingComments.length){var S=t.leadingComments[0].value;T=s(S),T.paramTypes}for(var f=m.function+m.space+t.id.name,h=m.functionOpen,_=0;_<t.params.length;_++)h+=t.params[_].name,T.paramTypes&&T.paramTypes[t.params[_].name]&&(h+=T.paramTypes[t.params[_].name]),_!=t.params.length-1&&(h+=m.comma);return h+=m.functionClose,!T.returnType||T.returnType==m.any||(h+=m.colon+m.space+T.returnType),o=new A(e,n,h),f+=h,f+=m.semicolon,f}return""},isPrototype:function(e){return!(e.type!=u.ExpressionStatement)&&!(e.expression.type!=u.AssignmentExpression)&&!!e.expression.left.object&&!!(e.expression.left.object&&e.expression.left.object.name==r)&&!!(e.expression.left.property&&"prototype"==e.expression.left.property.name)},FunctionDeclaration:function(e){var t=this.getBaseClassInfo();if(!t.name)return r=e.id.name,m.class+m.space+e.id.name+m.space+m.blockOpen},VarialbeDeclarator:function(e){return r=e.id.name,m.class+m.space+e.id.name},getBaseClassInfo:function(){for(var e=0,n;e<t.body.length;e++)if(n=t.body[e],n&&this.isPrototype(n,null)){if(n.expression.right.type==u.ObjectExpression)return{name:void 0,properties:n.expression.right.properties};if(n.expression.right.type==u.CallExpression){var s=n.expression.right.arguments[0],a="";if(s.type==u.Identifier?a=s.name:s.type==u.MemberExpression&&(a=s.object.name+"."+s.property.name),!!a){var r=n.expression.right.arguments,o=[];2<=r.length&&r[1].properties&&(o=r[1].properties);var p=a.split(".");return 1<p.length&&p[1]==m.prototype_1&&(a=p[0]),{name:a,properties:o}}}break}return{}},isObjectDeclaration:function(e){if(!e)return!1;if(e.kind!=N.var)return e.type==u.ExpressionStatement&&e.expression.right&&e.expression.right.type&&e.expression.right.type==u.ObjectExpression;for(var t=0,n;t<e.declarations.length;t++)return n=e.declarations[0],n.init.type==u.ObjectExpression},VariableDeclaration:function(t){var s=t.kind==N.var,a=this.isObjectDeclaration(t);if(t.kind!=N.var&&!a)return void console.log("not defined");if(!s&&a){var p=this.formatObjectExpression(t.expression.right.properties,!0,!1);return p=m.var+m.space+t.expression.left.name+m.colon+m.space+p,p}for(var l=0,d;l<t.declarations.length;l++){if(d=t.declarations[0],d.init.type==u.ObjectExpression){var p=this.formatObjectExpression(d.init.properties,!0,!1);return o=new b(e,n,p),p=m.var+m.space+d.id.name+m.colon+m.space+p,p}var c=this.VarialbeDeclarator(t.declarations[l],t);c+=m.space;var g=this.getBaseClassInfo();return g.name&&(c+=m.extends+m.space+g.name+m.space,o.setBaseName(g.name)),c+=m.blockOpen,c}},ExpressionStatement:function(t,i){var s=t.expression;if(s.type==u.AssignmentExpression){var a=this.isAnonymousTypeExported(t,i,u.ObjectExpression),r=this.isAnonymousTypeExported(t,i,u.FunctionExpression);if(a){var p=this.formatObjectExpression(s.right.properties,!1,!1),l=m.blockOpen+m.newline;return l+=p+m.blockClose,o=new b(e,n,l),""}if(r);return this.MemberExpression(s,t)}},AssignmentExpression:function(){console.log("assignment expression")},FunctionExpression:function(e,t){if(!(e.left.property||e.left.name))return"";var n={};t&&t.leadingComments&&0<t.leadingComments.length&&(n=s(t.leadingComments[0].value));var a="";a=e.left.property?e.left.property.name:e.left.name,a+=m.functionOpen;for(var r=0;r<e.right.params.length;r++){var o=e.right.params[r].name,p=m.any;n.paramTypes&&n.paramTypes[o]?(p=n.paramTypes[o],a+=e.right.params[r].name+p):a+=e.right.params[r].name+m.colon+p,r!=e.right.params.length-1&&(a+=m.comma)}return a+=m.functionClose,n.returnType&&n.returnType!=m.any&&(a+=m.colon+n.returnType),a+=m.semicolon,a},MemberExpression:function(e,t){var n=e.left.object&&e.left.object.name===r,a=e.left.property&&e.left.property.name,p={};t&&t.leadingComments&&0<t.leadingComments.length&&(p=s(t.leadingComments[0].value));var l="";n&&(l=m.static+m.space);var d=e.right.type==u.FunctionExpression;l+=d?this.FunctionExpression(e,t):a+m.colon;var c=m.any;if(e.right.type==u.Literal){var g=typeof e.right.value;g!=m.function&&(c=g),!p.fieldType||(c=p.fieldType)}else{if(e.right.type==u.ObjectExpression)return p.fieldType?c=p.fieldType:(c=this.formatObjectExpression(e.right.properties),!a&&(l=m.var+m.space+e.left.name+m.colon+m.space),c="{\n"+c+"}"),o.addField(a,c,n,!1),l+c+";\n";if(e.right.type==u.ArrayExpression)c="Array<any>";else{if(e.right.type==u.FunctionExpression){for(var f=e.right.params,y=m.functionOpen,h=0;h<f.length;h++)y+=f[h].name,!p.paramTypes||!p.paramTypes[f[h].name]||(y+=p.paramTypes[f[h].name]),h!=f.length-1&&(y+=m.comma);return y+=m.functionClose,p.returnType&&p.returnType!=m.any&&(y+=m.colon+p.returnType),o.addField(a,y,!0,!0),console.log("static function found"),l}if(e.right.type==u.NewExpression||e.right.type==u.CallExpression){var C={};t&&t.leadingComments&&0<t.leadingComments.length&&(C=s(t.leadingComments[0].value)),!C.fieldType||(c=C.fieldType)}else console.log("Literal not found")}}return l+=c+m.semicolon,o.addField(a,c,n,!1),l},formatObjectExpression:function(e,t,p){if(void 0===t&&(t=!1),void 0===p&&(p=!1),!e)return"";for(var l=t?"{\n":"",d=0;d<e.length;d++){var c=e[d],g=c.key.name||c.key.value,f=g;c.key.name?(l+=g,f=g):(l+=c.key.raw,f=c.key.raw);var y="initialize"==g&&p&&c.value.type==u.FunctionExpression,h="",C=m.any,T=!1,S={},_="",b=m.any,A=void 0;if(c.leadingComments&&0!=c.leadingComments.length&&(A=s(c.leadingComments[0].value),b=A.fieldType,_=A.returnType,S=A.paramTypes),c.value.type==u.NewExpression||c.value.type==u.CallExpression)C=b,l+=m.colon+m.space+b;else if(c.value.type==u.Literal){var I=typeof c.value.value;C=I,l+=m.colon+m.space+I}else if(c.value.type==u.ObjectExpression){if(b==m.any){var x=this.formatObjectExpression(c.value.properties,!0);C=x,l+=m.colon+m.space+x}else C=b,l+=m.colon+m.space+b;}else if(c.value.type==u.FunctionExpression){T=!0;for(var r=c.value.params,E=0,M;E<r.length;E++)M=r[E].name,h+=M,S[M]&&(h+=S[M]),E!=r.length-1&&(h+=m.comma);if(h=m.functionOpen+h+m.functionClose,(0<_.length&&_!=m.any||!p)&&(p?h+=m.colon+_:(h+=m.arrow,h+=_?_:m.any)),h=v[n+"."+g]||h,p?l+=h:(l+=m.colon+m.space,l+=h),y){o.setConstructor(h);for(var F=a(c.value.body.body),N=0,k=F,D;N<k.length;N++)D=k[N],o.addField(D.name,D.value,!p,!1)}C=h}else c.value.type==u.ArrayExpression?(l+=m.colon+m.space+"Array<any>",C="Array<any>",b!=m.any&&(C=b)):l+=m.colon+m.space+m.any;p?l+=m.semicolon:d!=e.length-1&&(l+=m.comma),p&&o.addField(f,C,!p,T),l+=m.newline,y&&p&&(l+="\nconstructor",l+=h,l+=";",l+=m.newline)}return t&&(l+=m.blockClose),l},prototypeExpression:function(){var e=this.getBaseClassInfo();return this.formatObjectExpression(e.properties,void 0,!0)}}}function l(e,t,n,s,a){void 0===a&&(a=!1);var l=n.split("."),d=l[l.length-1],c=s.parse(t,{attachComment:!0}),g=p(e,c,n,a),f="";o(e,c,n);for(var y=g.isObjectDeclaration(c.body[0]),h=!0,C=!1,T=0,S,_;T<c.body.length;T++)if(_=c.body[T],_){if("undefined"==typeof g[_.type]){console.log("not defined");continue}var b="";if(h&&(h=!1,b=g.anonymousDeclaration(_,c,n),C=g.isSingleFunctionExported(_,c,u.FunctionDeclaration),b)){f+=b;continue}b=g.isPrototype(_,null)?g.prototypeExpression(_,c):g[_.type](_,c),b&&(f+=b+m.newline)}return S=g.getMetaInfo(),0==f.length?console.log("empty came"):!y&&!C&&(f+=m.blockClose),{strFormat:f,metaInfo:S}}function d(e){var t="";for(var n in e){t+="declare namespace "+n+" {\n";for(var s=e[n],a="",r=0,o;r<s.length;r++)o=s[r],t+=o.declaration,t+="\n";t+="}\n",t+=a+m.newline}return t}function c(e,t,n,s){void 0===n&&(n={}),void 0===s&&(s=!1);var a=[],r={},o=[],p=[];({})["global.StorageDataSize"]=!0;for(var c=0,g;c<e.length;c++)if(g=new C(e[c]),!n[g.sys_id]&&(g.api_name=g.api_name.trim(),!(0<=f[g.api_name]))){console.log("parsing "+g.api_name);var u="",m=g.api_name.split(".");r[m[0]]||(r[m[0]]=[]);var y=r[m[0]];try{var h=l(g,g.script,g.api_name,t,s||!!g.jsdoc);u=h.strFormat,h.metaInfo.setAccessType(g.access),h.metaInfo.setSysId(g.sys_id),a.push(h.metaInfo),u||(p.push(g.api_name),console.log("Empty declaration => "+g.api_name)),y.push(new x(g.api_name,g.sys_scope.value,u,g.access,g.sys_id))}catch(t){o.push(g.api_name),console.log(" parsing error for => "+g.api_name)}}for(var T=d(r),S=new F,_=0,b=a,A;_<b.length;_++)A=b[_],S.addType(A.exportToTS());return{getFormat:function(e){return void 0===e&&(e=!1),e?S.exportJSON():S.emit()},getParsingErrors:function(){return o},getEmptyDeclarations:function(){return p}}}Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n);var g;(function(e){e.never="never",e["var"]="var",e.fun="fun",e.cls="cls"})(g=t.JSExportedTypes||(t.JSExportedTypes={}));var f;(function(e){e[e["global.Class"]=1]="global.Class",e[e["global.PrototypeServer"]=2]="global.PrototypeServer",e[e["global.CIIdentifier"]=3]="global.CIIdentifier",e[e["global.KBProperty"]=4]="global.KBProperty",e[e["global.KBUtils"]=5]="global.KBUtils",e[e["global.Workflow"]=6]="global.Workflow",e[e["global.StorageDataSize"]=7]="global.StorageDataSize",e[e["global.DevExHelpers"]=8]="global.DevExHelpers"})(f=t.BlockedSI||(t.BlockedSI={}));var u;(function(e){e.VariableDeclaration="VariableDeclaration",e.VariableDeclarator="VariableDeclarator",e.ExpressionStatement="ExpressionStatement",e.AssignmentExpression="AssignmentExpression",e.Literal="Literal",e.Identifier="Identifier",e.FunctionDeclaration="FunctionDeclaration",e.FunctionExpression="FunctionExpression",e.ObjectExpression="ObjectExpression",e.CallExpression="CallExpression",e.MemberExpression="MemberExpression",e.ArrayExpression="ArrayExpression",e.NewExpression="NewExpression",e.ThisExpression="ThisExpression"})(u=t.ExpressionType||(t.ExpressionType={}));var m;(function(e){e.namespace="namespace",e["import"]="import",e["export"]="export",e["class"]="class",e["interface"]="interface",e.space=" ",e.startString="\"",e.endString="\"",e["new"]="new",e.prototype_1="prototype",e.newline="\n",e.tab="\t",e.blockOpen="{",e.blockClose="}",e["static"]="static",e.colon=":",e.semicolon=";",e.any="any",e.boolean="boolean",e.number="number",e.object="object",e.string="string",e.undefined="undefined",e["function"]="function",e.functionOpen="(",e.functionClose=")",e.comma=",",e.dot=".",e["extends"]="extends",e["implements"]="implements",e.constructor="new",e.typeAdd="Constructor",e["var"]="var",e.equal="=",e.declare="declare",e["const"]="const",e.arrow="=>"})(m=t.TokenType||(t.TokenType={}));var y;(function(e){e["public"]="public",e.package_private="package_private"})(y=t.SIAccessType||(t.SIAccessType={}));var h;(function(e){e.read="read",e["protected"]="protected",e.nil=""})(h=t.SISysPolicy||(t.SISysPolicy={}));t.ERROR_MSG="Errors in the source files, use 'F8' or 'shift + F8' to navigate errors in editor",t.getDotWalkingRegExp=i;var C=function(){function e(e,t){void 0===t&&(t=!1),this.isNewRecord=t,this.access=y.public,this.active=!1,this.jsdoc=!1,this.api_name="global",this.client_callable=!1,this.description="",this.name="",this.script="",this.script_type="",this.sys_class_name="",this.sys_updated_by="",this.sys_created_on="",this.sys_id="",this.sys_mod_count=0,this.sys_name="",this.sys_package={link:"",value:""},this.sys_policy=h.nil,this.sys_scope={link:"",value:""},this.sys_tags="",this.sys_update_name="",this.sys_created_by="",this.sys_updated_on="",this.tsscript="",this.typedeclaration="",this.typesourcemap="",this.parseReturnType=!0,this.isDirty=!1,this.parseReturnType=!0,!e||(!e.tsscript&&(e.tsscript=e.script),this.copy(e)),0==this.sys_id.length&&(this.sys_id="yln")}return e.prototype.canPlaceBreakPoints=function(){return!this.isNewRecord},e.prototype.isGlobalScope=function(){return"global"==this.getScopeAndAPIMap().scope},e.convertToJSConstructor=function(t){if(t.isJavascript()){var n=t.tsscript.split("\n"),i=t.getScopeAndAPIMap(),s=n.findIndex(function(e){if(0>e.indexOf("Class.create()"))return!1;var t=e.split(" "),n=t.filter(function(e){return 0<e.trim().length});return 4==n.length&&(n=n.map(function(e){return e.trim()}),"var"==n[0]&&n[1]==i.name&&"="==n[2]&&"Class.create();"==n[3])});-1==s||(e.isClsFound=!0,n[s]="function "+i.name+"() { }",t.tsscript=t.script=n.join("\n"))}},e.getClassConstructorFormat=function(t){if(t.isTypescript())return t.script;if(window.recordConfig.isES6)return t.script;if(!e.isClsFound)return t.tsscript;var n=t.getScopeAndAPIMap(),i=t.tsscript.split("\n"),s=i.findIndex(function(e){return!!e.trim().startsWith("function "+n.name+"() { }")});return-1==s?t.tsscript:(i[s]="var "+n.name+" = Class.create();",i.join("\n"))},e.prototype.getScopeAndAPIMap=function(){var e=this.api_name.split("."),t=e[0],n=2==e.length?e[1]:"";return{scope:t,name:n}},e.prototype.isTypescriptWithJSStyle=function(){return!1},e.prototype.isJavascript=function(){return 0==this.script_type.length||"javascript"==this.script_type||"js"==this.script_type},e.prototype.isTypescript=function(){return"typescript"==this.script_type||"ts"==this.script_type},e.prototype.containsTemplateExpression=function(){var e=i();return e.test(this.tsscript)},e.prototype.generateCurrentSIDeclaration=function(e,t){if(void 0===t&&(t=!1),this.isTypescript())return"";var n=this.generateDeclaration(e,t),i=n.getFormat(!0),r=JSON.parse(i),o=this.api_name.split("."),p=o[0],l=o[1],d="\""+l+"\":"+this.api_name+"Constructor",c=a(d,"JSTypes"),g=s(r[p][0].typeFormat+"\n"+r[p][0].aliasFormat,p);return g+"\n"+c},e.prototype.formatCurrentSITSFormat=function(e){var t=this.api_name.split("."),n=s(e.tf+"\n\n"+e.af,t[0]);return n},e.prototype.generateDeclaration=function(e,t){return void 0===t&&(t=!1),this.canGenerateDeclaration()||new Error("declaration is not possible"),c([this],e,{},t)},e.prototype.updateTSScript=function(e){this.tsscript=e},e.prototype.updateScript=function(e){this.script=e},e.prototype.updateDeclaration=function(e){this.typedeclaration=e},e.prototype.updateJSDoc=function(e){this.jsdoc=e},e.prototype.updateSourcemap=function(e){this.typesourcemap=e},e.prototype.isUpToDate=function(){return!this.isDirty},e.prototype.setDirtyState=function(e){this.isDirty=e},e.prototype.canGenerateDeclaration=function(){if(this.isNew())return console.log("generating declaration without apiname not possible"),!1;if(this.isTypescript())return console.log("generating typescript is automatic"),!1;if(0==this.script.length)return console.log("declaration not possible for empty script"),!1;if(0==this.api_name.length)return!1;var e=this.api_name.split(".");return 2==e.length},e.prototype.isNew=function(){return"undefined"==typeof window?"global"==this.api_name||0!=this.api_name.length&&0==this.sys_id.length:window.recordConfig.isNewRecord},e.prototype.formatForAddLib=function(e,t){t=t||e.api.split(".")[0];var n={};n[t]=[e];var i=new M(n);return i.emit(t)},e.prototype.updateAPIName=function(e){return 0==e.length?console.log("API name should not be empty"):void(this.api_name=e)},e.prototype.updateSysId=function(e){this.sys_id=e},e.prototype.updateAccessType=function(e){this.access=e},e.prototype.updateLangType=function(e){this.script_type=e?e:"javascript"},e.prototype.emitTSDeclaration=function(e,t){void 0===t&&(t=0);var n=/declare class/gi,i=/declare function/gi,s=/declare enum/gi,a=/declare var/gi,r=/declare const/gi,o=/declare type/gi,p=/declare namespace/gi,l=0<=e.search(n),d=0<=e.search(i),c=0<=e.search(s),f=0<=e.search(a);e=e.replace(n,m.class),e=e.replace(i,m.function),e=e.replace(s,"enum"),e=e.replace(a,"var"),e=e.replace(r,"const"),e=e.replace(o,"type"),e=e.replace(p,"namespace"),e=e.replace("/// <reference types=\"snlib\" />","");var u="",y=this.getScopeAndAPIMap(),h=y.scope,C=y.name||"Point";u=this.isNew()?this.api_name+"_"+C+"":this.api_name.replace(".","_")+"";var T=m.export+m.space+m.import+m.space+C+m.space+m.equal;T+=m.space+h+m.dot+u+m.dot+C+m.semicolon;var _=m.import+m.space+C+m.space+m.equal;_+=m.space+h+m.dot+u+m.dot+C+m.semicolon,_="";var b=m.namespace+m.space+u+m.space+m.blockOpen+m.newline;b+=e+m.newline+m.blockClose+m.newline;var A=new S(C,this.sys_id,b,T,_,this.access,g.cls,0),I={api:C,id:this.sys_id,f:t,tf:b};return S.updateFlags(I,this,g.cls),I},e.fromSIRec=function(t){var n=new e(void 0,!1);for(var i in t)n[i]=t[i].value;n.active="1"==t.active.value,n.jsdoc=window.recordConfig.useTypeChecker;var s=new e(void 0,window.recordConfig.isNewRecord);return s.copy(n),s},e.prototype.copy=function(e){this.parseReturnType=e.parseReturnType,this.access=e.access,this.active="true"==e.active+"",this.api_name=e.api_name,this.jsdoc="true"==e.jsdoc+"",this.client_callable="true"==e.client_callable+"",this.description=e.description,this.name=e.name,this.script=e.script,this.script_type=e.script_type?e.script_type:"javascript",this.sys_class_name=e.sys_class_name,this.sys_updated_by=e.sys_updated_by,this.sys_created_on=e.sys_created_on,this.sys_id=e.sys_id,this.sys_mod_count=parseInt(e.sys_mod_count+""),this.sys_name=e.sys_name,this.sys_package=e.sys_package,this.sys_policy=e.sys_policy,this.sys_scope=e.sys_scope,this.sys_tags=e.sys_tags,this.sys_update_name=e.sys_update_name,this.sys_created_by=e.sys_created_by,this.sys_updated_on=e.sys_updated_by,this.sys_updated_on=e.sys_updated_on,this.typedeclaration=e.typedeclaration?e.typedeclaration:"",this.typesourcemap=e.typesourcemap?e.typesourcemap:"",this.tsscript=e.tsscript},e.isClsFound=!1,e}();t.ClientSIRecordData=C;var T;(function(e){e[e["public"]=2]="public",e[e.cls=4]="cls",e[e.fun=8]="fun",e[e.obj=16]="obj",e[e.blocked=32]="blocked",e[e.ts=64]="ts",e[e.jsES6=128]="jsES6"})(T||(T={}));var S=function(){function e(e,t,n,i,s,a,r,o,p,l){this.api=e,this.id=t,this.tf=n,this.af=i,this.gf=s,this.accessType=a,this.internalType=r,this.f=o,this.td=p,this.sp=l}return e.expandMinifiedFormat=function(t,n,i){function s(e){var i=e.f.endsWith(";")?"":";";e.l=e.l||0;var s="/**\n\t\t\t\t\t * @see http://"+n+"."+t.api+"/"+e.l+"\n\t\t\t\t\t */\n\t\t\t\t\t"+e.f+i+"\n\t\t\t\t\t";return s}if(void 0===i&&(i=!1),t instanceof e)return t;if(0==t.f&&!i)return null;if(0==t.f)return null;if(i=e.isTypescript(t.f)||e.isES6(t.f),t.df&&!i)if(e.isObject(t.f)){var a="";t.df.forEach(function(e){return Array.isArray(e)?void console.warn("invalid syntax found"):void(a+=s(e))}),t.tf=a}else if((e.isClass(t.f)||this.isFunction(t.f))&&Array.isArray(t.df)&&2==t.df.length){var r=t.df[0],o=t.df[1],p="",l="";r.forEach(function(e){p+=s(e)}),o.forEach(function(e){l+=s(e)}),t.tf=[p,l]}var d="/** @see http://"+n+"."+t.api+"/1 */\n\t\tconst "+t.api+": "+t.api+"Constructor",c="/** @see http://"+n+"."+t.api+"/1 */\n\t\tdeclare const "+t.api+": "+n+"."+t.api+"Constructor";if(i)return d="/** @see http://"+n+"."+t.api+"/1 */\n\t\t\texport import "+t.api+" = "+n+"."+n+"_"+t.api+"."+t.api,c="",t.f|=T.cls,t.af=d,t.gf=c,Array.isArray(t.tf)?t.tf=t.tf[0]:"string"!=typeof t.tf&&(t.tf=""),t;if(e.isObject(t.f))return t.df&&(t.tf="{\n\t\t\t\t\t"+t.tf+"\n\t\t\t\t}"),t.tf="interface "+t.api+" "+t.tf,t.af="const "+t.api+": "+t.api,t.gf="declare const "+t.api+": "+n+"."+t.api,t;if(e.isClass(t.f)||e.isFunction(t.f)){if(!Array.isArray(t.tf))return null;if(e.isClass(t.f)&&2!=t.tf.length)return null;if((e.isClass(t.f)&&!t.sp||e.isFunction(t.f))&&(e.isFunction(t.f)?t.tf="interface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}":t.tf="interface "+t.api+" {\n\t\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t\t}\n\t\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}"),e.isClass(t.f)&&"string"==typeof t.sp){var g=t.sp,f=t.sp.split(".");1==f.length&&(g=n+"."+t.api),t.tf="interface "+t.api+" extends "+g+" {\n\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t}\n\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t}"}return t.af=d,t.gf=c,t}return t.af=d,t.gf=c,t.tf="",t},e.expandMinifiedFormat_1=function(t,n,i){if(void 0===i&&(i=!1),t instanceof e)return t;if(0==t.f&&!i)return null;if(0==t.f)return null;i=e.isTypescript(t.f);var s="const "+t.api+": "+t.api+"Constructor",a="declare const "+t.api+": "+n+"."+t.api+"Constructor";if(i)return s="export import "+t.api+" = "+n+"."+n+"_"+t.api+"."+t.api,a="",t.f|=T.cls,t.af=s,t.gf=a,Array.isArray(t.tf)?t.tf=t.tf[0]:"string"!=typeof t.tf&&(t.tf=""),t;if(e.isObject(t.f))return t.tf="interface "+t.api+" "+t.tf,t.af="const "+t.api+": "+t.api,t.gf="declare const "+t.api+": "+n+"."+t.api,t;if(e.isClass(t.f)||e.isFunction(t.f)){if(!Array.isArray(t.tf))return null;if(e.isClass(t.f)&&2!=t.tf.length)return null;if((e.isClass(t.f)&&!t.sp||e.isFunction(t.f))&&(e.isFunction(t.f)?t.tf="interface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}":t.tf="interface "+t.api+" {\n\t\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t\t}\n\t\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}"),e.isClass(t.f)&&"string"==typeof t.sp){var r=t.sp,o=t.sp.split(".");1==o.length&&(r=n+"."+t.api),t.tf="interface "+t.api+" extends "+r+" {\n\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t}\n\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t}"}return t.af=s,t.gf=a,t}return t.af=s,t.gf=a,t.tf="",t},e.updateFlags=function(t,n,i){var s=t.f||0;n.access==y.public&&(s|=T.public),n.isTypescript()&&(s|=T.ts),e.isES6(s)&&(s|=T.ts,s|=T.jsES6),i==g.cls?s|=T.cls:i==g.var?s|=T.obj:i==g.fun&&(s|=T.fun),t.f=s},e.updateFlagsMinifiy=function(e,t,n){var i=e.f||0;t.access==y.public&&(i|=T.public),t.isTypescript()&&(i|=T.ts),n==g.cls?i|=T.cls:n==g.var?i|=T.obj:n==g.fun&&(i|=T.fun),e.f=i},e.isTypescript=function(e){return(e&T.ts)==T.ts},e.isES6=function(e){return void 0===e&&(e=0),(e&T.jsES6)===T.jsES6},e.isPublic=function(e){return(e&T.public)==T.public},e.isClass=function(e){return(e&T.cls)==T.cls},e.isFunction=function(e){return(e&T.fun)==T.fun},e.isObject=function(e){return(e&T.obj)==T.obj},e.isBlocked=function(e){return(e&T.blocked)==T.blocked},e}();t.SITSFormat=S;var _=function(){function e(e,t,n,i){void 0===n&&(n=""),void 0===i&&(i=""),this.currentSI=e,this.apiName=t,this.accessType=n,this.sysId=i,this.apiName=t.trim(),this.accessType="",this.sysId=""}return e.prototype.getJSName=function(){if(!this.apiName)return{};var e=this.apiName.split("."),t="",n="";return 1==e.length?t=e[0]:2==e.length&&(n=e[0],t=e[1]),{name:t,scopeName:n}},e.prototype.getInternalType=function(){return g.never},e.prototype.setAccessType=function(e){this.accessType=e},e.prototype.setSysId=function(e){this.sysId=e},e.prototype.exportAliasName=function(e){var t=m.const+m.space+this.getJSName().name+m.space+m.colon+m.space+this.apiName+m.typeAdd+m.semicolon;return e?t:m.declare+m.space+t},e}();t.TypeData=_;var b=function(e){function t(t,n,i){var s=e.call(this,t,n)||this;return s.apiName=n,s.format=i,s.format=i,s}return __extends(t,e),t.prototype.getTempInterfaceName=function(){return this.apiName},t.prototype.toInternalFormat=function(){var e=this.getJSName().name,t=this.getTempInterfaceName(),n=t.split(".");t=n[n.length-1];var i=m.interface+m.space+t+this.format;return i},t.prototype.exportToTS=function(){var e=new S(this.apiName,this.sysId,this.toInternalFormat(),this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return S.updateFlags(e,this.currentSI,this.getInternalType()),e},t.prototype.getInternalType=function(){return g.var},t.prototype.exportAliasName=function(e){var t=this.getJSName(),n=m.const+m.space;return n+=t.name+m.colon+this.getTempInterfaceName()+m.semicolon,e?n:m.declare+m.space+n},t}(_);t.TypeVarData=b;var A=function(e){function t(t,n,i,s){void 0===s&&(s=!1);var a=e.call(this,t,n)||this;return a.apiName=n,a.format=i,a.format=i,a}return __extends(t,e),t.prototype.getTypeFormat=function(){var e=this.getJSName();return m.function+m.space+e.name+this.format+m.semicolon},t.prototype.exportToTS=function(){var e=this.getJSName(),t=this.getTypeFormat(),n=new S(this.apiName,this.sysId,"",this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return S.updateFlags(n,this.currentSI,this.getInternalType()),n},t.prototype.getInternalType=function(){return g.fun},t.prototype.exportAliasName=function(e){return e?this.getTypeFormat():m.declare+m.space+this.getTypeFormat()},t}(_);t.TypeFunctionData=A;var I=function(e){function t(t,n,i,s){void 0===i&&(i=""),void 0===s&&(s="");var a=e.call(this,t,n)||this;return a.apiName=n,a.baseName=i,a.constructorFormat=s,a.fields=[],a.baseName="",a}return __extends(t,e),t.prototype.setBaseName=function(e){this.baseName=e},t.prototype.setConstructor=function(e){this.constructorFormat=e},t.prototype.addField=function(e,t,n,i){var s=!1;this.fields.every(function(t){return t.key!=e||t.isStatic!=n||(s=!0,!1)}),s||this.fields.push({key:e,value:t,isStatic:n,isMemberFunction:i})},t.prototype.getFieldFormat=function(){for(var e="",t="",n=0;n<this.fields.length;n++){var s=this.fields[n],a=s.key;s.isMemberFunction||(a+=m.colon+m.space),a+=s.value+m.semicolon,a+=m.newline,s.isStatic?t+=a:e+=a}return{staticFields:t,memberFields:e}},t.prototype.getStaticTypeFormat=function(){var e=this.getJSName(),t=m.interface+m.space+e.name+m.typeAdd+m.space+m.blockOpen+m.newline,n=this.getFieldFormat().staticFields;return this.constructorFormat||(this.constructorFormat=m.functionOpen+m.functionClose),t+=m.new+this.constructorFormat+m.colon+this.getJSName().name+m.semicolon,t+=m.newline+m.prototype_1+m.colon+m.space+e.name+m.semicolon,t+=m.newline+n,t+=m.newline+m.blockClose,t},t.prototype.getMemberTypeFormat=function(){var e=m.interface+m.space,t=this.getJSName();e+=t.name,this.baseName&&(e+=m.space+m.extends+m.space+this.baseName),e+=m.space+m.blockOpen+m.newline;var n=this.getFieldFormat().memberFields;return e+=n,e=e.trim(),e+=m.newline+m.blockClose,e+=m.newline,e},t.prototype.exportToTS=function(){var e=this.getMemberTypeFormat()+m.newline+this.getStaticTypeFormat(),t=new S(this.apiName,this.sysId,e,this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return S.updateFlags(t,this.currentSI,this.getInternalType()),t},t.prototype.getInternalType=function(){return g.cls},t.prototype.exportAliasName=function(e){if("global.JSON"==this.apiName)return"";var t=m.const+m.space+this.getJSName().name+m.space+m.colon+m.space+this.apiName+m.typeAdd+m.semicolon;return e?t:m.declare+m.space+t},t}(_);t.TypeClassData=I;var x=function(){return function(e,t,n,i,s,a){void 0===a&&(a=""),this.apiName=e,this.scope=t,this.declaration=n,this.accessType=i,this.sysId=s,this.aliasFormat=a}}();t.TSClassDefinitionFormat=x,t.wrapInNamespace=s,t.wrapInInterface=a;var E={"global.XMLDocument":!0,"global.JSON":!0},M=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=!1),this.siJSData=e,this.emitForVSCode=t}return e.prototype.emit=function(e,t){void 0===t&&(t={});var n="",i="",a={};for(var r in this.siJSData)for(var o=0,p=this.siJSData[r],l;o<p.length;o++)if(l=p[o],l.sp){var d=l.sp.split(".");if(1==d.length){a[r]=a[r]||{},a[r][l.sp]=!0;continue}a[d[0]]=a[d[0]]||{},a[d[0]][d[1]]=!0}for(var r in this.siJSData){for(var c="",g=e==r||this.emitForVSCode,f="",u="",y=0,h=this.siJSData[r],l;y<h.length;y++){if(l=h[y],!l.f){console.warn("skipping declaration for => "+l.api);continue}if(!t[l.id]){var C=this.emitForVSCode||S.isPublic(l.f);(g||C||a[r]&&a[r][l.api])&&(c+=l.tf+m.newline),(C||g&&!C)&&"string"==typeof l.af&&0!=l.af.length&&(f+=l.af+m.semicolon+m.newline),g&&!E[r+"."+l.api]&&"string"==typeof l.gf&&(u+=l.gf+m.semicolon+m.newline)}}0<f.length&&(c+=m.newline+f.trim()),0<u.length&&(i+=u.trim()+m.newline);var T=s(c,r)+m.newline;n+=T}return n.trim()+m.newline+i.trim()},e.prototype.getSysIdMap=function(){var e={};for(var t in this.siJSData)for(var n=this.siJSData[t],s=0;s<n.length;s++)e[n[s].id]=n[s];return e},e}();t.DefinitionEmittor=M;var F=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t,!0)||this;return n.siJSData=t,n.interfaceFormat={},n.aliasFormat={},n.globalAliasFormat={},n.typeMapFormat={},n.allJSTypes={},n.scopeTypes={},n}return __extends(t,e),t.prototype.exportJSON=function(){return JSON.stringify(this.siJSData)},t.prototype.addType=function(e){var t=e.api.split("."),n=t[0];this.siJSData[n]=this.siJSData[n]||[],this.siJSData[n].push(e)},t.prototype.emit=function(){return e.prototype.emit.call(this,"")},t}(M);t.DefinitionEmittorForVSCode=F;var N={var:"var"};t.stripPrivateTypes=o,t.getEmittor=p,t.emitDeclarationForScope=d,t.parseSI=c;var k;(function(e){function t(e){var t=0;do if(" "!==e[t])return t;while(++t<e.length);return t}function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},s=Array.prototype.slice.call(arguments),a=0,r=s.length,o,p;a<r;a++)for(o in p=s[a],p)p.hasOwnProperty(o)&&(n[o]=p[o]);return n}function i(e,t){for(var n=e.length,s=!0,a;n--;){for(a in t)t.hasOwnProperty(a)&&(s=t[a]===e[n][a]&&s);if(s)return e[n]}return null}function s(e,t){if("string"!=typeof e||"@"!==e[0])return null;var i=t.reduce(function(e,t){var i;try{i=t(e.source,n({},e.data))}catch(n){e.data.errors=(e.data.errors||[]).concat(t.name+": "+n.message)}return i&&(e.source=e.source.slice(i.source.length),e.data=n(e.data,i.data)),e},{source:e,data:{}}).data;return i.optional=!!i.optional,i.optional&&!!i.type&&(i.type=i.type.substring(0,i.type.length-1)),i.type=void 0===i.type?"":i.type,i.name=void 0===i.name?"":i.name,i.description=void 0===i.description?"":i.description,i}function a(e,t){var n=t.trim?function(e){return e.trim()}:function(e){return e},a=e.map(function(e){return n(e.source)}).join("\n");a=n(a);var r=e[0].number;e=e.reduce(function(e,i){if(i.source=n(i.source),i.source.match(/^\s*@(\w+)/))e.push({source:[i.source],line:i.number});else{var s=e[e.length-1];if(void 0!==t.join&&!1!==t.join&&0!==t.join&&!i.startWithStar&&0<s.source.length){var a;a="string"==typeof t.join?t.join+i.source.replace(/^\s+/,""):"number"==typeof t.join?i.source:" "+i.source.replace(/^\s+/,""),s.source[s.source.length-1]+=a}else s.source.push(i.source)}return e},[{source:[]}]).map(function(e){return e.source=n(e.source.join("\n")),e});var o=e.shift();if(""===o.source&&0===e.length)return null;var p=e.reduce(function(e,n){var a=s(n.source,t.parsers);if(!a)return e;if(a.line=n.line,a.source=n.source,t.dotted_names&&-1!==a.name.indexOf(".")){for(var r=e,o=a.name.split("."),p,l;1<o.length;)p=o.shift(),l=i(r,{tag:a.tag,name:p}),l||(l={tag:a.tag,line:+a.line,name:p,type:"",description:""},r.push(l)),l.tags=l.tags||[],r=l.tags;return a.name=o[0],r.push(a),e}return e.concat(a)},[]);return{tags:p,line:r,description:o.source,source:a}}function r(e){var t=0,i=0,s;return e=n({},{trim:!0,dotted_names:!1,parsers:[o.parse_tag,o.parse_type,o.parse_name,o.parse_description]},e||{}),function(n){var r=n.indexOf("/**"),o=n.indexOf("*/"),p;if(-1!==r&&n.indexOf("/***")!==r&&(s=[],t=r+3),s){var l=t,d=!1,c=n.match(/\S/);0<s.length&&c&&("*"===c[0]?(l=c.index+2,d=!0):c.index<t&&(l=c.index)),s.push({number:i,startWithStar:d,source:n.slice(l,-1===o?n.length:o)}),-1!==o&&(p=a(s,e),s=null,t=0)}return i+=1,p}}var o={parse_tag:function(e){var t=e.match(/^\s*@(\S+)/);if(!t)throw new Error("Invalid `@tag`, missing @ symbol");return{source:t[0],data:{tag:t[1]}}},parse_type:function(e,n){if(n.errors&&n.errors.length)return null;var i=t(e),s="",a=0;if("{"!==e[i])return null;for(;i<e.length&&(a+="{"===e[i]?1:"}"===e[i]?-1:0,s+=e[i],i++,0!==a););if(0!==a)throw new Error("Invalid `{type}`, unpaired curlies");return{source:e.slice(0,i),data:{type:s.slice(1,-1)}}},parse_name:function(e,n){if(n.errors&&n.errors.length)return null;for(var i=t(e),s="",a=0;i<e.length&&(a+="["===e[i]?1:"]"===e[i]?-1:0,s+=e[i],i++,!(0===a&&/\s/.test(e[i]))););if(0!==a)throw new Error("Invalid `name`, unpaired brackets");var r={name:s,optional:!1,default:""};if(/=$/.test(n.type)&&(r.optional=!0),"["===s[0]&&"]"===s[s.length-1]&&(r.optional=!0,s=s.slice(1,-1),-1!==s.indexOf("="))){var o=s.split("=");s=o[0],r.default=o[1].replace(/^(["'])(.+)(\1)$/,"$2")}return r.name=s,{source:e.slice(0,i),data:r}},parse_description:function(e,t){if(t.errors&&t.errors.length)return null;var n=e.match(/^\s+((.|\s)+)?/);return n?{source:n[0],data:{description:void 0===n[1]?"":n[1]}}:null}};e.parse=function(e,t){for(var n=[],s=r(t),a=e.split(/\n/),o=0,p=a.length,l;o<p;o++)l=s(a.shift()),l&&n.push(l);return n}})(k||(k={}));var v={"global.PwdEmailNotificationManager._sendCodeToDevices":"(devices, code, userSysId?: string)","global.OCDHTMLXCalendarFormatter.initialize":"(groupEvents?: any)","global.OCRotationV2.initialize":"(schedulePage, formatter?: any)","global.WorkflowIconsSCR.initialize":"(ref?: any)","global.KnowledgeTypeDefaultsAjax.getValue":"(ge?: any)","global.SchedulePriorityECCJob.initialize":"(label?: any, document?: any, script?: any)","global.ClientTestRunnerBrowserInfo.initialize":"(browserName, version, osName, osVersion?: any)","global.PwdSMSNotificationManager._sendCodeToDevices":"(devices, code, userSysId?: string)","global.KBViewModelSNC.getKnowledgeRecord":"(query?: any, value?: any, stopWorkflow?: any)","global.KBMyKnowledgeSNC.initialize":"(type?: any, windowStart?: any)","global.sc_ic_RequestedItem.initialize":"(_gr, _gs, _workflow?: any)","global.StdChangeUtilsSNC.getValue":"(property?: any)","sn_schedule_pages.CMNScheduleRESTWrapper.getEvents":"(params?: any)","sn_schedule_pages.CMNScheduleRESTWrapper.updateEvent":"(params?: any)","sn_comm_management.CommunicationManagementChannelAbstractSNC.getConfig":"(sourceTable: string)"},D;(function(e){e[e.typeDefs=0]="typeDefs",e[e.callback=1]="callback"})(D=t.JSDocTypes||(t.JSDocTypes={}));var P;(function(e){function s(e){function t(t,n,i){if("<"!=e[0]&&"("!=e[0])throw"Not a function";for(var s=-1,a=0,r=!1;t<e.length;t++)if(e[t]==n&&(-1==s&&(s=t),a++),e[t]==i&&(a--,0==a)){t++,r=!0;break}return{start:s,length:r?t-s:0}}var n={template:"",paramBody:"",returnType:""},i=t(0,"<",">"),s=0;0!=i.length&&(n.template=e.substr(i.start,i.length),s=1);var a=t(s,"(",")");if(0==a.length)throw"Not a arrow function";n.paramBody=e.substr(a.start,a.length);var r=a.start+a.length,o=e.substr(r).trim();if(0==o.indexOf("=>"))o=o.replace("=>","").trim();else throw"Not a function";return n.returnType=o,n}function a(e,t,n,i){return ts.typeToDisplayParts(e,t,n,i)}function r(e){var t="";for(var n in e){var i=c(e[n],n);0<i.decl.length&&(t+="\n"+i.decl+"\n")}return t}function o(e){O[e]=!0}function p(){O={}}function l(e){w[e]=!0}function d(e){return!!(w[e]||O[e])}function c(e,t){function n(e){var t="";for(var i in e)if("object"==typeof e[i]){var s=n(e[i]);t+="namespace "+i+" {\n"+s+"\n}\n"}else"string"==typeof e[i]&&(t+=e[i]);return t}var s={decl:""};if(!Array.isArray(e))return s;for(var a={},r=0;r<e.length;r++)for(var o=0,p;o<e[r].length;o++)if(p=e[r][o],p.name){var d=p.name.split("."),c="",g=d.splice(d.length-1,1)[0],f=p.type.trim();c=f.startsWith("{")?f.endsWith("[]")?"type "+g+" = "+f+"; \n\n":"interface "+g+" "+f+"\n\n":"interface "+g+" extends "+f+" {}\n",l(t+"."+g);for(var u=a,m=0;m<d.length;m++)u[d[m]]=u[d[m]]||{},"string"==typeof u[d[m]]&&(console.log("module is defined as type overriding the type with modue "),u[d[m]]={}),u=u[d[m]];u[g]=c}var y=n(a);return 0==y.length?s:(y="declare namespace "+t+" {\n\t\t\t"+y+"\n\t\t}",s.decl=y,s)}function f(e,t){void 0===t&&(t="-1");var n={};for(var s in e){n[s]||(n[s]=[]);for(var a=0;a<e[s].length;a++)Array.isArray(e[s][a].td)&&e[s][a].id!=t&&n[s].push(e[s][a].td)}return n}function u(e){for(var t=0,n=[],s=0,a=0;a<e.length;a++)if(n.push(e[a]),"punctuation"==e[a].kind){if("{"==e[a].text){s++;continue}if("}"==e[a].text){s--;continue}if(0==s)continue;if(":"!=e[a].text&&"("!=e[a].text&&"<"!=e[a].text)continue;if("<"==e[a].text){if(1>a)continue;if("methodName"!=e[a-1].kind)continue}for(var r=n.length-2;1<r;){var o=n[r].kind,p=n[r].text;if(("punctuation"!=o||"."!=p)&&"propertyName"!=o&&"localName"!=o&&"methodName"!=o){r++;break}r--}n.splice(r,n.length-r-2)}t=0;var l=n.filter(function(e){return 0<t?(t--,!1):("keyword"==e.kind&&"typeof"==e.text?(t=2,e.text="any"):"functionName"==e.kind&&(e.text="Function"),!0)}),d={kind:"type",text:""};return d=l.reduce(function(e,t){return e.text+=t.text,e},{text:"",kind:"type"}),d.text.endsWith("...")?"any":d.text}function m(e,t,n,l){function c(e){return{isOptional:!1,name:e.getName(),documentation:ts.displayPartsToString(e.getDocumentationComment(l)),type:l.typeToString(l.getTypeOfSymbolAtLocation(e,e.valueDeclaration),void 0,ts.TypeFormatFlags.UseFullyQualifiedType)}}function g(e,t){void 0===t&&(t=!1);var n=e.getTypeParameters(),i=[];null!=n&&n.forEach(function(e){var t=e.getSymbol();t&&i.push(t.getName())});var s=ts.TypeFormatFlags.UseFullyQualifiedType;s|=ts.TypeFormatFlags.WriteArrayAsGenericType,s|=ts.TypeFormatFlags.NoTruncation;var r="";if(!t){var o=a(l,e.getReturnType(),void 0,s);r=u(o)}var p=ts.displayPartsToString(e.getDocumentationComment(l)),d={line:0,character:0};return 0<p.length&&(d.doc=p),{lineInfo:d,parameters:e.parameters.map(c),returnType:r,documentation:p,typeParams:i}}function f(e){var t=I.getLineAndCharacterOfPosition(e.pos);return t.line+=1,t.character+=1,{line:t.line,character:t.character}}function m(t){function n(){return-1!=t.body.getText().indexOf("return this;")||!e.parseReturnType}function i(e){if(!(ts.isFunctionExpression(e)||ts.isFunctionDeclaration(e))){if(ts.isReturnStatement(e)){if(3!=e.getChildCount())return;var t=e.getChildAt(1);if(ts.isObjectLiteralExpression(t)){var n=h(t),s=new L("temp");s.setKeysType(n);var r=s.toTypeFormat();return void(-1==o.indexOf(r)&&o.push(r))}var p=!1;if(ts.isFunctionExpression(t)&&(p=!0),"this"==t.getText())return void o.push("this");var d=l.getTypeAtLocation(t),c=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,g=a(l,d,void 0,c),f=u(g);return"any"==f||0<=o.indexOf(f)?void 0:void(p?o.unshift(f):o.push(f))}e.forEachChild(i)}}var s=f(t),o=[],p=l.getTypeAtLocation(t).getCallSignatures().map(function(e){return g(e,n())}),r=b(t);if(0<r.length&&(p[0].returnType=r),p[0].lineInfo=s,n()&&(p[0].returnType="this"),p[0].parameters.length>t.parameters.length&&p[0].parameters.splice(p[0].parameters.length-1,1),0<t.parameters.length){var d=0;t.parameters.forEach(function(e){p[0].parameters[d++].isOptional=l.isOptionalParameter(e)})}var c=ts.getJSDocReturnTag(t),m=p[0].returnType;if("Function"==m||"any"==m)try{i(t.body);var y=o.join("|");"Function"==m&&(p[0].returnType=0<y.length?y:"void")}catch(e){console.log("Return type parsing error "+e)}else if("boolean"==m&&c){var C=ts.getJSDocReturnType(t);if(C){var T=C.getText().split(" ");if(3==T.length&&"is"==T[1]){var S=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,_=a(l,l.getTypeAtLocation(t),void 0,S),A=u(_),I=C.getText();A.endsWith(I)&&(p[0].returnType=I)}}}return p}function y(e){var t=[],i=e.getChildren(n).find(ts.isBlock);if(!i)return t;var r=i.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});if(!r)return t;var o=r.getChildren(n).filter(ts.isExpressionStatement);return o.forEach(function(e){var i=f(e),r=e.getChildren(n).find(ts.isBinaryExpression);if(!r)return t;var o=r.getChildren(),p=o.find(ts.isPropertyAccessExpression);if(!p)return t;var d=p.getChildren();if(d[0].kind!=ts.SyntaxKind.ThisKeyword)return t;var c=d[d.length-1],g=c.getText(),m=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,y=o[o.length-1];i=f(y);var h="";if(ts.isNumericLiteral(y))h="number";else if(ts.isStringLiteral(y))h="string";else if(ts.isLiteralTypeNode(y))h="number";else if(ts.SyntaxKind.FalseKeyword==y.kind||ts.SyntaxKind.TrueKeyword==y.kind)h="boolean";else if(ts.SyntaxKind.FirstLiteralToken==y.kind)h="number";else{h=l.typeToString(l.getTypeAtLocation(y),n,0);var C=a(l,l.getTypeAtLocation(y),void 0,ts.TypeFormatFlags.UseFullyQualifiedType),T=u(C);h!=T&&(h=T),"Function"==h&&(h="any")}var S=!1;try{var _=s(h);S=!0,t.push(new v(g,_.paramBody,_.returnType,_.template).setLineInfo(i))}catch(t){}S||t.push(new F(g,h).setLineInfo(i).setLineInfo(i))}),t}function h(e,t){void 0===t&&(t=!1);var i={};return e.properties.forEach(function(e){var r=e.name.getText(),o=e.getChildren(),p=o.find(ts.isIdentifier),d=o.find(ts.isFunctionExpression);if(t&&d&&"initialize"==r){var c=y(d);c.forEach(function(e){i[e.name]=e})}var g=o[o.length-1],h="",C=ts.isStringLiteral(o[0]),T=f(g);if(ts.isNumericLiteral(g))i[r]=new E(r,"number").setLineInfo(T);else if(ts.isStringLiteral(g))i[r]=new M(r,"string").setLineInfo(T);else if(d){var S=m(d),_=P.create(r,S[0]);i[r]=_}else{var b=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals;h=l.typeToString(l.getTypeAtLocation(g),void 0,b);var A=l.typeToString(l.getTypeAtLocation(e),n,b);h!=A&&(console.log("different types found, overriding default one"),h=A);var I=a(l,l.getTypeAtLocation(e),void 0,b);h=u(I);var x=!1;try{var S=s(h);i[r]=new v(r,S.paramBody,S.returnType,S.template),x=!0}catch(t){}x||(i[r]=new F(r,h))}C&&i[r].setAsElement(),i[r].setLineInfo(T)}),i}function C(e,t,n){var i=f(t),a=ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.MultilineObjectLiterals,r=l.typeToString(l.getTypeAtLocation(t),void 0,a),o=!1;try{var p=s(r);o=!0,e==x?(O.addConstructorFunction(new v(e,p.paramBody,p.returnType,p.template).setLineInfo(i)),O.setAsFunction()):O.addField(new v(e,p.paramBody,p.returnType,p.template).setLineInfo(i))}catch(t){}o||O.addField(new F(e,r,n).setLineInfo(i))}function T(e){var t=e.getChildren().find(ts.isParenthesizedExpression),n;if(!t)return n;var i=t.getChildren().find(ts.isFunctionExpression);if(!i)return n;var s=i.getChildren().find(ts.isBlock);if(!s)return n;var a=s.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});return a}function S(e){var t=[],n=e.getChildCount();if(!(1<=n&&2>=n))return t;var i=e.getChildAt(0);if(!ts.isCallExpression(i))return t;var s=T(i);return s?s.getChildren():t}function _(e){var t=ts.getJSDocTags(e).filter(ts.isJSDocTypedefTag);t.forEach(function(e){var t=e.getChildren(),i=ts.getNameOfJSDocTypedef(e);if(console.log(i.getText()),3==t.length){var r=t.find(ts.isModuleDeclaration);if(r&&!R[r.getText()]){var p=t[2].getChildren();p.forEach(function(e){var t=l.getTypeAtLocation(e),i=a(l,t,n,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType);console.log(u(i))})}var d=t[2],c="any",g=d.getText().trim(),f=g;if(!r){var m=l.getSymbolAtLocation(d);if(!m)return;var y=a(l,l.getDeclaredTypeOfSymbol(m),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType);if(c=u(y),"any"==c){var h="",C=l.getDeclaredTypeOfSymbol(m),T=C.getProperties();C.getApparentProperties(),T.forEach(function(e){var t=l.typeToString(l.getTypeOfSymbolAtLocation(e,e.valueDeclaration),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType),n="";try{var i=s(t);n=i.template+i.paramBody+": "+i.returnType}catch(t){}h+=0<n.length?""+e.getEscapedName()+n+",\n":e.getEscapedName()+": "+t+",\n"}),c="{\n\t\t\t\t\t\t\t\t"+h+"\n\t\t\t\t\t\t\t}"}}else{var S=g.split(".");if(S.shift(),g=S.join("."),1>t[1].getChildCount())return;var _=l.getTypeAtLocation(t[1].getChildren()[1]),b=a(l,_,void 0,void 0);if(c=u(b),"any"==c){var A="",I=[];try{I=t[1].getChildren()[1].getChildAt(1).getChildren()}catch(t){console.log("typedef parsing error")}I.forEach(function(e){var t=e.getChildren().find(ts.isIdentifier);if(null!=t){var n=a(l,l.getTypeAtLocation(e),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType),i=u(n),r="";try{var o=s(i);r=""+o.template+o.paramBody+": "+o.returnType}catch(t){}A+=0<r.length?""+t.getText()+r+",\n":t.getText()+": "+i+",\n"}}),A="{"+A+"}",c=A}}"any"==c?console.warn("typedef came as any "+g):(o(f),O.addTypedefData({type:c,kind:D.typeDefs,name:g}))}})}function b(e){var t=ts.getJSDocReturnTag(e);if(!t)return"";var n=ts.getJSDocReturnType(e);return n?d(n.getText())?n.getText():"":""}function A(e,t){void 0===t&&(t=!0),_(e);var i=f(e);if(ts.isVariableStatement(e)){var o=e.declarationList.declarations[0],p=o.getChildren(n);if(1==p.length)return void(w=p[0].getText().trim()==x);if(3!=p.length)return;var d=p[0],c=p[2];if(ts.isObjectLiteralExpression(c)&&(B[d.getText().trim()]=c),w)return;if(ts.isIdentifier(d)){if(d.getText().trim()!=x)return;if(ts.isCallExpression(c)){var I=c.getFullText().trim();if("Class.create()"==I)return w=!0,void O.setAsClass();var F=T(c);if(F)F.getChildren(n).forEach(function(e){A(e,!1)});else{var k=l.getTypeAtLocation(c),v=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,D=a(l,k,void 0,v),j=u(D);if(j.startsWith("{")&&j.endsWith("}"))w=!0,O.addField(new V(x,j).setLineInfo(i)),O.setAsObjectLiteral();else try{s(j)}catch(t){}}}else if(ts.isObjectLiteralExpression(c)){w=!0;var R=h(c),U=new L(x);U.setLineInfo(i),U.setKeysType(R),O.addField(U),O.setAsObjectLiteral()}else if(ts.isFunctionExpression(c)){w=!0,O.setAsFunction();var J=m(c);O.addConstructorFunction(P.create(x,J[0]));var W=y(c);0<W.length&&O.setAsClass(),W.forEach(function(e){return O.addField(e)})}else if(ts.isIdentifier(c)){var z=c.getText().trim();if(!B[z])return;w=!0;var R=h(B[z]),U=new L(x);U.setKeysType(R),O.addField(U),O.setAsObjectLiteral()}else if(ts.isParenthesizedExpression(c)){var G=c.getChildren().filter(ts.isFunctionExpression);if(0!=G.length){w=!0,O.setAsFunction();var J=m(G[0]);O.addConstructorFunction(P.create(x,J[0]))}else{if(1!=n.statements.length)return;var K=c.getChildren().filter(ts.isCallExpression);if(1!=K.length)return;var q=K.find(ts.isCallExpression);if(!q)return;var H=q.getChildren().find(ts.isFunctionExpression);if(!H)return;var Q=H.getChildren().find(ts.isBlock);if(!Q)return;var X=Q.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});if(!X)return;X.getChildren().forEach(function(e){A(e,!1)})}}}return}if(ts.isExpressionStatement(e)){if(!w){var Y=e.getChildren().find(ts.isBinaryExpression);if(!Y){var Z=e.getChildren();return 2==Z.length?ts.isIdentifier(Z[0])&&Z[1].kind==ts.SyntaxKind.SemicolonToken?void(w=Z[0].getText().trim()==x):void 0:void 0}var ee=Y.getChildren();if(3!=ee.length)return;var te=ee[2],ne=ee[0];if(ts.isIdentifier(ne))if(ne.getText().trim()!=x)ts.isObjectLiteralExpression(te)&&(B[ne.getText().trim()]=te);else if(ts.isCallExpression(te)){var I=te.getFullText().trim();"Class.create()"==I&&(w=!0,O.setAsClass())}else if(ts.isObjectLiteralExpression(te)){w=!0;var ie=l.getSymbolAtLocation(te),se;ie&&(se=ts.displayPartsToString(ie.getDocumentationComment(l)));var U=new L(x,se);U.setLineInfo(f(te));var ae=h(te);U.setKeysType(ae),O.addField(U),O.setAsObjectLiteral()}else if(ts.isFunctionExpression(te)){w=!0;var J=m(te);O.setAsFunction(),O.addConstructorFunction(P.create(ne.getText(),J[0]));var W=y(te);0<W.length&&O.setAsClass(),W.forEach(function(e){return O.addField(e)})}else if(ts.isIdentifier(te)){var re=te.getText().trim();if(!B[re])return;w=!0;var R=h(B[re]),U=new L(x);U.setLineInfo(f(te)),U.setKeysType(R),O.setAsObjectLiteral(),O.addField(U)}return}var oe=e.getChildren();if(1<=oe.length&&2>=oe.length&&t&&ts.isCallExpression(oe[0])){var pe=S(e);pe.forEach(function(e){A(e,!1)})}var le=oe.find(ts.isBinaryExpression);if(!le)return;var de=le.getChildren();if(3!=de.length)return;ts.isObjectLiteralExpression(de[2])&&(B[de[0].getText().trim()]=de[2]);var ce=de.find(ts.isPropertyAccessExpression),ge=void 0,fe="",ue="",me=!1;if(ce){me=!0;var ye=ce.getChildren(n).filter(ts.isIdentifier),he=ce.getText().trim(),Ce=he.split(".");if(ge=de[de.length-1],Ce[0]!=x)return;if(ts.isIdentifier(ge)&&B[ge.getText().trim()]&&(ge=B[ge.getText().trim()]),fe=Ce.join("."),3<Ce.length)return}else if(ts.isIdentifier(de[0])&&(ts.isObjectLiteralExpression(de[2])&&(B[de[0].getText()]=de[2]),de[0].getText().trim()==x&&de[1].kind==ts.SyntaxKind.FirstAssignment&&(O.clearAll(),ge=de[2],fe=x,ts.isCallExpression(ge)&&"Class.create()"==ge.getText().trim())))return O.clearAll(),void O.setAsClass();if(ge&&ts.isIdentifier(ge)&&B[ge.getText()]&&(ge=B[ge.getText()]),!ge)return;if(i=f(ge),ts.isNumericLiteral(ge))O.addField(new E(fe,"").setLineInfo(i));else if(ts.isStringLiteral(ge))O.addField(new M(fe,"").setLineInfo(i));else if(ts.isObjectLiteralExpression(ge)){var Te=h(ge,!0),Se=new L(fe,"");Se.setLineInfo(f(ge)),Se.setKeysType(Te),O.addField(Se),me||O.setAsObjectLiteral()}else if(ts.isFunctionExpression(ge)){var ae=m(ge);me?O.addField(P.create(fe,ae[0])):(O.addConstructorFunction(P.create(x,ae[0])),O.setAsFunction())}else if(fe==x+".prototype"&&ts.isCallExpression(ge)){var _e=ge.getChildren().find(ts.isPropertyAccessExpression);if(_e&&"Object.extendsObject"==_e.getText()){var X=ge.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList}),be=X.getChildCount();if(3!=be)return;var Ae=X.getChildAt(0,n);if(ts.isIdentifier(Ae)||(Ae=void 0),Ae||(Ae=X.getChildren().find(ts.isPropertyAccessExpression)),!Ae)return void console.log("unable to find the base class information");O.setAsClass();var Ie=Ae.getText();1==Ie.split(".").length&&(Ie=N+"."+Ie),O.setBaseType(Ie);var xe=X.getChildren().find(ts.isObjectLiteralExpression);if(!xe){var Ee=X.getChildren(),Me=Ee[Ee.length-1];if(ts.isIdentifier(Me)){var Fe=Me.getText().trim();xe=B[Fe]}}if(xe){var ae=h(xe,!0),Ne=new L(fe);Ne.setLineInfo(i),Ne.setKeysType(ae),O.addField(Ne)}else{var v=ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals;ue=l.typeToString(l.getTypeAtLocation(X.getChildAt(be-1)),void 0,v),-1==ue.indexOf("typeof")&&C(fe,X.getChildAt(be-1),"")}}else{var X=T(ge),pe=[];X&&(pe=X.getChildren(n)),pe.forEach(function(e){A(e,!1)});var ke=pe.filter(ts.isReturnStatement);if(0<ke.length){1<ke.length&&console.warn("Found multiple return statements in prototype assignment");var ve=ke[ke.length-1].getChildren()[1],xe=void 0;if(ts.isIdentifier(ve))xe=B[ve.getText()];else if(ts.isObjectLiteralExpression(ve))xe=ve;else if(ts.isCallExpression(ve)){var De=ve.getChildren();if(4!==De.length)return;var Pe=De[0];if(!ts.isPropertyAccessExpression(Pe))return;if("Object.extendsObject"!==Pe.getText())return;var Ve=ve.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});if(!Ve)return;var Le=Ve.getChildren();if(3!=Le.length)return;var Ae=Le[0];if(!ts.isPropertyAccessExpression(Ae))return;var Se=Le[2];if(!ts.isObjectLiteralExpression(Se))return;O.setAsClass();var Ie=Ae.getText();1==Ie.split(".").length&&(Ie=N+"."+Ie),O.setBaseType(Ie),xe=Se}if(xe){var ae=h(xe,!0),Ne=new L(fe);return Ne.setLineInfo(i),Ne.setKeysType(ae),void O.addField(Ne)}}C(fe,ge,"")}}else C(fe,ge,"")}else if(ts.isFunctionDeclaration(e)){var je=e.name.getText();if(je!=x)return;w=!0;var ie=l.getSymbolAtLocation(e.name),Oe=l.getTypeOfSymbolAtLocation(ie,ie.valueDeclaration),we=Oe.getCallSignatures().map(function(e){return g(e)}),Re=b(e);if(0<Re.length&&(we[0].returnType=Re),0<e.parameters.length){var Be=0;e.parameters.forEach(function(e){we[0].parameters[Be++].isOptional=l.isOptionalParameter(e)})}O.setAsFunction(),O.addConstructorFunction(P.create(je,we[0]));var W=y(e);0<W.length&&O.setAsClass(),W.forEach(function(e){O.addField(e)});var Ue=ts.getJSDocAugmentsTag(e);if(!Ue)return;var Je=Ue.getChildren();if(2!=Je.length)return;var We=Je[0];if(!We)return;var ze=l.getTypeAtLocation(Je[1]);if(!ze)return;var Ge=a(l,ze,void 0,ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.NoTruncation),Ke=u(Ge);0<Ke.length&&"any"!=Ke&&O.setBaseType(Ke)}else ts.isClassDeclaration(e)&&O.setAsES6()}p();var I=n,x="",N="",k=t.split(".");1==k.length?x=t:(x=k[1],N=k[0]);var O=new j(e,t,"","12345"),w=!1,R={};(function(e){function t(e){if(e){if(ts.isJSDocTypedefTag(e)){var n=ts.getNameOfJSDocTypedef(e);console.log(n.getText());var i=e.getChildren(),s=i.find(ts.isModuleDeclaration);if(!s)return;if(2<=i.length){var r=s.getText(),o=r.split(".");if(2>o.length)return void console.warn("typedef should start with 'sn' namespace");if("sn"!=o[0])return void console.warn("typedef should start with 'sn' namespace");R[r]=!0}}else if(ts.isTypeReferenceNode(e)){var p=e.getFullText();if(!R[p])return;var d=e.typeName.getChildren();if(0==d.length)return void console.log("type children must exists "+e.getFullText());var c=l.getSymbolAtLocation(d[d.length-1]);if(!c)return;var g=a(l,l.getDeclaredTypeOfSymbol(c),void 0,8388608),f=u(g);O.addTypedefData({type:f,kind:D.typeDefs,name:p})}var m=e.getChildren();0<m.length&&m.forEach(function(e){return t(e)})}}t(e)})(n);for(var B={},U=0,r;n&&U<n.statements.length;U++)r=n.statements[U],A(r);return O}function h(e){e.forEach(function(e){"javaGlobalAPI"==e.name?W=e:"tableAPI"==e.name?G=e:"javaScopedAPI"==e.name?z=e:"jsAPI"==e.name&&(K=e)}),q="string"==typeof W.json_value?JSON.parse(W.json_value).api+"\n\n"+W.customization:W.json_value.api+"\n\n"+W.customization,H="string"==typeof z.json_value?JSON.parse(z.json_value).api+"\n\n"+W.customization:z.json_value.api+"\n\n"+z.customization,Q="string"==typeof G.json_value?JSON.parse(G.json_value).api+"\n\n"+G.customization+"\n\n"+K.customization:G.json_value.api+"\n\n"+G.customization,X="string"==typeof K.json_value?JSON.parse(K.json_value).api:K.json_value.api}function b(e,t){void 0===t&&(t=!1);var n=e.split("."),i=n[0],s=n[1],a="";if(t)return X[i]?(X[i].forEach(function(e){var t=e.api.split(".");t[1]!=s&&"string"==typeof e.gf&&(a+=e.gf+";\n")}),a):(console.log("Unable to find the scope falling back to default one "+e),"");var r={},o=function(e){var t=X[e];t.forEach(function(t){if(t.sp){var n=t.sp.split(".");return 1==n.length?(r[e]=r[e]||{},void(r[e][t.sp]=!0)):void(r[n[0]]=r[n[0]]||{},r[n[0]][n[1]]=!0)}})};for(var p in X)o(p);var l=function(e){var t=X[e];a+="declare namespace "+e+" {",t.forEach(function(t){if("string"==typeof t.gf&&(S.isPublic(t.f)||e==i))a+="\n"+t.tf+"\n"+t.af+"\n";else{if(!r[e])return;r[e][t.api]&&(a+="\n"+t.tf+"\n")}}),a+="}\n"};for(var p in X)l(p);return"global"==i?q+Q+a:H+Q+a}function A(i,s,a){h(s);var o="point.js",p=f(X,a.sys_id),l=r(p),d=new eslint.Linter,c,g,u;return{dispose:function(){c&&(c.disposeAll(),c=null),g&&(g=null)},getTypeInfo:function(s,a){s.api_name||(s.api_name="global.point"),u||(u=s.api_name);var r=s.getScopeAndAPIMap();if(!c||u!=s.api_name){var p=0;s.access==y.public&&(p|=T.public),p|=T.cls;var f=new S(s.api_name,s.sys_id,"export class "+r.name+" { prop: number; }","","",s.access,"",p),h=s.formatCurrentSITSFormat(f),C=i+"\n\n"+b(s.api_name)+"\n\n\n"+b(s.api_name,!0);C+="\n\n"+h+"\n\n"+l+"\n\n"+K.customization+"",c||(c=new U(C)),u!=s.api_name&&(u=s.api_name,c.updateLib(C))}var _={js:"",declaration:"",sourceMap:"",afterDotWalK:"",errorMsg:t.ERROR_MSG,linterErrors:[],tsDeclaration:""},A="pointOut.js",I=3.7<=parseFloat(ts.versionMajorMinor);if(s.isJavascript()){a.allowJs=!0,a.declaration=I&&self.recordConfig.isES6,a.removeComments=!0,a.noEmitOnError=!0,a.outFile=A;var x=s.tsscript;self.recordConfig.isES6&&!self.recordConfig.isFromScriptRunner&&(x+="\n "+r.name+" = global.__extends(Class.create(), "+r.name+");\n"),c.updateSI(x)}else{a.allowJs=!1,a.declaration=!0;var x=s.tsscript;self.recordConfig.isFromScriptRunner||(x+="\n "+r.name+" = global.__extends(Class.create(), "+r.name+");\n"),c.updateTypeScriptSI(x),o="point.ts"}a.noLib=!0,a.types=["snlib"],ts.defaultMaximumTruncationLength=1e4,a.noResolve=!1,a.skipLibCheck=!0,g=ts.createProgram([o],a,c,g);var E=g.emit(g.getSourceFile(o),void 0,void 0,void 0,{before:[e.dotWalkingTransformer]}),M=ts.getPreEmitDiagnostics(g).concat(E.diagnostics);if(M.forEach(function(e){if(e.file){var t=e.file.getLineAndCharacterOfPosition(e.start),n=t.line,i=t.character,s=ts.flattenDiagnosticMessageText(e.messageText,"\n");console.log(e.file.fileName+" ("+(n+1)+","+(i+1)+"): "+s)}else console.log(""+ts.flattenDiagnosticMessageText(e.messageText,"\n"))}),E.emitSkipped)return _;var F=c.getOutFiles();if(s.isTypescript()?(_.js=F["point.js"],_.sourceMap=F["point.js.map"]):(I&&(_.tsDeclaration=F["pointOut.d.ts"]),_.js=F[A],_.sourceMap=F[A+".map"]),_.afterDotWalK=s.tsscript,_.errorMsg="",s.isTypescript())return _.tsDeclaration=_.declaration=F["point.d.ts"],_;var N;try{N=m(s,s.api_name,g.getSourceFile(o),g.getTypeChecker()),N.sysId=s.sys_id,N.accessType=s.access;var k=N.toMinifiedInterfaceFormat();_.declaration=JSON.stringify(k),_.afterDotWalK=s.tsscript,a.linter&&(_.linterErrors=d.verify(s.tsscript,n.eslintConfig))}catch(t){_.errorMsg=JSON.stringify({error:t+"",id:1})}return _}}}var I;(function(e){e[e.NumericLiteral=0]="NumericLiteral",e[e.StringLiteral=1]="StringLiteral",e[e.StringType=2]="StringType",e[e.FunctionType=3]="FunctionType",e[e.ObjectLiteral=4]="ObjectLiteral",e[e.AnonymouseStringLiteral=5]="AnonymouseStringLiteral"})(I=e.LiteralType||(e.LiteralType={}));var x=function(){function e(e,t,n,i){void 0===i&&(i=!1),this.name=e,this.type=t,this.doc=n,this.isStringPropertyElement=i}return e.prototype.setLineInfo=function(e){return this.lineInfo=e,this},e.prototype.toJSONDecl=function(){var e={};return e.f=this.toTypeFormat(),this.lineInfo&&(e.l=this.lineInfo.line,this.lineInfo.doc&&(e.d=this.lineInfo.doc)),e},e.prototype.setDoc=function(e){this.doc=e},e.prototype.setAsElement=function(){this.isStringPropertyElement=!0},e.isNumericType=function(t){return t instanceof e&&t.type==I.NumericLiteral},e.isStringLiteral=function(t){return t instanceof e&&t.type==I.StringLiteral},e.isStringType=function(t){return t instanceof e},e.isParamType=function(e){return e instanceof N},e.isFunctionType=function(t){return t instanceof e&&t.type==I.FunctionType},e.isRawFunctionType=function(e){return e instanceof v},e.isObjectLiteral=function(t){return t instanceof e&&t.type==I.ObjectLiteral},e.isAnonymousStringType=function(t){return t instanceof e&&t.type==I.AnonymouseStringLiteral},e.prototype.getPropertyName=function(){if(this.isStringPropertyElement)return this.name;var e=this.name.split(".");return e[e.length-1]},e.prototype.isStatic=function(){var e=this.name.split(".");return!(2>e.length)&&"prototype"!=e[1]},e}();e.RawFieldType=x;var E=function(e){function t(t,n){return e.call(this,t,I.NumericLiteral,n)||this}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.getPropertyName()+": number"},t}(x);e.NumericLiteralType=E;var M=function(e){function t(t,n){return e.call(this,t,I.StringLiteral,n)||this}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.getPropertyName()+": string"},t}(x);e.StringLiteralType=M;var F=function(e){function t(t,n,i){var s=e.call(this,t,I.StringType,i)||this;return("true"==n||"false"==n)&&(n="boolean"),n=n.replace(/undefined\[\]/g,"Array<any>"),s.rawType=n,s}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.getPropertyName()+": "+this.rawType},t}(x);e.StringType=F;var N=function(e){function t(t,n,i,s){void 0===i&&(i=!1);var a=e.call(this,t,n,s)||this;return a.isOpt=i,a}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.isOpt?this.name+(this.isOpt?"?: ":": ")+this.rawType:"any"==this.rawType?this.name:this.name+": "+this.rawType},t}(F);e.ParamInfoType=N;var k=function(e){function t(t,n){return e.call(this,"",t,n)||this}return __extends(t,e),t.prototype.toTypeFormat=function(){return"any"==this.rawType?"":this.rawType},t}(F);e.AnonymousStringType=k;var v=function(e){function t(t,n,i,s,a){var r=e.call(this,t,n,a)||this;return r.returnType=i,r.templateBody=s,r}return __extends(t,e),t.prototype.getParts=function(){var e="";!this.templateBody||(e=this.templateBody),e+=this.rawType;var t;return this.returnType&&"any"!=this.returnType&&(t=this.returnType),{name:this.getPropertyName(),body:e,returnType:t}},t.prototype.getParamsFormat=function(){var e=this.getParts();return e.body},t.prototype.getClsFunctionFormat=function(){var e=this.getParts();return e.returnType?e.body:e.body+": "+e.returnType},t.prototype.toTypeFormat=function(){var e="",t=this.getParts();return e=t.name+t.body,!t.returnType||(e+=": "+t.returnType),e},t}(F);e.RawFunctionType=v;var P=function(e){function t(t,n){return e.call(this,t,I.FunctionType,n)||this}return __extends(t,e),t.prototype.getParts=function(){var e=this.getPropertyName(),t="";if(Array.isArray(this.typeParams)&&0<this.typeParams.length&&(t="<"+this.typeParams.join(", ")+">"),Array.isArray(this.params)&&0<this.params.length){var n=[];this.params.map(function(e){n.push(e.toTypeFormat())}),t+="("+n.join(",")+")"}else t="()";var i;return this.returnType&&"any"!=this.returnType&&(i=this.returnType),{name:e,body:t,returnType:i}},t.prototype.getParamsFormat=function(){var e=this.getParts();return e.body},t.prototype.getClsFunctionFormat=function(){var e=this.getParts();return e.returnType&&(!e.returnType||"any"!=e.returnType)?e.body+": "+e.returnType:e.body},t.prototype.toTypeFormat=function(){var e=this.getParts();return e.returnType&&(!e.returnType||"any"!=e.returnType)?e.name+e.body+": "+e.returnType:e.name+e.body},t.prototype.addParam=function(e,t,n,i){void 0===n&&(n=!1),Array.isArray(this.params)||(this.params=[]),this.params.push(new N(e,t,n,i))},t.prototype.setReturnType=function(e,t){this.returnType=e,this.returnDoc=t},t.prototype.setTypeParams=function(e){Array.isArray(e)&&0<e.length&&(this.typeParams=e)},t.create=function(e,n){var i=new t(e,n.documentation);return n.parameters.forEach(function(e){i.addParam(e.name,e.type,e.isOptional,e.documentation)}),n.lineInfo&&i.setLineInfo(n.lineInfo),i.setReturnType(n.returnType),i.setTypeParams(n.typeParams),i},t}(x);e.FunctionType=P;var V=function(e){function t(t,n){var i=e.call(this,t,I.StringType)||this;return i.typeFormat=n,i}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.typeFormat},t.prototype.toJSONDecl=function(){var e=this.toTypeFormat().trim();return e.startsWith("{")&&(e=e.substring(1)),e.endsWith("}")&&(e=e.substr(0,e.length-1)),e=e.trim(),{l:0,f:e}},t}(x);e.RawStringObjectLiteralType=V;var L=function(e){function t(t,n){return e.call(this,t,I.ObjectLiteral,n)||this}return __extends(t,e),t.prototype.addField=function(e){this.keys[e.name]=e},t.prototype.setKeysType=function(e){this.keys=e},t.prototype.getPartsWithLineInfo=function(){var e=[];for(var t in this.keys){var n={};n.f=this.keys[t].toTypeFormat(),this.keys[t].lineInfo&&(n.l=this.keys[t].lineInfo.line,this.keys[t].lineInfo.doc&&(n.d=this.keys[t].lineInfo.doc)),e.push(n)}return e},t.prototype.getParts=function(){var e=[];for(var t in this.keys)e.push(this.keys[t].toTypeFormat());return e},t.prototype.toTypeFormat=function(){var e="{\n",t=this.getParts();return e+=t.join(";\n"),e+="\n}",e},t}(x);e.ObjectLiteraltype=L;var j=function(e){function t(t,n,i,s){var a=e.call(this,t,n,i,s)||this;return a.fields={},a.flags=0,a.isES6=!1,a}return __extends(t,e),t.prototype.setAsES6=function(){this.isES6=!0,this.flags|=T.jsES6},t.prototype.getInternalType=function(){return this.isClass()||this.isSubClass()?g.cls:this.isFunctionType()?g.fun:this.isObjectLiteral()?g.var:g.never},t.prototype.clearAll=function(){this.fields={}},t.prototype.exportToTS=function(){var e;return e},t.prototype.addConstructorFunction=function(e){this.constFun=e},t.prototype.addField=function(e){var t=e.name.split(".");if(1<t.length&&"prototype"==t[1])this.setAsClass();else if(this.isObjectLiteral()){var n=e.name.split("."),i=this.fields[n[0]];return void(i instanceof L&&2==n.length&&(e.name=n[1],i.addField(e)))}this.fields[e.name]=e},t.prototype.exportAliasName=function(){return""},t.prototype.isSubClass=function(){return!!this.baseName},t.prototype.setBaseType=function(e){this.baseName=e},t.prototype.setAsFunction=function(){this.resetState(),this.flags|=T.fun},t.prototype.isFunctionType=function(){return!!(this.flags&T.fun)},t.prototype.setAsObjectLiteral=function(){this.resetState(),this.flags|=T.obj},t.prototype.isObjectLiteral=function(){return!!(this.flags&T.obj)},t.prototype.resetState=function(){this.flags=0},t.prototype.setAsClass=function(){this.resetState(),this.flags|=T.cls},t.prototype.isClass=function(){return!!(this.flags&T.cls)},t.prototype.addTypedefData=function(e){this.typeDefs||(this.typeDefs=[]),this.typeDefs.push(e)},t.prototype.toMinifiedInterfaceFormat_1=function(){var e=this,t=this.apiName.split("."),n=t[0],i=t[1],s="",a="",r=Object.keys(this.fields),o="",p;if(0==this.flags&&1==Object.keys(this.fields).length)this.fields[i];if(this.isObjectLiteral()){var l="";for(var d in this.fields)this.fields[d]instanceof L?l+=this.fields[d].toTypeFormat():this.fields[d]instanceof V&&(l+=this.fields[d].toTypeFormat());var c={api:i,id:this.sysId,tf:l,f:0};return S.updateFlags(c,this.currentSI,this.getInternalType()),c}if(r.forEach(function(t){var n=e.fields[t],r="";if(t!=i+".prototype")r=n.toTypeFormat()+";\n",n.isStatic()?x.isObjectLiteral(n)?a+=n.getPropertyName()+": "+r:a+=r:x.isObjectLiteral(n)?s+=n.getPropertyName()+": "+r:s+=r;else if(x.isObjectLiteral(n)){r=n.getParts().join(";\n"),0<r.length&&(s+=r+";\n");var l=n.keys.initialize;l&&x.isFunctionType(l)&&(p=l)}else x.isStringType(n)&&(o=n.rawType,"{"==o[0]&&o[o.length-1]||(o=""))}),this.isClass()){var g="new";p=p||this.constFun,g+=p?p.getParamsFormat()+": "+this.apiName:"(): "+this.apiName,a=g+";\nprototype: "+this.apiName+";\n"+a}this.isFunctionType()&&!!this.constFun&&(this.constFun instanceof P?a=this.constFun.getClsFunctionFormat()+";\n"+a:this.constFun instanceof v&&(a=this.constFun.rawType+": "+this.constFun.returnType+";\n"+a)),0<o.length&&(o=o.substring(1),o=o.substr(0,o.length-1),s+="\n"+o);var f=[];f.push(s.trim()),f.push(a.trim());var u={api:i,id:this.sysId,f:0,tf:f};return this.isSubClass()&&(u.sp=this.baseName),!this.typeDefs||(u.td=this.typeDefs),S.updateFlags(u,this.currentSI,this.getInternalType()),u},t.prototype.toMinifiedInterfaceFormat=function(){var e=this,t=this.apiName.split("."),n=t[0],i=t[1],s="",a="",r=Object.keys(this.fields),o="",p;if(0==this.flags&&1==Object.keys(this.fields).length)this.fields[i];if(this.isES6){var l={api:i,id:this.sysId,f:this.flags};return"undefined"!=typeof this.typeDefs&&(l.td=this.typeDefs),l}if(this.isObjectLiteral()){var d="",c=[];for(var g in this.fields)this.fields[g]instanceof L?d+=this.fields[g].toTypeFormat():this.fields[g]instanceof V&&(d+=this.fields[g].toTypeFormat(),c.push(this.fields[g].toJSONDecl()));var f=this.fields[i];if(f.keys)for(var g in f.keys)c.push(f.keys[g].toJSONDecl());var u={api:i,id:this.sysId,df:c,f:0};return S.updateFlags(u,this.currentSI,this.getInternalType()),u}var m=[],y=[];if(r.forEach(function(t){var n=e.fields[t],r="";if(t!=i+".prototype"){r=n.toTypeFormat()+";\n";var l=n.lineInfo,d={};d.l=l.line,l.doc&&(d.d=l.doc),n.isStatic()?(y.push(d),x.isObjectLiteral(n)?(d.f=n.getPropertyName()+": "+n.toTypeFormat(),a+=n.getPropertyName()+": "+r):(d.f=n.toTypeFormat(),a+=r)):(m.push(d),x.isObjectLiteral(n)?(d.f=n.getPropertyName()+": "+n.toTypeFormat(),s+=n.getPropertyName()+": "+r):(d.f=n.toTypeFormat(),s+=r))}else if(x.isObjectLiteral(n)){m=n.getPartsWithLineInfo(),r=n.getParts().join(";\n"),0<r.length&&(s+=r+";\n");var c=n.keys.initialize;c&&x.isFunctionType(c)&&(p=c)}else x.isStringType(n)&&(o=n.rawType,"{"==o[0]&&o[o.length-1]||(o=""))}),this.isClass()){var h="new";p=p||this.constFun;var C={};y.push(C),p?(h+=p.getParamsFormat()+": "+this.apiName,C.f=h,p.lineInfo&&(C.l=p.lineInfo.line,p.doc&&(C.d=p.doc))):(h+="(): "+this.apiName,C.f=h,C.l=0);var T={};T.f="prototype: "+this.apiName,T.l=0,y.push(T),a=h+";\nprototype: "+this.apiName+";\n"+a}if(this.isFunctionType()&&!!this.constFun){var _={};_.l=0,_.f="",y.push(_),this.constFun instanceof P?(a=this.constFun.getClsFunctionFormat()+";\n"+a,_.f=this.constFun.getClsFunctionFormat()):this.constFun instanceof v&&(a=this.constFun.rawType+": "+this.constFun.returnType+";\n"+a,_.f=this.constFun.rawType+": "+this.constFun.returnType)}0<o.length&&(console.warn("fix this extra user case"),o=o.substring(1),o=o.substr(0,o.length-1),s+="\n"+o);var b=[];b.push(s.trim()),b.push(a.trim());var A={api:i,id:this.sysId,f:0,df:[m,y]};return this.isSubClass()&&(A.sp=this.baseName),!this.typeDefs||(A.td=this.typeDefs),S.updateFlags(A,this.currentSI,this.getInternalType()),A},t.prototype.toInterfaceFormat=function(){var e=this,t=this.apiName.split("."),n=t[0],i=t[1],s="",a="",r=Object.keys(this.fields),o="",p;if(0==this.flags&&1==Object.keys(this.fields).length){this.fields[i];console.log("unknown type")}if(this.isObjectLiteral()){var l="interface "+i+" ";for(var d in this.fields)l+=this.fields[d].toTypeFormat();var c="declare const "+i+": "+this.apiName+";",f=new S(this.apiName,this.sysId,l,"const "+i+": "+i+";",c,this.accessType,g.var,0,this.typeDefs);return S.updateFlags(f,this.currentSI,this.getInternalType()),f}if(r.forEach(function(t){var n=e.fields[t],r="";if(t!=i+".prototype")r=n.toTypeFormat()+";\n",n.isStatic()?x.isObjectLiteral(n)?a+=n.getPropertyName()+": "+r:a+=r:s+=r;else if(x.isObjectLiteral(n)){r=n.getParts().join(";\n"),s+=r+";\n";var l=n.keys.initialize;l&&x.isFunctionType(l)&&(p=l)}else x.isStringType(n)&&(o=n.rawType,"{"==o[0]&&o[o.length-1]||(o=""))}),this.isClass()){var u="new";u+=p?p.getParamsFormat()+": "+this.apiName:"(): "+this.apiName,a=u+";\nprototype: "+this.apiName+";\n"+a}this.isFunctionType()&&!!this.constFun&&(this.constFun instanceof P?a=this.constFun.getClsFunctionFormat()+";\n"+a:this.constFun instanceof v&&(a=this.constFun.rawType+": "+this.constFun.returnType+";\n"+a)),0<o.length&&(o=o.substring(1),o=o.substr(0,o.length-1),s+="\n"+o);var m="interface "+i;this.isSubClass()&&(m+=" extends "+this.baseName),s=s.trim(),m+=" {\n"+s+"\n}";var y="interface "+i+"Constructor {\n";a=a.trim(),y+=a+"\n}";var h=m+"\n"+y,C="declare const "+i+": "+this.apiName+"Constructor;",T=new S(this.apiName,this.sysId,h,"const "+i+": "+i+"Constructor;",C,this.accessType,g.cls,0,this.typeDefs);return S.updateFlags(T,this.currentSI,this.getInternalType()),T},t}(_);e.TSTypeExporter=j,e.generateTypedefDeclFromScopemap=r;var O={};e.addToThisSITypedefMap=o,e.clearThisSITypedefMap=p;var w={};e.addToTypeDefMap=l,e.isTypedefType=d,e.generateTypedefDeclFromScopeName=c,e.generateTypedefDecl=function(e){function t(e){var n="";for(var i in e)if("object"==typeof e[i]){var s=t(e[i]);n+="namespace "+i+" {\n"+s+"\n}\n"}else"string"==typeof e[i]&&(n+=e[i]);return n}if(!Array.isArray(e))return"";for(var n={},s=0;s<e.length;s++)for(var a=0,r;a<e[s].length;a++)if(r=e[s][a],r.name){var o=r.name.split("."),p="interface "+o[o.length-1]+" "+r.type+"\n\n";1<o.length&&o.splice(0,1);for(var l=o.splice(o.length-1,1)[0],d=n,c=0;c<o.length;c++)d[o[c]]=d[o[c]]||{},"string"==typeof d[o[c]]&&(console.log("module is defined as type overriding the type with modue "),d[o[c]]={}),d=d[o[c]];d[l]=p}var g=t(n);return g="declare namespace sn {\n"+g+"}",console.log(g),g},e.getTypeDefsAsScopeMap=f,e.getTypeDefs=function(e,t){void 0===t&&(t="-1");var n=[];for(var s in e)for(var a=0;a<e[s].length;a++)Array.isArray(e[s][a].td)&&e[s][a].id!=t&&n.push(e[s][a].td);return n},e.parseSIWithTypeChecker=m;var R="point.js",B="node_modules/@types/snlib/index.d.ts",U=function(){function e(e,t,n){this.snlib=e,this.sourceFiles={},this.outFiles={},this.updateContent(B,this.snlib),t&&this.updateContent("atypes.ts",t),n&&this.updateContent(R,n)}return e.prototype.getOutFiles=function(){return this.outFiles},e.prototype.disposeAll=function(){for(var e in this.sourceFiles)ts.disposeEmitNodes(this.sourceFiles[e]),this.sourceFiles[e]=null},e.prototype.updateContent=function(e,t){this.sourceFiles[e]&&(ts.disposeEmitNodes(this.sourceFiles[e]),this.sourceFiles[e]=null);var n=ts.createSourceFile(e,t,ts.ScriptTarget.ES5,!0,e.endsWith(".ts")?ts.ScriptKind.TS:ts.ScriptKind.JS);this.sourceFiles[e]=n},e.prototype.updateLib=function(e){this.updateContent(B,e)},e.prototype.updateAnonymousContent=function(e){this.updateContent("atypes.ts",e)},e.prototype.updateTypeScriptSI=function(e){this.updateContent("point.ts",e)},e.prototype.updateSI=function(e){this.updateContent(R,e)},e.prototype.getTypeInfo=function(e,t,n){void 0===n&&(n="Point");var i=null;return i=m(e,n,this.sourceFiles[R],t),i},e.prototype.getSourceFile=function(e){return this.sourceFiles[e]?this.sourceFiles[e]:void 0},e.prototype.writeFile=function(e,t){this.outFiles[e]=t},e.prototype.getDefaultLibFileName=function(){return"lib.d.ts"},e.prototype.useCaseSensitiveFileNames=function(){return!1},e.prototype.getCanonicalFileName=function(e){return e},e.prototype.getCurrentDirectory=function(){return""},e.prototype.getNewLine=function(){return"\r\n"},e.prototype.fileExists=function(){return!0},e.prototype.readFile=function(e){return console.log("read file "+e),""},e.prototype.directoryExists=function(){return!0},e.prototype.getDirectories=function(){return[]},e}();e.MyCompilerHost=U;var J={allowNonTsExtensions:!0,target:1,allowJs:!0,sourceMap:!0,noLib:!0,noErrorTruncation:!0,types:["snlib"],linter:!1},W,z,G,K,q,H,Q,X;e.dotWalkingTransformer=function(e){return function(t){function n(t){if(t=ts.visitEachChild(t,n,e),!ts.isTemplateExpression(t))return t;var s=t.getFullText(),a=i(),r=s.match(a);if(!r)return t;if(0==r.length)return t;var o=r[0].split(".");if(1>=o.length)return t;var p=function(e){var t=e.replace(a,function(e,t,n,i){var s=n;n.startsWith("$$")&&(n=n.substring(2,n.length)),n.startsWith("{")&&(n=n.substring(1,n.length)),n.endsWith("}")&&(n=n.substr(0,n.length-1));var a=n.split(".");return 1==a.length?s:(a.splice(0,1),t+a.join(".")+i)});return t.trim()}(s);return ts.createStringLiteral(p)}return!t.sourceFiles||(t=t.sourceFiles[0]),ts.visitNode(t,n)}},e.initTypeInfoForSingleSI=A,e.generateTypeInfo=function(e,t,n,i){h(n);var s={},a=[],o={};e.forEach(function(e){return e instanceof C||(e=new C(e)),"global"==e.sys_scope.value?void a.push(e):void(!o[e.sys_scope.value]&&(o[e.sys_scope.value]=[]),o[e.sys_scope.value].push(e))});var p=[];for(var l in 0<a.length&&p.push(a),o)p.push(o[l]);var d=null,c=[],g=["point.js","atypes.ts"],u=[],m=0,y="global",T;return p.forEach(function(n){n.forEach(function(n){m++;var a=(100*m/e.length).toFixed(2);if(i)try{i({name:n.api_name,percentage:a,sysId:n.sys_id})}catch(e){}n instanceof C||(n=new C(n));var o=n.getScopeAndAPIMap();if("string"!=typeof n.script)return void console.log("skipping: undefined script found for api "+n.api_name);var p=b(n.api_name,!0);if(!d){var l=b(n.api_name),h=f(X,"-1"),S=r(h);d=new U(t+"\n\n"+l+"\n\n"+S)}if(d.updateAnonymousContent(p),d.updateSI(n.script),o.scope!=y){var l=b(n.api_name);d.updateLib(t+"\n\n"+l),y=o.scope,T=void 0}T=ts.createProgram(g,J,d,T);try{var _=d.getTypeInfo(n,T.getTypeChecker(),n.api_name);_.accessType=n.access,_.sysId=n.sys_id,_&&c.push(_),s[o.scope]||(s[o.scope]=[]);var A=_.toMinifiedInterfaceFormat();if(s[o.scope].push(A),i)try{i({name:n.api_name,percentage:a,sysId:n.sys_id,decl:A})}catch(e){}}catch(t){u.push(n.api_name)}})}),{formatterResult:s,types:c,errors:u,program:T,host:d}}})(P=t.TSChecker||(t.TSChecker={}))}),define("scripts/tsCompilerOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={allowNonTsExtensions:!0,module:0,noResolve:!0,suppressOutputPathCheck:!0,skipLibCheck:!0,skipDefaultLibCheck:!0,target:1,noImplicitAny:!1,strict:!1,strictNullChecks:!1,noImplicitThis:!1,noImplicitReturns:!1,experimentalDecorators:!1,noUnusedLocals:!1,noUnusedParameters:!1,declaration:!0,sourceMap:!0,jsx:2,jsxFactory:"createElement",noEmitHelpers:!1,isolatedModules:!1,noEmitOnError:!1,stripInternal:!1,allowJs:!0,checkJs:!1,noFallthroughCasesInSwitch:!1,allowUnreachableCode:!1,linter:!1,inlineSourceMap:!1,inlineSources:!1}}),define("scripts/recordWatcher",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e){return"string"==typeof e?(e=e.replace(/\^EQ/g,"").replace(/\^ORDERBY(?:DESC)?[^^]*/g,"").replace(/^GOTO/,""),btoa(e).replace(/=/g,"-")):""}function t(e){return d.getChannel(e)}function n(n,i){var s="/rw/default/"+n+"/"+e(i||"");return d.getChannel(s)}function i(e,t,n){if(void 0===n&&(n="sys_idISNOTEMPTY"),!!e){var i="";return i=t?"sys_id="+t:n,i||(i="sys_idISNOTEMPTY"),r(e,i)}}function s(e,t){if(e)return t=t||"sys_idISNOTEMPTY",r(e,t)}function a(e,t){t&&t.unsubscribe();var n=e.toString();return r("task","sys_idIN"+n)}function r(e,t){return(void 0===t&&(t="sys_idISNOTEMPTY"),l(e))?(p("Blocked from watching",e),null):(p(">>> init "+e+"?"+t),c=n(e,t),c.subscribe(o),d.connect(),c)}function o(e){var t=e.data,n=e.channel;p(t)}function p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log(e.join("s"))}function l(e){return"sys_amb_message"==e||e.startsWith("sys_rw")}var d;if("undefined"==typeof g_ambClient?window.top.g_ambClient&&(d=window.top.g_ambClient):d=g_ambClient,!!d){var c;return{getChannel:t,initTaskList:a,initChannel:r,init:function(e,t,n){void 0===n&&(n=""),i(e,t,n)},initList:s,initRecord:function(e,t){i(e,t,"")}}}}});var __extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t=1,a=arguments.length,n;t<a;t++)for(var r in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},__assign.apply(this,arguments)},__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("scripts/SIDeclEmittor",["require","exports","scripts/constants","scripts/siParser","scripts/tsCompilerOptions","scripts/recordWatcher"],function(e,t,n,s,a,r){"use strict";var L=Math.max;function o(){return"undefined"!=typeof window}function p(){return!o()}function l(){return!!p()||d()&&window.recordConfig.canWrite}function d(){return!!p()||window.recordConfig.canRead}function c(e){l()&&e&&(K=new z(e),self.yln={dispatcher:K},K.sendMsg({cmd:J.THREAD_INITIALIZED}))}function g(e){return void(void 0===e&&(e=!1));var t=window.ylnWorker}function f(t){if(void 0===t&&(t=__assign({},S(N().isJavascript()))),!l())return Promise.reject("Unable to write Script Include");var n=__assign({},Te);if(n.script="",n.typedeclaration="",n.typesourcemap="",!Q){var i={cmd:J.UPDATE_LIBS,lib:e("vs/language/typescript/lib/lib").lib_es5_dts,typeDecl:Ce,siRecord:n,isScriptRunner:T()};K.sendMsg(i).then(function(){Q=!0})}var s={cmd:J.SINGLE_SCRIPT_INCLUDE_REQUEST,siRecord:n,options:t},a=K.sendMsg(s);return g(),a.then(function(){clearTimeout(H),H=-1,q--},function(){clearTimeout(H),H=-1,q--}),q++,a}function u(t){if(!l())return Promise.reject("Unable to write Script Include");var n=e("vs/language/typescript/lib/lib").lib_es5_dts;t.forEach(function(e){X[e.sys_id]={record:e},e.parseReturnType=!0,"undefined"!=typeof Y[e.sys_id]&&(!Y[e.sys_id]&&console.log("skipping return type for "+e.api_name),e.parseReturnType=Y[e.sys_id])}),g();var i=K.sendMsg({cmd:J.SCRIPT_INCLUDE_REQUEST,typeDecl:Ce,lib:n,siRecords:t});return i}function m(){var e=Te.getScopeAndAPIMap().scope,t=monaco.languages.typescript.typescriptDefaults;(0==O.length||O!=e)&&(0!=O.length&&w.dispose(),w=e==n.GLOBAL_SOCPE?t.addExtraLib(ce,"yln_"+Z+n.JAVA_GLOBAL_API):t.addExtraLib(ge,"yln_"+Z+n.JAVA_SCOPE_API)),O=e}function y(){Z++,m();var e=new s.DefinitionEmittor(he),t={};Te.isNew()||(t[Te.sys_id]=!0),ue=e.emit(Te.getScopeAndAPIMap().scope,t)+j.newline+me,B&&(B.dispose(),B=null);var i="yln_"+Z+n.JS_API;B=monaco.languages.typescript.typescriptDefaults.addExtraLib(ue,i),U&&U.dispose(),U=null;var a=s.TSChecker.getTypeDefsAsScopeMap(he,Te.sys_id),r=s.TSChecker.generateTypedefDeclFromScopemap(a),o="yln_"+Z+n.TYPE_DEFS;U=monaco.languages.typescript.typescriptDefaults.addExtraLib(r,o),Q=!1}function h(e){if(!e)return void y();if(e.id!=Te.sys_id){if(!e.sc)return void console.warn("scope name not found in record watcher "+JSON.stringify(e));he[e.sc]||(he[e.sc]=[]);for(var t=-1,n=he[e.sc],a=0;a<n.length;a++)if(n[a].id==e.id){t=a;break}var r=s.SITSFormat.expandMinifiedFormat(e,e.sc,s.SITSFormat.isTypescript(e.f));-1==t?he[e.sc].push(r):"delete"==e.op?he[e.sc].splice(t,1):he[e.sc][t]=r,y()}}function C(){return!!window.g_ck}function T(){return!!window.recordConfig&&window.recordConfig.isFromScriptRunner&&"undefined"==typeof g_form}function S(e,t){void 0===t&&(t=!1);var n={};if(e){var i=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();return i.target=a.default.target,i.allowJs=a.default.allowJs,i.checkJs=a.default.checkJs,i.strict=a.default.strict,i.jsx=a.default.jsx,i.jsxFactory=a.default.jsxFactory,i.noImplicitAny=a.default.noImplicitAny,i.strictNullChecks=a.default.strictNullChecks,(a.default.target>ae.ES2015||T())&&(i.sourceMap=a.default.sourceMap),i.noImplicitThis=a.default.noImplicitThis,i.noImplicitReturns=a.default.noImplicitReturns,i.noUnusedParameters=a.default.noUnusedParameters,i.noUnusedLocals=a.default.noUnusedLocals,i.noFallthroughCasesInSwitch=a.default.noFallthroughCasesInSwitch,i.linter=a.default.linter,t||(i.declaration=!1),i}return n.jsx=a.default.jsx,n.jsxFactory=a.default.jsxFactory,n.noFallthroughCasesInSwitch=a.default.noFallthroughCasesInSwitch,n.allowUnreachableCode=a.default.allowUnreachableCode,n.module=monaco.languages.typescript.ModuleKind.None,n.noResolve=a.default.noResolve,n.skipLibCheck=a.default.skipLibCheck,n.skipDefaultLibCheck=a.default.skipDefaultLibCheck,n.target=a.default.target,n.noImplicitAny=a.default.noImplicitAny,n.strictNullChecks=a.default.strictNullChecks,n.noImplicitThis=a.default.noImplicitThis,n.noImplicitReturns=a.default.noImplicitReturns,n.experimentalDecorators=a.default.experimentalDecorators,n.noUnusedLocals=a.default.noUnusedLocals,n.noUnusedParameters=a.default.noUnusedParameters,n.declaration=a.default.declaration,n.sourceMap=a.default.sourceMap,n.noEmitHelpers=a.default.noEmitHelpers,n.isolatedModules=a.default.isolatedModules,n.noEmitOnError=a.default.noEmitOnError,n.strict=a.default.strict,n.stripInternal=a.default.stripInternal,n.linter=a.default.linter,n}function _(){return he}function b(){return N().isGlobalScope()?ce:ge}function A(){return fe}function I(){return ue}function x(){return ye}function E(){return b()+j.newline+A()+j.newline+I()+j.newline+x()}function M(){return Ce}function F(e,t,i,a){Ce=e;var r=n.GLOBAL_SOCPE;if(0!=t.length){var o=t.split(".");r=o[0].trim()}for(var p={},l=0,d=Ce,c;l<d.length;l++)c=d[l],p[c.name]="string"==typeof c.json_value?{api:JSON.parse(c.json_value).api,customization:c.customization}:{api:c.json_value.api,customization:c.customization};he||!p.jsAPI||(he=p.jsAPI.api),"string"==typeof he&&(he=JSON.parse(he+""));var g=function(e){var t=he[e];t.forEach(function(t,n,i){if("undefined"!=typeof t.f){var a=s.SITSFormat.expandMinifiedFormat(t,e);a&&(i[n]=a)}})};for(var f in he)g(f);var u=s.TSChecker.getTypeDefsAsScopeMap(he,i),m=s.TSChecker.generateTypedefDeclFromScopemap(u),y=new s.DefinitionEmittor(he);ce=p.javaGlobalAPI.api+j.newline+p.javaGlobalAPI.customization,ge=p.javaScopedAPI.api+j.newline+p.javaScopedAPI.customization,fe=p.tableAPI.api+j.newline+p.tableAPI.customization,ue=y.emit(r,a)+j.newline+p.jsAPI.customization,me=p.jsAPI.customization;var h=monaco.languages.typescript.typescriptDefaults;(0==O.length||O!=r&&r==n.GLOBAL_SOCPE)&&(0!=O.length&&w.dispose(),w=r==n.GLOBAL_SOCPE?h.addExtraLib(ce,n.JAVA_GLOBAL_API):h.addExtraLib(ge,n.JAVA_SCOPE_API)),O=r,R||(R=h.addExtraLib(fe,n.TABLE_API)),B&&B.dispose(),B=null,B=h.addExtraLib(ue,n.JS_API),U&&U.dispose(),U=null,ye=m,0<m.length&&(U=h.addExtraLib(m,n.TYPE_DEFS))}function N(){return Te}function k(){return P()?"module.tsx":Te.isJavascript()?"module.js":"module.ts"}function v(e,t){if((void 0===e&&(e=!1),!Te.isTypescript())&&(Se&&(Se.dispose(),Se=null),Te.canGenerateDeclaration()||T()))if(!window.recordConfig.useTypeChecker){var n=Te.generateCurrentSIDeclaration(esprima,e||!!window.recordConfig.jsdoc);Se=monaco.languages.typescript.typescriptDefaults.addExtraLib(n,"current.d.ts")}else{if(!t)return;if(0<t.tf.length){var i=Te.formatCurrentSITSFormat(t);Se=monaco.languages.typescript.typescriptDefaults.addExtraLib(i,"current.d.ts")}}}function D(){return window.recordConfig?window.recordConfig.libVersions.jsLibState:!!window.snMonacoConfig&&window.snMonacoConfig.libState.jsLibState}function P(){return window.recordConfig&&window.recordConfig.isSeismic}function V(){if(!_e){_e=!0;["node_modules/@types/react/global.d.ts","node_modules/@types/prop-types/index.d.ts","node_modules/@types/react/index.d.ts","node_modules/csstype/index.d.ts","https://cdn.jsdelivr.net/gh/yln99517/yln-monaco@1.5/seismic.d.ts"].forEach(function(e){var t=e.replace("node_modules","https://www.unpkg.com/");fetch(t).then(function(e){return e.text()}).then(function(t){monaco.languages.typescript.typescriptDefaults.addExtraLib(t,e)})}),monaco.languages.typescript.typescriptDefaults.addExtraLib("import * as React from 'react';\n\tdeclare module 'react' {\n\t\tinterface HTMLAttributes<T> extends AriaAttributes, DOMAttributes<T> {\n\t\t\tattrs?: { [key: string]: any }\n\t\t}\n\t}\n\t","react_attr.d.ts")}}Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n),s=__importStar(s),a=__importDefault(a),r=__importDefault(r);var j=s.TokenType,O="",w,R,B,U,J;(function(e){e[e.THREAD_INITIALIZED=0]="THREAD_INITIALIZED",e[e.SCRIPT_INCLUDE_REQUEST=1]="SCRIPT_INCLUDE_REQUEST",e[e.SCRIPT_INCLUDE_RESPONSE=2]="SCRIPT_INCLUDE_RESPONSE",e[e.SINGLE_SCRIPT_INCLUDE_REQUEST=3]="SINGLE_SCRIPT_INCLUDE_REQUEST",e[e.SINGLE_SCRIPT_INCLUDE_RESPONSE=4]="SINGLE_SCRIPT_INCLUDE_RESPONSE",e[e.UPDATE_LIBS=5]="UPDATE_LIBS",e[e.PROGRESS_MSG=6]="PROGRESS_MSG"})(J||(J={}));var W=function(){function e(){}return e.getInstance=function(t,n,i){return null==e.instance?(e.instance=new e,e.instance.typeInfo=s.TSChecker.initTypeInfoForSingleSI(t,n,i),e.instance):(t&&n&&(e.instance.typeInfo.dispose(),e.instance.typeInfo=s.TSChecker.initTypeInfoForSingleSI(t,n,i)),e.instance)},e.prototype.handleRequest=function(e){var t=new s.ClientSIRecordData(e.siRecord);return Te=t,console.log("si reqest parser came"),Te.isNew()&&2>t.api_name.split(".").length&&(t.api_name="global.Point"),this.typeInfo.getTypeInfo(Te,e.options)},e}();t.SingleSIRequestHandler=W;var z=function(){function e(e){this.sender=e,this.pendingReplies={},this.seqNumber=0,e.onmessage=this.handleMessage.bind(this)}return e.prototype.cancelAllExistingPromises=function(){for(var e in this.pendingReplies)this.pendingReplies[e].reject("Parser thread is too busy for this operation. Please try again or contact yln99517@gmail.com with your SI"),delete this.pendingReplies[e]},e.prototype.sendReplyMsg=function(e,t){this.sender.postMessage(__assign({seqNum:t},e))},e.prototype.sendMsg=function(e){var t=this,n=this.seqNumber++ +"",i=__assign({seqNum:n},e),s=new Promise(function(e,s){t.pendingReplies[n]={resolve:e,reject:s},t.sender.postMessage(i)});return s},e.prototype.isSIProgressMsg=function(e){return e.cmd==J.PROGRESS_MSG},e.prototype.isSingleSIRequest=function(e){return e.cmd==J.SINGLE_SCRIPT_INCLUDE_REQUEST},e.prototype.isSIParserRequest=function(e){return e.cmd==J.SCRIPT_INCLUDE_REQUEST},e.prototype.isSIParserResp=function(e){return e.cmd==J.SCRIPT_INCLUDE_RESPONSE},e.prototype.isLibUpdateMsg=function(e){return e.cmd==J.UPDATE_LIBS},e.prototype.handleMessage=function(t){var e=this,n=t.data,i=this.pendingReplies[n.seqNum];if(i){delete this.pendingReplies[n.seqNum];try{n.errorMsg?i.reject(n.errorMsg):i.resolve(n)}catch(t){console.log("error on resolving thread message "+t)}return}if(this.isSIParserRequest(n)){var a=s.TSChecker.generateTypeInfo(n.siRecords,n.lib,n.typeDecl,function(t){var n={seqNum:"-1",cmd:J.PROGRESS_MSG,name:t.name,sysId:t.sysId,percentage:t.percentage,decl:t.decl};e.sendReplyMsg(n,"-1")}),r={seqNum:n.seqNum,cmd:J.SCRIPT_INCLUDE_RESPONSE,formatterResult:a.formatterResult,types:a.types,errors:a.errors};this.sendReplyMsg(r,n.seqNum)}else if(this.isSingleSIRequest(n)){var p=W.getInstance().handleRequest(n);this.sendReplyMsg(p,n.seqNum)}else this.isLibUpdateMsg(n)?(W.getInstance(n.lib,n.typeDecl,n.siRecord),self.recordConfig.isFromScriptRunner=n.isScriptRunner,this.sendReplyMsg({replayMsg:"thank you",cmd:J.SINGLE_SCRIPT_INCLUDE_RESPONSE},n.seqNum)):n.cmd==J.THREAD_INITIALIZED?G=!0:this.isSIProgressMsg(n)&&o()&&(g(!0),Y[n.sysId]=!!n.decl,!n.decl&&console.log("Parser started for => "+n.name),"function"==typeof window.onSIParserProgressEvent&&window.onSIParserProgressEvent(n.name,n.percentage,n.decl))},e}();t.isMainThread=o,t.isWorkerThread=p,t.canWriteSI=l,t.canReadSI=d;var G=!1,K;t.onThreadInitialized=c;var q=0,H=-1,Q;t.generateTypeDeclForSingleRecord=f;t.gotoDefintionService={open:function(){var e=arguments[0];"string"==typeof arguments[0]&&(e=monaco.Uri.parse(arguments[0]));var t=e.authority.split("."),n=_();if(!n[t[0]])return void console.log("invalid scope name when opening file "+e.authority);var i=n[t[0]].find(function(e){return e.api==t[1]});if(!i)return void console.log("invalid scope name when opening file "+e.authority);var s=e.path.substr(1),a="./sys_script_include.do?sys_id="+i.id+"&gotoLine="+s;return window.open(a),console.log(JSON.stringify(arguments)),{catch:function(){console.log("eror callback")}}}};var X={},Y={};t.generateTypeDeclarations=u,t.scopeUpdated=m;var Z=0;t.apiDeclarationUpdated=y,t.siUpdated=h;var ee;if(o()&&"undefined"!=typeof BroadcastChannel){var te=r.default();if(te){var ne=te.getChannel("/yln/typedef");ne.subscribe(function(e){h(e.data)})}}t.updateSIDeclListeners=function(e){!ee||ee.postMessage(JSON.stringify(e))},t.isServiceNow=C;var ie=function(){return function(e,t,n,i,s,a){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),void 0===i&&(i=""),this.js=e,this.declaration=t,this.sourceMap=n,this.tsScript=i,this.backEndDecl=s,this.linterErrors=a}}();t.TranspilerOutput=ie;var se=function(e){return function(t){function n(t){if(t=ts.visitEachChild(t,n,e),!ts.isTemplateExpression(t))return t;var i=t.getFullText(),a=s.getDotWalkingRegExp(),r=i.match(a);if(!r)return t;if(0==r.length)return t;var o=r[0].split(".");if(1>=o.length)return t;var p=function(e){var t=e.replace(a,function(e,t,n,i){var s=n;n=n.replace(/^\$\${/,""),n=n.replace(/\}$/,"");var a=n.split(".");return 1==a.length?s:(a.splice(0,1),t+a.join(".")+i)});return t.trim()}(i);return ts.createStringLiteral(p)}return ts.visitNode(t,n)}};t.isScriptRunner=T;var ae;(function(e){e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES2015=2]="ES2015",e[e.ES2016=3]="ES2016",e[e.ES2017=4]="ES2017",e[e.ES2018=5]="ES2018",e[e.ESNext=6]="ESNext",e[e.JSON=100]="JSON",e[e.Latest=6]="Latest"})(ae||(ae={})),t.getCompilerOptions=S;var re=function(){function t(e,t,n,i){void 0===i&&(i=ts.ScriptTarget.ES5),this.sourceContent=e,this.libContent=t,this.snLibContent=n,this.SOURCE_PATH="module.ts",this.LIB_PATH="lib.d.ts",this.SN_LIB_PATH="node_modules/@types/snlib/index.d.ts",this.sourceFileMap={},this.fileMap={},t+="\n\n\n"+E(),this.sourceFileMap[this.LIB_PATH]=ts.createSourceFile(this.LIB_PATH,t,i);var s=Te.isJavascript()?ts.ScriptKind.JS:ts.ScriptKind.TS;Te.isJavascript()&&(this.SOURCE_PATH="module.js");var a=ts.createSourceFile(this.SOURCE_PATH,Te.tsscript,ts.ScriptTarget.ES5,!0,s);this.sourceFileMap[this.SOURCE_PATH]=a;var r=ts.transform(a,[se]),o=r.transformed[0],p=ts.createPrinter(),l=p.printFile(o);ts.disposeEmitNodes(a),r.dispose(),this.sourceFileMap[this.SOURCE_PATH]=a.update(l,{span:{start:0,length:e.length},newLength:l.length})}return t.prototype.getFileMap=function(){return this.fileMap},t.prototype.getSourceFile=function(e){return this.sourceFileMap[e]},t.prototype.writeFile=function(e,t){"module.js"==e?this.fileMap.js=t:"module.d.ts"==e?this.fileMap.declaration=t:this.fileMap.sourceMap=t},t.prototype.getDefaultLibFileName=function(){return"lib.d.ts"},t.prototype.useCaseSensitiveFileNames=function(){return!1},t.prototype.getCanonicalFileName=function(e){return e},t.prototype.getCurrentDirectory=function(){return""},t.prototype.getNewLine=function(){return"\r\n"},t.prototype.fileExists=function(){return!0},t.prototype.readFile=function(){return""},t.prototype.directoryExists=function(){return!0},t.prototype.getDirectories=function(){return[]},t.compile=function(n,i){void 0===n&&(n=__assign({},S(!1))),void 0===i&&(i=!1);var s=new ie,a=e("vs/language/typescript/lib/lib").lib_es5_dts+"\n\n\n"+E(),r=new t(N().tsscript,a,E()),o=ts.createProgram([i?"module.js":"module.ts"],n,r),l=o.emit(),d=r.getFileMap();for(var c in d)console.log(d[c]);var p=ts.getPreEmitDiagnostics(o).concat(l.diagnostics);p.forEach(function(e){if(e.file){var t=e.file.getLineAndCharacterOfPosition(e.start),n=t.line,i=t.character,s=ts.flattenDiagnosticMessageText(e.messageText,"\n");console.log(e.file.fileName+" ("+(n+1)+","+(i+1)+"): "+s)}else console.log(""+ts.flattenDiagnosticMessageText(e.messageText,"\n"))});var g=l.emitSkipped?1:0;if(console.log("Process exiting with code '"+g+"'."),o.getSourceFiles().forEach(function(e){return ts.disposeEmitNodes(e)}),0!=g)return Promise.reject("Compilation Errros");s.js=d.js,s.tsScript=Te.tsscript,s.sourceMap=d.sourceMap;var f=Te.emitTSDeclaration(d.declaration);return s.declaration=Te.typedeclaration=JSON.stringify(f),Te.script=s.js,Te.typesourcemap=s.sourceMap,Promise.resolve(s)},t.getModelValueAfterTransform=function(e){var n=t.applyTemplateTransformation(e),i=n.transformed[0],s=ts.createPrinter(),a=s.printFile(i);return n.dispose(),a},t.getSourceAfterTransform=function(e){var n=t.applyTemplateTransformation(e);return n.transformed[0]},t.applyTemplateTransformation=function(e){var t="proxyModel.js",n=ts.ScriptKind.JS;Te.isTypescript()&&(t="proxyModel.ts",n=ts.ScriptKind.TS);var i=ts.createSourceFile(t,e,ts.ScriptTarget.ES5,!0,n),a=ts.transform(i,[s.TSChecker.dotWalkingTransformer]);return a},t}();t.TSCompilerHost=re,o()&&(window.transform=re.getModelValueAfterTransform);var oe=function(){function e(e,t){void 0===t&&(t=""),this.pathName=e,this.filter=t}return e.prototype.fetch=function(){if(this.fetchPromise)return this.fetchPromise;var e=this;return this.fetchPromise=new Promise(function(t){jQuery.ajax({url:e.pathName,data:{},headers:{"X-UserToken":window.g_ck},success:function(n){e.onFetch(n);try{t(n.result)}catch(e){console.log("error on resolving promise")}console.log("received for path "+e.pathName)}})}),this.fetchPromise},e.prototype.onFetch=function(){},e}();t.RecordFetcher=oe;var pe=function(e){function t(t,n){void 0===n&&(n="");var i=e.call(this,t,n)||this;return i.pathName=t,i.isDataAvailable=!1,(!C()||D())&&(i.isDataAvailable=!0,i.cachedData="string"==typeof window.snLibContent?JSON.parse(window.snLibContent).result:window.snLibContent.result),i}return __extends(t,e),t.prototype.fetch=function(){var t=this;return this.isDataAvailable?new Promise(function(e){e(t.cachedData)}):e.prototype.fetch.call(this)},t.prototype.onFetch=function(e){this.isDataAvailable=!0,this.cachedData=e.result},t}(oe);t.CachedRecordData=pe;var le=n.DECLARATION_TABLE_PATH;o()&&!C()&&(le=n.DECLARATION_DATA_PATH);var de=null;o()&&(de=new pe(le,""),de.fetch());var ce="",ge="",fe="",ue="",me="",ye="",he;t.getSIMap=_,t.getJavaAPI=b,t.setJavaAPI=function(e){ce=e},t.getTableAPI=A,t.getJSAPI=I,t.getTypedefAPI=x,t.getAllDeclAPI=E;var Ce;t.getTypeDeclarations=M,t.internalInitialize=F;var Te;t.getCurrentSI=N,t.getCurrentModuleName=k;var Se;t.updateCurrentSIDeclaration=v,t.isJSCacheReady=D,t.isSeismicComponent=P;var _e=!1;t.loadJSXIntellisense=V,t.initializeWithSIRecord=function(e){Te=e;var t=new Promise(function(e){return P()?e():void de.fetch().then(function(t){var n={};Te.isNew()||(n[Te.sys_id]=!0),F(t,Te.api_name,Te.sys_id,n),C()&&v(!1),e()})});return t},t.initializeTypeDeclarations=function(e){return void 0===e&&(e=""),e=e||"global.",new Promise(function(t){de.fetch().then(function(n){F(n,e,"-1",{}),t()})})}});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t};define("scripts/fileSearch",["require","exports","scripts/SIDeclEmittor","scripts/siParser"],function(e,t,n,i){"use strict";var r=Math.ceil,o=Math.floor,p=Math.max;function s(e,t){for(var n=-1,s=0,a=0,r=e.length,o=0,l=t.length,d=!1,c=!1,g=!0,f=null,u=null,m=null,y=0,h=[];o!=l;){var C=a==r?null:e.charAt(a),T=t.charAt(o),S=null==C?null:C.toLowerCase(),_=T.toLowerCase(),b=T.toUpperCase(),A=C&&S==_,I=f&&u==_,x=A&&f,E=f&&C&&u==S;if((x||E)&&(s+=y,h.push(m),f=null,u=null,m=null,y=0),A||I){var M=0;if(0==a){var F=p(o*-3,-9);s+=F}d&&(M+=5),g&&(M+=10),c&&T==b&&_!=b&&(M+=10),A&&++a,M>=y&&(null!=f&&(s+=n),f=T,u=f.toLowerCase(),m=o,y=M),d=!0}else N+=T,s+=n,d=!1;c=T==_&&_!=b,g="_"==T||" "==T,++o}f&&(s+=y,h.push(m));for(var N="",k=0,v=0;v<h.length;++v){var D=h[v],P=t.substr(k,D-k),V=t.charAt(D);N+="<span class = \"no-match\">"+P+"</span><span class='highlight'>"+V+"</span>",k=D+1}0!=t.length-k&&(N+="<span class=\"no-match\">"+t.substr(k,t.length-k)+"</span>");var L=a==r;return[L,s,N]}function a(e,t,a){function r(){clearTimeout(l),l=null;var r=performance.now()+o,d=n.getSIMap();for(var c in d)for(var g=d[c],f=0;f<g.length;f++){var u=g[f].api.split("."),m=u[0];2==u.length&&g[f].api.split(".")[1];var y=e(t,m);e==s&&!0!=y[0]||p.push({rank:y[1],matchStr:y[2],item:g[f]})}return a(p),null}var o=1e3/30,p=[],l=null;this.cancel=function(){null!==l&&clearTimeout(l)},this.start=function(){r()},this.flush=function(){o=1/0,r()}}Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n);var l=function(){function e(e){this.domNode=e,this.id="FileSearch"}return e.prototype.getId=function(){return this.id},e.prototype.getDomNode=function(){return this.domNode},e.prototype.getPosition=function(){return null},e}(),d=function(){function e(e){this.name=e}return e.prototype.update=function(){},e}(),c="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH4gcPDwoiWcgyPAAAAh5JREFUSMfV1U2IjWEUB/Df/aDBVVj4mHEZnwmFBVGWdthJESGEUrOSpTWRKERNYqwsSKJ8pGztrCjF1FgIibi5GMPiOdc83ebOZXb+9fae53nOec/X/zkv/zsKI23WB7pbGnRU+0c9b9YdzUEJMzEev/AOtSbVMqqYFTpvMIDBXKEVpqEPi8OgB7ey8yU4gg2hCx/wCMfxvJ2DErrigUnZ2QJcwZommwp2Yzl24nmxTRl/xXsok2Ff9vEaHuIBvsTefCxtl0ErTMS6bN2LoxHAXmzEKTz+GwcjkaCEjmz9BvWQL0Xp/pChXYlGwleJKQ0cwB6p0YP5xzuq/aM6KLTYH8QNfI/1XFzEHRxGZ0OxPtA9pgzgJk7jW6zHYS3O4i52xF5bB3kWOYvqOIb9eGL4YhWwQupFD4pjzUBE3yexZg/uG272BOkSri//7VxpyiDHe1yLsm3DCUzFdGzKM1goNSwvT34+lMmzcQjzsr0aLkfJGugqhreDUnPOSiwoYjVmhOIPfAx5C27jPM5gmdTQElZJt7iBD2VpWJ2UZs1CzMHrUK6EYj+ehbwIK0PeHPJT/AybOXH2GQ/K0gy5Ho0qhMHKLIofuBBO4Zw0ovdF5NV4cgxJTLpXiCZPkS7J9lAeL7HkZSj2GuY8aR5txa4o0eQI7ite4Gr0o1ZoYlFnNK6CT+HgrdaooFtiTEn6H7yKd2LKv/z+GhiLzf+L3xLMgT1r10J2AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA3LTE1VDEzOjEwOjM0KzAyOjAwRXld0gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wNy0xNVQxMzoxMDozNCswMjowMDQk5W4AAAAASUVORK5CYII=\" alt=\"\" />",g="<img  src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAMAAAC/MqoPAAACtVBMVEVHcEwChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdOSyISIAAAA5nRSTlMADp7WvNdD8g2AymLxKI/4+Z25Bpzu31C99FPvusICIRnrrAoI1UWb/XA1Ec4aG+cLA+ROrUQmByqptPM+S3FI3L4z8MDY+tn2meLgDA8gsJ9Sc0Yw/PWkQt7Uu8hmFYuRCcnbT4dvW2cnin9++5eDNjjE5sPhBU2yJR8ulmzRdow7rxYyoKLjVoFlxxI0pa4p0Ct3hVGIdZq4fagE2iOzYaPta7cQ3ZQUhPeQWgHsLGimF12TWZhBlcxfL40dy78eiRxyqsVVYOUTpxh0THstMdJ5tml4XCIkgs1tR+nq/qs8wT9kOT1MaxsAAAb7SURBVHja7d2Dl+XYHsXxfV2XZdvVXXa1OW3btu0e27bnjZ9t27ax/41nz0lubmmS3zmfaPms71KcwDAMwzAMwzAMwzAML0jeWB5xgZKlGHez6A7LMe5K6Q45XRhv2XSHbB/GW4TuEMlyd7pJN+km3aSbdJNu0k26STfpJt2km/Qp45++lu6Q48N4+zXdoagb4+2DdIfHMO66v5UKZmxWgjZKY8EM5R3vhVf43kcrU/a/DNHW0MplCPcHWmiDdNNoYS+km7iWag9BusEE1aKQbklE2/Qsk27STbpJT8ukm3STbtJNuknP6giH49G/ueL3Pxr9m7Jw+KYs0eldnyg7nheLtFAhOxIK+qNl4Q5x6fX9r68oKWd6LaGKFdsnfMQnJL1jQl0tM5N4qtj76cWpL7VwOIr6pg94OP3z18/nSKw/6c301q3Lj3KkKnZ6MP29hRwNs7yW3rp3PkfJGm+l7yvkqDnvpfSVpziKwh5K30Hqmd7/PWqa/hKpZ3p+LnVNz6Om6Z/aQk3T8xdR0/Snd1HX9Dzqmv46nWgJBe/1X4n+l0f9/r5gKOLh9JVML3b96g6rwW+I+2PeTPdFaK9w/fSfII1k/FiJ99IraWv+S61wZmDVJm+lT6ed+76CTJzcscVD6bQRmI2MlVV4Jf1NWqo9gGHpXV/qhfSDtJR3N4arfZIH0i/QyqsYid773J6e/xta+CNG6MSNZLGL0/fSwmGM3Hu23+ze9IajVEuJv79+gGq7IT69jWr3iE/3ZVPpGMSnF1Mp8S756QVU+iLkp5+l0sflp1+i0ruXyE+PU6kC8tObqfQFDdI/Q6UNGqRXUiXnoAbp11BlTre26Qt8GqSHqNJZr236r7q0TS8d1Df9NQ3SZ1LpTxqkf5pK0zVIL6HSGQ3SF1LpjaXy039BtVXy009QrVJ++uCLVJsoPd36htvH5Kc/TwtPansdnjlLpKdjES00ik9vppVbpae309LjwtMxmZYWCk9fRmuPy07HYlp7QXZ6GW08s0ZyOippo6VXcnoNbT0hOB19tNXWLze9oZP21r8mNR03MI3yXqnpeJjp/HyP0HRsYVqTlslMR4BprX3uhMj0+xN0YMfLAtNR8yIdKCxol5eO3yXoRGn0a+LSUdNDRxIFa6Sl42AnHcp9Vlg66uvo0NqCalnpQC6dyoluk5WO/S10qrTgoqh0fOcBOrevW1I6kKJzi6I+Sel4Zzmd+2qTpHTc/SozsGmGoHTg9k5mYNI3BKWj/g5mYF1Bt5x0YHYjM7B7hqB04JcBZmBytaB0IDqPzuWcl5SO9iPMwOYBQenAxVw6t+DLktKB2ZnEf32npHQgvJmOLR4SlQ5Mq6BT2RNkpQO3B+jUt4WlA/t30aHl9cLSgesK6UxgUFo6Wq8G6Mj8i55Nt3ZdDp3oWSYvHZcOF9KB7Gny0oHWQ3Ti/QLTgeSbTO+VAYnpwP0XmNZZmenAI31M5zmh6cC+OUxjodR0bDvENJqkpgOzi2jraJfYdOQ/RlvvkJsOrC6ine8KTkfDrbSx+2nB6cBW2jgsOh3nF9BSuex0LCunpT2y0/HTa2klJDwd52hphvB0rKaVPOnp+DEtzBGfjlO0MFV8egctfFR8On5EtZny07GYapfkp2+n2gH56TdTLSU/HSEqTdYg/QiV2jRIv4dKMzVIryqkyib56VZHdLU6pE+iygId0j9MlYgO6X6qTNEhPZcq63RIb6bKRh3Sl1OlUYf0M1QJaJB+rpAqlRqkD1HpCQ3SV1HpkAbpbVT6kPz0JNWq5affQaWzkJ9eSaUCF6bvCY7qK/gTqVbswvQAmfM8Rs21VFrnc2F6EUnm7Rzjhysa3fvzk8VX8zEKGt6g2sNu/hdE0QyM3FxaqHFzOvnbRzBCK2jhB3B3OnmmCSPRTCtJ16eTv1/ZjuHKpZVF8EA6Oe+WJgzH6mdo6QNvW/rnMkknedfVy8jQwM9oLYCxtpQWvmmfrrLRX3wOjp3MpZ3PYqwNdlJtqn26hdN18ctLkd6zKye/7U9G48G6nshbxZqXpE+3MOWu6NQuWLupLBViGut8GA9VWW8FeyGmUT4rFd8wVJ1V9T/jVA9tmHAsls30psKtQnQm0hMMBuui0ei9f932ROjUJ+Hp9BEoga7pJdA1/fQ2XdMDPmiaPrcemqa/AJd7hWPkCNxuI8dE0US43vc5Fq7kwwMWctTNHYI3PBTiqJr5JLxjWgVHTVEc3tK04jaOhtiqfHhOVdNT8zgy81IPwqNqfth3G4fr9Nw7a+BlVck7NyeYscQtxfkQwNcfrWispVO1u5r7fRCkIVl2PC8Woa1ILBVPNkCkrGR4QtQfLGkMhWoj/zbnmtADwbpofGIWhDEMwzAMwzAMwzAM4y/wP4iuedx40wAAAABJRU5ErkJggg==\" >";g="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB6VBMVEUAAABCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfX///+B2un8AAAAonRSTlMAAAAAAAAAAAAAAAAAAAUPEREREQ8CAA8WBgAAPq24t7e4pBk6rMWFFwA4mKXk66ePK7/PoclBAAIHFbPDGAUm3agnHwcAAAANs8IRAAqR78dsEgAADrPCEgAADmG875YXAA6zwhIAGVQfH7nvTAAOtsUSAEvfv5rjtycACoSODgAJVrXHmSgAAAENDQEAAAEQFwoAAAAAAAAAAAAAAAAAAACWgQ7oAAAAAWJLR0SisN3fjAAAAAd0SU1FB+MCDg4gM+bRj2EAAADDSURBVAjXY2BABYxMzCysbOwcnFzcPLwMDHz8AoJCwiKiYuISklLSDDKycvIKikrKKqpq6hqaDFraOrp6+gaGRsYmpmbmDBaWVtY2tnb2Do5Ozi6uDG7uHp5e3j6+fv4BgUHBDAwhoWHhEZFR0TGxcfEJDAyJSckpqWnpGZlZ2Tm5DAx5+QWFRcUlpWXlFZVVDAzVNbV19Q2NTc0trW3tDAwdnV3dPb19/RMmTpo8hYFh6rTpM2bOmj1n7rz5Cxai+QAAKY8y8qwS6uQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDItMTRUMTQ6MzI6NTErMDA6MDDdB6Q2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTAyLTE0VDE0OjMyOjUxKzAwOjAwrFocigAAAABJRU5ErkJggg==\" alt=\"\" />",g="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAPCAMAAADXs89aAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABOFBMVEVCpfX///9CpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfX///8Jns0AAAAAZnRSTlMAAEx9fn98eAcsiqeURr0SAkTi+HQOmtTTz+ff0Agg6uu25jIWKCYhYSInUvV1Q1kLZD5XbvryVm1ezUkxuu38XwYw7vNjRSOTrBCp+cQ6Kp0Pw7zW/r9yThOHszaIgCQFjqWbaBXwbi/OAAAAAWJLR0QB/wIt3gAAAAd0SU1FB+MCDg4uBi7hZswAAAABb3JOVAHPoneaAAAA2klEQVQY022QaVcBcRTGb/4TlUhkUKSpUGNsMVH2Jdq0b5Rdz/f/CGYmh8nxe3Gf5/ze3HsuGRjjuFXGmNG0RrS+Yd60kIIVM7Zs23YlHDtOIt7l9uwCe163x7fvx4FwCBwRHQeCIQ44ORWDFIYUoSgfi5NGAjhTMwkHR3NSgLZHlHEupGc6M9W2CxmQLrMLmiiXLwDFUnlBE1XMVdSu/ut6QxnXwI1e397dNx98jwLwpL/k+QWwv7694yOn6U/gS81WW1Kf8B36W/PT6fa00q8PhqPxr9JWljIBIUAu3lTAeuwAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDItMTRUMTQ6NDY6MDYrMDA6MDBwkCElAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTAyLTE0VDE0OjQ2OjA2KzAwOjAwAc2ZmQAAAABJRU5ErkJggg==\" alt=\"\" />";var f=function(){function t(e,t){this.editor=e,this.callback=t,this.id="FileSearch",this.fileSearchWrapper="FileSearch-filesWrapper",this.fileSearchInput="FileSearch-searchInput",this.domNode=document.createElement("div"),this.domNode.setAttribute("id",this.id),this.domNode.setAttribute("class",this.id),this.filterTimerId=-1,this.nextResultTimerId=-1,this.currentIndex=0}return t.prototype.getNode=function(){return this.domNode},t.prototype.close=function(){},t.prototype.dispose=function(){t.isOpen=!1,this.domNode.removeEventListener("click",this),this.domNode.removeEventListener("keydown",this),this.domNode.removeEventListener("mousewheel",this),document.removeEventListener("keydown",this),this.editor.removeOverlayWidget(this.overlayWidget),this.editor.focus()},t.prototype.handleEvent=function(n){var e=this;if("mousewheel"==n.type)return n.stopImmediatePropagation(),void n.stopPropagation();var i,s;if("keydown"==n.type){var a=n;if(27==a.keyCode||13==a.keyCode){if(13==a.keyCode&&(i=jQuery(this.domNode).find("#FileSearch-filesWrapper"),s=i.children(),this.currentIndex<s.length)){var p=s[this.currentIndex].getAttribute("data-sysid"),l=s[this.currentIndex].getAttribute("data-apiname");this.callback({apiName:l,sysId:p})}return a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault(),void this.dispose()}if(40==a.keyCode||38==a.keyCode){n.stopImmediatePropagation(),n.stopPropagation(),n.preventDefault(),i=jQuery(this.domNode).find("#FileSearch-filesWrapper"),s=i.children();var d=this.currentIndex;40==a.keyCode?this.currentIndex++:(this.currentIndex--,0>this.currentIndex&&(this.currentIndex=s.length-1)),this.currentIndex%=s.length,0<=d&&jQuery(s[d]).removeClass("selected"),jQuery(s[this.currentIndex]).addClass("selected"),!t.itemHieght&&0<s.length&&(t.itemHieght=s[0].getBoundingClientRect().height);var c=t.itemHieght||23,g=c*this.currentIndex,f=i.height(),u=i.scrollTop();if(38==a.keyCode){if(g=o(g),g>=u&&g<f+u)return;i.scrollTop(g)}else{var m=r(g+c);if(m>=u&&m<f+u)return;i.scrollTop(m-f)}return}var y=a.keyCode;if(!(47<y&&58>y||64<y&&91>y||96<y&&123>y||8==y||13==y))return;var h=this.domNode.querySelector("#"+this.fileSearchInput);return-1!=this.filterTimerId&&(window.clearTimeout(this.filterTimerId),this.filterTimerId=-1),-1!=this.nextResultTimerId&&window.clearTimeout(this.nextResultTimerId),this.nextResultTimerId=-1,void(this.filterTimerId=window.setTimeout(function(){e.filter(h.value)},100))}var C=n.target,T=C.closest("div.FileSearch-file");if(null!=T){var l=T.dataset.apiname,p=T.dataset.sysid;return this.dispose(),void this.callback({apiName:l,sysId:p})}null==C.closest("div#FileSearch")&&this.dispose()},t.prototype.open=function(){t.isOpen=!0,this.domNode.innerHTML=this.constructHTML(),this.domNode.addEventListener("click",this),this.domNode.addEventListener("keydown",this),this.domNode.addEventListener("mousewheel",this),document.addEventListener("keydown",this),this.overlayWidget=new l(this.domNode),this.editor.addOverlayWidget(this.overlayWidget),this.domNode.querySelector("#"+this.fileSearchInput).focus()},t.prototype.filter=function(e){var t=this.domNode.querySelector("#"+this.fileSearchWrapper),n=this.constructItems(e);this.currentIndex=-1,!n||(t.innerHTML=n)},t.prototype.constructItemsUsingFuzzy=function(e,t){var n=this;void 0===t&&(t=50),!this.asyncMatcher||(this.asyncMatcher.cancel(),this.asyncMatcher=void 0),this.asyncMatcher=new a(s,e,function(e){e=e.sort(function(e,t){return t.rank-e.rank});for(var s=0,a="",r="",o=0,p=e;o<p.length;o++){var l=p[o],d=c;i.SITSFormat.isTypescript(l.item.f)&&(d=g);var f="<div class=\"FileSearch-file\" data-apiname=\""+l.item.api+"\" data-sysId=\""+l.item.id+"\">\n\t\t\t\t\t"+d+"<span class=\"normName\">"+l.matchStr+"</span></div>";if(s>t){r+=f;continue}s++,a+=f}var u=n.domNode.querySelector("#"+n.fileSearchWrapper);n.currentIndex=-1,u.innerHTML=a;var m=jQuery(n.domNode).find("#FileSearch-filesWrapper");setTimeout(function(){m.scrollTop(0)},0),n.appendNextResultSet(r)}),this.asyncMatcher.start()},t.prototype.appendNextResultSet=function(e){if(0!=e.length){var t=this.domNode.querySelector("#"+this.fileSearchWrapper);this.nextResultTimerId=window.setTimeout(function(){jQuery(e).appendTo(t)},200)}},t.prototype.constructItems=function(e,t){if(void 0===t&&(t=50),0<e.length)return this.constructItemsUsingFuzzy(e);var s="",a=0;0>t&&(t=50),t=p(t,50);var r=new RegExp(e,"gi"),o=n.getSIMap(),l="";for(var d in o)for(var f=o[d],u=0;u<f.length;u++){var m=f[u],y=m.api.split("."),h=y[0];if(1<y.length&&(h=y[1]),!e||null!=h.match(r)){a++;var C=c;i.SITSFormat.isTypescript(m.f)&&(C=g);var T="<div class=\"FileSearch-file\" data-apiname=\""+m.api+"\" data-sysId=\""+m.id+"\">"+C+"<span class=\"normName\">"+h+"</span></div>";a>=t?l+=T:s+=T}}return this.appendNextResultSet(l),s},t.prototype.constructHTML=function(){var e=this.constructItems("");return"<div class=\"FileSearch-searchWrapper\">\n\t\t\t\t\t<input type=\"text\" class=\"FileSearch-searchInput\" id=\"FileSearch-searchInput\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"FileSearch-filesWrapper\" id=\"FileSearch-filesWrapper\">\n\t\t\t\t"+e+"\n\t\t\t</div>"},t.isOpen=!1,t}();t.FileSearch=f});var __extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t};define("scripts/newMonaco",["require","exports","scripts/SIDeclEmittor"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n);var i;(function(e){e.js="javascript",e.jsx="javascript",e.ts="typescript",e.tsx="typescript",e.html="html",e.css="css",e.xml="xml",e.json="json"})(i||(i={}));var s=function(){function e(e,t){this.el=e,this.monacoField=t;var s=t.fileName.split("."),a=i.js;"undefined"!=typeof g_form&&(t.value=g_form.getValue(t.name)),0<s.length&&(a=i[s[s.length-1]]);var r=a;r===i.js||r===i.jsx||r===i.ts||r===i.tsx?r=i.ts:r===i.xml||r===i.html?r=i.html:void 0,this.model=monaco.editor.createModel(t.value,r,monaco.Uri.file(t.fileName)),this.editor=monaco.editor.create(e,{model:this.model,language:r,fontSize:16,formatOnType:!0,formatOnPaste:!0},{openerService:n.gotoDefintionService}),this.editor.onDidChangeModelContent(this.onValueChanged.bind(this))}return e.prototype.onValueChanged=function(){"undefined"==typeof g_form||g_form.setValue(this.monacoField.name,this.model.getValue())},e.prototype.getValue=function(){return{value:this.model.getValue()}},e}();t.MonacoEditor=s;var a=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.onValueChanged=function(){var e=this;monaco.languages.typescript.getTypeScriptWorker().then(function(t){t(e.model.uri).then(function(t){var n=t.getEmitOutput(e.model.uri.toString());n.then(function(t){t.emitSkipped||(e.js=t.outputFiles[0].text,"undefined"==typeof g_form||(g_form.setValue(e.monacoField.name,e.model.getValue()),g_form.setValue(e.monacoField.tupleName,e.js)))})})})},t.prototype.getValue=function(){return{jsx:this.js,value:this.model.getValue()}},t}(s);t.MonacoJSXEditor=a});var __extends=this&&this.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t=1,a=arguments.length,n;t<a;t++)for(var r in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},__assign.apply(this,arguments)},__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("scripts/monacoInit",["require","exports","scripts/SIDeclEmittor","scripts/tsCompilerOptions","scripts/fileSearch","scripts/constants","scripts/siParser","scripts/recordWatcher","scripts/newMonaco"],function(e,t,n,s,a,r,o,p,l){"use strict";var c=Math.floor;function d(){function e(e){var t=new g;try{var i=n.getCurrentSI();M()&&(i.updateAPIName("global.Point"),i.updateSysId("yln"),i.updateAccessType("public"),i.updateLangType("javascript"));var s=i.getScopeAndAPIMap(),a=l();if(t.js=a.outputText,t.sourceMap=a.sourceMapText,i.updateScript(a.outputText),window.recordConfig.useTypeChecker)return t;var r=i.generateDeclaration(esprima,e||!!window.recordConfig.jsdoc).getFormat(!0),o=JSON.parse(r);o[s.scope]&&Array.isArray(o[s.scope])&&0<o[s.scope].length&&(t.declaration=JSON.stringify(o[s.scope][0]))}catch(e){console.log(e.toString())}return t}function t(){var e=new Promise(function(e,t){var i=n.getCurrentModuleName();monaco.languages.typescript.getTypeScriptWorker().then(function(n){n("file:///"+i).then(function(n){n.getScriptFileNames().then(function(i){var s=!1;i.forEach(function(e){0<e.indexOf(".d.ts")||(n.getSemanticDiagnostics(e).then(function(){s=!0}),n.getSyntacticDiagnostics(e).then(function(){s=!0}))}),s?t(o.ERROR_MSG):e()})})})});return e}function i(t){void 0===t&&(t=!1);var i=n.getCurrentSI();if(!M()){var s=g_form.getValue("api_name");if(0==s.length)return Promise.reject("API Name shouldn't be empty");var a=g_form.getUniqueValue(),r=g_form.getValue("access");i.isNew()||(i.updateAPIName(s),i.updateSysId(a),i.updateAccessType(r))}var p=monaco.Uri.file(i.isTypescript()?"/module.ts":"/module.js"),l=new Promise(function(s,a){var r=Date.now();if(i.isJavascript()){if(!window.recordConfig.useTypeChecker)return console.log("compilation time is "+(Date.now()-r)),void s(e(t));var p=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();return void n.generateTypeDeclForSingleRecord(p).then(function(e){console.log("compilation time is "+(Date.now()-r)),M()||window.recordConfig.isES6||(e.js=i.tsscript),i.setDirtyState(!1),i.updateScript(e.js);var t=new g(e.js,"",e.sourceMap,i.tsscript,void 0,e.linterErrors),a=JSON.parse(e.declaration);if(o.SITSFormat.isES6(a.f)){var p=i.emitTSDeclaration(e.tsDeclaration,a.f);p.td=a.td,a=p}t.backEndDecl=__assign({sc:i.getScopeAndAPIMap().scope},a);var l=o.SITSFormat.expandMinifiedFormat(a,i.getScopeAndAPIMap().scope,o.SITSFormat.isES6(a.f));n.updateCurrentSIDeclaration(!0,l),t.declaration=JSON.stringify(l),s(t)},function(e){a(e)})}var l=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();n.generateTypeDeclForSingleRecord(l).then(function(e){console.log("compilation time is "+(Date.now()-r)),i.setDirtyState(!1),i.updateScript(e.js);var t=new g(e.js,"",e.sourceMap,i.tsscript),a=i.emitTSDeclaration(e.declaration);t.backEndDecl=__assign({sc:i.getScopeAndAPIMap().scope},a);var p=o.SITSFormat.expandMinifiedFormat(a,i.getScopeAndAPIMap().scope,i.isTypescript());t.declaration=JSON.stringify(p),n.updateCurrentSIDeclaration(!0,p),s(t)},function(e){a(e)})});return l}function l(){var e=n.getCurrentSI(),t=n.getCompilerOptions(e.isJavascript());t.declaration=!1;var i=e.tsscript;if(e.containsTemplateExpression()&&(i=n.TSCompilerHost.getModelValueAfterTransform(e.tsscript)),t.target<ts.ScriptTarget.ES2015&&!M())return{outputText:e.tsscript};var s=ts.transpileModule(i,{compilerOptions:t,fileName:"./module.js"});return console.log(s.outputText),s}function d(e,t,s,a,p){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===s&&(s=!1);var l="global.Point",d="yln",c="public",g=n.getCurrentSI(),f=g.script_type,u=[],m="undefined"!=typeof g_form;if(m){if(u=g_form.getEditableFields(),v)return!0;l=g_form.getValue("api_name"),d=g_form.getUniqueValue(),c=g_form.getValue("access"),-1!=u.indexOf("script_type")&&(f=g_form.getValue("script_type")),-1!=u.indexOf("jsdoc")&&(e="true"==g_form.getValue("jsdoc"))}return g.updateAPIName(l),g.updateSysId(d),g.updateAccessType(c),g.updateLangType(f),g.updateJSDoc(e),i(e).then(function(e){g.setDirtyState(!1),g.updateScript(e.js),g.updateDeclaration(e.declaration),g.updateSourcemap(e.sourceMap),m&&(g_form.setValue(r.FIELD_SCRIPT,o.ClientSIRecordData.getClassConstructorFormat(g)),g_form.setValue(r.FIELD_TS_SCRIPT,g.tsscript),g_form.setValue(r.FIELD_SOURCEMAP,g.typesourcemap),g_form.setValue(r.FIELD_DECLARATION,g.typedeclaration),(-1!=u.indexOf(r.FIELD_DECLARATION)||s)&&(v=!0),(window.recordConfig.useTypeChecker||!s||-1!=u.indexOf(r.FIELD_TS_SCRIPT))&&n.updateSIDeclListeners(JSON.parse(e.declaration)));var i=g_form.getActionName();if(t&&m&&-1==u.indexOf(r.FIELD_DECLARATION))return jQuery.ajax({url:"api/now/typescript_helpers/update_declaration",type:"post",data:JSON.stringify(e.backEndDecl),headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}}).done(function(e){console.log(e),a&&a()}).fail(function(){p&&p()}),!1;if(s){var l=window.recordConfig;l.isNewRecord?gsftSubmit(void 0,void 0,"sysverb_insert"):gsftSubmit(void 0,void 0,i)}},function(e){g_form.addErrorMessage(e,"script_error")}),!1}function f(e,t){function i(e){if("undefined"!=typeof g_form&&(g_form.setValue(r.FIELD_SCRIPT,e.js),g_form.setValue(r.FIELD_DECLARATION,e.declaration),g_form.setValue(r.FIELD_TS_SCRIPT,e.tsScript),g_form.setValue(r.FIELD_SOURCEMAP,e.sourceMap)),!d||d.updateModelContent(e.js),o){var t="";0!=e.declaration.length&&(t=n.getCurrentSI().formatForAddLib(JSON.parse(e.declaration),l.getScopeAndAPIMap().scope)),t=t.replace(/</gi,"&lt;"),o.innerHTML=t,0!=t.length&&monaco.editor.colorizeElement(o,{theme:N})}!p||(p.innerText=e.sourceMap)}void 0===t&&(t=r.LangType.typescript);var s=document.getElementById(r.EL_TS_EDITOR),a=document.getElementById(r.EL_JS_EDITOR),o=document.getElementById(r.EL_TS_DECL),p=document.getElementById(r.EL_TS_SOURCEMAP),l=n.getCurrentSI(),d;return n.isSeismicComponent()&&(l.tsscript=localStorage.getItem("last_monaco_script")||"function render() {return (<div></div>);}"),k=n.isSeismicComponent()?new L(s,i,!0,l.tsscript):new V(s,i,!0,l.tsscript),a&&(d=new P(a,null,"// wating ...",!0),k.setJSInstance(d),window.jsInstnace=d),window.tsInstance=k,{dispose:function(){}}}function u(e){var t=Math.round,n,i,s,a,r;return r=t(e%1e3),a=c(e/1e3),s=c(a/60),a%=60,i=c(s/60),s%=60,n=c(i/24),i%=24,{day:n,hour:i,minute:s,seconds:a,ms:r}}function m(){var e=localStorage.getItem("sn.codenow"),t={theme:N};if(!e)return t;var n=JSON.parse(e);return n.theme=n.theme||t.theme,M()||(n.theme=N),n}function y(e){var t=m();for(var n in e)t[n]=e[n];M()&&localStorage.setItem("sn.codenow",JSON.stringify(t))}function h(e){jQuery("#yln-standalone-editor").removeClass(N).addClass(e),N=e,monaco.editor.setTheme(N),y({theme:e}),jQuery(j).val(e)}function C(){function e(e){for(var t=e.split("\n"),n=[],s=0;s<t.length;s++)t[s].match(/^\s*debugger;\s?/)&&(n.push(s+2),t[s]="\"debugger\";");return{dbgStatements:n,js:t.join("\n")}}if(j&&(j.onchange=function(){h(j.value)}),n.isSeismicComponent())return void jQuery("#"+r.EL_SCOPE_SELECT).hide();var t=document.getElementById(r.EL_SCOPE_SELECT);if(t){var s="",a=window.recordConfig;for(var o in a.scopes){var p=a.scopes[o];"global"!=p.sysId&&(s+="<option value='"+p.value+"' scope-id='"+p.sysId+"'>"+p.displayValue+"</option>\n")}s="<option value='global' scope-id='global' selected>Global</option>\n"+s.trim(),t.innerHTML=s,t.onchange=function(){var e=t.value,i=n.getCurrentSI();i.updateAPIName(e+"."),n.siUpdated()}}var l=document.getElementById(r.EL_SCRIPT_RUNNER);n.isServiceNow()||n.isSeismicComponent()||jQuery(l).hide(),l&&n.isServiceNow()&&(l.onclick=function(){function s(e){return new Promise(function(t,n){jQuery("a[href=\"#script-output\"]").tab("show");var i=jQuery("#"+r.EL_SCRIPT_OUTPUT),s=Date.now(),a=!1,o=document.getElementById("excution-timer"),i=jQuery("#"+r.EL_SCRIPT_OUTPUT);i.html("<div class = \"script-running\">\n\t\t\t\t\t\t\t<i class=\"glyphicon glyphicon-refresh spin\"></i>\n\t\t\t\t\t\t\t</div>");var d=function(){var e=Date.now(),t=u(e-s),n=t.minute+":"+t.seconds+":"+t.ms;o.innerText=n,a||window.requestAnimationFrame(d)};d(),_(e,p).then(function(e){l.disabled=!1,a=!0;var n=new DOMParser,i=n.parseFromString(e,"text/html");jQuery("#"+r.EL_SCRIPT_OUTPUT).html(i.body.innerHTML),t()},function(){a=!0,n(),l.disabled=!1})})}function a(t){function n(e){return void 0===e&&(e=!1),a.map(function(t){var n={data:JSON.stringify({evaluationString:""}),url:"/api/now/js/debugger/breakpoint/sys_script_include/1172f0210bf213008e64aabcb4673aee/script/"+t,method:"POST",contentType:"application/json",headers:{"X-UserToken":window.g_ck}};return e&&delete n.data,$.ajax(n)})}var i=e(t),a=i.dbgStatements;if(t=i.js,0==a.length)return s(t);var r={sysparm_key:"sys_script_include.1172f0210bf213008e64aabcb4673aee.script",sysparm_breakpoints:JSON.stringify(a),sysparm_processor:"BreakpointProcessor",sysparm_action:"SET_BREAKPOINTS",sysparm_express_transaction:!0,sysparm_debugger_transaction:!0},o={url:"xmlhttp.do",data:r,headers:{"X-UserToken":window.g_ck}},p={contentType:"application/json",data:JSON.stringify({script:"function TempDebugger(){\n"+t+"\n};"}),headers:{X_UserToken:window.g_ck},method:"POST",type:"POST",url:"/api/now/typescript_helpers/UpdateDebuggerScript"},d={data:JSON.stringify({evaluationString:""}),url:"/api/now/js/debugger/breakpoint/sys_script_include/1172f0210bf213008e64aabcb4673aee/script/2",method:"POST",contentType:"application/json",headers:{"X-UserToken":window.g_ck}};jQuery.when(n(),$.ajax(p)).then(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];$.ajax(d).done(function(){s("global.TempDebugger()").then(function(){jQuery.when(n(!0)).then(function(){})},function(){jQuery.when(n(!0)).then(function(){})})})},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l.disabled=!1,console.log("failure to update breakpoints and scripts")})}if(n.isServiceNow()){l.disabled=!0;var o=n.getCurrentSI(),p=t.selectedOptions[0].getAttribute("scope-id");return o.isUpToDate()?void a(o.script):void i().then(function(e){a(e.js)},function(e){alert(e),l.disabled=!1})}})}function T(){function e(){var e=jQuery(document.getElementById("sys_script_include.form_scroll")),t=e.offset();if(t){var n=jQuery("#ts_editor_container").offset();if(n){var i=n.top-t.top;0<i&&e.scrollTop(i)}}}n.isServiceNow()||(window.recordConfig.scopes={"3ad18693db92220004997878f0b8f516":{sysId:"3ad18693db92220004997878f0b8f516",displayValue:"Benchmark Client",value:"sn_bm_client"},"1bc6c2d3db92220004997878f0b8f571":{sysId:"1bc6c2d3db92220004997878f0b8f571",displayValue:"Benchmark Common",value:"sn_bm_common"},de0be0e15bb00300514d484c11f91a4b:{sysId:"de0be0e15bb00300514d484c11f91a4b",displayValue:"Benchmarks Spoke",value:"sn_bm_spoke"},"18351d53eb32120034d1eeea1206fe79":{sysId:"18351d53eb32120034d1eeea1206fe79",displayValue:"Change Management - CAB Workbench",value:"sn_change_cab"},cdcf033467020300b410afa00585ef2b:{sysId:"cdcf033467020300b410afa00585ef2b",displayValue:"Change Management - Change Schedule",value:"sn_chg_soc"},"1ae06f355710130034d169202d94f92e":{sysId:"1ae06f355710130034d169202d94f92e",displayValue:"Change Management - Color Picker",value:"sn_chg_soc_cp"},f9752f20d7120200b6bddb0c8252032e:{sysId:"f9752f20d7120200b6bddb0c8252032e",displayValue:"Code Search",value:"sn_codesearch"},"116703c19f200300af7196fcc67fcf17":{sysId:"116703c19f200300af7196fcc67fcf17",displayValue:"Connect Spoke",value:"sn_connect_ah"},"1ae3c8a3c3221200f25d174292d3aea3":{sysId:"1ae3c8a3c3221200f25d174292d3aea3",displayValue:"Delegated Dev User Administration",value:"sn_dd_user_admin"},dc1fcaa2c3032200f7d1ca3adfba8f1a:{sysId:"dc1fcaa2c3032200f7d1ca3adfba8f1a",displayValue:"Enhanced Global Search UI",value:"sn_global_searchui"},"801cef500b312200c438ee6537673a04":{sysId:"801cef500b312200c438ee6537673a04",displayValue:"Flow-Action Designer",value:"sn_flow_designer"},global:{sysId:"global",displayValue:"Global",value:"global"},"5f4ef4ed9f401200b18a7feea57fcfbe":{sysId:"5f4ef4ed9f401200b18a7feea57fcfbe",displayValue:"Guided Setup",value:"sn_guided_setup"},"7f1c13c0731103005e7d234ffff6a7da":{sysId:"7f1c13c0731103005e7d234ffff6a7da",displayValue:"ITSM Spoke",value:"sn_itsm_spoke"},dd9d31505f221200c438ef50ff4666de:{sysId:"dd9d31505f221200c438ef50ff4666de",displayValue:"JavaScript Debugger",value:"sn_jsdebugger"},"2efa4be5db0003004d27b31be0b8f5e9":{sysId:"2efa4be5db0003004d27b31be0b8f5e9",displayValue:"Major Incident Management",value:"sn_major_inc_mgmt"},fae90fb35f6b03006ae6a184ff46667a:{sysId:"fae90fb35f6b03006ae6a184ff46667a",displayValue:"Major workbench components",value:"sn_major_workbench"},b2881e900b3003001e684ac3b6673a93:{sysId:"b2881e900b3003001e684ac3b6673a93",displayValue:"Performance Analytics - Diagnostics",value:"sn_pa_diagnostics"},"1c3f9f936741030032468aaad485efda":{sysId:"1c3f9f936741030032468aaad485efda",displayValue:"Performance Analytics - Enhanced UI",value:"sn_pa_ui"},"9a31657653373200e8960ef5d5dc34d5":{sysId:"9a31657653373200e8960ef5d5dc34d5",displayValue:"Schedule Pages",value:"sn_schedule_pages"},"893ea311d71321004f6a0eca5e6103e6":{sysId:"893ea311d71321004f6a0eca5e6103e6",displayValue:"Scoped App Author",value:"sn_appauthor"},"781f36a96fef21005be8883e6b3ee43d":{sysId:"781f36a96fef21005be8883e6b3ee43d",displayValue:"Scoped App Client",value:"sn_appclient"},"0aa1393093213100ae6e941e867ffb40":{sysId:"0aa1393093213100ae6e941e867ffb40",displayValue:"Scoped App Creator",value:"sn_appcreator"},"6e70d1f5c32302006f333b0ac3d3ae7b":{sysId:"6e70d1f5c32302006f333b0ac3d3ae7b",displayValue:"Service Catalog REST API",value:"sn_sc"},"6c11c4f357201300ff01ac11ac94f982":{sysId:"6c11c4f357201300ff01ac11ac94f982",displayValue:"Service Level Management - Breakdowns",value:"sn_sla_brkdwn"},"67ac5062db10220035417878f0b8f5c4":{sysId:"67ac5062db10220035417878f0b8f5c4",displayValue:"Service Portal Surveys",value:"sn_portal_surveys"},"97515a49134b5200ed373d62f244b04a":{sysId:"97515a49134b5200ed373d62f244b04a",displayValue:"ServiceNow Guided Tour Designer",value:"sn_tourbuilder"},"11722b01473231007f47563dbb9a7154":{sysId:"11722b01473231007f47563dbb9a7154",displayValue:"Social Knowledge",value:"sn_kb_social_qa"},"5d9789f3eb51310007e48c1cf106fe9e":{sysId:"5d9789f3eb51310007e48c1cf106fe9e",displayValue:"Studio",value:"sn_devstudio"},"0fdd6483d72302004f1e82285e61033a":{sysId:"0fdd6483d72302004f1e82285e61033a",displayValue:"Targeted Communications",value:"sn_publications"},"8dfe92d95373030029200ef5d5dc348a":{sysId:"8dfe92d95373030029200ef5d5dc348a",displayValue:"Task Communications Management",value:"sn_comm_management"},"46aa60c2ff10020014ecffffffffffa5":{sysId:"46aa60c2ff10020014ecffffffffffa5",displayValue:"Twilio Driver",value:"sn_twilio_driver"},"9353f56fb33332000abf86d256a8dce9":{sysId:"9353f56fb33332000abf86d256a8dce9",displayValue:"Visual Task Board (VTB) Spoke",value:"sn_vtb_ah"},"0f6ab99a0f36060094f3c09ce1050ee8":{sysId:"0f6ab99a0f36060094f3c09ce1050ee8",displayValue:"[ws] Xplore: Developer Toolkit",value:"global"}},window.recordConfig.snippets=[{label:"doc",doc:"Documentation Header ",text:"/**\r \n* Description: $0\r \n* Parameters: \r \n* Returns:\r\n*/\r "},{label:"for",doc:"Standard loop for arrays",text:"for (var i=0; i< myArray.length; i++) {\r\n //myArray[i];\r \n}\r\n\r "},{label:"vargror",doc:"Example GlideRecord Or Query",text:"var gr = new GlideRecord('${1:tableName}');\r \nvar qc = gr.addQuery('${2:columnName}', 'value1');\r \nqc.addOrCondition('${0:columnName}', 'value2');\r\ngr.query();\r \nwhile (gr.next()) {\r\n\r \n}\r\n\r "},{label:"info",doc:"",text:"gs.addInfoMessage(gs.getMessage(\"$0\"));"},{label:"method",doc:"Standard JavaScript Class Method",text:"/*_________________________________________________________________\r\n   * Description:\r\n   * Parameters:\r\n   * Returns:\r\n   ________________________________________________________________*/\r\n   $0: function() {\r\n   \r\n   },\r\n"},{label:"vargr",doc:"A common pattern of creating and querying a GlideRecord",text:"var gr = new GlideRecord(\"$0\");\r\ngr.addQuery(\"name\", \"value\");\r\ngr.query();\r\nif (gr.next()) {\r\n   \r\n}\r\n"}]),C(),h(m().theme);var t=window.recordConfig;if(!n.isServiceNow()){var i=new o.ClientSIRecordData;i.updateAPIName(t.apiName),i.updateLangType(t.langType),n.initializeWithSIRecord(i).then(function(){f(t.apiName,t.langType||r.LangType.javascript)})}else if(t.isNewRecord){var i=new o.ClientSIRecordData(void 0,!0);i.updateLangType(window.recordConfig.langType),n.initializeWithSIRecord(i).then(function(){f("",t.langType||r.LangType.javascript),M()||n.getCurrentSI().isNew()||e()})}else{var s=o.ClientSIRecordData.fromSIRec(window.recordConfig.siRec);o.ClientSIRecordData.convertToJSConstructor(s),n.initializeWithSIRecord(s).then(function(){f(t.apiName,t.langType||r.LangType.javascript),M()||e()})}}function S(e,t){void 0===e&&(e="gs.info('hello yln')"),void 0===t&&(t="0f6ab99a0f36060094f3c09ce1050ee8");var n={script:e,sysparm_ck:window.g_ck,runscript:"Run script",sys_scope:t},i="",s=[];for(var a in n)s.push(encodeURIComponent(a)+"="+encodeURIComponent(n[a]));return i=s.join("&").replace(/%20/g,"+"),i}function _(e,t){return jQuery.ajax({url:"/sys.scripts.do",data:S(e,t),cache:!1,contentType:"application/x-www-form-urlencoded",processData:!1,method:"POST",type:"POST",headers:{"X-UserToken":window.g_ck},success:function(e){console.log(e)},error:function(e){console.log(e)}})}function b(e,t,n){function i(){var i=window.innerWidth-40,s=window.innerHeight,a=window.screenX+20,r=window.screenY+20,o="width="+i+",height="+s+",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,screenX="+a+",left="+a+",screenY="+r+",top="+r,p=window.open("","sn_ScriptDebugger",o,!1),l=p.location.href,d=!1;if("about:blank"===l){try{var c=parseInt(localStorage.getItem("sn_ScriptDebugger")),g=new Date().getTime();if(c&&6e4>g-c)return p.close(),void localStorage.setItem("sn_ScriptDebuggerExist_ShowNotification",new Date().getTime()+"")}catch(t){}d=!0}var f="/$jsdebugger.do?sysparm_nostack=true";if(e&&t&&n&&(f="/$jsdebugger.do?scriptId="+e+"&scriptType="+t+"&scriptField="+n+"&sysparm_nostack=true",!d))try{localStorage.setItem("sn_ScriptDebugger_url",f)}catch(t){var u=l.slice(l.indexOf("$jsdebugger.do"));u!=f&&(d=!0)}d&&(p=window.open(f,"sn_ScriptDebugger",o,!1)),p.focus(),p.setTimeout(focus,1)}if(void 0===e&&(e="1172f0210bf213008e64aabcb4673aee"),void 0===t&&(t="sys_script_include"),void 0===n&&(n="script"),O){O=!1;try{i()}catch(t){}O=!0}}function A(){var e=n.getCompilerOptions(n.getCurrentSI().isJavascript(),window.recordConfig.isES6);monaco.languages.typescript.typescriptDefaults.setCompilerOptions(e);var t=k;t.triggerCompilation()}function I(e,t,n){function i(){n.off("hidden.bs.modal",i),e.removeAttr("disabled"),t.addClass("hide")}n.on("hidden.bs.modal",i),n.modal()}function x(e,t,n){if(void 0===n&&(n=2500),"undefined"==typeof GlideUI)return void alert(e);var i=document.createElement("span");i.setAttribute("data-type",t),i.setAttribute("data-text",e),i.setAttribute("data-duration",n+""),GlideUI.get().fire(new GlideUINotification({xml:i}))}var E=0;window.addEventListener("beforeunload",function(e){0<E&&(M()||"undefined"!=typeof g_form&&!g_form.submitted)&&(e.returnValue="There is a pending work. sure you want to leave")});var M=n.isScriptRunner,F=s.default,N="vs",k;jQuery(function(){function e(){for(var e=[ts.JsxEmit.None,ts.JsxEmit.Preserve,ts.JsxEmit.React,ts.JsxEmit.ReactNative],t=[ts.ScriptTarget.ES3,ts.ScriptTarget.ES5,ts.ScriptTarget.ES2015,ts.ScriptTarget.ES2016,ts.ScriptTarget.ES2018,ts.ScriptTarget.Latest],n="<select onchange=\"settings.onTargetChange('target', this.value)\">",a=F.target,r=0,o;r<t.length;r++)o="",a==t[r]&&(o="selected"),n+="<option "+o+" value='"+t[r]+"'>"+ts.ScriptTarget[t[r]]+"</option>";n+="</select>";var p="<select onchange=\"settings.onJSXChange('jsxTarget', this.value)\">";e.forEach(function(e,t){var n="",i=F.jsx;t===i&&(n="selected"),p+="<option "+n+" value='"+e+"'>"+ts.JsxEmit[e]+"</option>"}),p+="</select>",M()||(p="");var l="glyphicon-unchecked",d="<div style=\"max-height: 300px;overflow: auto; white-space: nowrap;\">\n\t\t\t\t<div class=\"eslint\">\n\t\t\t\t\t<label style=\"margin: 8px;\">\n\t\t\t\t\t\t<input onclick=\"javascript:settings.toggleLinter();\" style=\"margin: 0px 8px;\" type='checkbox' "+(s.default.linter?"checked":"")+">\n\t\t\t\t\t\tEnable ESlint\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<ul class=\"list-group checked-list-box\" onclick=\"javascript:settings.onCompilerSettingsChange(event.target)\">\n\t\t\t\t\t<li class=\"list-group-item\">Target "+n+"</li>\n\t\t\t\t\t<li class=\"list-group-item\">JSX "+p+"</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Allows js to compile\" data-key=\"allowJs\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.allowJs?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tallowJs\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Enable type checking on JavaScript files\" data-key=\"checkJs\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.checkJs?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tcheckJs\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title = \"Warn on expressions and declarations with an implied 'any' type\" data-key=\"noImplicitAny\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noImplicitAny?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoImplicitAny\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Enable strict null checks\" data-key=\"strictNullChecks\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.strictNullChecks?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tstrictNullChecks\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Raise error on 'this' expressions with an implied any type\" data-key=\"noImplicitThis\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noImplicitThis?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoImplictThis\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report error when not all code paths in function return a value\" data-key=\"noImplicitReturns\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noImplicitReturns?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoImplicitReturns\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Do not report errors on unreachable code\" data-key=\"allowUnreachableCode\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noImplicitReturns?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tallowUnreachableCode\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report errors for fallthrough cases in switch statement\" data-key=\"noFallthroughCasesInSwitch\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noImplicitReturns?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoFallthroughCasesInSwitch\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Enable all strict type-checking options\" data-key=\"strict\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.strict?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tstrict\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Parse in strict mode and emit 'use strict'\" data-key=\"alwaysStrict\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.alwaysStrict?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\talwaysStrict\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Do not generate custom helper functions like __extends in compiled output.'\" data-key=\"noEmitHelpers\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noEmitHelpers?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoEmitHelpers\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report errors on unused parameters\" data-key=\"noUnusedParameters\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noUnusedParameters?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoUnusedParameters\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report errors on unused locals\" data-key=\"noUnusedLocals\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.noUnusedLocals?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoUnusedLocals\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"strip @internal methods when generating declaration\" data-key=\"stripInternal\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(F.stripInternal?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tstripInternals\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>";return d}jQuery("#compiler-settings").popover({html:!0,trigger:"manual",content:function(){return e()},title:"Compiler Settings"}).click(function(t){0==jQuery("#compiler-settings-container > .popover").length?jQuery(this).popover("show"):jQuery(this).popover("hide"),t.stopPropagation(),t.preventDefault()}),jQuery(document).on("click",function(t){var e=jQuery(t.target);e.data&&"undefined"==typeof e.data("original-title")&&!jQuery(t.target).parents().is(".popover.in")&&jQuery("[data-original-title]").popover("hide")})}),window.compileJS=l,window.compileTS=i;var v=!1,D=function(){function e(e,t,i,s,a,r){function o(){if(n.isScriptRunner()){var e=jQuery("#yln-standalone-editor > .navbar-default").height();jQuery("#yln-standalone-editor > .workspace-area").css({top:e})}}function p(){g=-1,this.editor&&this.editor.layout(),o()}void 0===s&&(s=""),void 0===a&&(a="/module.ts"),void 0===r&&(r=!1);var l=this;this.isReadonly=r,this.breakPoints=[],this.existingBreakPoints=[],this.initialModelVersion=-1,this.lastModelVersion=-1,this.gotoDefLine=-1;var d=n.getCurrentSI();window.currentSI=d,s||(d.isTypescript()?s="function getIncidentRec(sysId: string) {\n\tvar gr = new GlideRecord('incident');\n\tgr.get(sysId);\n\treturn gr;\n}":s="function getIncidentRec(sysId) {\n\tvar gr = new GlideRecord('incident');\n\tgr.get(sysId);\n\treturn gr;\n}"),0==d.tsscript.length&&M()&&!r&&d.updateTSScript(s),"function"==typeof Array.prototype.include&&(Array.prototype.include=void 0),this.model=monaco.editor.createModel(s,i,monaco.Uri.file(a)),this.model.updateOptions({trimAutoWhitespace:!0,tabSize:4,insertSpaces:!1}),this.initialModelVersion=this.model.getAlternativeVersionId(),this.modelVersion=this.model.getAlternativeVersionId();var c=n.getCurrentSI().isNew();this.editor=monaco.editor.create(e,{model:this.model,language:i,renderWhitespace:r?"none":"all",fontSize:14,formatOnType:!0,formatOnPaste:!0,glyphMargin:!c||window.recordConfig.breakpoints,readOnly:r,renderIndentGuides:!0,lineNumbersMinChars:2,suggestSelection:"recentlyUsed",scrollBeyondLastLine:!1,lightbulb:{enabled:!0},minimap:{enabled:!1},scrollbar:{useShadows:!1,verticalHasArrows:!1,horizontalHasArrows:!1,vertical:"visible",horizontal:"visible",verticalScrollbarSize:7,horizontalScrollbarSize:7,arrowSize:30}},{openerService:n.gotoDefintionService});var g=-1;window.addEventListener("resize",function(){-1!=g&&window.clearTimeout(g),g=window.setTimeout(p.bind(l),2000)}),o()}return e.prototype.onBreakpoint=function(e){n.isServiceNow()&&!M()?this.toggleBreakPointInServer(e):this.toggleBreakPoint([e])},e.prototype.loadBreakPointsFromServer=function(){var e=this;if(n.isServiceNow()){var t=n.getCurrentSI();if(t.canPlaceBreakPoints()){var i={url:"/api/now/js/debugger/scripts",method:"GET",headers:{"X-UserToken":window.g_ck}};jQuery.ajax(i).done(function(n){if(n&&"object"==typeof n){var i=t.sys_class_name+"."+t.sys_id+".script",s=n.result[i];e.jsBreakPointsState=s,s&&(!s.debugpoints&&(s.debugpoints={BREAKPOINT:{}}),!s.debugpoints.BREAKPOINT&&(s.debugpoints.BREAKPOINT={}),e.updateBreakPoints(s))}})}}},e.prototype.updateBreakPoints=function(e){var t=[];t=Object.keys(e.debugpoints.BREAKPOINT).map(function(e){return parseInt(e)}),0<t.length&&this.toggleBreakPoint(t)},e.prototype.toggleBreakPointInServer=function(e,t,i){var s=this;if((void 0===t&&(t=""),void 0===i&&(i=!1),!!n.isServiceNow())&&!M()){var a=n.getCurrentSI(),r="/api/now/js/debugger/breakpoint/"+a.sys_class_name+"/"+a.sys_id+"/script/"+e,o={evaluationString:t},p={url:r,contentType:"application/json",method:"POST",headers:{"X-UserToken":window.g_ck}};this.jsBreakPointsState&&(this.jsBreakPointsState.debugpoints.BREAKPOINT&&!this.jsBreakPointsState.debugpoints.BREAKPOINT[e]||0<t.length||i)&&(p.data=JSON.stringify(o)),jQuery.ajax(p).done(function(){s.loadBreakPointsFromServer(a.sys_class_name+".script")})}},e.prototype.toggleBreakPoint=function(e){if(n.isServiceNow()&&!M())this.breakPoints=e;else{var t=this.breakPoints.indexOf(e[0]);-1==t?this.breakPoints.push(e[0]):this.breakPoints.splice(t,1)}for(var i=[],s=!1,a=0,r=this.breakPoints;a<r.length;a++){var o=r[a],p={range:new monaco.Range(o,1,o,1),options:{glyphMarginClassName:"dbg-breakpoint",stickiness:monaco.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges}};this.gotoDefLine==o&&(s=!0,p.options.isWholeLine=!0,p.options.className="gotoLine"),i.push(p)}if(-1!=this.gotoDefLine&&!s){var l={range:new monaco.Range(this.gotoDefLine,1,this.gotoDefLine,1),options:{isWholeLine:!0,className:"gotoLine"}};i.push(l)}this.existingBreakPoints=this.editor.deltaDecorations(this.existingBreakPoints,i)},e.prototype.updateModelContent=function(e){this.model.setValue(e)},e}(),P=function(e){function t(t,n,i,s){void 0===i&&(i=""),void 0===s&&(s=!1);var a=e.call(this,t,n,r.LangType.javascript,i,"es5Module.js",s)||this;return a.cb=n,a}return __extends(t,e),t.prototype.onContentChanged=function(){},t}(D),V=function(e){function t(t,i,o,p,l,d){function c(t){if(t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN){var e=t.target.position.lineNumber;if(!_)b=e;else if(b==e)return;b=e,_=!0;var n=t.event.browserEvent.clientX,i=t.event.browserEvent.clientY,s=I.jsBreakPointsState;I.tsBreakPointState&&(s=I.tsBreakPointState);var a=s&&s.debugpoints.BREAKPOINT&&s.debugpoints.BREAKPOINT[e],r=jQuery("#new-breakpoint-menu"),o="";a&&(o=s.debugpoints.BREAKPOINT[e].evaluationString+"");var p=document.getElementById("ts_editor");if(p){var l=p.getBoundingClientRect();i-=l.top-60,0>i&&(i=0),n+=30}r.find("#breakpoint-line-number").text(e);var d=r.find("#breakpoint-condition");d.attr("data-linenumber",e),d.val(o),r.css({display:"block",transform:"translate("+n+"px, "+i+"px)"}).addClass("show")}}function g(){-1!=A&&(clearTimeout(A),A=-1),_&&(jQuery("#new-breakpoint-menu").removeClass("show").hide(),_=!1)}void 0===o&&(o=!1),void 0===p&&(p=""),void 0===l&&(l=""),void 0===d&&(d=!1);var f=e.call(this,t,i,r.LangType.typescript,p,n.getCurrentModuleName(),!n.canWriteSI())||this;f.cb=i,f.autoCompile=o,f.compileTriggerTimoutID=-1,f.isBreakPointsLoaded=!1,f.tsBreakPointState={debugpoints:{BREAKPOINT:{}}};var u=n.getCurrentSI();u.tsscript;var m;if(M()){n.isSeismicComponent()&&window.recordConfig.snippets.push({label:"Seismic",doc:"Creates seismic component template",text:"(function () {\n\t\t\t\t\t\t\tlet createElement = window.snComponentServices.createElement;\n\t\t\t\t\t\t\tlet Fragment = window.snComponentServices.Fragment;\n\t\t\t\t\t\t\tconst getProperties = () => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tage: {\n\t\t\t\t\t\t\t\t\t\tdefault: 38\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tgender: {\n\t\t\t\t\t\t\t\t\t\tdefault: 'male'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tarea1: {\n\t\t\t\t\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\t\t\t\t\tpin: '',\n\t\t\t\t\t\t\t\t\t\t\tstreet: {\n\t\t\t\t\t\t\t\t\t\t\t\tline: '',\n\t\t\t\t\t\t\t\t\t\t\t\troad: ''\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\treflect: true\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tsalary: {\n\t\t\t\t\t\t\t\t\t\tcomputed() {\n\t\t\t\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tusers: {\n\t\t\t\t\t\t\t\t\t\tunstableParse: true\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tname: {\n\t\t\t\t\t\t\t\t\t\tdefault: 'Fred',\n\t\t\t\t\t\t\t\t\t\treadonly: true\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tconst getInitialState = () => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tfirstName: 'lakshmi',\n\t\t\t\t\t\t\t\t\tlastName: 'narayana',\n\t\t\t\t\t\t\t\t\tage: 38\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\ttype State = ReturnType<typeof getInitialState> & {\n\t\t\t\t\t\t\t\tproperties: ComponentPropType<ReturnType<typeof getProperties>>\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tlet componentTempate = window.snComponentServices.getDefaultTemplate();\n\t\t\t\t\t\t\tcomponentTempate.view = (state: State, dispatch: Dispatch<State>) => {\n\t\t\t\t\t\t\t\treturn (<div attrs={{ firstName: 'lakshmi', lastName: 'narayana' }} style={{ color: 'red' }} hook-insert={() => {\n\t\t\t\t\t\t\t\t\tconsole.log('element mounted');\n\t\t\t\t\t\t\t\t}} hook-update={() => {\n\t\t\t\t\t\t\t\t\tconsole.log('element updated');\n\t\t\t\t\t\t\t\t}}> {state.firstName} - {state.lastName}\n\t\t\t\t\t\t\t\t\t<button on-click={() => {\n\t\t\t\t\t\t\t\t\t\t//dispatch.updateState({ age: ++state.age });\n\t\t\t\t\t\t\t\t\t\tdispatch.updateState({ path: 'age', value: ++state.age, operation: 'set' });\n\t\t\t\t\t\t\t\t\t}}>increment</button>\n\t\t\t\t\t\t\t\t\t<span>{state.age}</span>\n\t\t\t\t\t\t\t\t\t<button on-click={() => {\n\t\t\t\t\t\t\t\t\t\tdispatch.updateState({ age: --state.age });\n\t\t\t\t\t\t\t\t\t}}>decrement</button>\n\t\t\t\t\t\t\t\t</div>);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcomponentTempate.initialState = getInitialState();\n\t\t\t\t\t\t\tcomponentTempate.properties = getProperties();\n\t\t\t\t\t\t\tcomponentTempate.eventHandlers = [];\n\t\t\t\t\t\t\twindow.snComponentServices.registerComponent('yln-test', componentTempate);\n\t\t\t\t\t\t})();"});for(var y=[],h=0,C=window.recordConfig.snippets,T;h<C.length;h++)T=C[h],y.push({range:void 0,label:"yln_"+T.label,kind:monaco.languages.CompletionItemKind.Snippet,documentation:T.doc,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:T.text});0<y.length&&monaco.languages.registerCompletionItemProvider("typescript",{provideCompletionItems:function(){return{suggestions:y}}}),f.editor.addAction({id:"Run",label:"Run",contextMenuGroupId:"modification",contextMenuOrder:3.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_R],run:function(){return document.getElementById(r.EL_SCRIPT_RUNNER).click(),null}})}else n.isServiceNow()&&!u.isNew()&&f.editor.addAction({id:"Save",label:"Save",contextMenuGroupId:"modification",contextMenuOrder:2.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],run:function(){R.saveSI(null)}});f.editor.addAction({id:"FielOpen",label:"FileOpen",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_P],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){return a.FileSearch.isOpen||(m=new a.FileSearch(e,function(e){var t="./?sys_id="+e.sysId;n.isServiceNow()&&(t="./sys_script_include.do?sys_id="+e.sysId),window.open(t)}),m.open()),null}});var S=-1,_=!1,b=0,A=-1,I=f;return f.isReadonly||(f.editor.onDidChangeModelContent(function(t){E++,u.setDirtyState(!0),u.updateTSScript(f.model.getValue()),-1!=S&&clearTimeout(S),S=window.setTimeout(function(){S=-1,f.onContentChanged(t)},n.isSeismicComponent()?2e3:5e3)}),jQuery(document).on("keyup",function(t){27==t.keyCode&&g()}),jQuery("#ts_editor_container").on("keyup","#breakpoint-condition",function(t){if(27==t.keyCode)return void g();if(13==t.keyCode){var e=jQuery(t.target),n=parseInt(e.attr("data-linenumber")),i=e.val();f.onBreakpoint(n,1,i,!0),g()}}),(!u.isNew()||!!window.recordConfig.breakpoints)&&(f.editor.onMouseDown(function(t){t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&t.event.leftButton&&(u.isUpToDate()&&u.canPlaceBreakPoints()||!!window.recordConfig.breakpoints)&&f.onBreakpoint(t.target.position.lineNumber,1)}),!M()&&(f.editor.onContextMenu(function(t){c(t)}),f.editor.onMouseMove(function(t){return t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN?_?void c(t):-1==A?void(A=self.setTimeout(function(){c(t),A=-1},500)):void 0:void(A-1&&(clearTimeout(A),A=-1))})))),f.editor.onDidFocusEditorText(function(){console.log("focus to editor"),-1==f.gotoDefLine||(f.gotoDefLine=-1,f.toggleBreakPoint(f.breakPoints))}),setTimeout(function(){var e=0;window.recordConfig.gotoLine&&(e=parseInt(window.recordConfig.gotoLine)||0,e&&(f.gotoDefLine=e,f.editor.revealPositionInCenter({lineNumber:e,column:0}),f.toggleBreakPoint(f.breakPoints)))},10),M()?n.isSeismicComponent()&&(s.default.jsx=monaco.languages.typescript.JsxEmit.React,s.default.inlineSourceMap=!0,s.default.inlineSources=!0):s.default.declaration=window.recordConfig.isES6,monaco.languages.typescript.typescriptDefaults.setCompilerOptions(s.default),setTimeout(function(){return f.triggerCompilation()},1e3),f}return __extends(t,e),t.prototype.setJSInstance=function(e){this.jsInstance=e},t.prototype.updateBreakPoints=function(e){var t=this,n=Object.keys(e.debugpoints.BREAKPOINT).map(function(e){return parseInt(e)});this.convertLineNoFromJSToTS(n).then(function(e){t.toggleBreakPoint(e)})},t.prototype.onBreakpoint=function(e,t,i,s){var a=this;void 0===i&&(i=""),void 0===s&&(s=!1);n.getCurrentSI();this.convertLineNoFromTStoJS([e]).then(function(e){a.jsInstance&&a.jsInstance.toggleBreakPoint(e),!n.isServiceNow||M()?a.convertLineNoFromJSToTS(e).then(function(e){a.toggleBreakPoint(e)},function(e){console.log(e)}):a.toggleBreakPointInServer(e[0],i,s)},function(e){console.log(e)})},t.prototype.onContentChanged=function(){var e=n.getCurrentSI();e.setDirtyState(!0),e.updateTSScript(this.model.getValue()),-1!=this.compileTriggerTimoutID&&(clearTimeout(this.compileTriggerTimoutID),this.compileTriggerTimoutID=-1);var t="undefined"!=typeof ts,i="undefined"!=typeof monaco;t&&i&&(this.compileTriggerTimoutID=window.setTimeout(this.triggerCompilation.bind(this),5000))},t.prototype.triggerCompilation=function(){var e=this,t=n.getCurrentSI();this.compileTriggerTimoutID=-1,i().then(function(i){if(t.updateScript(i.js),t.setDirtyState(!1),t.updateDeclaration(i.declaration),t.updateSourcemap(i.sourceMap),e.sourcemapConsumer&&e.sourcemapConsumer.destroy(),e.sourcemapConsumer=void 0,e.tsOuput=i,t.isJavascript()){i.linterErrors=i.linterErrors||[];var s=i.linterErrors.map(function(e){return{startLineNumber:e.line,endLineNumber:e.endLine||e.line,startColumn:e.column,endColumn:e.endColumn||e.column,message:e.message+" ("+e.ruleId+")",severity:monaco.MarkerSeverity.Warning,source:"ESLint"}});monaco.editor.setModelMarkers(e.model,"eslint",s)}e.applySourcemap().then(function(i){if(e.sourcemapConsumer=i,!e.isBreakPointsLoaded&&(e.isBreakPointsLoaded=!0,n.getCurrentSI().canPlaceBreakPoints()&&!M()&&e.loadBreakPointsFromServer("sys_script_include.script"),n.isServiceNow()&&!t.isNew())){var s=p.default(),a="script_id="+t.sys_id,r=-1;s.initChannel("sys_js_breakpoint",a).subscribe(function(){-1!=r&&clearTimeout(r),r=self.setTimeout(function(){e.loadBreakPointsFromServer("sys_script_include.script")},5e3)})}}),e.cb(i)},function(e){console.log(e)})},t.prototype.convertLineNoFromTStoJS=function(e){if(!window.recordConfig.isES6)return Promise.resolve(e);if(!this.sourcemapConsumer)return Promise.resolve(e);var t=[],i=n.getCurrentSI(),s="point.js";i.isTypescript()&&(s="point.ts");for(var a=0,r=e;a<r.length;a++){var o=r[a],p=this.sourcemapConsumer.generatedPositionFor({source:s,line:o,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});t.push(p.line)}return Promise.resolve(t)},t.prototype.convertLineNoFromJSToTS=function(e){if(!window.recordConfig.isES6)return Promise.resolve(e);if(!this.sourcemapConsumer)return this.tsBreakPointState=this.jsBreakPointsState,Promise.resolve(e);for(var t=[],n={debugpoints:{BREAKPOINT:{}},key:this.jsBreakPointsState&&this.jsBreakPointsState.key},i=0,s=e;i<s.length;i++){var a=s[i],r=this.sourcemapConsumer.originalPositionFor({line:a,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});r&&r.line&&(n.debugpoints.BREAKPOINT[r.line]=this.jsBreakPointsState&&this.jsBreakPointsState.debugpoints.BREAKPOINT&&this.jsBreakPointsState.debugpoints.BREAKPOINT[a],t.push(r.line))}return this.tsBreakPointState=n,Promise.resolve(t)},t.prototype.applySourcemap=function(){if("undefined"==typeof sourceMap)return Promise.resolve(void 0);if(!this.tsOuput.sourceMap)return Promise.resolve(void 0);var e=new sourceMap.SourceMapConsumer(JSON.parse(this.tsOuput.sourceMap));return e},t}(D),L=function(e){function i(t,i,s,a,r,o){void 0===s&&(s=!1),void 0===a&&(a=""),void 0===r&&(r=""),void 0===o&&(o=!1);var p=e.call(this,t,i,s,a,r,o)||this;return p.registerForRun(),n.loadJSXIntellisense(),p}return __extends(i,e),i.prototype.registerForRun=function(){var e=this,t=document.getElementById(r.EL_SCRIPT_RUNNER);t.addEventListener("click",function(){e.renderOutput()})},i.prototype.onContentChanged=function(){return this.handleJSXChanges()},i.prototype.triggerCompilation=function(){if(n.isSeismicComponent())return this.handleJSXChanges()},i.prototype.renderOutput=function(){var e=this.jsxValue;window.getComponent=function(){return e},jQuery("a[href=\"#script-output\"]").tab("show");var t=jQuery("#"+r.EL_SCRIPT_OUTPUT),i=document.createElement("iframe");i.id="seismic_host",i.style.width="100%",i.style.height="100%",i.style.border="1px solid darkgray",i.src="./seismic."+(n.isServiceNow()?"do":"html")+"?cache="+Date.now(),t.html(i)},i.prototype.handleJSXChanges=function(){var e=this;localStorage.setItem("last_monaco_script",this.model.getValue()),monaco.languages.typescript.getTypeScriptWorker().then(function(n){n(e.model.uri).then(function(n){var i=n.getEmitOutput(e.model.uri.toString());i.then(function(n){return n.emitSkipped?void t().then(function(){},function(){console.log("Error while compiling")}):void n.outputFiles.forEach(function(t){t.name.endsWith(".js")&&(e.jsxValue=t.text,e.jsInstance&&e.jsInstance.updateModelContent(t.text))})})})})},i}(V),j=document.getElementById(r.EL_THEME_SELECT),O=!0;var w=-1,R={startDebugger:function(){var e;return"undefined"==typeof window.top.launchScriptDebugger?window.top.opener&&window.top.opener.top.launchScriptDebugger&&(e=window.top.opener.top.launchScriptDebugger):e=window.top.launchScriptDebugger,"undefined"!=typeof e&&"undefined"!=typeof g_form?void e(g_form.getUniqueValue(),g_form.getTableName()):"undefined"==typeof g_form?void b():void b(g_form.getUniqueValue(),g_form.getTableName())},saveSI:function(e){-1==w&&e&&(w=self.setTimeout(function(){w=-1},60000),x("You can use ` CMD/CTRL + s ` keyboard shorcut to save the script. It's pretty handy!","info",1e4)),e||(e=document.getElementById("codenow.savesi"));var t=jQuery(e),s=t.find(">i");return t.attr("disabled","disabled"),s.removeClass("hide"),i(!0).then(function(e){var i=o.ClientSIRecordData.getClassConstructorFormat(n.getCurrentSI()),a={js:i,decl:e.backEndDecl,esNext:e.tsScript,sourceMap:e.sourceMap},r={contentType:"application/json",data:JSON.stringify(a),headers:{X_UserToken:window.g_ck},method:"POST",type:"POST",url:"/api/now/typescript_helpers/UpdateSI"};jQuery.ajax(r).done(function(){t.removeAttr("disabled"),s.addClass("hide"),E=0,x("Updated successfully","info")}).fail(function(){I(t,s,jQuery("#fail_modal"))})},function(e){x(e,"error"),t.removeAttr("disabled"),s.addClass("hide")}),!1},toggleLinter:function(){s.default.linter=!s.default.linter,monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:s.default.linter,noSyntaxValidation:s.default.linter}),A()},updateAllSIDeclaration:function(e,t){function i(e){if(0==e.length)return void I(s,a,jQuery("#success_modal"));if(n.isServiceNow()){var i={url:"/api/now/typescript_helpers/updateMultiSIDecl",type:"POST",data:e,headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}};t&&(i.url="/api/now/table/ts_definition/b4c6d3500ba213008e64aabcb4673a6c",i.type="put",i.data=JSON.stringify({json_value:e})),jQuery.ajax(i).done(function(e){I(s,a,jQuery("#success_modal")),console.log(e)}).fail(function(){I(s,a,jQuery("#fail_modal"))})}}void 0===t&&(t=!1);var s=jQuery(e),a=s.find(">i");s.attr("disabled","disabled"),a.removeClass("hide");var r="";r=t?"/api/now/table/sys_script_include?&sysparm_query=active=true":"/api/now/typescript_helpers/getOutOfSyncSI",n.isServiceNow()||(r="/scripts/sys_script_include.json");var p=new n.RecordFetcher(r);p.fetch().then(function(e){var t=jQuery("#UpdateSI");if(0==e.length)return I(s,a,jQuery("#success_modal")),void t.text("Update Scripts");if(!window.recordConfig.useTypeChecker){var r=o.parseSI(e,esprima),l=JSON.stringify({api:JSON.parse(r.getFormat(!0))}),d=r.getParsingErrors(),c=r.getEmptyDeclarations();d.forEach(function(e){console.error("Parsing error for => "+e)}),c.forEach(function(e){console.error("empty declaration for "+e)}),i(l)}else{window.onSIParserProgressEvent=function(e,n){t.text("Updating ... "+n+" %")};var g=n.generateTypeDeclarations(e);g.then(function(e){var n=JSON.stringify({api:e.formatterResult});i(n),console.log("type checker parser results came "),e.errors&&0<e.errors.length&&e.errors.forEach(function(e){console.log("parsing error "+e)}),t.text("Update Scripts")},function(){s.removeAttr("disabled"),t.text("Try again")}),console.log("parsing done")}},function(e){alert("unable to fetch the script include with error "+e)})},updateTableDeclarations:function(e){var t=jQuery(e),n=t.find(">i");t.attr("disabled","disabled"),n.removeClass("hide");jQuery.ajax({url:"/api/now/typescript_helpers/updatetabledefinition",type:"post",data:JSON.stringify({}),headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}}).done(function(e){I(t,n,jQuery("#success_modal")),console.log(e)}).fail(function(){I(t,n,jQuery("#fail_modal"))})},openNewWindow:function(){window.open(location.href)},updateOnSave:function(){return d(!1,window.recordConfig.useTypeChecker,!0,function(){var e=window.recordConfig;e.isNewRecord?gsftSubmit(void 0,void 0,"sysverb_insert"):gsftSubmit(void 0,void 0,g_form.getActionName())},function(){})},updateDecl:function(e,t){var n=jQuery(e),i=n.find(">i");return n.attr("disabled","disabled"),i.removeClass("hide"),d(t,!0,!1,function(){I(n,i,jQuery("#success_modal"))},function(){I(n,i,jQuery("#fail_modal"))})},onCompilerSettingsChange:function(e){var t=e.closest("li"),n=t.dataset.key;n&&(F[n]=!F[n],F[n]?jQuery(t).find(".state-icon").removeClass("glyphicon-unchecked").addClass("glyphicon-check"):jQuery(t).find(".state-icon").removeClass("glyphicon-check").addClass("glyphicon-unchecked"),A())},onTargetChange:function(e,t){var n=parseInt(t);F.target=n,A()},onJSXChange:function(e,t){var i=parseInt(t);return F.jsx=i,n.loadJSXIntellisense(),A()},initialize:function(){T()}};return R}Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n),s=__importDefault(s),r=__importStar(r),o=__importStar(o),p=__importDefault(p),l=__importStar(l);var g=n.TranspilerOutput,f;(function(e){e[e.DIFF_DELETE=-1]="DIFF_DELETE",e[e.DIFF_INSERT=1]="DIFF_INSERT",e[e.DIFF_EQUAL=0]="DIFF_EQUAL"})(f||(f={}));n.isMainThread()&&window.recordConfig&&(window.settings=d())});function getWorkerUrl(e){if(0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")){var t="ylnworker.jsdbx";return window.g_ck||(t="ylnworker.js"),t+"?v="+e}var n=location.origin+"/";window.recordConfig.paths.app.startsWith("ylnEditorMain")?n+=window.recordConfig.paths.app:n=window.recordConfig.paths.app,window.g_ck||(n=location.origin+"/app.js");var i="'"+window.recordConfig.paths.linter+"'",s="'"+window.recordConfig.paths.vsLoader+"'",a="'"+window.recordConfig.paths.tsCompiler+"'",r=[i,s,a].join(","),o={libVersions:{appVersion:window.recordConfig.libVersions.appVersion},paths:{app:window.recordConfig.paths.app,tsCompiler:window.recordConfig.paths.tsCompiler,vsLoader:window.recordConfig.paths.vsLoader,linter:window.recordConfig.paths.linter},isES6:window.recordConfig.isES6},p="self.recordConfig = JSON.parse('"+JSON.stringify(o)+"');\n";p+="importScripts("+r+");",p+="require.config({baseUrl: './',urlArgs: 'sysparm_substitute=false', paths: {},ignoreDuplicateModules: []});",p+="define('typescript', [], function () {return self.ts;});",p+="importScripts('"+n+"');",p+="var siDeclName = 'scripts/SIDeclEmittor';require(siDeclName).onThreadInitialized(self);";var l="data:text/javascript;charset=utf-8,"+encodeURIComponent(p);return l}function loadWorkerThread(){var e={app:window.g_ck?location.origin+"/ylnEditorMain.jsdbx":location.origin+"/app.js",loaderVersion:recordConfig.tsVersion,tsVersion:"3.2.2"};(function(e,t){var n="("+e+")(";return"string"==typeof t&&(n+=t),n+=")",new Worker(URL.createObjectURL(new Blob([n])))})(function(e){console.log(e);var t=e||JSON.parse(e),n=t.loaderVersion||"0.15.6",i=t.tsVersion||"3.2.2";importScripts("https://cdn.jsdelivr.net/npm/monaco-editor@"+n+"/min/vs/loader.js","https://cdnjs.cloudflare.com/ajax/libs/typescript/"+i+"/typescript.min.js"),console.log("cdn scripts loaded"),require.config({baseUrl:"./",urlArgs:"sysparm_substitute=false",paths:{},ignoreDuplicateModules:[]}),define("typescript",[],function(){return self.ts}),importScripts(t.app),console.log("app loaded"),require("scripts/SIDeclEmittor").onThreadInitialized(self),console.log("messages registered successfully")},JSON.stringify(e))}function escapeText(e){for(var t=0,n=null,s=[],a=0,r=e.length,o;a<r;a++)o=e.charCodeAt(a),o===96?n="\\`":o===8?n="\\b":o===12?n="\\f":o===10?n="\\n":o===0?n="\\0":o===13?n="\\r":o===9?n="\\t":o===11?n="\\v":o===92?n="\\\\":o===34?n="\\\"":void 0,null!==n&&(s.push(e.substring(t,a)),s.push(n),t=a+1,n=null);return s.push(e.substring(t,r)),s.join("")}function CodeMirrorNoScriptTextAreaElementForSI(e){this.name=e}CodeMirrorNoScriptTextAreaElementForSI.prototype.initialize=function(e){this.name=e},CodeMirrorNoScriptTextAreaElementForSI.prototype.setReadOnly=function(){},CodeMirrorNoScriptTextAreaElementForSI.prototype.isDisabled=function(){return!1},CodeMirrorNoScriptTextAreaElementForSI.prototype.isReadOnly=function(){return!1},CodeMirrorNoScriptTextAreaElementForSI.prototype.getValue=function(){return currentSI.script},CodeMirrorNoScriptTextAreaElementForSI.prototype.setValue=function(){document.getElementById(this.name).value=currentSI.script},CodeMirrorNoScriptTextAreaElementForSI.prototype.isVisible=function(){return!0};function createParserThread(e){var t={libVersions:{appVersion:window.recordConfig.libVersions.appVersion},paths:{app:window.recordConfig.paths.app,tsCompiler:window.recordConfig.paths.tsCompiler,vsLoader:window.recordConfig.paths.vsLoader,linter:window.recordConfig.paths.linter},isES6:window.recordConfig.isES6},n=new Worker(getWorkerUrl(window.recordConfig.libVersions.appVersion),{name:"ylnworker?codenowWorkerParams="+JSON.stringify(t)});window.ylnWorker=n,e.onThreadInitialized(n)}function loadEditorUI(){function e(){window.removeEventListener("visibilitychange",e),console.log("initialyzing monaco editor on visibility change event"),settings.initialize()}var t=require||t;t.config({urlArgs:"sysparm_substitute=false",paths:{vs:window.recordConfig.paths.vsSource},ignoreDuplicateModules:["vs/basic-languages/typescript/typescript","vs/editor/editor.main"]});window.recordConfig.useDev||(window.MonacoEnvironment={getWorkerUrl:function(){var e="self.MonacoEnvironment = {";return e+="baseUrl: '"+window.recordConfig.paths.monacoBase+"'",e+="}\nimportScripts('"+window.recordConfig.paths.monacoWorker+"')","data:text/javascript;charset=utf-8,"+encodeURIComponent(e)}}),t(["vs/editor/editor.main"],function(){t(["vs/language/typescript/tsWorker"],function(){define("typescript",["require"],function(){'use strict';return window.ts}),t(["scripts/monacoInit","scripts/SIDeclEmittor"],function(t,n){n.canWriteSI()&&!n.isSeismicComponent()&&createParserThread(n),function t(){return"undefined"==typeof monaco?void setTimeout(t,1e3):void("undefined"==typeof document.hidden?settings.initialize():document.hidden?window.addEventListener("visibilitychange",e):settings.initialize())}()})})}),function e(){return window.g_ck?"undefined"==typeof g_form?void setTimeout(e,1e3):void(g_form.ylnWindow=window):void 0}()}if("undefined"!=typeof window&&window.recordConfig){window.CodeMirrorNoScriptTextAreaElement=CodeMirrorNoScriptTextAreaElementForSI;var keyName="codenow_"+window.recordConfig.sysId,thisStorage=localStorage.getItem(keyName);if(!window.recordConfig.isFromScriptRunner){if(thisStorage){var lastActiveTime=parseInt(thisStorage);!isNaN(lastActiveTime)&&4e3>Date.now()-lastActiveTime&&confirm("Seems like you already opened this SI, click OK to close")&&window.close()}setInterval(function(){localStorage.setItem(keyName,Date.now())},1e3),window.addEventListener("beforeunload",function(){localStorage.removeItem(keyName)})}loadEditorUI()}define("scripts/loaderMain.js",function(){});var diff_match_patch=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;diff_match_patch.Diff=function(e,t){this[0]=e,this[1]=t},diff_match_patch.Diff.prototype.length=2,diff_match_patch.Diff.prototype.toString=function(){return this[0]+","+this[1]},diff_match_patch.prototype.diff_main=function(e,t,n,i){var s=Number.MAX_VALUE;"undefined"==typeof i&&(0>=this.Diff_Timeout?i=s:i=new Date().getTime()+1e3*this.Diff_Timeout);var a=i;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new diff_match_patch.Diff(DIFF_EQUAL,e)]:[];"undefined"==typeof n&&(n=!0);var r=n,o=this.diff_commonPrefix(e,t),p=e.substring(0,o);e=e.substring(o),t=t.substring(o),o=this.diff_commonSuffix(e,t);var l=e.substring(e.length-o);e=e.substring(0,e.length-o),t=t.substring(0,t.length-o);var d=this.diff_compute_(e,t,r,a);return p&&d.unshift(new diff_match_patch.Diff(DIFF_EQUAL,p)),l&&d.push(new diff_match_patch.Diff(DIFF_EQUAL,l)),this.diff_cleanupMerge(d),d},diff_match_patch.prototype.diff_compute_=function(e,t,n,s){var a;if(!e)return[new diff_match_patch.Diff(DIFF_INSERT,t)];if(!t)return[new diff_match_patch.Diff(DIFF_DELETE,e)];var r=e.length>t.length?e:t,o=e.length>t.length?t:e,p=r.indexOf(o);if(-1!=p)return a=[new diff_match_patch.Diff(DIFF_INSERT,r.substring(0,p)),new diff_match_patch.Diff(DIFF_EQUAL,o),new diff_match_patch.Diff(DIFF_INSERT,r.substring(p+o.length))],e.length>t.length&&(a[0][0]=a[2][0]=DIFF_DELETE),a;if(1==o.length)return[new diff_match_patch.Diff(DIFF_DELETE,e),new diff_match_patch.Diff(DIFF_INSERT,t)];var i=this.diff_halfMatch_(e,t);if(i){var l=i[0],d=i[1],c=i[2],g=i[3],f=i[4],u=this.diff_main(l,c,n,s),m=this.diff_main(d,g,n,s);return u.concat([new diff_match_patch.Diff(DIFF_EQUAL,f)],m)}return n&&100<e.length&&100<t.length?this.diff_lineMode_(e,t,s):this.diff_bisect_(e,t,s)},diff_match_patch.prototype.diff_lineMode_=function(e,t,n){var i=this.diff_linesToChars_(e,t);e=i.chars1,t=i.chars2;var s=i.lineArray,a=this.diff_main(e,t,!1,n);this.diff_charsToLines_(a,s),this.diff_cleanupSemantic(a),a.push(new diff_match_patch.Diff(DIFF_EQUAL,""));for(var r=0,o=0,p=0,l="",d="";r<a.length;){switch(a[r][0]){case DIFF_INSERT:p++,d+=a[r][1];break;case DIFF_DELETE:o++,l+=a[r][1];break;case DIFF_EQUAL:if(1<=o&&1<=p){a.splice(r-o-p,o+p),r=r-o-p;for(var c=this.diff_main(l,d,!1,n),g=c.length-1;0<=g;g--)a.splice(r,0,c[g]);r+=c.length}p=0,o=0,l="",d="";}r++}return a.pop(),a},diff_match_patch.prototype.diff_bisect_=function(e,t,n){for(var i=e.length,s=t.length,a=Math.ceil((i+s)/2),r=a,o=2*a,p=Array(o),l=Array(o),c=0;c<o;c++)p[c]=-1,l[c]=-1;p[r+1]=0,l[r+1]=0;for(var g=i-s,f=0!=g%2,u=0,m=0,y=0,h=0,C=0;C<a&&!(new Date().getTime()>n);C++){for(var T=-C+u;T<=C-m;T+=2){var S=r+T,_;_=T==-C||T!=C&&p[S-1]<p[S+1]?p[S+1]:p[S-1]+1;for(var b=_-T;_<i&&b<s&&e.charAt(_)==t.charAt(b);)_++,b++;if(p[S]=_,_>i)m+=2;else if(b>s)u+=2;else if(f){var A=r+g-T;if(0<=A&&A<o&&-1!=l[A]){var I=i-l[A];if(_>=I)return this.diff_bisectSplit_(e,t,_,b,n)}}}for(var E=-C+y;E<=C-h;E+=2){var A=r+E,I;I=E==-C||E!=C&&l[A-1]<l[A+1]?l[A+1]:l[A-1]+1;for(var M=I-E;I<i&&M<s&&e.charAt(i-I-1)==t.charAt(s-M-1);)I++,M++;if(l[A]=I,I>i)h+=2;else if(M>s)y+=2;else if(!f){var S=r+g-E;if(0<=S&&S<o&&-1!=p[S]){var _=p[S],b=r+_-S;if(I=i-I,_>=I)return this.diff_bisectSplit_(e,t,_,b,n)}}}}return[new diff_match_patch.Diff(DIFF_DELETE,e),new diff_match_patch.Diff(DIFF_INSERT,t)]},diff_match_patch.prototype.diff_bisectSplit_=function(e,t,n,i,s){var a=e.substring(0,n),r=t.substring(0,i),o=e.substring(n),p=t.substring(i),l=this.diff_main(a,r,!1,s),d=this.diff_main(o,p,!1,s);return l.concat(d)},diff_match_patch.prototype.diff_linesToChars_=function(e,t){var i=String.fromCharCode;function n(e){for(var t="",n=0,o=-1,p=s.length;o<e.length-1;){o=e.indexOf("\n",n),-1==o&&(o=e.length-1);var l=e.substring(n,o+1);(a.hasOwnProperty?a.hasOwnProperty(l):a[l]!==void 0)?t+=i(a[l]):(p==r&&(l=e.substring(n),o=e.length),t+=i(p),a[l]=p,s[p++]=l),n=o+1}return t}var s=[],a={};s[0]="";var r=4e4,o=n(e);r=65535;var p=n(t);return{chars1:o,chars2:p,lineArray:s}},diff_match_patch.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var s=e[n][1],a=[],r=0;r<s.length;r++)a[r]=t[s.charCodeAt(r)];e[n][1]=a.join("")}},diff_match_patch.prototype.diff_commonPrefix=function(e,t){var n=Math.min,i=Math.floor;if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var s=0,a=n(e.length,t.length),r=a,o=0;s<r;)e.substring(o,r)==t.substring(o,r)?(s=r,o=s):a=r,r=i((a-s)/2+s);return r},diff_match_patch.prototype.diff_commonSuffix=function(e,t){var n=Math.min,i=Math.floor;if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var s=0,a=n(e.length,t.length),r=a,o=0;s<r;)e.substring(e.length-r,e.length-o)==t.substring(t.length-r,t.length-o)?(s=r,o=s):a=r,r=i((a-s)/2+s);return r},diff_match_patch.prototype.diff_commonOverlap_=function(e,t){var n=e.length,i=t.length;if(0==n||0==i)return 0;n>i?e=e.substring(n-i):n<i&&(t=t.substring(0,n));var s=Math.min(n,i);if(e==t)return s;for(var a=0,r=1;;){var o=e.substring(s-r),p=t.indexOf(o);if(-1==p)return a;r+=p,(0==p||e.substring(s-r)==t.substring(0,r))&&(a=r,r++)}},diff_match_patch.prototype.diff_halfMatch_=function(e,t){var i=Math.ceil,s=Math.floor;function n(e,t,n){for(var i=e.substring(n,n+s(e.length/4)),a=-1,r="",p,l,d,c;-1!=(a=t.indexOf(i,a+1));){var g=o.diff_commonPrefix(e.substring(n),t.substring(a)),f=o.diff_commonSuffix(e.substring(0,n),t.substring(0,a));r.length<f+g&&(r=t.substring(a-f,a)+t.substring(a,a+g),p=e.substring(0,n-f),l=e.substring(n+g),d=t.substring(0,a-f),c=t.substring(a+g))}return 2*r.length>=e.length?[p,l,d,c,r]:null}if(0>=this.Diff_Timeout)return null;var a=e.length>t.length?e:t,r=e.length>t.length?t:e;if(4>a.length||2*r.length<a.length)return null;var o=this,p=n(a,r,i(a.length/4)),l=n(a,r,i(a.length/2)),d;if(!p&&!l)return null;d=l?p?p[4].length>l[4].length?p:l:l:p;var c,g,f,u;e.length>t.length?(c=d[0],g=d[1],f=d[2],u=d[3]):(f=d[0],u=d[1],c=d[2],g=d[3]);var m=d[4];return[c,g,f,u,m]},diff_match_patch.prototype.diff_cleanupSemantic=function(e){for(var t=Math.max,n=!1,i=[],s=0,a=null,r=0,o=0,p=0,l=0,d=0;r<e.length;)e[r][0]==DIFF_EQUAL?(i[s++]=r,o=l,p=d,l=0,d=0,a=e[r][1]):(e[r][0]==DIFF_INSERT?l+=e[r][1].length:d+=e[r][1].length,a&&a.length<=t(o,p)&&a.length<=t(l,d)&&(e.splice(i[s-1],0,new diff_match_patch.Diff(DIFF_DELETE,a)),e[i[s-1]+1][0]=DIFF_INSERT,s--,s--,r=0<s?i[s-1]:-1,o=0,p=0,l=0,d=0,a=null,n=!0)),r++;for(n&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),r=1;r<e.length;){if(e[r-1][0]==DIFF_DELETE&&e[r][0]==DIFF_INSERT){var c=e[r-1][1],g=e[r][1],f=this.diff_commonOverlap_(c,g),u=this.diff_commonOverlap_(g,c);f>=u?(f>=c.length/2||f>=g.length/2)&&(e.splice(r,0,new diff_match_patch.Diff(DIFF_EQUAL,g.substring(0,f))),e[r-1][1]=c.substring(0,c.length-f),e[r+1][1]=g.substring(f),r++):(u>=c.length/2||u>=g.length/2)&&(e.splice(r,0,new diff_match_patch.Diff(DIFF_EQUAL,c.substring(0,u))),e[r-1][0]=DIFF_INSERT,e[r-1][1]=g.substring(0,g.length-u),e[r+1][0]=DIFF_DELETE,e[r+1][1]=c.substring(u),r++),r++}r++}},diff_match_patch.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),i=t.charAt(0),s=n.match(diff_match_patch.nonAlphaNumericRegex_),a=i.match(diff_match_patch.nonAlphaNumericRegex_),r=s&&n.match(diff_match_patch.whitespaceRegex_),o=a&&i.match(diff_match_patch.whitespaceRegex_),p=r&&n.match(diff_match_patch.linebreakRegex_),l=o&&i.match(diff_match_patch.linebreakRegex_),d=p&&e.match(diff_match_patch.blanklineEndRegex_),c=l&&t.match(diff_match_patch.blanklineStartRegex_);if(d||c)return 5;return p||l?4:s&&!r&&o?3:r||o?2:s||a?1:0}for(var n=1;n<e.length-1;){if(e[n-1][0]==DIFF_EQUAL&&e[n+1][0]==DIFF_EQUAL){var i=e[n-1][1],s=e[n][1],a=e[n+1][1],r=this.diff_commonSuffix(i,s);if(r){var o=s.substring(s.length-r);i=i.substring(0,i.length-r),s=o+s.substring(0,s.length-r),a=o+a}for(var p=i,l=s,d=a,c=t(i,s)+t(s,a);s.charAt(0)===a.charAt(0);){i+=s.charAt(0),s=s.substring(1)+a.charAt(0),a=a.substring(1);var g=t(i,s)+t(s,a);g>=c&&(c=g,p=i,l=s,d=a)}e[n-1][1]!=p&&(p?e[n-1][1]=p:(e.splice(n-1,1),n--),e[n][1]=l,d?e[n+1][1]=d:(e.splice(n+1,1),n--))}n++}},diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,diff_match_patch.whitespaceRegex_=/\s/,diff_match_patch.linebreakRegex_=/[\r\n]/,diff_match_patch.blanklineEndRegex_=/\n\r?\n$/,diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/,diff_match_patch.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],i=0,s=null,a=0,r=!1,o=!1,p=!1,l=!1;a<e.length;)e[a][0]==DIFF_EQUAL?(e[a][1].length<this.Diff_EditCost&&(p||l)?(n[i++]=a,r=p,o=l,s=e[a][1]):(i=0,s=null),p=l=!1):(e[a][0]==DIFF_DELETE?l=!0:p=!0,s&&(r&&o&&p&&l||s.length<this.Diff_EditCost/2&&3==r+o+p+l)&&(e.splice(n[i-1],0,new diff_match_patch.Diff(DIFF_DELETE,s)),e[n[i-1]+1][0]=DIFF_INSERT,i--,s=null,r&&o?(p=l=!0,i=0):(i--,a=0<i?n[i-1]:-1,p=l=!1),t=!0)),a++;t&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_cleanupMerge=function(e){e.push(new diff_match_patch.Diff(DIFF_EQUAL,""));for(var t=0,n=0,i=0,s="",a="",r;t<e.length;)switch(e[t][0]){case DIFF_INSERT:i++,a+=e[t][1],t++;break;case DIFF_DELETE:n++,s+=e[t][1],t++;break;case DIFF_EQUAL:1<n+i?(0!==n&&0!==i&&(r=this.diff_commonPrefix(a,s),0!==r&&(0<t-n-i&&e[t-n-i-1][0]==DIFF_EQUAL?e[t-n-i-1][1]+=a.substring(0,r):(e.splice(0,0,new diff_match_patch.Diff(DIFF_EQUAL,a.substring(0,r))),t++),a=a.substring(r),s=s.substring(r)),r=this.diff_commonSuffix(a,s),0!==r&&(e[t][1]=a.substring(a.length-r)+e[t][1],a=a.substring(0,a.length-r),s=s.substring(0,s.length-r))),t-=n+i,e.splice(t,n+i),s.length&&(e.splice(t,0,new diff_match_patch.Diff(DIFF_DELETE,s)),t++),a.length&&(e.splice(t,0,new diff_match_patch.Diff(DIFF_INSERT,a)),t++),t++):0!==t&&e[t-1][0]==DIFF_EQUAL?(e[t-1][1]+=e[t][1],e.splice(t,1)):t++,i=0,n=0,s="",a="";}""===e[e.length-1][1]&&e.pop();var o=!1;for(t=1;t<e.length-1;)e[t-1][0]==DIFF_EQUAL&&e[t+1][0]==DIFF_EQUAL&&(e[t][1].substring(e[t][1].length-e[t-1][1].length)==e[t-1][1]?(e[t][1]=e[t-1][1]+e[t][1].substring(0,e[t][1].length-e[t-1][1].length),e[t+1][1]=e[t-1][1]+e[t+1][1],e.splice(t-1,1),o=!0):e[t][1].substring(0,e[t+1][1].length)==e[t+1][1]&&(e[t-1][1]+=e[t+1][1],e[t][1]=e[t][1].substring(e[t+1][1].length)+e[t+1][1],e.splice(t+1,1),o=!0)),t++;o&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_xIndex=function(e,t){var n=0,i=0,s=0,a=0,r;for(r=0;r<e.length&&(e[r][0]!==DIFF_INSERT&&(n+=e[r][1].length),e[r][0]!==DIFF_DELETE&&(i+=e[r][1].length),!(n>t));r++)s=n,a=i;return e.length!=r&&e[r][0]===DIFF_DELETE?a:a+(t-s)},diff_match_patch.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,i=/</g,s=/>/g,a=/\n/g,r=0;r<e.length;r++){var o=e[r][0],p=e[r][1],l=p.replace(n,"&amp;").replace(i,"&lt;").replace(s,"&gt;").replace(a,"&para;<br>");o===DIFF_INSERT?t[r]="<ins style=\"background:#e6ffe6;\">"+l+"</ins>":o===DIFF_DELETE?t[r]="<del style=\"background:#ffe6e6;\">"+l+"</del>":o===DIFF_EQUAL?t[r]="<span>"+l+"</span>":void 0}return t.join("")},diff_match_patch.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==DIFF_INSERT&&(t[n]=e[n][1]);return t.join("")},diff_match_patch.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==DIFF_DELETE&&(t[n]=e[n][1]);return t.join("")},diff_match_patch.prototype.diff_levenshtein=function(e){for(var t=Math.max,n=0,i=0,s=0,a=0;a<e.length;a++){var r=e[a][0],o=e[a][1];r===DIFF_INSERT?i+=o.length:r===DIFF_DELETE?s+=o.length:r===DIFF_EQUAL?(n+=t(i,s),i=0,s=0):void 0}return n+=t(i,s),n},diff_match_patch.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case DIFF_INSERT:t[n]="+"+encodeURI(e[n][1]);break;case DIFF_DELETE:t[n]="-"+e[n][1].length;break;case DIFF_EQUAL:t[n]="="+e[n][1].length;}return t.join("\t").replace(/%20/g," ")},diff_match_patch.prototype.diff_fromDelta=function(e,t){for(var i=[],s=0,a=0,r=t.split(/\t/g),o=0,p;o<r.length;o++)switch(p=r[o].substring(1),r[o].charAt(0)){case"+":try{i[s++]=new diff_match_patch.Diff(DIFF_INSERT,decodeURI(p))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+p)}break;case"-":case"=":var l=parseInt(p,10);if(isNaN(l)||0>l)throw new Error("Invalid number in diff_fromDelta: "+p);var n=e.substring(a,a+=l);i[s++]="="==r[o].charAt(0)?new diff_match_patch.Diff(DIFF_EQUAL,n):new diff_match_patch.Diff(DIFF_DELETE,n);break;default:if(r[o])throw new Error("Invalid diff operation in diff_fromDelta: "+r[o]);}if(a!=e.length)throw new Error("Delta length ("+a+") does not equal source text length ("+e.length+").");return i},diff_match_patch.prototype.match_main=function(e,t,n){var i=Math.min,s=Math.max;if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=s(0,i(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},diff_match_patch.prototype.match_bitap_=function(e,t,n){var a=Math.min,r=Math.floor,o=Math.max;function i(i,e){var a=i/t.length,r=Math.abs(n-e);return s.Match_Distance?a+r/s.Match_Distance:r?1:a}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var p=this.match_alphabet_(t),s=this,l=this.Match_Threshold,c=e.indexOf(t,n);-1!=c&&(l=a(i(0,c),l),c=e.lastIndexOf(t,n+t.length),-1!=c&&(l=a(i(0,c),l)));var g=1<<t.length-1;c=-1;for(var f=t.length+e.length,u=0,m,y,h;u<t.length;u++){for(m=0,y=f;m<y;)i(u,n+y)<=l?m=y:f=y,y=r((f-m)/2+m);f=y;var C=o(1,n-y+1),T=a(n+y,e.length)+t.length,S=Array(T+2);S[T+1]=(1<<u)-1;for(var _=T,b;_>=C;_--)if(b=p[e.charAt(_-1)],S[_]=0===u?(1|S[_+1]<<1)&b:(1|S[_+1]<<1)&b|(1|(h[_+1]|h[_])<<1)|h[_+1],S[_]&g){var A=i(u,_-1);if(A<=l)if(l=A,c=_-1,c>n)C=o(1,2*n-c);else break}if(i(u+1,n)>l)break;h=S}return c},diff_match_patch.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},diff_match_patch.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var n=t.substring(e.start2,e.start2+e.length1),i=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,n=t.substring(e.start2-i,e.start2+e.length1+i);i+=this.Patch_Margin;var s=t.substring(e.start2-i,e.start2);s&&e.diffs.unshift(new diff_match_patch.Diff(DIFF_EQUAL,s));var a=t.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,a)),e.start1-=s.length,e.start2-=s.length,e.length1+=s.length+a.length,e.length2+=s.length+a.length}},diff_match_patch.prototype.patch_make=function(e,t,n){var i,s;if("string"==typeof e&&"string"==typeof t&&"undefined"==typeof n)i=e,s=this.diff_main(i,t,!0),2<s.length&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s));else if(e&&"object"==typeof e&&"undefined"==typeof t&&"undefined"==typeof n)s=e,i=this.diff_text1(s);else if("string"==typeof e&&t&&"object"==typeof t&&"undefined"==typeof n)i=e,s=t;else if("string"==typeof e&&"string"==typeof t&&n&&"object"==typeof n)i=e,s=n;else throw new Error("Unknown call format to patch_make.");if(0===s.length)return[];for(var a=[],r=new diff_match_patch.patch_obj,o=0,p=0,l=0,d=i,c=i,g=0;g<s.length;g++){var f=s[g][0],u=s[g][1];o||f===DIFF_EQUAL||(r.start1=p,r.start2=l),f===DIFF_INSERT?(r.diffs[o++]=s[g],r.length2+=u.length,c=c.substring(0,l)+u+c.substring(l)):f===DIFF_DELETE?(r.length1+=u.length,r.diffs[o++]=s[g],c=c.substring(0,l)+c.substring(l+u.length)):f===DIFF_EQUAL?u.length<=2*this.Patch_Margin&&o&&s.length!=g+1?(r.diffs[o++]=s[g],r.length1+=u.length,r.length2+=u.length):u.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(r,d),a.push(r),r=new diff_match_patch.patch_obj,o=0,d=c,p=l):void 0,f!==DIFF_INSERT&&(p+=u.length),f!==DIFF_DELETE&&(l+=u.length)}return o&&(this.patch_addContext_(r,d),a.push(r)),a},diff_match_patch.prototype.patch_deepCopy=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],s=new diff_match_patch.patch_obj;s.diffs=[];for(var a=0;a<i.diffs.length;a++)s.diffs[a]=new diff_match_patch.Diff(i.diffs[a][0],i.diffs[a][1]);s.start1=i.start1,s.start2=i.start2,s.length1=i.length1,s.length2=i.length2,t[n]=s}return t},diff_match_patch.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var i=0,s=[],a=0;a<e.length;a++){var r=e[a].start2+i,o=this.diff_text1(e[a].diffs),p=-1,l;if(o.length>this.Match_MaxBits?(l=this.match_main(t,o.substring(0,this.Match_MaxBits),r),-1!=l&&(p=this.match_main(t,o.substring(o.length-this.Match_MaxBits),r+o.length-this.Match_MaxBits),(-1==p||l>=p)&&(l=-1))):l=this.match_main(t,o,r),-1==l)s[a]=!1,i-=e[a].length2-e[a].length1;else{s[a]=!0,i=l-r;var d;if(d=-1==p?t.substring(l,l+o.length):t.substring(l,p+this.Match_MaxBits),o==d)t=t.substring(0,l)+this.diff_text2(e[a].diffs)+t.substring(l+o.length);else{var c=this.diff_main(o,d,!1);if(o.length>this.Match_MaxBits&&this.diff_levenshtein(c)/o.length>this.Patch_DeleteThreshold)s[a]=!1;else{this.diff_cleanupSemanticLossless(c);for(var g=0,f=0,u,m;f<e[a].diffs.length;f++)m=e[a].diffs[f],m[0]!==DIFF_EQUAL&&(u=this.diff_xIndex(c,g)),m[0]===DIFF_INSERT?t=t.substring(0,l+u)+m[1]+t.substring(l+u):m[0]===DIFF_DELETE&&(t=t.substring(0,l+u)+t.substring(l+this.diff_xIndex(c,g+m[1].length))),m[0]!==DIFF_DELETE&&(g+=m[1].length)}}}}return t=t.substring(n.length,t.length-n.length),[t,s]},diff_match_patch.prototype.patch_addPadding=function(e){for(var t=String.fromCharCode,n=this.Patch_Margin,i="",s=1;s<=n;s++)i+=t(s);for(var s=0;s<e.length;s++)e[s].start1+=n,e[s].start2+=n;var a=e[0],r=a.diffs;if(0==r.length||r[0][0]!=DIFF_EQUAL)r.unshift(new diff_match_patch.Diff(DIFF_EQUAL,i)),a.start1-=n,a.start2-=n,a.length1+=n,a.length2+=n;else if(n>r[0][1].length){var o=n-r[0][1].length;r[0][1]=i.substring(r[0][1].length)+r[0][1],a.start1-=o,a.start2-=o,a.length1+=o,a.length2+=o}if(a=e[e.length-1],r=a.diffs,0==r.length||r[r.length-1][0]!=DIFF_EQUAL)r.push(new diff_match_patch.Diff(DIFF_EQUAL,i)),a.length1+=n,a.length2+=n;else if(n>r[r.length-1][1].length){var o=n-r[r.length-1][1].length;r[r.length-1][1]+=i.substring(0,o),a.length1+=o,a.length2+=o}return i},diff_match_patch.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=t)){var i=e[n];e.splice(n--,1);for(var s=i.start1,a=i.start2,r="";0!==i.diffs.length;){var o=new diff_match_patch.patch_obj,p=!0;for(o.start1=s-r.length,o.start2=a-r.length,""!==r&&(o.length1=o.length2=r.length,o.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,r)));0!==i.diffs.length&&o.length1<t-this.Patch_Margin;){var l=i.diffs[0][0],d=i.diffs[0][1];l===DIFF_INSERT?(o.length2+=d.length,a+=d.length,o.diffs.push(i.diffs.shift()),p=!1):l===DIFF_DELETE&&1==o.diffs.length&&o.diffs[0][0]==DIFF_EQUAL&&d.length>2*t?(o.length1+=d.length,s+=d.length,p=!1,o.diffs.push(new diff_match_patch.Diff(l,d)),i.diffs.shift()):(d=d.substring(0,t-o.length1-this.Patch_Margin),o.length1+=d.length,s+=d.length,l===DIFF_EQUAL?(o.length2+=d.length,a+=d.length):p=!1,o.diffs.push(new diff_match_patch.Diff(l,d)),d==i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(d.length))}r=this.diff_text2(o.diffs),r=r.substring(r.length-this.Patch_Margin);var c=this.diff_text1(i.diffs).substring(0,this.Patch_Margin);""!==c&&(o.length1+=c.length,o.length2+=c.length,0!==o.diffs.length&&o.diffs[o.diffs.length-1][0]===DIFF_EQUAL?o.diffs[o.diffs.length-1][1]+=c:o.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,c))),p||e.splice(++n,0,o)}}},diff_match_patch.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},diff_match_patch.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var n=e.split("\n"),i=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<n.length;){var a=n[i].match(s);if(!a)throw new Error("Invalid patch string: "+n[i]);var r=new diff_match_patch.patch_obj;for(t.push(r),r.start1=parseInt(a[1],10),""===a[2]?(r.start1--,r.length1=1):"0"==a[2]?r.length1=0:(r.start1--,r.length1=parseInt(a[2],10)),r.start2=parseInt(a[3],10),""===a[4]?(r.start2--,r.length2=1):"0"==a[4]?r.length2=0:(r.start2--,r.length2=parseInt(a[4],10)),i++;i<n.length;){var o=n[i].charAt(0);try{var p=decodeURI(n[i].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+p)}if("-"==o)r.diffs.push(new diff_match_patch.Diff(DIFF_DELETE,p));else if("+"==o)r.diffs.push(new diff_match_patch.Diff(DIFF_INSERT,p));else if(" "==o)r.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,p));else if("@"==o)break;else if(""===o);else throw new Error("Invalid patch mode \""+o+"\" in: "+p);i++}}return t},diff_match_patch.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},diff_match_patch.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var n=["@@ -"+e+" +"+t+" @@\n"],i=0,s;i<this.diffs.length;i++){switch(this.diffs[i][0]){case DIFF_INSERT:s="+";break;case DIFF_DELETE:s="-";break;case DIFF_EQUAL:s=" ";}n[i+1]=s+encodeURI(this.diffs[i][1])+"\n"}return n.join("").replace(/%20/g," ")},this.diff_match_patch=diff_match_patch,this.DIFF_DELETE=DIFF_DELETE,this.DIFF_INSERT=DIFF_INSERT,this.DIFF_EQUAL=DIFF_EQUAL,define("scripts/diff/diffMatch.js",function(){});const requirejs=require,monacoVersion="0.18.1",defaultPaths={vsLoader:"./scripts/"+monacoVersion+"/dev/vs/loader.js",vsSource:"./scripts/"+monacoVersion+"/dev/vs",tsCompiler:"./scripts/tscompiler/3.6.3/typescript.min.js",monacoBase:"./scripts/"+monacoVersion+"/dev/",monacoWorker:"./vs/base/worker/workerMain.js",linter:"./scripts/eslint/eslint.js",app:"./app.js"};"function"==typeof Array.prototype.include&&(Array.prototype.include=void 0);function newMonacoInitializer(){function e(t){let n=document.getElementById(t);return n?void n.classList.add("sn_original_editor"):void setTimeout(e,100,t)}function t(){requirejs(["scripts/newMonaco"],t=>{i.fields.forEach(n=>{if(n.isEditorInitialized)return;if(!(n.canRead||n.canWrite))return void(n.isEditorInitialized=!0);let i=document.getElementById(n.ref);if(i&&0===i.offsetWidth&&0==i.offsetHeight)return;let s=document.getElementById("monaco_"+n.ref),a="element."+n.ref;if(!s){let e=document.getElementById("element."+n.ref);if(!e)return;let t=document.createElement("fieldset"),i=document.createElement("legend");i.textContent=n.name,t.appendChild(i),s=document.createElement("div"),s.classList.add("sn_monaco_editor"),s.setAttribute("file-name",n.fileName),s.setAttribute("id","monaco_"+n.ref),i.appendChild(s),a=n.ref,e.insertBefore(t,e.firstChild)}n.isEditorInitialized=!0;let o;o="jsx"===n.internalType||"tsx"===n.internalType?new t.MonacoJSXEditor(s,n):new t.MonacoEditor(s,n),r.set(n.name,o),e(a)})})}function n(e){let t=e.split("."),n="";if(1>t.length)return null;n=t[t.length-1];const s=i.fieldMap.get(n);return r.get(s.name)}let i=window.snMonacoConfig;i||(i={});const s=i&&i.paths;let a=defaultPaths;i.paths&&(a=i.paths);let r=new Map;i.fieldMap=new Map;let o="";return i.customDeclaration&&(o+=i.customDeclaration+"\n"),Array.isArray(i.fields)&&i.fields.forEach(e=>{e.customDeclaration&&(o+=e.customDeclaration+"\n"),i.fieldMap.set(e.name,e)}),{initialize:function(){let e=new Map,n=["node_modules/@types/react/global.d.ts","node_modules/@types/prop-types/index.d.ts","node_modules/@types/react/index.d.ts","node_modules/csstype/index.d.ts"];requirejs.config({urlArgs:"sysparm_substitute=false",paths:{vs:a.vsSource},ignoreDuplicateModules:["vs/basic-languages/typescript/typescript","vs/editor/editor.main"]});s&&(window.MonacoEnvironment={getWorkerUrl:function(){var e="self.MonacoEnvironment = {";return e+="baseUrl: '"+a.monacoBase+"'",e+="}\nimportScripts('"+a.monacoWorker+"')","data:text/javascript;charset=utf-8,"+encodeURIComponent(e)}}),requirejs(["vs/editor/editor.main"],()=>{requirejs(["vs/language/typescript/tsWorker"],()=>{define("typescript",["require"],()=>window.ts),requirejs(["scripts/SIDeclEmittor"],s=>{function a(){if("undefined"==typeof monaco)return void window.setTimeout(a,1e3);let r=s.getCompilerOptions(!0);monaco.languages.typescript.typescriptDefaults.setCompilerOptions(r),s.initializeTypeDeclarations(i.appScope+".jeffa").then(()=>{t()}),n.forEach(t=>{const n=t.replace("node_modules","https://www.unpkg.com/");fetch(n).then(e=>e.text()).then(n=>{e.set(t,n),monaco.languages.typescript.typescriptDefaults.addExtraLib(n,t)})}),0<o.length&&monaco.languages.typescript.typescriptDefaults.addExtraLib(o),console.log("monaco is ready")}"undefined"!=typeof CustomEvent&&"undefined"!=typeof CustomEvent.observe&&(CustomEvent.observe("tabs.disable",function(){t()}),CustomEvent.observe("element_script_display_true",function(){t()}),CustomEvent.observe("tab.activated",function(){t()})),a()})})})},getValue:function(e){let t=n(e);return t.getValue().value},getConfig:function(){return i}}}let monacoProvider;function CodeMirrorNoScriptTextAreaElementForOthers(e){this.name=e,this.textEl=document.getElementById(e)}CodeMirrorNoScriptTextAreaElementForOthers.prototype.initialize=function(e){this.name=e},CodeMirrorNoScriptTextAreaElementForOthers.prototype.setReadOnly=function(){},CodeMirrorNoScriptTextAreaElementForOthers.prototype.isDisabled=function(){return!1},CodeMirrorNoScriptTextAreaElementForOthers.prototype.isReadOnly=function(){return!1},CodeMirrorNoScriptTextAreaElementForOthers.prototype.getValue=function(){return this.textEl||(this.textEl=document.getElementById(name)),this.textEl?this.textEl.value:""},CodeMirrorNoScriptTextAreaElementForOthers.prototype.setValue=function(e){this.textEl||(this.textEl=document.getElementById(name)),this.textEl&&(this.textEl.value=e)},CodeMirrorNoScriptTextAreaElementForOthers.prototype.isVisible=function(){return!0},"undefined"==typeof window||window.recordConfig||(window.CodeMirrorNoScriptTextAreaElement=CodeMirrorNoScriptTextAreaElementForOthers),"undefined"==typeof window||window.recordConfig||(monacoProvider=newMonacoInitializer(),monacoProvider.initialize());define("scripts/allElements.js",function(){});