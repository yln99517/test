var __awaiter=this&&this.__awaiter||function(e,t,i,n){function s(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,a){function r(e){try{p(n.next(e))}catch(t){a(t)}}function o(e){try{p(n["throw"](e))}catch(t){a(t)}}function p(e){e.done?i(e.value):s(e.value).then(r,o)}p((n=n.apply(e,t||[])).next())})},__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};function setupMainThread(){const e=window.recordConfig?window.recordConfig.paths:window.snMonacoConfig.paths;require.config({urlArgs:"sysparm_substitute=false",paths:{vs:e.vsSource}}),"function"==typeof Array.prototype.include&&(Array.prototype.include=void 0),window.MonacoEnvironment={getWorkerUrl:function(){return`data:text/javascript;charset=utf-8,${encodeURIComponent(`
			self.MonacoEnvironment = {
			baseUrl: '${e.monacoBase}'
			};
			importScripts('${e.monacoWorker}');`)}`}},requestAnimationFrame(()=>{require(["./main"],({Main:e})=>{e.init()})})}(function(){"undefined"!=typeof window&&setupMainThread()})(),define("codenowUtils",["require","exports"],function(e,t){"use strict";function i(e){return e.host&&e.host.hostType===n.GlideVar?e.host.name:e.name}Object.defineProperty(t,"__esModule",{value:!0});t.CodeNowUtils=class{static snFetch(e,t,i=!0){return __awaiter(this,void 0,void 0,function*(){t||(t={});const n=t.headers||{"Content-Type":"application/json",accept:"application/json"};return n["X-UserToken"]=window.g_ck,t.headers=n,i?yield(yield fetch(e,t)).json():yield fetch(e,t)})}};var n;(function(e){e.Collection="collection",e.Reference="reference",e.Choice="choice",e.string="string",e.type_boolean="boolean",e.DocumentID="document_id",e.SourceID="source_id",e.PhoneNumber="phone_number_e164",e.GlideVar="glide_var"})(n=t.FieldType||(t.FieldType={})),t.getFieldNameFromMonacoField=i}),define("constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e.javascript="javascript",e.typescript="typescript"})(i=t.LangType||(t.LangType={})),t.GLOBAL_SOCPE="global",t.JAVA_GLOBAL_API="JavaGlobalAPI.d.ts",t.JAVA_SCOPE_API="JavaScopeAPI.d.ts",t.TABLE_API="TableAPI.d.ts",t.JS_API="JSAPI.d.ts",t.TYPE_DEFS="sn_typedef.d.ts",t.CURRENT_API="CurrentAPI.d.ts",t.libES5Path="vs/language/typescript/lib/lib-ts",t.libES6Path="vs/language/typescript/lib/lib-es6-ts",t.TS_DECLARATION="ts_definition",t.DECLARATION_DATA_PATH="../metadata/snapi.json",t.DECLARATION_TABLE_PATH="/api/now/table/ts_definition",t.FIELD_DECLARATION="typedeclaration",t.FIELD_SOURCEMAP="typesourcemap",t.FIELD_TS_SCRIPT="tsscript",t.FIELD_SCRIPT="script",t.EL_TS_EDITOR="ts_editor",t.EL_JS_EDITOR="js_editor",t.EL_TS_DECL="ts_decl",t.EL_TS_SOURCEMAP="ts_sourcemap",t.EL_THEME_SELECT="themeselect",t.EL_SCOPE_SELECT="scope-select",t.EL_SCRIPT_RUNNER="script-runner",t.EL_SCRIPT_OUTPUT="script-output";var n;(function(e){e.sys_script_include="sys_script_include",e.ts_definition="ts_definitions"})(n=t.TableNames||(t.TableNames={})),t.emojis=["\uD83D\uDE00","\uD83D\uDE01","\uD83D\uDE02","\uD83D\uDE03","\uD83D\uDE04","\uD83D\uDE05","\uD83D\uDE06","\uD83D\uDE07","\uD83D\uDE08","\uD83D\uDE09","\uD83D\uDE0A","\uD83D\uDE0B","\uD83D\uDE0C","\uD83D\uDE0D","\uD83D\uDE0E","\uD83D\uDE0F","\uD83D\uDE10","\uD83D\uDE11","\uD83D\uDE12","\uD83D\uDE13","\uD83D\uDE14","\uD83D\uDE15","\uD83D\uDE16","\uD83D\uDE17","\uD83D\uDE18","\uD83D\uDE19","\uD83D\uDE1A","\uD83D\uDE1B","\uD83D\uDE1C","\uD83D\uDE1D","\uD83D\uDE1E","\uD83D\uDE1F","\uD83D\uDE20","\uD83D\uDE21","\uD83D\uDE22","\uD83D\uDE23","\uD83D\uDE24","\uD83D\uDE25","\uD83D\uDE26","\uD83D\uDE27","\uD83D\uDE28","\uD83D\uDE29","\uD83D\uDE2A","\uD83D\uDE2B","\uD83D\uDE2C","\uD83D\uDE2D","\uD83D\uDE2E","\uD83D\uDE2F","\uD83D\uDE30","\uD83D\uDE31","\uD83D\uDE32","\uD83D\uDE33","\uD83D\uDE34","\uD83D\uDE35","\uD83D\uDE36","\uD83D\uDE37","\uD83D\uDE41","\uD83D\uDE42","\uD83D\uDE43","\uD83D\uDE44","\uD83E\uDD10","\uD83E\uDD11","\uD83E\uDD12","\uD83E\uDD13","\uD83E\uDD14","\uD83E\uDD15","\uD83E\uDD20","\uD83E\uDD21","\uD83E\uDD22","\uD83E\uDD23","\uD83E\uDD24","\uD83E\uDD25","\uD83E\uDD27","\uD83E\uDD28","\uD83E\uDD29","\uD83E\uDD2A","\uD83E\uDD2B","\uD83E\uDD2C","\uD83E\uDD2D","\uD83E\uDD2E","\uD83E\uDD2F","\uD83E\uDDD0"],t.SAMPLE_TS_CONTENT=`// This is a sample typescript SI
  class Point {
	  constructor(public x = 0, public y = 0) {
		  this.initialize(x, y);
	  }
	  initialize(x = 0, y = 0) {
		  this.x = x;
		  this.y = y;
	  }
  }`,t.SAMPLE_JS_CONTENT=`// This is a sample ES6 class style SI
  class Point {
	  constructor(x = 0, y = 0) {
		  this.x = x;
		  this.y = y;
	  }
	  initialize(x = 0, y = 0) {
		  this.x = x;
		  this.y = y;
	  }
  }`,t.SAMPLE_STANDARD_SI_CONTENT=`// This is standard SI
  var Point = Class.create();
  Point.prototype = {
	  /**
	   * @type {number}
	   */
	  x: null,
	  /**
	   * @type {number}
	   */
	  y: null,
	  /**
	   * @param {number=} x
	   * @param {number=} y
	   */
	  initialize: function (x, y) {
		  if (void 0 === x)
			  x = 0;
		  if (void 0 === y)
			  y = 0;
		  this.x = x;
		  this.y = y;
	  },
	  type: 'Point'
  };`,t.SAMPLE_SEISMIC_CONTENT=`(function () {
	let createElement = window.snComponentServices.createElement;
	let Fragment = window.snComponentServices.Fragment;
	const getProperties = () => {
		return {
			age: {
				default: 38
			},
			gender: {
				default: 'male'
			},
			area1: {
				default: {
					pin: '',
					street: {
						line: '',
						road: ''
					}
				},
				reflect: true
			},
			salary: {
				computed() {
					return 0;
				}
			},
			users: {
				unstableParse: true
			},
			name: {
				default: 'Fred',
				readonly: true
			}
		};
	};
	const getInitialState = () => {
		return {
			firstName: 'lakshmi',
			lastName: 'narayana',
			age: 38
		};
	};
	type State = ReturnType<typeof getInitialState> & {
		properties: ComponentPropType<ReturnType<typeof getProperties>>
	};
	let componentTempate = window.snComponentServices.getDefaultTemplate();
	componentTempate.view = (state: State, dispatch: Dispatch<State>) => {
		return (<div attrs={{ firstName: 'lakshmi', lastName: 'narayana' }} style={{ color: 'red' }} hook-insert={() => {
			console.log('element mounted');
		}} hook-update={() => {
			console.log('element updated');
		}}> {state.firstName} - {state.lastName}
			<button on-click={() => {
				//dispatch.updateState({ age: ++state.age });
				dispatch.updateState({ path: 'age', value: ++state.age, operation: 'set' });
			}}>increment</button>
			<span>{state.age}</span>
			<button on-click={() => {
				dispatch.updateState({ age: --state.age });
			}}>decrement</button>
		</div>);
	};
	componentTempate.initialState = getInitialState();
	componentTempate.properties = getProperties();
	componentTempate.eventHandlers = [];
	window.snComponentServices.registerComponent('yln-test', componentTempate);
})();`,t.snippets=[{label:"doc",doc:"Documentation Header ",text:"/**\r \n* Description: $0\r \n* Parameters: \r \n* Returns:\r\n*/\r "},{label:"for",doc:"Standard loop for arrays",text:"for (var i=0; i< myArray.length; i++) {\r\n //myArray[i];\r \n}\r\n\r "},{label:"vargror",doc:"Example GlideRecord Or Query",text:"var gr = new GlideRecord('${1:tableName}');\r \nvar qc = gr.addQuery('${2:columnName}', 'value1');\r \nqc.addOrCondition('${0:columnName}', 'value2');\r\ngr.query();\r \nwhile (gr.next()) {\r\n\r \n}\r\n\r "},{label:"info",doc:"",text:"gs.addInfoMessage(gs.getMessage(\"$0\"));"},{label:"method",doc:"Standard JavaScript Class Method",text:"/*_________________________________________________________________\r\n   * Description:\r\n   * Parameters:\r\n   * Returns:\r\n   ________________________________________________________________*/\r\n   $0: function() {\r\n   \r\n   },\r\n"},{label:"vargr",doc:"A common pattern of creating and querying a GlideRecord",text:"var gr = new GlideRecord(\"$0\");\r\ngr.addQuery(\"name\", \"value\");\r\ngr.query();\r\nif (gr.next()) {\r\n   \r\n}\r\n"}],t.scopes={"3ad18693db92220004997878f0b8f516":{sysId:"3ad18693db92220004997878f0b8f516",displayValue:"Benchmark Client",value:"sn_bm_client"},"1bc6c2d3db92220004997878f0b8f571":{sysId:"1bc6c2d3db92220004997878f0b8f571",displayValue:"Benchmark Common",value:"sn_bm_common"},de0be0e15bb00300514d484c11f91a4b:{sysId:"de0be0e15bb00300514d484c11f91a4b",displayValue:"Benchmarks Spoke",value:"sn_bm_spoke"},"18351d53eb32120034d1eeea1206fe79":{sysId:"18351d53eb32120034d1eeea1206fe79",displayValue:"Change Management - CAB Workbench",value:"sn_change_cab"},cdcf033467020300b410afa00585ef2b:{sysId:"cdcf033467020300b410afa00585ef2b",displayValue:"Change Management - Change Schedule",value:"sn_chg_soc"},"1ae06f355710130034d169202d94f92e":{sysId:"1ae06f355710130034d169202d94f92e",displayValue:"Change Management - Color Picker",value:"sn_chg_soc_cp"},f9752f20d7120200b6bddb0c8252032e:{sysId:"f9752f20d7120200b6bddb0c8252032e",displayValue:"Code Search",value:"sn_codesearch"},"116703c19f200300af7196fcc67fcf17":{sysId:"116703c19f200300af7196fcc67fcf17",displayValue:"Connect Spoke",value:"sn_connect_ah"},"1ae3c8a3c3221200f25d174292d3aea3":{sysId:"1ae3c8a3c3221200f25d174292d3aea3",displayValue:"Delegated Dev User Administration",value:"sn_dd_user_admin"},dc1fcaa2c3032200f7d1ca3adfba8f1a:{sysId:"dc1fcaa2c3032200f7d1ca3adfba8f1a",displayValue:"Enhanced Global Search UI",value:"sn_global_searchui"},"801cef500b312200c438ee6537673a04":{sysId:"801cef500b312200c438ee6537673a04",displayValue:"Flow-Action Designer",value:"sn_flow_designer"},global:{sysId:"global",displayValue:"Global",value:"global"},"5f4ef4ed9f401200b18a7feea57fcfbe":{sysId:"5f4ef4ed9f401200b18a7feea57fcfbe",displayValue:"Guided Setup",value:"sn_guided_setup"},"7f1c13c0731103005e7d234ffff6a7da":{sysId:"7f1c13c0731103005e7d234ffff6a7da",displayValue:"ITSM Spoke",value:"sn_itsm_spoke"},dd9d31505f221200c438ef50ff4666de:{sysId:"dd9d31505f221200c438ef50ff4666de",displayValue:"JavaScript Debugger",value:"sn_jsdebugger"},"2efa4be5db0003004d27b31be0b8f5e9":{sysId:"2efa4be5db0003004d27b31be0b8f5e9",displayValue:"Major Incident Management",value:"sn_major_inc_mgmt"},fae90fb35f6b03006ae6a184ff46667a:{sysId:"fae90fb35f6b03006ae6a184ff46667a",displayValue:"Major workbench components",value:"sn_major_workbench"},b2881e900b3003001e684ac3b6673a93:{sysId:"b2881e900b3003001e684ac3b6673a93",displayValue:"Performance Analytics - Diagnostics",value:"sn_pa_diagnostics"},"1c3f9f936741030032468aaad485efda":{sysId:"1c3f9f936741030032468aaad485efda",displayValue:"Performance Analytics - Enhanced UI",value:"sn_pa_ui"},"9a31657653373200e8960ef5d5dc34d5":{sysId:"9a31657653373200e8960ef5d5dc34d5",displayValue:"Schedule Pages",value:"sn_schedule_pages"},"893ea311d71321004f6a0eca5e6103e6":{sysId:"893ea311d71321004f6a0eca5e6103e6",displayValue:"Scoped App Author",value:"sn_appauthor"},"781f36a96fef21005be8883e6b3ee43d":{sysId:"781f36a96fef21005be8883e6b3ee43d",displayValue:"Scoped App Client",value:"sn_appclient"},"0aa1393093213100ae6e941e867ffb40":{sysId:"0aa1393093213100ae6e941e867ffb40",displayValue:"Scoped App Creator",value:"sn_appcreator"},"6e70d1f5c32302006f333b0ac3d3ae7b":{sysId:"6e70d1f5c32302006f333b0ac3d3ae7b",displayValue:"Service Catalog REST API",value:"sn_sc"},"6c11c4f357201300ff01ac11ac94f982":{sysId:"6c11c4f357201300ff01ac11ac94f982",displayValue:"Service Level Management - Breakdowns",value:"sn_sla_brkdwn"},"67ac5062db10220035417878f0b8f5c4":{sysId:"67ac5062db10220035417878f0b8f5c4",displayValue:"Service Portal Surveys",value:"sn_portal_surveys"},"97515a49134b5200ed373d62f244b04a":{sysId:"97515a49134b5200ed373d62f244b04a",displayValue:"ServiceNow Guided Tour Designer",value:"sn_tourbuilder"},"11722b01473231007f47563dbb9a7154":{sysId:"11722b01473231007f47563dbb9a7154",displayValue:"Social Knowledge",value:"sn_kb_social_qa"},"5d9789f3eb51310007e48c1cf106fe9e":{sysId:"5d9789f3eb51310007e48c1cf106fe9e",displayValue:"Studio",value:"sn_devstudio"},"0fdd6483d72302004f1e82285e61033a":{sysId:"0fdd6483d72302004f1e82285e61033a",displayValue:"Targeted Communications",value:"sn_publications"},"8dfe92d95373030029200ef5d5dc348a":{sysId:"8dfe92d95373030029200ef5d5dc348a",displayValue:"Task Communications Management",value:"sn_comm_management"},"46aa60c2ff10020014ecffffffffffa5":{sysId:"46aa60c2ff10020014ecffffffffffa5",displayValue:"Twilio Driver",value:"sn_twilio_driver"},"9353f56fb33332000abf86d256a8dce9":{sysId:"9353f56fb33332000abf86d256a8dce9",displayValue:"Visual Task Board (VTB) Spoke",value:"sn_vtb_ah"},"0f6ab99a0f36060094f3c09ce1050ee8":{sysId:"0f6ab99a0f36060094f3c09ce1050ee8",displayValue:"[ws] Xplore: Developer Toolkit",value:"global"}}}),define("eslintConfig",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e[e.off=0]="off",e[e.warn=1]="warn",e[e.error=2]="error"})(i=t.ruleSetting||(t.ruleSetting={})),t.eslintConfig={parserOptions:{ecmaVersion:5,sourceType:"script",ecmaFeatures:{}},rules:{"constructor-super":2,"for-direction":2,"getter-return":2,"no-case-declarations":2,"no-class-assign":2,"no-compare-neg-zero":2,"no-cond-assign":2,"no-console":2,"no-const-assign":2,"no-constant-condition":2,"no-control-regex":2,"no-debugger":2,"no-delete-var":2,"no-dupe-args":2,"no-dupe-class-members":2,"no-dupe-keys":2,"no-duplicate-case":2,"no-empty":2,"no-empty-character-class":2,"no-empty-pattern":2,"no-ex-assign":2,"no-extra-boolean-cast":2,"no-extra-semi":2,"no-fallthrough":2,"no-func-assign":2,"no-global-assign":2,"no-inner-declarations":2,"no-invalid-regexp":2,"no-irregular-whitespace":2,"no-mixed-spaces-and-tabs":2,"no-new-symbol":2,"no-obj-calls":2,"no-octal":2,"no-redeclare":2,"no-regex-spaces":2,"no-self-assign":2,"no-sparse-arrays":2,"no-this-before-super":2,"no-unexpected-multiline":2,"no-unreachable":2,"no-unsafe-finally":2,"no-unsafe-negation":2,"no-unused-labels":2,"no-unused-vars":2,"no-useless-escape":2,"require-yield":2,"use-isnan":2,"valid-typeof":2,semi:2,"semi-spacing":2,"semi-style":2,eqeqeq:2,"eol-last":2,"default-case":2,"consistent-return":2,camelcase:2,"no-else-return":2,"no-eq-null":2,"no-eval":2,"no-extend-native":2,"no-extra-bind":2,"no-self-compare":2,"no-unused-expressions":2},env:{browser:!0}}}),define("siParser",["require","exports","eslintConfig","constants"],function(e,t,i,n){"use strict";function s(){let e=/\`(.*?)(\$\$\{[^\{]+(?=\})\})(.*?)\`/g;return e}function a(e,t){var i=f.declare+f.space+f.namespace+f.space+t+f.blockOpen+f.newline;return i+=e+f.newline+f.blockClose,i}function r(e,t){var i=f.interface+f.space+t+f.blockOpen+f.newline;return i+=e,i+=f.newline+f.blockClose,i}function o(e,t,n){function s(e){return!(e.type!=m.ExpressionStatement)&&!(e.expression.type!=m.AssignmentExpression)&&e.expression.left.property&&e.expression.left.property.name==P}var a=p(e,t,n,!1),r=n.split(".");n=r[r.length-1];for(var o=0,l;o<t.body.length;o++)if(l=t.body[o],l.type==m.VariableDeclaration){if(1==l.declarations.length&&l.declarations[0].id.name!=n){t.body[o]=null;continue}for(var d=0;d<l.declarations.length;d++)l.declarations[d].id.name!=n&&(l.declarations[d]=null)}else if(l.type==m.FunctionDeclaration){if(l.id.name!=n){t.body[o]=null;continue}}else if(s(l))l.expression.left.object.name!=n&&(t.body[o]=null);else if(l.type==m.ExpressionStatement&&l.expression&&l.expression.type==m.CallExpression){if(l.expression.callee&&l.expression.callee.object&&"gs"==l.expression.callee.object.name&&"include"==l.expression.callee.property.name){t.body[o]=null;continue}}else if(l.type==m.ExpressionStatement&&l.expression.type==m.AssignmentExpression){if(l.expression.left.type==m.Identifier&&l.expression.left.name==n)continue;if(l.expression.left.type!=m.MemberExpression){t.body[o]=null;continue}if(l.expression.left.object&&l.expression.left.object.name!=n){t.body[o]=null;continue}}}function p(e,t,n,s=!1){function a(e){if(!s)return{fieldType:f.any,paramTypes:{},returnType:f.any};e="/*"+e+"*/";let t=f.any,i=f.any,n;var a={};let r=e.split("\n"),o=r.map(e=>e.trim());if(n=k.parse(o.join("\n")),0<n.length){var p=n[0];for(let e of p.tags){if(!e.type)continue;if(0==e.type.length)continue;let n=e.tag;"param"==n?a[e.name]=e.optional?"?: "+e.type:": "+e.type:"returns"==n||"return"==n?i=e.type:"type"==n&&!!e.type&&(t=e.type)}}return{fieldType:t,paramTypes:a,returnType:i}}function r(e){let t=[];for(let n=0,i;n<e.length;n++){if(i=e[n],i.type!=m.ExpressionStatement)continue;if(!i.expression)continue;if(i.expression.type!=m.AssignmentExpression)continue;if("="!=i.expression.operator)continue;if(!i.expression.left)continue;if(i.expression.left.type!=m.MemberExpression)continue;if(!i.expression.left.object)continue;if(i.expression.left.object.type!=m.ThisExpression)continue;let r={fieldType:f.any,paramTypes:{},returnType:f.any};if(s&&!!i.leadingComments&&0<i.leadingComments.length){let e=i.leadingComments[0].value;r=a(e)}let o="",p=f.any;i.expression.left.property.type==m.Identifier?(o=i.expression.left.property.name,i.expression.right.type==m.Literal&&(p=typeof i.expression.right.value)):i.expression.left.property.type==m.Literal&&(o=i.expression.left.property.value,i.expression.right.type==m.Literal&&(p=typeof i.expression.right.value)),s&&r.fieldType!=f.any&&(p=r.fieldType);let l={name:o,value:p};t.push(l)}return t}var o="",p=new I(e,n),l={getMetaInfo:function(){return p},getSimpleName(){var e=n.split(".");return 0==e.length?"":e[e.length-1]},isSingleFunctionExported:function(e,t,i){return!(e.type!=i||1!=t.body.length)||this.isAnonymousTypeExported(e,t,m.FunctionExpression)},isAnonymousTypeExported:function(e,t,i){var s=n.split("."),a=s[s.length-1];return!(e.type!=m.VariableDeclaration&&e.type!=m.ExpressionStatement||e.type!=m.ExpressionStatement||e.expression.type!=m.AssignmentExpression||e.expression.left.type!=m.Identifier||e.expression.left.name!=a||e.expression.right.type!=i)},anonymousDeclaration:function(t,s,r){var l=r.split("."),d=l[l.length-1],c="";if(t.type==m.VariableDeclaration||t.type==m.ExpressionStatement){if(t.type==m.ExpressionStatement&&t.expression.type==m.AssignmentExpression&&t.expression.left.type==m.Identifier&&t.expression.left.name==d){if(this.isAnonymousTypeExported(t,s,m.CallExpression)){o=d;var u=this.getBaseClassInfo();return c=f.class+f.space+d,u.name&&(c+=f.space+f.extends+f.space+u.name,p.setBaseName(u.name)),c+=f.blockOpen+f.newline,c}if(this.isAnonymousTypeExported(t,s,m.ObjectExpression));else if(this.isAnonymousTypeExported(t,s,m.FunctionExpression)){console.log("anonymous function expression");var g=f.function+f.space+this.getSimpleName();let s=t.expression.right.params;var y=f.functionOpen;for(let e=0;e<s.length;e++)y+=s[e].name+f.colon+f.any,e!=s.length&&(y+=f.comma);return y+=f.functionClose,p=new E(e,n,y),f.function+f.space+this.getSimpleName()+y+f.semicolon}}}else if(this.isSingleFunctionExported(t,s,m.FunctionDeclaration)){let i={fieldType:f.any,paramType:{},returnType:f.any};if(t.leadingComments&&1==t.leadingComments.length){let e=t.leadingComments[0].value;i=a(e),i.paramTypes}for(var g=f.function+f.space+t.id.name,y=f.functionOpen,h=0;h<t.params.length;h++)y+=t.params[h].name,i.paramTypes&&i.paramTypes[t.params[h].name]&&(y+=i.paramTypes[t.params[h].name]),h!=t.params.length-1&&(y+=f.comma);return y+=f.functionClose,!i.returnType||i.returnType==f.any||(y+=f.colon+f.space+i.returnType),p=new E(e,n,y),g+=y,g+=f.semicolon,g}return""},isPrototype:function(e){return!(e.type!=m.ExpressionStatement)&&!(e.expression.type!=m.AssignmentExpression)&&!!e.expression.left.object&&!!(e.expression.left.object&&e.expression.left.object.name==o)&&!!(e.expression.left.property&&e.expression.left.property.name==P)},FunctionDeclaration:function(e){var t=this.getBaseClassInfo();if(!t.name)return o=e.id.name,f.class+f.space+e.id.name+f.space+f.blockOpen},VarialbeDeclarator:function(e){return o=e.id.name,f.class+f.space+e.id.name},getBaseClassInfo:function(){for(var e=0,n;e<t.body.length;e++)if(n=t.body[e],n&&this.isPrototype(n,null)){if(n.expression.right.type==m.ObjectExpression)return{name:void 0,properties:n.expression.right.properties};if(n.expression.right.type==m.CallExpression){var s=n.expression.right.arguments[0],a="";if(s.type==m.Identifier?a=s.name:s.type==m.MemberExpression&&(a=s.object.name+"."+s.property.name),!!a){let e=n.expression.right.arguments,t=[];2<=e.length&&e[1].properties&&(t=e[1].properties);let i=a.split(".");return 1<i.length&&i[1]==f.prototype_1&&(a=i[0]),{name:a,properties:t}}}break}return{}},isObjectDeclaration:function(e){if(!e)return!1;if(e.kind!=v.var)return e.type==m.ExpressionStatement&&e.expression.right&&e.expression.right.type&&e.expression.right.type==m.ObjectExpression;for(var t=0,n;t<e.declarations.length;t++)return n=e.declarations[0],n.init.type==m.ObjectExpression},VariableDeclaration:function(t){var s=t.kind==v.var,a=this.isObjectDeclaration(t);if(t.kind!=v.var&&!a)return void console.log("not defined");if(!s&&a){var o=this.formatObjectExpression(t.expression.right.properties,!0,!1);return o=f.var+f.space+t.expression.left.name+f.colon+f.space+o,o}for(var l=0,d;l<t.declarations.length;l++){if(d=t.declarations[0],d.init.type==m.ObjectExpression){var o=this.formatObjectExpression(d.init.properties,!0,!1);return p=new _(e,n,o),o=f.var+f.space+d.id.name+f.colon+f.space+o,o}var c=this.VarialbeDeclarator(t.declarations[l],t);c+=f.space;var u=this.getBaseClassInfo();return u.name&&(c+=f.extends+f.space+u.name+f.space,p.setBaseName(u.name)),c+=f.blockOpen,c}},ExpressionStatement:function(t,i){var s=t.expression;if(s.type==m.AssignmentExpression){var a=this.isAnonymousTypeExported(t,i,m.ObjectExpression),r=this.isAnonymousTypeExported(t,i,m.FunctionExpression);if(a){var o=this.formatObjectExpression(s.right.properties,!1,!1),l=f.blockOpen+f.newline;return l+=o+f.blockClose,p=new _(e,n,l),""}if(r);return this.MemberExpression(s,t)}},AssignmentExpression:function(){console.log("assignment expression")},FunctionExpression:function(e,t){if(!(e.left.property||e.left.name))return"";let n={};t&&t.leadingComments&&0<t.leadingComments.length&&(n=a(t.leadingComments[0].value));var s="";s=e.left.property?e.left.property.name:e.left.name,s+=f.functionOpen;for(var r=0;r<e.right.params.length;r++){let t=e.right.params[r].name,i=f.any;n.paramTypes&&n.paramTypes[t]?(i=n.paramTypes[t],s+=e.right.params[r].name+i):s+=e.right.params[r].name+f.colon+i,r!=e.right.params.length-1&&(s+=f.comma)}return s+=f.functionClose,n.returnType&&n.returnType!=f.any&&(s+=f.colon+n.returnType),s+=f.semicolon,s},MemberExpression:function(e,t){var i=e.left.object&&e.left.object.name===o,n=e.left.property&&e.left.property.name;let s={};t&&t.leadingComments&&0<t.leadingComments.length&&(s=a(t.leadingComments[0].value));var r="";i&&(r=f.static+f.space);var l=e.right.type==m.FunctionExpression;r+=l?this.FunctionExpression(e,t):n+f.colon;var d=f.any;if(e.right.type==m.Literal){var c=typeof e.right.value;c!=f.function&&(d=c),!s.fieldType||(d=s.fieldType)}else{if(e.right.type==m.ObjectExpression)return s.fieldType?d=s.fieldType:(d=this.formatObjectExpression(e.right.properties),!n&&(r=f.var+f.space+e.left.name+f.colon+f.space),d="{\n"+d+"}"),p.addField(n,d,i,!1),r+d+";\n";if(e.right.type==m.ArrayExpression)d="Array<any>";else{if(e.right.type==m.FunctionExpression){var u=e.right.params,g=f.functionOpen;for(let e=0;e<u.length;e++)g+=u[e].name,!s.paramTypes||!s.paramTypes[u[e].name]||(g+=s.paramTypes[u[e].name]),e!=u.length-1&&(g+=f.comma);return g+=f.functionClose,s.returnType&&s.returnType!=f.any&&(g+=f.colon+s.returnType),p.addField(n,g,!0,!0),console.log("static function found"),r}if(e.right.type==m.NewExpression||e.right.type==m.CallExpression){let e={};t&&t.leadingComments&&0<t.leadingComments.length&&(e=a(t.leadingComments[0].value)),!e.fieldType||(d=e.fieldType)}else console.log("Literal not found")}}return r+=d+f.semicolon,p.addField(n,d,i,!1),r},formatObjectExpression:function(e,t=!1,s=!1){if(!e)return"";for(var o=t?"{\n":"",l=0;l<e.length;l++){var d=e[l],c=d.key.name||d.key.value;let t=c;d.key.name?(o+=c,t=c):(o+=d.key.raw,t=d.key.raw);var u="initialize"==c&&s&&d.value.type==m.FunctionExpression,g="",y=f.any,h=!1,T={},S="",b=f.any;let i;if(d.leadingComments&&0!=d.leadingComments.length&&(i=a(d.leadingComments[0].value),b=i.fieldType,S=i.returnType,T=i.paramTypes),d.value.type==m.NewExpression||d.value.type==m.CallExpression)y=b,o+=f.colon+f.space+b;else if(d.value.type==m.Literal){let e=typeof d.value.value;y=e,o+=f.colon+f.space+e}else if(d.value.type==m.ObjectExpression){if(b==f.any){var C=this.formatObjectExpression(d.value.properties,!0);y=C,o+=f.colon+f.space+C}else y=b,o+=f.colon+f.space+b;}else if(d.value.type==m.FunctionExpression){h=!0;var _=d.value.params;for(let e=0,t;e<_.length;e++)t=_[e].name,g+=t,T[t]&&(g+=T[t]),e!=_.length-1&&(g+=f.comma);if(g=f.functionOpen+g+f.functionClose,(0<S.length&&S!=f.any||!s)&&(s?g+=f.colon+S:(g+=f.arrow,g+=S?S:f.any)),g=D[n+"."+c]||g,s?o+=g:(o+=f.colon+f.space,o+=g),u){p.setConstructor(g);let e=r(d.value.body.body);for(let t of e)p.addField(t.name,t.value,!s,!1)}y=g}else d.value.type==m.ArrayExpression?(o+=f.colon+f.space+"Array<any>",y="Array<any>",b!=f.any&&(y=b)):o+=f.colon+f.space+f.any;s?o+=f.semicolon:l!=e.length-1&&(o+=f.comma),s&&p.addField(t,y,!s,h),o+=f.newline,u&&s&&(o+="\nconstructor",o+=g,o+=";",o+=f.newline)}return t&&(o+=f.blockClose),o},prototypeExpression:function(){var e=this.getBaseClassInfo();return this.formatObjectExpression(e.properties,void 0,!0)}};return l}function l(e,t,n,s,a=!1){var l=n.split("."),d=l[l.length-1],c=s.parse(t,{attachComment:!0}),u=p(e,c,n,a),g="";o(e,c,n);var y=u.isObjectDeclaration(c.body[0]),h=!0,T=!1;let S;for(var b=0,C;b<c.body.length;b++)if(C=c.body[b],C){if("undefined"==typeof u[C.type]){console.log("not defined");continue}var _="";if(h&&(h=!1,_=u.anonymousDeclaration(C,c,n),T=u.isSingleFunctionExported(C,c,m.FunctionDeclaration),_)){g+=_;continue}_=u.isPrototype(C,null)?u.prototypeExpression(C,c):u[C.type](C,c),_&&(g+=_+f.newline)}return S=u.getMetaInfo(),0==g.length?console.log("empty came"):!y&&!T&&(g+=f.blockClose),{strFormat:g,metaInfo:S}}function d(e){var t="";for(var n in e){t+="declare namespace "+n+" {\n";for(var s=e[n],a="",r=0,o;r<s.length;r++)o=s[r],t+=o.declaration,t+="\n";t+="}\n",t+=a+f.newline}return t}function c(e,t,n={},s=!1){let a=[];var r={},o=[],p=[];({})["global.StorageDataSize"]=!0;for(var c=0,u;c<e.length;c++)if(u=new T(e[c]),!n[u.sys_id]&&(u.api_name=u.api_name.trim(),!(0<=g[u.api_name]))){console.log("parsing "+u.api_name);var m="",f=u.api_name.split(".");r[f[0]]||(r[f[0]]=[]);var y=r[f[0]];try{let e=l(u,u.script,u.api_name,t,s||!!u.jsdoc);m=e.strFormat,e.metaInfo.setAccessType(u.access),e.metaInfo.setSysId(u.sys_id),a.push(e.metaInfo),m||(p.push(u.api_name),console.log("Empty declaration => "+u.api_name)),y.push(new A(u.api_name,u.sys_scope.value,m,u.access,u.sys_id))}catch(t){o.push(u.api_name),console.log(" parsing error for => "+u.api_name)}}d(r);var h=new N;for(let i of a)h.addType(i.exportToTS());return{getFormat:function(e=!1){return e?h.exportJSON():h.emit()},getParsingErrors:function(){return o},getEmptyDeclarations:function(){return p}}}Object.defineProperty(t,"__esModule",{value:!0}),i=__importStar(i);var u;(function(e){e.never="never",e["var"]="var",e.fun="fun",e.cls="cls"})(u=t.JSExportedTypes||(t.JSExportedTypes={}));var g;(function(e){e[e["global.Class"]=1]="global.Class",e[e["global.PrototypeServer"]=2]="global.PrototypeServer",e[e["global.CIIdentifier"]=3]="global.CIIdentifier",e[e["global.KBProperty"]=4]="global.KBProperty",e[e["global.KBUtils"]=5]="global.KBUtils",e[e["global.Workflow"]=6]="global.Workflow",e[e["global.StorageDataSize"]=7]="global.StorageDataSize",e[e["global.DevExHelpers"]=8]="global.DevExHelpers"})(g=t.BlockedSI||(t.BlockedSI={}));var m;(function(e){e.VariableDeclaration="VariableDeclaration",e.VariableDeclarator="VariableDeclarator",e.ExpressionStatement="ExpressionStatement",e.AssignmentExpression="AssignmentExpression",e.Literal="Literal",e.Identifier="Identifier",e.FunctionDeclaration="FunctionDeclaration",e.FunctionExpression="FunctionExpression",e.ObjectExpression="ObjectExpression",e.CallExpression="CallExpression",e.MemberExpression="MemberExpression",e.ArrayExpression="ArrayExpression",e.NewExpression="NewExpression",e.ThisExpression="ThisExpression"})(m=t.ExpressionType||(t.ExpressionType={}));var f;(function(e){e.namespace="namespace",e["import"]="import",e["export"]="export",e["class"]="class",e["interface"]="interface",e.space=" ",e.startString="\"",e.endString="\"",e["new"]="new",e.prototype_1="prototype",e.newline="\n",e.tab="\t",e.blockOpen="{",e.blockClose="}",e["static"]="static",e.colon=":",e.semicolon=";",e.any="any",e.boolean="boolean",e.number="number",e.object="object",e.string="string",e.undefined="undefined",e["function"]="function",e.functionOpen="(",e.functionClose=")",e.comma=",",e.dot=".",e["extends"]="extends",e["implements"]="implements",e.constructor="new",e.typeAdd="Constructor",e["var"]="var",e.equal="=",e.declare="declare",e["const"]="const",e.arrow="=>"})(f=t.TokenType||(t.TokenType={}));var y;(function(e){e["public"]="public",e.package_private="package_private"})(y=t.SIAccessType||(t.SIAccessType={}));var h;(function(e){e.read="read",e["protected"]="protected",e.nil=""})(h=t.SISysPolicy||(t.SISysPolicy={}));t.ERROR_MSG=`Errors in the source files, use 'F8' or 'shift + F8' to navigate errors in editor`,t.getDotWalkingRegExp=s;class T{constructor(e,t=!1){this.isNewRecord=t,this.access=y.public,this.active=!1,this.jsdoc=!1,this.api_name="global",this.client_callable=!1,this.description="",this.name="",this.script="",this.script_type="",this.sys_class_name="",this.sys_updated_by="",this.sys_created_on="",this.sys_id="",this.sys_mod_count=0,this.sys_name="",this.sys_package={link:"",value:""},this.sys_policy=h.nil,this.sys_scope={link:"",value:""},this.sys_tags="",this.sys_update_name="",this.sys_created_by="",this.sys_updated_on="",this.tsscript="",this.typedeclaration="",this.typesourcemap="",this.parseReturnType=!0,this.isDirty=!1,this.parseReturnType=!0,!e||(!e.tsscript&&(e.tsscript=e.script),this.copy(e)),0==this.sys_id.length&&(this.sys_id="yln")}canPlaceBreakPoints(){return!this.isNewRecord}isGlobalScope(){return"global"==this.getScopeAndAPIMap().scope}static convertToJSConstructor(e){if(e.isJavascript()){var t=e.tsscript.split("\n"),i=e.getScopeAndAPIMap(),n=t.findIndex(e=>{if(0>e.indexOf("Class.create()"))return!1;let t=e.split(" "),n=t.filter(e=>0<e.trim().length);return 4==n.length&&(n=n.map(e=>e.trim()),"var"==n[0]&&n[1]==i.name&&"="==n[2]&&"Class.create();"==n[3])});-1==n||(T.isClsFound=!0,t[n]=`function ${i.name}() { }`,e.tsscript=e.script=t.join("\n"))}}static getClassConstructorFormat(e){if(e.isTypescript())return e.script;if(window.recordConfig.isES6)return e.script;if(!T.isClsFound)return e.tsscript;var t=e.getScopeAndAPIMap(),i=e.tsscript.split("\n"),n=i.findIndex(e=>!!e.trim().startsWith(`function ${t.name}() { }`));return-1==n?e.tsscript:(i[n]=`var ${t.name} = Class.create();`,i.join("\n"))}getScopeAndAPIMap(){var e=this.api_name.split("."),t=e[0],i=2==e.length?e[1]:"";return{scope:t,name:i}}isTypescriptWithJSStyle(){return!1}isJavascript(){return 0==this.script_type.length||"javascript"==this.script_type||"js"==this.script_type}isTypescript(){return"typescript"==this.script_type||"ts"==this.script_type}updateScriptType(e){if("string"==typeof e&&0!==e.length){const t=e.split(".");2!==t.length||("ts"===t[1]?this.script_type=n.LangType.typescript:this.script_type=n.LangType.javascript)}}containsTemplateExpression(){var e=s();return e.test(this.tsscript)}generateCurrentSIDeclaration(e,t=!1){if(this.isTypescript())return"";var i=this.generateDeclaration(e,t),n=i.getFormat(!0),s=JSON.parse(n),o=this.api_name.split("."),p=o[0],l=o[1],d="\""+l+"\":"+this.api_name+"Constructor",c=r(d,"JSTypes"),u=a(s[p][0].typeFormat+"\n"+s[p][0].aliasFormat,p);return u+"\n"+c}formatCurrentSITSFormat(e){let t=this.api_name.split(".");var i=a(e.tf+"\n\n"+e.af,t[0]);return i}generateDeclaration(e,t=!1){return this.canGenerateDeclaration()||new Error("declaration is not possible"),c([this],e,{},t)}updateTSScript(e){this.tsscript=e}updateScript(e){this.script=e}updateDeclaration(e){this.typedeclaration=e}updateJSDoc(e){this.jsdoc=e}updateSourcemap(e){this.typesourcemap=e}isUpToDate(){return!this.isDirty}setDirtyState(e){this.isDirty=e}canGenerateDeclaration(){if(this.isNew())return console.log("generating declaration without apiname not possible"),!1;if(this.isTypescript())return console.log("generating typescript is automatic"),!1;if(0==this.script.length)return console.log("declaration not possible for empty script"),!1;if(0==this.api_name.length)return!1;var e=this.api_name.split(".");return!(2!=e.length)}isNew(){return"undefined"==typeof window?!("global"!=this.api_name)||0!=this.api_name.length&&0==this.sys_id.length:window.recordConfig.isNewRecord}formatForAddLib(e,t){t=t||e.api.split(".")[0];var i={};i[t]=[e];var n=new F(i);return n.emit(t)}updateAPIName(e){return 0==e.length?console.log("API name should not be empty"):void(this.api_name=e)}updateSysId(e){this.sys_id=e}updateAccessType(e){this.access=e}updateLangType(e){this.script_type=e?e:"javascript"}emitTSDeclaration(e="",t=0){var i=/declare class/gi,n=/declare function/gi,s=/declare enum/gi,a=/declare var/gi,r=/declare const/gi,o=/declare type/gi,p=/declare namespace/gi,l=0<=e.search(i),d=0<=e.search(n),c=0<=e.search(s),g=0<=e.search(a);e=e.replace(i,f.class),e=e.replace(n,f.function),e=e.replace(s,"enum"),e=e.replace(a,"var"),e=e.replace(r,"const"),e=e.replace(o,"type"),e=e.replace(p,"namespace"),e=e.replace("/// <reference types=\"snlib\" />","");var m="",y=this.getScopeAndAPIMap(),h=y.scope,T=y.name||"Point";m=this.isNew()?this.api_name+"_"+T+"":this.api_name.replace(".","_")+"";let S=f.export+f.space+f.import+f.space+T+f.space+f.equal;S+=f.space+h+f.dot+m+f.dot+T+f.semicolon;let C=f.import+f.space+T+f.space+f.equal;C+=f.space+h+f.dot+m+f.dot+T+f.semicolon,C="";var _=f.namespace+f.space+m+f.space+f.blockOpen+f.newline;_+=e+f.newline+f.blockClose+f.newline;var E=new b(T,this.sys_id,_,S,C,this.access,u.cls,0),I={api:T,id:this.sys_id,f:t,tf:_};return b.updateFlags(I,this,u.cls),I}static fromSIRec(e){var t=new T(void 0,!1);for(let i in e)t[i]=e[i].value;t.active="1"==e.active.value,t.jsdoc=window.recordConfig.useTypeChecker;var i=new T(void 0,window.recordConfig.isNewRecord);return i.copy(t),i}copy(e){this.parseReturnType=e.parseReturnType,this.access=e.access,this.active="true"==e.active+"",this.api_name=e.api_name,this.jsdoc="true"==e.jsdoc+"",this.client_callable="true"==e.client_callable+"",this.description=e.description,this.name=e.name,this.script=e.script,this.script_type=!e.script_type?"javascript":e.script_type,this.sys_class_name=e.sys_class_name,this.sys_updated_by=e.sys_updated_by,this.sys_created_on=e.sys_created_on,this.sys_id=e.sys_id,this.sys_mod_count=parseInt(e.sys_mod_count+""),this.sys_name=e.sys_name,this.sys_package=e.sys_package,this.sys_policy=e.sys_policy,this.sys_scope=e.sys_scope,this.sys_tags=e.sys_tags,this.sys_update_name=e.sys_update_name,this.sys_created_by=e.sys_created_by,this.sys_updated_on=e.sys_updated_by,this.sys_updated_on=e.sys_updated_on,this.typedeclaration=!e.typedeclaration?"":e.typedeclaration,this.typesourcemap=!e.typesourcemap?"":e.typesourcemap,this.tsscript=e.tsscript}}t.ClientSIRecordData=T,T.isClsFound=!1;var S;(function(e){e[e["public"]=2]="public",e[e.cls=4]="cls",e[e.fun=8]="fun",e[e.obj=16]="obj",e[e.blocked=32]="blocked",e[e.ts=64]="ts",e[e.jsES6=128]="jsES6"})(S||(S={}));class b{constructor(e,t,i,n,s,a,r,o,p,l){this.api=e,this.id=t,this.tf=i,this.af=n,this.gf=s,this.accessType=a,this.internalType=r,this.f=o,this.td=p,this.sp=l}static expandMinifiedFormat(e,t,i=!1){function n(i){var n=i.f.endsWith(";")?"":";";i.l=i.l||0;var s=`/**
					 * @see http://${t}.${e.api}/${i.l}
					 */
					${i.f}${n}
					`;return s}if(e instanceof b)return e;if(0==e.f&&!i)return null;if(0==e.f)return null;if(i=b.isTypescript(e.f)||b.isES6(e.f),e.df&&!i)if(b.isObject(e.f)){let t="";e.df.forEach(e=>Array.isArray(e)?void console.warn("invalid syntax found"):void(t+=n(e))),e.tf=t}else if((b.isClass(e.f)||this.isFunction(e.f))&&Array.isArray(e.df)&&2==e.df.length){let t=e.df[0],i=e.df[1],s="",a="";t.forEach(e=>{s+=n(e)}),i.forEach(e=>{a+=n(e)}),e.tf=[s,a]}let s=`/** @see http://${t}.${e.api}/1 */
		const ${e.api}: ${e.api}Constructor`,a=`/** @see http://${t}.${e.api}/1 */
		declare const ${e.api}: ${t}.${e.api}Constructor`;if(i)return s=`/** @see http://${t}.${e.api}/1 */
			export import ${e.api} = ${t}.${t}_${e.api}.${e.api}`,a="",e.f|=S.cls,e.af=s,e.gf=a,Array.isArray(e.tf)?e.tf=e.tf[0]:"string"!=typeof e.tf&&(e.tf=""),e;if(b.isObject(e.f))return e.df&&(e.tf=`{
					${e.tf}
				}`),e.tf=`interface ${e.api} ${e.tf}`,e.af=`const ${e.api}: ${e.api}`,e.gf=`declare const ${e.api}: ${t}.${e.api}`,e;if(b.isClass(e.f)||b.isFunction(e.f)){if(!Array.isArray(e.tf))return null;if(b.isClass(e.f)&&2!=e.tf.length)return null;if((b.isClass(e.f)&&!e.sp||b.isFunction(e.f))&&(b.isFunction(e.f)?e.tf=`interface ${e.api}Constructor {
						${e.tf[1]}
					}`:e.tf=`interface ${e.api} {
						${e.tf[0]}
					}
					interface ${e.api}Constructor {
						${e.tf[1]}
					}`),b.isClass(e.f)&&"string"==typeof e.sp){let i=e.sp,n=e.sp.split(".");1==n.length&&(i=`${t}.${e.api}`),e.tf=`interface ${e.api} extends ${i} {
					${e.tf[0]}
				}
				interface ${e.api}Constructor {
					${e.tf[1]}
				}`}return e.af=s,e.gf=a,e}return e.af=s,e.gf=a,e.tf="",e}static expandMinifiedFormat_1(e,t,i=!1){if(e instanceof b)return e;if(0==e.f&&!i)return null;if(0==e.f)return null;i=b.isTypescript(e.f);let n=`const ${e.api}: ${e.api}Constructor`,s=`declare const ${e.api}: ${t}.${e.api}Constructor`;if(i)return n=`export import ${e.api} = ${t}.${t}_${e.api}.${e.api}`,s="",e.f|=S.cls,e.af=n,e.gf=s,Array.isArray(e.tf)?e.tf=e.tf[0]:"string"!=typeof e.tf&&(e.tf=""),e;if(b.isObject(e.f))return e.tf=`interface ${e.api} ${e.tf}`,e.af=`const ${e.api}: ${e.api}`,e.gf=`declare const ${e.api}: ${t}.${e.api}`,e;if(b.isClass(e.f)||b.isFunction(e.f)){if(!Array.isArray(e.tf))return null;if(b.isClass(e.f)&&2!=e.tf.length)return null;if((b.isClass(e.f)&&!e.sp||b.isFunction(e.f))&&(b.isFunction(e.f)?e.tf=`interface ${e.api}Constructor {
						${e.tf[1]}
					}`:e.tf=`interface ${e.api} {
						${e.tf[0]}
					}
					interface ${e.api}Constructor {
						${e.tf[1]}
					}`),b.isClass(e.f)&&"string"==typeof e.sp){let i=e.sp,n=e.sp.split(".");1==n.length&&(i=`${t}.${e.api}`),e.tf=`interface ${e.api} extends ${i} {
					${e.tf[0]}
				}
				interface ${e.api}Constructor {
					${e.tf[1]}
				}`}return e.af=n,e.gf=s,e}return e.af=n,e.gf=s,e.tf="",e}static updateFlags(e,t,i){let n=e.f||0;t.access==y.public&&(n|=S.public),t.isTypescript()&&(n|=S.ts),b.isES6(n)&&(n|=S.ts,n|=S.jsES6),i==u.cls?n|=S.cls:i==u.var?n|=S.obj:i==u.fun&&(n|=S.fun),e.f=n}static updateFlagsMinifiy(e,t,i){let n=e.f||0;t.access==y.public&&(n|=S.public),t.isTypescript()&&(n|=S.ts),i==u.cls?n|=S.cls:i==u.var?n|=S.obj:i==u.fun&&(n|=S.fun),e.f=n}static isTypescript(e){return(e&S.ts)==S.ts}static isES6(e=0){return(e&S.jsES6)===S.jsES6}static isPublic(e){return(e&S.public)==S.public}static isClass(e){return(e&S.cls)==S.cls}static isFunction(e){return(e&S.fun)==S.fun}static isObject(e){return(e&S.obj)==S.obj}static isBlocked(e){return(e&S.blocked)==S.blocked}}t.SITSFormat=b;class C{constructor(e,t,i="",n=""){this.currentSI=e,this.apiName=t,this.accessType=i,this.sysId=n,this.apiName=t.trim(),this.accessType="",this.sysId=""}getJSName(){if(!this.apiName)return{};var e=this.apiName.split("."),t="",i="";return 1==e.length?t=e[0]:2==e.length&&(i=e[0],t=e[1]),{name:t,scopeName:i}}getInternalType(){return u.never}setAccessType(e){this.accessType=e}setSysId(e){this.sysId=e}exportAliasName(e){var t=f.const+f.space+this.getJSName().name+f.space+f.colon+f.space+this.apiName+f.typeAdd+f.semicolon;return e?t:f.declare+f.space+t}}t.TypeData=C;class _ extends C{constructor(e,t,i){super(e,t),this.apiName=t,this.format=i,this.format=i}getTempInterfaceName(){return this.apiName}toInternalFormat(){var e=this.getJSName().name,t=this.getTempInterfaceName(),i=t.split(".");t=i[i.length-1];var n=f.interface+f.space+t+this.format;return n}exportToTS(){var e=new b(this.apiName,this.sysId,this.toInternalFormat(),this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return b.updateFlags(e,this.currentSI,this.getInternalType()),e}getInternalType(){return u.var}exportAliasName(e){var t=this.getJSName(),i=f.const+f.space;return i+=t.name+f.colon+this.getTempInterfaceName()+f.semicolon,e?i:f.declare+f.space+i}}t.TypeVarData=_;class E extends C{constructor(e,t,i,n=!1){super(e,t),this.apiName=t,this.format=i,this.format=i}getTypeFormat(){var e=this.getJSName();return f.function+f.space+e.name+this.format+f.semicolon}exportToTS(){let e=this.getJSName(),t=this.getTypeFormat(),i=new b(this.apiName,this.sysId,"",this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return b.updateFlags(i,this.currentSI,this.getInternalType()),i}getInternalType(){return u.fun}exportAliasName(e){return e?this.getTypeFormat():f.declare+f.space+this.getTypeFormat()}}t.TypeFunctionData=E;class I extends C{constructor(e,t,i="",n=""){super(e,t),this.apiName=t,this.baseName=i,this.constructorFormat=n,this.fields=[],this.baseName=""}setBaseName(e){this.baseName=e}setConstructor(e){this.constructorFormat=e}addField(e,t,i,n){let s=!1;this.fields.every(t=>t.key!=e||t.isStatic!=i||(s=!0,!1));s||this.fields.push({key:e,value:t,isStatic:i,isMemberFunction:n})}getFieldFormat(){for(var e="",t="",n=0;n<this.fields.length;n++){let i=this.fields[n],s=i.key;i.isMemberFunction||(s+=f.colon+f.space),s+=i.value+f.semicolon,s+=f.newline,i.isStatic?t+=s:e+=s}return{staticFields:t,memberFields:e}}getStaticTypeFormat(){var e=this.getJSName(),t=f.interface+f.space+e.name+f.typeAdd+f.space+f.blockOpen+f.newline,i=this.getFieldFormat().staticFields;return this.constructorFormat||(this.constructorFormat=f.functionOpen+f.functionClose),t+=f.new+this.constructorFormat+f.colon+this.getJSName().name+f.semicolon,t+=f.newline+f.prototype_1+f.colon+f.space+e.name+f.semicolon,t+=f.newline+i,t+=f.newline+f.blockClose,t}getMemberTypeFormat(){var e=f.interface+f.space,t=this.getJSName();e+=t.name,this.baseName&&(e+=f.space+f.extends+f.space+this.baseName),e+=f.space+f.blockOpen+f.newline;var i=this.getFieldFormat().memberFields;return e+=i,e=e.trim(),e+=f.newline+f.blockClose,e+=f.newline,e}exportToTS(){var e=this.getMemberTypeFormat()+f.newline+this.getStaticTypeFormat();let t=new b(this.apiName,this.sysId,e,this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return b.updateFlags(t,this.currentSI,this.getInternalType()),t}getInternalType(){return u.cls}exportAliasName(e){if("global.JSON"==this.apiName)return"";var t=f.const+f.space+this.getJSName().name+f.space+f.colon+f.space+this.apiName+f.typeAdd+f.semicolon;return e?t:f.declare+f.space+t}}t.TypeClassData=I;class A{constructor(e,t,i,n,s,a=""){this.apiName=e,this.scope=t,this.declaration=i,this.accessType=n,this.sysId=s,this.aliasFormat=a}}t.TSClassDefinitionFormat=A,t.wrapInNamespace=a,t.wrapInInterface=r;var x={"global.XMLDocument":!0,"global.JSON":!0};class F{constructor(e={},t=!1){this.siJSData=e,this.emitForVSCode=t}emit(e,t={}){let i="",n="",s={};for(let i in this.siJSData)for(let e of this.siJSData[i])if(e.sp){var r=e.sp.split(".");if(1==r.length){s[i]=s[i]||{},s[i][e.sp]=!0;continue}s[r[0]]=s[r[0]]||{},s[r[0]][r[1]]=!0}for(let r in this.siJSData){let o="",p=e==r||this.emitForVSCode,l="",d="";for(let e of this.siJSData[r]){if(!e.f){console.warn("skipping declaration for => "+e.api);continue}if(t[e.id])continue;let i=this.emitForVSCode||b.isPublic(e.f);(p||i||s[r]&&s[r][e.api])&&(o+=e.tf+f.newline),(i||p&&!i)&&"string"==typeof e.af&&0!=e.af.length&&(l+=e.af+f.semicolon+f.newline),p&&!x[r+"."+e.api]&&"string"==typeof e.gf&&(d+=e.gf+f.semicolon+f.newline)}0<l.length&&(o+=f.newline+l.trim()),0<d.length&&(n+=d.trim()+f.newline);let c=a(o,r)+f.newline;i+=c}return i.trim()+f.newline+n.trim()}getSysIdMap(){let e={};for(var t in this.siJSData){let n=this.siJSData[t];for(let t=0;t<n.length;t++)e[n[t].id]=n[t]}return e}}t.DefinitionEmittor=F;class N extends F{constructor(e={}){super(e,!0),this.siJSData=e,this.interfaceFormat={},this.aliasFormat={},this.globalAliasFormat={},this.typeMapFormat={},this.allJSTypes={},this.scopeTypes={}}exportJSON(){return JSON.stringify(this.siJSData)}addType(e){var t=e.api.split("."),i=t[0];this.siJSData[i]=this.siJSData[i]||[],this.siJSData[i].push(e)}emit(){return super.emit("")}}t.DefinitionEmittorForVSCode=N;const v={var:"var"},P="prototype";t.stripPrivateTypes=o,t.getEmittor=p,t.emitDeclarationForScope=d,t.parseSI=c;var k;(function(e){function t(e){var t=0;do if(" "!==e[t])return t;while(++t<e.length);return t}function i(...e){for(var t={},n=Array.prototype.slice.call(arguments),s=0,a=n.length,r,o;s<a;s++)for(r in o=n[s],o)o.hasOwnProperty(r)&&(t[r]=o[r]);return t}function n(e,t){for(var n=e.length,s=!0,a;n--;){for(a in t)t.hasOwnProperty(a)&&(s=t[a]===e[n][a]&&s);if(s)return e[n]}return null}function s(e,t){if("string"!=typeof e||"@"!==e[0])return null;var n=t.reduce(function(e,t){var n;try{n=t(e.source,i({},e.data))}catch(i){e.data.errors=(e.data.errors||[]).concat(t.name+": "+i.message)}return n&&(e.source=e.source.slice(n.source.length),e.data=i(e.data,n.data)),e},{source:e,data:{}}).data;return n.optional=!!n.optional,n.optional&&!!n.type&&(n.type=n.type.substring(0,n.type.length-1)),n.type=void 0===n.type?"":n.type,n.name=void 0===n.name?"":n.name,n.description=void 0===n.description?"":n.description,n}function a(e,t){var i=t.trim?function(e){return e.trim()}:function(e){return e},a=e.map(function(e){return i(e.source)}).join("\n");a=i(a);var r=e[0].number;e=e.reduce(function(e,n){if(n.source=i(n.source),n.source.match(/^\s*@(\w+)/))e.push({source:[n.source],line:n.number});else{var s=e[e.length-1];if(void 0!==t.join&&!1!==t.join&&0!==t.join&&!n.startWithStar&&0<s.source.length){var a;a="string"==typeof t.join?t.join+n.source.replace(/^\s+/,""):"number"==typeof t.join?n.source:" "+n.source.replace(/^\s+/,""),s.source[s.source.length-1]+=a}else s.source.push(n.source)}return e},[{source:[]}]).map(function(e){return e.source=i(e.source.join("\n")),e});var o=e.shift();if(""===o.source&&0===e.length)return null;var p=e.reduce(function(e,i){var a=s(i.source,t.parsers);if(!a)return e;if(a.line=i.line,a.source=i.source,t.dotted_names&&-1!==a.name.indexOf(".")){for(var r=e,o=a.name.split("."),p,l;1<o.length;)p=o.shift(),l=n(r,{tag:a.tag,name:p}),l||(l={tag:a.tag,line:+a.line,name:p,type:"",description:""},r.push(l)),l.tags=l.tags||[],r=l.tags;return a.name=o[0],r.push(a),e}return e.concat(a)},[]);return{tags:p,line:r,description:o.source,source:a}}function r(e){var t=0,n=0,s;return e=i({},{trim:!0,dotted_names:!1,parsers:[o.parse_tag,o.parse_type,o.parse_name,o.parse_description]},e||{}),function(i){var r=i.indexOf("/**"),o=i.indexOf("*/"),p;if(-1!==r&&i.indexOf("/***")!==r&&(s=[],t=r+3),s){var l=t,d=!1,c=i.match(/\S/);0<s.length&&c&&("*"===c[0]?(l=c.index+2,d=!0):c.index<t&&(l=c.index)),s.push({number:n,startWithStar:d,source:i.slice(l,-1===o?i.length:o)}),-1!==o&&(p=a(s,e),s=null,t=0)}return n+=1,p}}var o={parse_tag:function(e){var t=e.match(/^\s*@(\S+)/);if(!t)throw new Error("Invalid `@tag`, missing @ symbol");return{source:t[0],data:{tag:t[1]}}},parse_type:function(e,i){if(i.errors&&i.errors.length)return null;var n=t(e),s="",a=0;if("{"!==e[n])return null;for(;n<e.length&&(a+="{"===e[n]?1:"}"===e[n]?-1:0,s+=e[n],n++,0!==a););if(0!==a)throw new Error("Invalid `{type}`, unpaired curlies");return{source:e.slice(0,n),data:{type:s.slice(1,-1)}}},parse_name:function(e,i){if(i.errors&&i.errors.length)return null;for(var n=t(e),s="",a=0;n<e.length&&(a+="["===e[n]?1:"]"===e[n]?-1:0,s+=e[n],n++,!(0===a&&/\s/.test(e[n]))););if(0!==a)throw new Error("Invalid `name`, unpaired brackets");var r={name:s,optional:!1,default:""};if(/=$/.test(i.type)&&(r.optional=!0),"["===s[0]&&"]"===s[s.length-1]&&(r.optional=!0,s=s.slice(1,-1),-1!==s.indexOf("="))){var o=s.split("=");s=o[0],r.default=o[1].replace(/^(["'])(.+)(\1)$/,"$2")}return r.name=s,{source:e.slice(0,n),data:r}},parse_description:function(e,t){if(t.errors&&t.errors.length)return null;var i=e.match(/^\s+((.|\s)+)?/);return i?{source:i[0],data:{description:void 0===i[1]?"":i[1]}}:null}};e.parse=function(e,t){for(var n=[],s=r(t),a=e.split(/\n/),o=0,p=a.length,l;o<p;o++)l=s(a.shift()),l&&n.push(l);return n}})(k||(k={}));const D={"global.PwdEmailNotificationManager._sendCodeToDevices":"(devices, code, userSysId?: string)","global.OCDHTMLXCalendarFormatter.initialize":"(groupEvents?: any)","global.OCRotationV2.initialize":"(schedulePage, formatter?: any)","global.WorkflowIconsSCR.initialize":"(ref?: any)","global.KnowledgeTypeDefaultsAjax.getValue":"(ge?: any)","global.SchedulePriorityECCJob.initialize":"(label?: any, document?: any, script?: any)","global.ClientTestRunnerBrowserInfo.initialize":"(browserName, version, osName, osVersion?: any)","global.PwdSMSNotificationManager._sendCodeToDevices":"(devices, code, userSysId?: string)","global.KBViewModelSNC.getKnowledgeRecord":"(query?: any, value?: any, stopWorkflow?: any)","global.KBMyKnowledgeSNC.initialize":"(type?: any, windowStart?: any)","global.sc_ic_RequestedItem.initialize":"(_gr, _gs, _workflow?: any)","global.StdChangeUtilsSNC.getValue":"(property?: any)","sn_schedule_pages.CMNScheduleRESTWrapper.getEvents":"(params?: any)","sn_schedule_pages.CMNScheduleRESTWrapper.updateEvent":"(params?: any)","sn_comm_management.CommunicationManagementChannelAbstractSNC.getConfig":"(sourceTable: string)"};var L;(function(e){e[e.typeDefs=0]="typeDefs",e[e.callback=1]="callback"})(L=t.JSDocTypes||(t.JSDocTypes={}));var M;(function(e){function n(e){function t(t,i,n){if("<"!=e[0]&&"("!=e[0])throw"Not a function";for(var s=-1,a=0,r=!1;t<e.length;t++)if(e[t]==i&&(-1==s&&(s=t),a++),e[t]==n&&(a--,0==a)){t++,r=!0;break}return{start:s,length:r?t-s:0}}var i={template:"",paramBody:"",returnType:""},n=t(0,"<",">"),s=0;0!=n.length&&(i.template=e.substr(n.start,n.length),s=1);var a=t(s,"(",")");if(0==a.length)throw"Not a arrow function";i.paramBody=e.substr(a.start,a.length);var r=a.start+a.length,o=e.substr(r).trim();if(0==o.indexOf("=>"))o=o.replace("=>","").trim();else throw"Not a function";return i.returnType=o,i}function a(e,t,i,n){return ts.typeToDisplayParts(e,t,i,n)}function r(e){let t="";for(let i in e){let n=c(e[i],i);0<n.decl.length&&(t+="\n"+n.decl+"\n")}return t}function o(e){O[e]=!0}function p(){O={}}function l(e){w[e]=!0}function d(e){return!!(w[e]||O[e])}function c(e,t){function i(e){var t="";for(var n in e)if("object"==typeof e[n]){let s=i(e[n]);t+="namespace "+n+" {\n"+s+"\n}\n"}else"string"==typeof e[n]&&(t+=e[n]);return t}var n={decl:""};if(!Array.isArray(e))return n;var s={};for(let n=0;n<e.length;n++)for(let i=0,d;i<e[n].length;i++){if(d=e[n][i],!d.name)continue;var a=d.name.split(".");let c="";var r=a.splice(a.length-1,1)[0];let u=d.type.trim();c=u.startsWith("{")?u.endsWith("[]")?`type ${r} = ${u}; \n\n`:"interface "+r+" "+u+"\n\n":`interface ${r} extends ${u} {}\n`,l(t+"."+r);for(var o=s,p=0;p<a.length;p++)o[a[p]]=o[a[p]]||{},"string"==typeof o[a[p]]&&(console.log("module is defined as type overriding the type with modue "),o[a[p]]={}),o=o[a[p]];o[r]=c}var d=i(s);return 0==d.length?n:(d=`declare namespace ${t} {
			${d}
		}`,n.decl=d,n)}function g(e,t="-1"){var n={};for(let s in e){n[s]||(n[s]=[]);for(let a=0;a<e[s].length;a++)Array.isArray(e[s][a].td)&&e[s][a].id!=t&&n[s].push(e[s][a].td)}return n}function m(e){var t=0,n=[],s=0;for(let t=0;t<e.length;t++)if(n.push(e[t]),"punctuation"==e[t].kind){if("{"==e[t].text){s++;continue}if("}"==e[t].text){s--;continue}if(0==s)continue;if(":"!=e[t].text&&"("!=e[t].text&&"<"!=e[t].text)continue;if("<"==e[t].text){if(1>t)continue;if("methodName"!=e[t-1].kind)continue}let i=n.length-2;for(;1<i;){let e=n[i].kind,t=n[i].text;if(("punctuation"!=e||"."!=t)&&"propertyName"!=e&&"localName"!=e&&"methodName"!=e){i++;break}i--}n.splice(i,n.length-i-2)}t=0;var a=n.filter(e=>0<t?(t--,!1):("keyword"==e.kind&&"typeof"==e.text?(t=2,e.text="any"):"functionName"==e.kind&&(e.text="Function"),!0)),r={kind:"type",text:""};return r=a.reduce((e,t)=>(e.text+=t.text,e),{text:"",kind:"type"}),r.text.endsWith("...")?"any":r.text}function f(e,t,s,l){function c(e){return{isOptional:!1,name:e.getName(),documentation:ts.displayPartsToString(e.getDocumentationComment(l)),type:l.typeToString(l.getTypeOfSymbolAtLocation(e,e.valueDeclaration),void 0,ts.TypeFormatFlags.UseFullyQualifiedType)}}function u(e,t=!1){var i=e.getTypeParameters(),n=[];null!=i&&i.forEach(e=>{let t=e.getSymbol();t&&n.push(t.getName())});var s=ts.TypeFormatFlags.UseFullyQualifiedType;s|=ts.TypeFormatFlags.WriteArrayAsGenericType,s|=ts.TypeFormatFlags.NoTruncation;let r="";if(!t){let t=a(l,e.getReturnType(),void 0,s);r=m(t)}var o=ts.displayPartsToString(e.getDocumentationComment(l)),p={line:0,character:0};return 0<o.length&&(p.doc=o),{lineInfo:p,parameters:e.parameters.map(c),returnType:r,documentation:o,typeParams:n}}function g(e){var t=I.getLineAndCharacterOfPosition(e.pos);return t.line+=1,t.character+=1,{line:t.line,character:t.character}}function f(t){function i(){return-1!=t.body.getText().indexOf("return this;")||!e.parseReturnType}function n(e){if(!(ts.isFunctionExpression(e)||ts.isFunctionDeclaration(e))){if(ts.isReturnStatement(e)){if(3!=e.getChildCount())return;let t=e.getChildAt(1);if(ts.isObjectLiteralExpression(t)){let e=h(t),i=new M("temp");i.setKeysType(e);let n=i.toTypeFormat();return void(-1==o.indexOf(n)&&o.push(n))}let i=!1;if(ts.isFunctionExpression(t)&&(i=!0),"this"==t.getText())return void o.push("this");let n=l.getTypeAtLocation(t),s=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,r=a(l,n,void 0,s),p=m(r);return"any"==p||0<=o.indexOf(p)?void 0:void(i?o.unshift(p):o.push(p))}e.forEachChild(n)}}var s=g(t),o=[],p=l.getTypeAtLocation(t).getCallSignatures().map(e=>u(e,i())),r=_(t);if(0<r.length&&(p[0].returnType=r),p[0].lineInfo=s,i()&&(p[0].returnType="this"),p[0].parameters.length>t.parameters.length&&p[0].parameters.splice(p[0].parameters.length-1,1),0<t.parameters.length){let e=0;t.parameters.forEach(t=>{p[0].parameters[e++].isOptional=l.isOptionalParameter(t)})}let d=ts.getJSDocReturnTag(t);var c=p[0].returnType;if("Function"==c||"any"==c)try{n(t.body);var f=o.join("|");"Function"==c&&(p[0].returnType=0<f.length?f:"void")}catch(e){console.log("Return type parsing error "+e)}else if("boolean"==c&&d){let e=ts.getJSDocReturnType(t);if(e){var y=e.getText().split(" ");if(3==y.length&&"is"==y[1]){let i=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,n=a(l,l.getTypeAtLocation(t),void 0,i),s=m(n),r=e.getText();s.endsWith(r)&&(p[0].returnType=r)}}}return p}function y(e){var t=[];let i=e.getChildren(s).find(ts.isBlock);if(!i)return t;let r=i.getChildren().find(e=>e.kind==ts.SyntaxKind.SyntaxList);if(!r)return t;let o=r.getChildren(s).filter(ts.isExpressionStatement);return o.forEach(e=>{let i=g(e),r=e.getChildren(s).find(ts.isBinaryExpression);if(!r)return t;let o=r.getChildren(),p=o.find(ts.isPropertyAccessExpression);if(!p)return t;let d=p.getChildren();if(d[0].kind!=ts.SyntaxKind.ThisKeyword)return t;let c=d[d.length-1],u=c.getText(),f=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,y=o[o.length-1];i=g(y);var h="";if(ts.isNumericLiteral(y))h="number";else if(ts.isStringLiteral(y))h="string";else if(ts.isLiteralTypeNode(y))h="number";else if(ts.SyntaxKind.FalseKeyword==y.kind||ts.SyntaxKind.TrueKeyword==y.kind)h="boolean";else if(ts.SyntaxKind.FirstLiteralToken==y.kind)h="number";else{h=l.typeToString(l.getTypeAtLocation(y),s,0);let e=a(l,l.getTypeAtLocation(y),void 0,ts.TypeFormatFlags.UseFullyQualifiedType),t=m(e);h!=t&&(h=t),"Function"==h&&(h="any")}var T=!1;try{var S=n(h);T=!0,t.push(new P(u,S.paramBody,S.returnType,S.template).setLineInfo(i))}catch(t){}T||t.push(new N(u,h).setLineInfo(i).setLineInfo(i))}),t}function h(e,t=!1){var i={};return e.properties.forEach(e=>{var r=e.name.getText(),o=e.getChildren(),p=o.find(ts.isIdentifier),d=o.find(ts.isFunctionExpression);if(t&&d&&"initialize"==r){let e=y(d);e.forEach(e=>{i[e.name]=e})}let c=o[o.length-1];var u="";let h=ts.isStringLiteral(o[0]),T=g(c);if(ts.isNumericLiteral(c))i[r]=new x(r,"number").setLineInfo(T);else if(ts.isStringLiteral(c))i[r]=new F(r,"string").setLineInfo(T);else if(d){let e=f(d),t=k.create(r,e[0]);i[r]=t}else{let t=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals;u=l.typeToString(l.getTypeAtLocation(c),void 0,t);let o=l.typeToString(l.getTypeAtLocation(e),s,t);u!=o&&(console.log("different types found, overriding default one"),u=o);let p=a(l,l.getTypeAtLocation(e),void 0,t);u=m(p);let d=!1;try{let e=n(u);i[r]=new P(r,e.paramBody,e.returnType,e.template),d=!0}catch(t){}d||(i[r]=new N(r,u))}h&&i[r].setAsElement(),i[r].setLineInfo(T)}),i}function T(e,t,i){var s=g(t);let a=ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.MultilineObjectLiterals,r=l.typeToString(l.getTypeAtLocation(t),void 0,a),o=!1;try{let t=n(r);o=!0,e==A?(w.addConstructorFunction(new P(e,t.paramBody,t.returnType,t.template).setLineInfo(s)),w.setAsFunction()):w.addField(new P(e,t.paramBody,t.returnType,t.template).setLineInfo(s))}catch(t){}o||w.addField(new N(e,r,i).setLineInfo(s))}function S(e){let t;var i=e.getChildren().find(ts.isParenthesizedExpression);if(!i)return t;var n=i.getChildren().find(ts.isFunctionExpression);if(!n)return t;var s=n.getChildren().find(ts.isBlock);if(!s)return t;let a=s.getChildren().find(e=>e.kind==ts.SyntaxKind.SyntaxList);return a}function b(e){var t=[];let i=e.getChildCount();if(!(1<=i&&2>=i))return t;let n=e.getChildAt(0);if(!ts.isCallExpression(n))return t;let s=S(n);return s?s.getChildren():t}function C(e){let t=ts.getJSDocTags(e).filter(ts.isJSDocTypedefTag);t.forEach(e=>{let t=e.getChildren();var i=ts.getNameOfJSDocTypedef(e);if(console.log(i.getText()),3!=t.length)return;let r=t.find(ts.isModuleDeclaration);if(r&&!V[r.getText()]){var p=t[2].getChildren();p.forEach(e=>{let t=l.getTypeAtLocation(e);var i=a(l,t,s,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType);console.log(m(i))})}let d=t[2],c="any",u=d.getText().trim(),g=u;if(!r){let e=l.getSymbolAtLocation(d);if(!e)return;let t=a(l,l.getDeclaredTypeOfSymbol(e),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType);if(c=m(t),"any"==c){let t="",i=l.getDeclaredTypeOfSymbol(e),s=i.getProperties();i.getApparentProperties(),s.forEach(e=>{let i=l.typeToString(l.getTypeOfSymbolAtLocation(e,e.valueDeclaration),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType),s="";try{let e=n(i);s=e.template+e.paramBody+": "+e.returnType}catch(t){}t+=0<s.length?`${e.getEscapedName()}${s},\n`:`${e.getEscapedName()}: ${i},\n`}),c=`{
								${t}
							}`}}else{let e=u.split(".");if(e.shift(),u=e.join("."),1>t[1].getChildCount())return;let i=l.getTypeAtLocation(t[1].getChildren()[1]);var f=a(l,i,void 0,void 0);if(c=m(f),"any"==c){let e="",i=[];try{i=t[1].getChildren()[1].getChildAt(1).getChildren()}catch(t){console.log("typedef parsing error")}i.forEach(t=>{let i=t.getChildren().find(ts.isIdentifier);if(null==i)return;let s=a(l,l.getTypeAtLocation(t),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType),r=m(s),o="";try{let e=n(r);o=`${e.template}${e.paramBody}: ${e.returnType}`}catch(t){}e+=0<o.length?`${i.getText()}${o},\n`:`${i.getText()}: ${r},\n`}),e=`{${e}}`,c=e}}"any"==c?console.warn("typedef came as any "+u):(o(g),w.addTypedefData({type:c,kind:L.typeDefs,name:u}))})}function _(e){var t=ts.getJSDocReturnTag(e);if(!t)return"";var i=ts.getJSDocReturnType(e);return i?d(i.getText())?i.getText():"":""}function E(e,t=!0){C(e);var i=g(e);if(ts.isVariableStatement(e)){let t=e.declarationList.declarations[0],c=t.getChildren(s);if(1==c.length)return void(R=c[0].getText().trim()==A);if(3!=c.length)return;let u=c[0],g=c[2];if(ts.isObjectLiteralExpression(g)&&(B[u.getText().trim()]=g),R)return;if(ts.isIdentifier(u)){if(u.getText().trim()!=A)return;if(ts.isCallExpression(g)){let e=g.getFullText().trim();if("Class.create()"==e)return R=!0,void w.setAsClass();var r=S(g);if(r)r.getChildren(s).forEach(e=>{E(e,!1)});else{let e=l.getTypeAtLocation(g),t=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,s=a(l,e,void 0,t);var o=m(s);if(o.startsWith("{")&&o.endsWith("}"))R=!0,w.addField(new D(A,o).setLineInfo(i)),w.setAsObjectLiteral();else try{n(o)}catch(t){}}}else if(ts.isObjectLiteralExpression(g)){R=!0;let e=h(g),t=new M(A);t.setLineInfo(i),t.setKeysType(e),w.addField(t),w.setAsObjectLiteral()}else if(ts.isFunctionExpression(g)){R=!0,w.setAsFunction();let e=f(g);w.addConstructorFunction(k.create(A,e[0]));let t=y(g);0<t.length&&w.setAsClass(),t.forEach(e=>w.addField(e))}else if(ts.isIdentifier(g)){var p=g.getText().trim();if(!B[p])return;R=!0;let e=h(B[p]),t=new M(A);t.setKeysType(e),w.addField(t),w.setAsObjectLiteral()}else if(ts.isParenthesizedExpression(g)){let e=g.getChildren().filter(ts.isFunctionExpression);if(0!=e.length){R=!0,w.setAsFunction();let t=f(e[0]);w.addConstructorFunction(k.create(A,t[0]))}else{if(1!=s.statements.length)return;let e=g.getChildren().filter(ts.isCallExpression);if(1!=e.length)return;var d=e.find(ts.isCallExpression);if(!d)return;let t=d.getChildren().find(ts.isFunctionExpression);if(!t)return;let i=t.getChildren().find(ts.isBlock);if(!i)return;let n=i.getChildren().find(e=>e.kind==ts.SyntaxKind.SyntaxList);if(!n)return;n.getChildren().forEach(e=>{E(e,!1)})}}}return}if(ts.isExpressionStatement(e)){if(!R){let t=e.getChildren().find(ts.isBinaryExpression);if(!t){let t=e.getChildren();return 2==t.length?ts.isIdentifier(t[0])&&t[1].kind==ts.SyntaxKind.SemicolonToken?void(R=t[0].getText().trim()==A):void 0:void 0}let i=t.getChildren();if(3!=i.length)return;let n=i[2],s=i[0];if(ts.isIdentifier(s))if(s.getText().trim()!=A)ts.isObjectLiteralExpression(n)&&(B[s.getText().trim()]=n);else if(ts.isCallExpression(n)){let e=n.getFullText().trim();"Class.create()"==e&&(R=!0,w.setAsClass())}else if(ts.isObjectLiteralExpression(n)){R=!0;let e=l.getSymbolAtLocation(n),t;e&&(t=ts.displayPartsToString(e.getDocumentationComment(l)));let i=new M(A,t);i.setLineInfo(g(n));let s=h(n);i.setKeysType(s),w.addField(i),w.setAsObjectLiteral()}else if(ts.isFunctionExpression(n)){R=!0;let e=f(n);w.setAsFunction(),w.addConstructorFunction(k.create(s.getText(),e[0]));let t=y(n);0<t.length&&w.setAsClass(),t.forEach(e=>w.addField(e))}else if(ts.isIdentifier(n)){let e=n.getText().trim();if(!B[e])return;R=!0;let t=h(B[e]),i=new M(A);i.setLineInfo(g(n)),i.setKeysType(t),w.setAsObjectLiteral(),w.addField(i)}return}let n=e.getChildren();if(1<=n.length&&2>=n.length&&t&&ts.isCallExpression(n[0])){let t=b(e);t.forEach(e=>{E(e,!1)})}let a=n.find(ts.isBinaryExpression);if(!a)return;let r=a.getChildren();if(3!=r.length)return;ts.isObjectLiteralExpression(r[2])&&(B[r[0].getText().trim()]=r[2]);let o=r.find(ts.isPropertyAccessExpression),p="",d="",c="",u=!1,m;if(o){u=!0;let e=o.getChildren(s).filter(ts.isIdentifier),t=o.getText().trim(),i=t.split(".");if(m=r[r.length-1],i[0]!=A)return;if(ts.isIdentifier(m)&&B[m.getText().trim()]&&(m=B[m.getText().trim()]),p=i.join("."),3<i.length)return}else if(ts.isIdentifier(r[0])&&(ts.isObjectLiteralExpression(r[2])&&(B[r[0].getText()]=r[2]),r[0].getText().trim()==A&&r[1].kind==ts.SyntaxKind.FirstAssignment&&(w.clearAll(),m=r[2],p=A,ts.isCallExpression(m)&&"Class.create()"==m.getText().trim())))return w.clearAll(),void w.setAsClass();if(m&&ts.isIdentifier(m)&&B[m.getText()]&&(m=B[m.getText()]),!m)return;if(i=g(m),ts.isNumericLiteral(m))w.addField(new x(p,"").setLineInfo(i));else if(ts.isStringLiteral(m))w.addField(new F(p,"").setLineInfo(i));else if(ts.isObjectLiteralExpression(m)){let e=h(m,!0),t=new M(p,d);t.setLineInfo(g(m)),t.setKeysType(e),w.addField(t),u||w.setAsObjectLiteral()}else if(ts.isFunctionExpression(m)){let e=f(m);u?w.addField(k.create(p,e[0])):(w.addConstructorFunction(k.create(A,e[0])),w.setAsFunction())}else if(p==A+".prototype"&&ts.isCallExpression(m)){let e=m.getChildren().find(ts.isPropertyAccessExpression);if(e&&"Object.extendsObject"==e.getText()){let e=m.getChildren().find(e=>e.kind==ts.SyntaxKind.SyntaxList),t=e.getChildCount();if(3!=t)return;let n=e.getChildAt(0,s);if(ts.isIdentifier(n)||(n=void 0),n||(n=e.getChildren().find(ts.isPropertyAccessExpression)),!n)return void console.log("unable to find the base class information");w.setAsClass();let a=n.getText();1==a.split(".").length&&(a=v+"."+a),w.setBaseType(a);let r=e.getChildren().find(ts.isObjectLiteralExpression);if(!r){let t=e.getChildren(),i=t[t.length-1];if(ts.isIdentifier(i)){let e=i.getText().trim();r=B[e]}}if(r){let e=h(r,!0),t=new M(p);t.setLineInfo(i),t.setKeysType(e),w.addField(t)}else{let i=ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals;c=l.typeToString(l.getTypeAtLocation(e.getChildAt(t-1)),void 0,i),-1==c.indexOf("typeof")&&T(p,e.getChildAt(t-1),d)}}else{let e=S(m),t=[];e&&(t=e.getChildren(s)),t.forEach(e=>{E(e,!1)});let n=t.filter(ts.isReturnStatement);if(0<n.length){1<n.length&&console.warn("Found multiple return statements in prototype assignment");let e=n[n.length-1].getChildren()[1],t;if(ts.isIdentifier(e))t=B[e.getText()];else if(ts.isObjectLiteralExpression(e))t=e;else if(ts.isCallExpression(e)){let i=e.getChildren();if(4!==i.length)return;let n=i[0];if(!ts.isPropertyAccessExpression(n))return;if("Object.extendsObject"!==n.getText())return;let s=e.getChildren().find(e=>e.kind==ts.SyntaxKind.SyntaxList);if(!s)return;let a=s.getChildren();if(3!=a.length)return;let r=a[0];if(!ts.isPropertyAccessExpression(r))return;let o=a[2];if(!ts.isObjectLiteralExpression(o))return;w.setAsClass();let p=r.getText();1==p.split(".").length&&(p=v+"."+p),w.setBaseType(p),t=o}if(t){let e=h(t,!0),n=new M(p);return n.setLineInfo(i),n.setKeysType(e),void w.addField(n)}}T(p,m,d)}}else T(p,m,"")}else if(ts.isFunctionDeclaration(e)){let t=e.name.getText();if(t!=A)return;R=!0;let i=l.getSymbolAtLocation(e.name),n=l.getTypeOfSymbolAtLocation(i,i.valueDeclaration),s=n.getCallSignatures().map(e=>u(e));var c=_(e);if(0<c.length&&(s[0].returnType=c),0<e.parameters.length){let t=0;e.parameters.forEach(e=>{s[0].parameters[t++].isOptional=l.isOptionalParameter(e)})}w.setAsFunction(),w.addConstructorFunction(k.create(t,s[0]));let r=y(e);0<r.length&&w.setAsClass(),r.forEach(e=>{w.addField(e)});let o=ts.getJSDocAugmentsTag(e);if(!o)return;let p=o.getChildren();if(2!=p.length)return;let d=p[0];if(!d)return;let g=l.getTypeAtLocation(p[1]);if(!g)return;let f=a(l,g,void 0,ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.NoTruncation),h=m(f);0<h.length&&"any"!=h&&w.setBaseType(h)}else ts.isClassDeclaration(e)&&w.setAsES6()}p();var I=s;let A="",v="",O=t.split(".");1==O.length?A=t:(A=O[1],v=O[0]);var w=new j(e,t,"","12345"),R=!1,V={};(function(e){function t(e){if(e){if(ts.isJSDocTypedefTag(e)){var i=ts.getNameOfJSDocTypedef(e);console.log(i.getText());let t=e.getChildren(),s=t.find(ts.isModuleDeclaration);if(!s)return;if(2<=t.length){let e=s.getText();var n=e.split(".");if(2>n.length)return void console.warn("typedef should start with 'sn' namespace");if("sn"!=n[0])return void console.warn("typedef should start with 'sn' namespace");V[e]=!0}}else if(ts.isTypeReferenceNode(e)){var s=e.getFullText();if(!V[s])return;let t=e.typeName.getChildren();if(0==t.length)return void console.log("type children must exists "+e.getFullText());let i=l.getSymbolAtLocation(t[t.length-1]);if(!i)return;var r=a(l,l.getDeclaredTypeOfSymbol(i),void 0,8388608),o=m(r);w.addTypedefData({type:o,kind:L.typeDefs,name:s})}var p=e.getChildren();0<p.length&&p.forEach(e=>t(e))}}t(e)})(s);var B={};for(let n=0,i;s&&n<s.statements.length;n++)i=s.statements[n],E(i);return w}function h(e){e.forEach(e=>{"javaGlobalAPI"==e.name?W=e:"tableAPI"==e.name?z=e:"javaScopedAPI"==e.name?K=e:"jsAPI"==e.name&&(G=e)}),H="string"==typeof W.json_value?JSON.parse(W.json_value).api+"\n\n"+W.customization:W.json_value.api+"\n\n"+W.customization,q="string"==typeof K.json_value?JSON.parse(K.json_value).api+"\n\n"+W.customization:K.json_value.api+"\n\n"+K.customization,Q="string"==typeof z.json_value?JSON.parse(z.json_value).api+"\n\n"+z.customization+"\n\n"+G.customization:z.json_value.api+"\n\n"+z.customization,Y="string"==typeof G.json_value?JSON.parse(G.json_value).api:G.json_value.api}function _(e,t=!1){var i=e.split("."),n=i[0],s=i[1],a="";if(t)return Y[n]?(Y[n].forEach(e=>{var t=e.api.split(".");t[1]!=s&&"string"==typeof e.gf&&(a+=e.gf+";\n")}),a):(console.log("Unable to find the scope falling back to default one "+e),"");let r={};for(let i in Y){let e=Y[i];e.forEach(e=>{if(e.sp){let t=e.sp.split(".");return 1==t.length?(r[i]=r[i]||{},void(r[i][e.sp]=!0)):void(r[t[0]]=r[t[0]]||{},r[t[0]][t[1]]=!0)}})}for(let i in Y){let e=Y[i];a+="declare namespace "+i+" {",e.forEach(e=>{if("string"==typeof e.gf&&(b.isPublic(e.f)||i==n))a+="\n"+e.tf+"\n"+e.af+"\n";else{if(!r[i])return;r[i][e.api]&&(a+="\n"+e.tf+"\n")}}),a+="}\n"}return"global"==n?H+Q+a:q+Q+a}function E(n,s,a){h(s);let o="point.js",p=g(Y,a.sys_id),l=r(p),d,c,u;var m=new eslint.Linter;return{dispose:function(){d&&(d.disposeAll(),d=null),c&&(c=null)},getTypeInfo:function(s,a){s.api_name||(s.api_name="global.point"),u||(u=s.api_name);var r=s.getScopeAndAPIMap();if(!d||u!=s.api_name){let e=0;s.access==y.public&&(e|=S.public),e|=S.cls;let t=new b(s.api_name,s.sys_id,"export class "+r.name+" { prop: number; }","","",s.access,"",e),i=s.formatCurrentSITSFormat(t);var p=n+"\n\n"+_(s.api_name)+"\n\n\n"+_(s.api_name,!0);p+="\n\n"+i+"\n\n"+l+"\n\n"+G.customization+"",d||(d=new U(p)),u!=s.api_name&&(u=s.api_name,d.updateLib(p))}let g={js:"",declaration:"",sourceMap:"",afterDotWalK:"",errorMsg:t.ERROR_MSG,linterErrors:[],tsDeclaration:""};let h=3.7<=parseFloat(ts.versionMajorMinor);if(s.isJavascript()){a.allowJs=!0,a.declaration=h&&self.recordConfig.isES6,a.removeComments=!0,a.noEmitOnError=!0,a.outFile="pointOut.js";let e=s.tsscript;self.recordConfig.isES6&&!self.recordConfig.isFromScriptRunner&&(e+=`\n/// @ts-ignore\n${r.name} = global.__extends(Class.create(), ${r.name});\n`),d.updateSI(e),o="point.js"}else{a.allowJs=!1,a.declaration=!0;let e=s.tsscript;self.recordConfig.isFromScriptRunner||(e+=`\n/// @ts-ignore\n${r.name} = global.__extends(Class.create(), ${r.name});\n`),d.updateTypeScriptSI(e),o="point.ts"}a.noLib=!0,a.types=["snlib"],ts.defaultMaximumTruncationLength=1e4,a.noResolve=!1,a.skipLibCheck=!0,c=ts.createProgram([o],a,d,c);let T=c.emit(c.getSourceFile(o),void 0,void 0,void 0,{before:[e.dotWalkingTransformer]}),C=ts.getPreEmitDiagnostics(c).concat(T.diagnostics);if(C.forEach(e=>{if(e.file){let{line:t,character:i}=e.file.getLineAndCharacterOfPosition(e.start),n=ts.flattenDiagnosticMessageText(e.messageText,"\n");console.log(`${e.file.fileName} (${t+1},${i+1}): ${n}`)}else console.log(`${ts.flattenDiagnosticMessageText(e.messageText,"\n")}`)}),T.emitSkipped)return g;let E=d.getOutFiles();if(s.isTypescript()?(g.js=E["point.js"],g.sourceMap=E["point.js.map"]):(h&&(g.tsDeclaration=E["pointOut.d.ts"]),g.js=E["pointOut.js"],g.sourceMap=E["pointOut.js.map"]),g.afterDotWalK=s.tsscript,g.errorMsg="",s.isTypescript())return g.tsDeclaration=g.declaration=E["point.d.ts"],g;var I;try{I=f(s,s.api_name,c.getSourceFile(o),c.getTypeChecker()),I.sysId=s.sys_id,I.accessType=s.access;let e=I.toMinifiedInterfaceFormat();g.declaration=JSON.stringify(e),g.afterDotWalK=s.tsscript,a.linter&&(g.linterErrors=m.verify(s.tsscript,i.eslintConfig))}catch(t){g.errorMsg=JSON.stringify({error:t+"",id:1})}return g}}}let I;(function(e){e[e.NumericLiteral=0]="NumericLiteral",e[e.StringLiteral=1]="StringLiteral",e[e.StringType=2]="StringType",e[e.FunctionType=3]="FunctionType",e[e.ObjectLiteral=4]="ObjectLiteral",e[e.AnonymouseStringLiteral=5]="AnonymouseStringLiteral"})(I=e.LiteralType||(e.LiteralType={}));class A{constructor(e,t,i,n=!1){this.name=e,this.type=t,this.doc=i,this.isStringPropertyElement=n}setLineInfo(e){return this.lineInfo=e,this}toJSONDecl(){var e={};return e.f=this.toTypeFormat(),this.lineInfo&&(e.l=this.lineInfo.line,this.lineInfo.doc&&(e.d=this.lineInfo.doc)),e}setDoc(e){this.doc=e}setAsElement(){this.isStringPropertyElement=!0}static isNumericType(e){return e instanceof A&&e.type==I.NumericLiteral}static isStringLiteral(e){return e instanceof A&&e.type==I.StringLiteral}static isStringType(e){return e instanceof A}static isParamType(e){return e instanceof v}static isFunctionType(e){return e instanceof A&&e.type==I.FunctionType}static isRawFunctionType(e){return e instanceof P}static isObjectLiteral(e){return e instanceof A&&e.type==I.ObjectLiteral}static isAnonymousStringType(e){return e instanceof A&&e.type==I.AnonymouseStringLiteral}getPropertyName(){if(this.isStringPropertyElement)return this.name;var e=this.name.split(".");return e[e.length-1]}isStatic(){var e=this.name.split(".");return!(2>e.length)&&"prototype"!=e[1]}}e.RawFieldType=A;class x extends A{constructor(e,t){super(e,I.NumericLiteral,t)}toTypeFormat(){return this.getPropertyName()+": number"}}e.NumericLiteralType=x;class F extends A{constructor(e,t){super(e,I.StringLiteral,t)}toTypeFormat(){return this.getPropertyName()+": string"}}e.StringLiteralType=F;class N extends A{constructor(e,t,i){super(e,I.StringType,i),("true"==t||"false"==t)&&(t="boolean"),t=t.replace(/undefined\[\]/g,"Array<any>"),this.rawType=t}toTypeFormat(){return this.getPropertyName()+": "+this.rawType}}e.StringType=N;class v extends N{constructor(e,t,i=!1,n){super(e,t,n),this.isOpt=i}toTypeFormat(){return this.isOpt?this.name+(this.isOpt?"?: ":": ")+this.rawType:"any"==this.rawType?this.name:this.name+": "+this.rawType}}e.ParamInfoType=v;e.AnonymousStringType=class extends N{constructor(e,t){super("",e,t)}toTypeFormat(){return"any"==this.rawType?"":this.rawType}};class P extends N{constructor(e,t,i,n,s){super(e,t,s),this.returnType=i,this.templateBody=n}getParts(){var e="";!this.templateBody||(e=this.templateBody),e+=this.rawType;var t;return this.returnType&&"any"!=this.returnType&&(t=this.returnType),{name:this.getPropertyName(),body:e,returnType:t}}getParamsFormat(){var e=this.getParts();return e.body}getClsFunctionFormat(){var e=this.getParts();return!e.returnType?e.body+": "+e.returnType:e.body}toTypeFormat(){var e="",t=this.getParts();return e=t.name+t.body,!t.returnType||(e+=": "+t.returnType),e}}e.RawFunctionType=P;class k extends A{constructor(e,t){super(e,I.FunctionType,t)}getParts(){var e=this.getPropertyName(),t="";if(Array.isArray(this.typeParams)&&0<this.typeParams.length&&(t="<"+this.typeParams.join(", ")+">"),Array.isArray(this.params)&&0<this.params.length){var i=[];this.params.map(e=>{i.push(e.toTypeFormat())}),t+="("+i.join(",")+")"}else t="()";var n;return this.returnType&&"any"!=this.returnType&&(n=this.returnType),{name:e,body:t,returnType:n}}getParamsFormat(){var e=this.getParts();return e.body}getClsFunctionFormat(){var e=this.getParts();return e.returnType&&(!e.returnType||"any"!=e.returnType)?e.body+": "+e.returnType:e.body}toTypeFormat(){var e=this.getParts();return e.returnType&&(!e.returnType||"any"!=e.returnType)?e.name+e.body+": "+e.returnType:e.name+e.body}addParam(e,t,i=!1,n){Array.isArray(this.params)||(this.params=[]),this.params.push(new v(e,t,i,n))}setReturnType(e,t){this.returnType=e,this.returnDoc=t}setTypeParams(e){Array.isArray(e)&&0<e.length&&(this.typeParams=e)}static create(e,t){var i=new k(e,t.documentation);return t.parameters.forEach(e=>{i.addParam(e.name,e.type,e.isOptional,e.documentation)}),t.lineInfo&&i.setLineInfo(t.lineInfo),i.setReturnType(t.returnType),i.setTypeParams(t.typeParams),i}}e.FunctionType=k;class D extends A{constructor(e,t,i){super(e,I.StringType),this.typeFormat=t}toTypeFormat(){return this.typeFormat}toJSONDecl(){var e=this.toTypeFormat().trim();return e.startsWith("{")&&(e=e.substring(1)),e.endsWith("}")&&(e=e.substr(0,e.length-1)),e=e.trim(),{l:0,f:e}}}e.RawStringObjectLiteralType=D;class M extends A{constructor(e,t){super(e,I.ObjectLiteral,t)}addField(e){this.keys[e.name]=e}setKeysType(e){this.keys=e}getPartsWithLineInfo(){var e=[];for(var t in this.keys){let i={};i.f=this.keys[t].toTypeFormat(),this.keys[t].lineInfo&&(i.l=this.keys[t].lineInfo.line,this.keys[t].lineInfo.doc&&(i.d=this.keys[t].lineInfo.doc)),e.push(i)}return e}getParts(){var e=[];for(var t in this.keys)e.push(this.keys[t].toTypeFormat());return e}toTypeFormat(){var e="{\n",t=this.getParts();return e+=t.join(";\n"),e+="\n}",e}}e.ObjectLiteraltype=M;class j extends C{constructor(e,t,i,n){super(e,t,i,n),this.fields={},this.flags=0,this.isES6=!1}setAsES6(){this.isES6=!0,this.flags|=S.jsES6}getInternalType(){return this.isClass()||this.isSubClass()?u.cls:this.isFunctionType()?u.fun:this.isObjectLiteral()?u.var:u.never}clearAll(){this.fields={}}exportToTS(){var e;return e}addConstructorFunction(e){this.constFun=e}addField(e){var t=e.name.split(".");if(1<t.length&&"prototype"==t[1])this.setAsClass();else if(this.isObjectLiteral()){let t=e.name.split("."),i=this.fields[t[0]];return void(i instanceof M&&2==t.length&&(e.name=t[1],i.addField(e)))}this.fields[e.name]=e}exportAliasName(e){return""}isSubClass(){return!!this.baseName}setBaseType(e){this.baseName=e}setAsFunction(){this.resetState(),this.flags|=S.fun}isFunctionType(){return!!(this.flags&S.fun)}setAsObjectLiteral(){this.resetState(),this.flags|=S.obj}isObjectLiteral(){return!!(this.flags&S.obj)}resetState(){this.flags=0}setAsClass(){this.resetState(),this.flags|=S.cls}isClass(){return!!(this.flags&S.cls)}addTypedefData(e){this.typeDefs||(this.typeDefs=[]),this.typeDefs.push(e)}toMinifiedInterfaceFormat_1(){var e=this.apiName.split("."),t=e[0],i=e[1];let n="",s="";var a=Object.keys(this.fields),r="",o;if(0==this.flags&&1==Object.keys(this.fields).length){this.fields[i]}if(this.isObjectLiteral()){let e="";for(let t in this.fields)this.fields[t]instanceof M?e+=this.fields[t].toTypeFormat():this.fields[t]instanceof D&&(e+=this.fields[t].toTypeFormat());let t={api:i,id:this.sysId,tf:e,f:0};return b.updateFlags(t,this.currentSI,this.getInternalType()),t}if(a.forEach(e=>{let t=this.fields[e],a="";if(e!=i+".prototype")a=t.toTypeFormat()+";\n",t.isStatic()?A.isObjectLiteral(t)?s+=t.getPropertyName()+": "+a:s+=a:A.isObjectLiteral(t)?n+=t.getPropertyName()+": "+a:n+=a;else if(A.isObjectLiteral(t)){a=t.getParts().join(";\n"),0<a.length&&(n+=a+";\n");var p=t.keys.initialize;p&&A.isFunctionType(p)&&(o=p)}else A.isStringType(t)&&(r=t.rawType,"{"==r[0]&&r[r.length-1]||(r=""))}),this.isClass()){var p="new";o=o||this.constFun,p+=o?o.getParamsFormat()+": "+this.apiName:"(): "+this.apiName,s=p+";\nprototype: "+this.apiName+";\n"+s}this.isFunctionType()&&!!this.constFun&&(this.constFun instanceof k?s=this.constFun.getClsFunctionFormat()+";\n"+s:this.constFun instanceof P&&(s=this.constFun.rawType+": "+this.constFun.returnType+";\n"+s)),0<r.length&&(r=r.substring(1),r=r.substr(0,r.length-1),n+="\n"+r);let l=[];l.push(n.trim()),l.push(s.trim());var d={api:i,id:this.sysId,f:0,tf:l};return this.isSubClass()&&(d.sp=this.baseName),!this.typeDefs||(d.td=this.typeDefs),b.updateFlags(d,this.currentSI,this.getInternalType()),d}toMinifiedInterfaceFormat(){var e=this.apiName.split("."),t=e[0],i=e[1];let n="",s="";var a=Object.keys(this.fields),r="",o;if(0==this.flags&&1==Object.keys(this.fields).length){this.fields[i]}if(this.isES6){let e={api:i,id:this.sysId,f:this.flags};return"undefined"!=typeof this.typeDefs&&(e.td=this.typeDefs),e}if(this.isObjectLiteral()){let e="",t=[];for(let i in this.fields)this.fields[i]instanceof M?e+=this.fields[i].toTypeFormat():this.fields[i]instanceof D&&(e+=this.fields[i].toTypeFormat(),t.push(this.fields[i].toJSONDecl()));let n=this.fields[i];if(n.keys)for(let e in n.keys)t.push(n.keys[e].toJSONDecl());let s={api:i,id:this.sysId,df:t,f:0};return b.updateFlags(s,this.currentSI,this.getInternalType()),s}let p=[],l=[];if(a.forEach(e=>{let t=this.fields[e],a="";if(e!=i+".prototype"){a=t.toTypeFormat()+";\n";let e=t.lineInfo;var d={};d.l=e.line,e.doc&&(d.d=e.doc),t.isStatic()?(l.push(d),A.isObjectLiteral(t)?(d.f=t.getPropertyName()+": "+t.toTypeFormat(),s+=t.getPropertyName()+": "+a):(d.f=t.toTypeFormat(),s+=a)):(p.push(d),A.isObjectLiteral(t)?(d.f=t.getPropertyName()+": "+t.toTypeFormat(),n+=t.getPropertyName()+": "+a):(d.f=t.toTypeFormat(),n+=a))}else if(A.isObjectLiteral(t)){p=t.getPartsWithLineInfo(),a=t.getParts().join(";\n"),0<a.length&&(n+=a+";\n");var c=t.keys.initialize;c&&A.isFunctionType(c)&&(o=c)}else A.isStringType(t)&&(r=t.rawType,"{"==r[0]&&r[r.length-1]||(r=""))}),this.isClass()){var d="new";o=o||this.constFun;let e={};l.push(e),o?(d+=o.getParamsFormat()+": "+this.apiName,e.f=d,o.lineInfo&&(e.l=o.lineInfo.line,o.doc&&(e.d=o.doc))):(d+="(): "+this.apiName,e.f=d,e.l=0);let t={};t.f=`prototype: ${this.apiName}`,t.l=0,l.push(t),s=d+";\nprototype: "+this.apiName+";\n"+s}if(this.isFunctionType()&&!!this.constFun){let e={};e.l=0,e.f="",l.push(e),this.constFun instanceof k?(s=this.constFun.getClsFunctionFormat()+";\n"+s,e.f=this.constFun.getClsFunctionFormat()):this.constFun instanceof P&&(s=this.constFun.rawType+": "+this.constFun.returnType+";\n"+s,e.f=this.constFun.rawType+": "+this.constFun.returnType)}0<r.length&&(console.warn("fix this extra user case"),r=r.substring(1),r=r.substr(0,r.length-1),n+="\n"+r);let c=[];c.push(n.trim()),c.push(s.trim());var u={api:i,id:this.sysId,f:0,df:[p,l]};return this.isSubClass()&&(u.sp=this.baseName),!this.typeDefs||(u.td=this.typeDefs),b.updateFlags(u,this.currentSI,this.getInternalType()),u}toInterfaceFormat(){var e=this.apiName.split("."),t=e[0],i=e[1];let n="",s="";var a=Object.keys(this.fields),r="",o;if(0==this.flags&&1==Object.keys(this.fields).length){this.fields[i];console.log("unknown type")}if(this.isObjectLiteral()){let e="interface "+i+" ";for(let t in this.fields)e+=this.fields[t].toTypeFormat();let t="declare const "+i+": "+this.apiName+";",n=new b(this.apiName,this.sysId,e,"const "+i+": "+i+";",t,this.accessType,u.var,0,this.typeDefs);return b.updateFlags(n,this.currentSI,this.getInternalType()),n}if(a.forEach(e=>{let t=this.fields[e],a="";if(e!=i+".prototype")a=t.toTypeFormat()+";\n",t.isStatic()?A.isObjectLiteral(t)?s+=t.getPropertyName()+": "+a:s+=a:n+=a;else if(A.isObjectLiteral(t)){a=t.getParts().join(";\n"),n+=a+";\n";var p=t.keys.initialize;p&&A.isFunctionType(p)&&(o=p)}else A.isStringType(t)&&(r=t.rawType,"{"==r[0]&&r[r.length-1]||(r=""))}),this.isClass()){var p="new";p+=o?o.getParamsFormat()+": "+this.apiName:"(): "+this.apiName,s=p+";\nprototype: "+this.apiName+";\n"+s}this.isFunctionType()&&!!this.constFun&&(this.constFun instanceof k?s=this.constFun.getClsFunctionFormat()+";\n"+s:this.constFun instanceof P&&(s=this.constFun.rawType+": "+this.constFun.returnType+";\n"+s)),0<r.length&&(r=r.substring(1),r=r.substr(0,r.length-1),n+="\n"+r);let l="interface "+i;this.isSubClass()&&(l+=" extends "+this.baseName),n=n.trim(),l+=" {\n"+n+"\n}";let d="interface "+i+"Constructor {\n";s=s.trim(),d+=s+"\n}";let c=l+"\n"+d;var g="declare const "+i+": "+this.apiName+"Constructor;";let m=new b(this.apiName,this.sysId,c,"const "+i+": "+i+"Constructor;",g,this.accessType,u.cls,0,this.typeDefs);return b.updateFlags(m,this.currentSI,this.getInternalType()),m}}e.TSTypeExporter=j,e.generateTypedefDeclFromScopemap=r;var O={};e.addToThisSITypedefMap=o,e.clearThisSITypedefMap=p;var w={};e.addToTypeDefMap=l,e.isTypedefType=d,e.generateTypedefDeclFromScopeName=c,e.generateTypedefDecl=function(e){function t(e){var i="";for(var n in e)if("object"==typeof e[n]){let s=t(e[n]);i+="namespace "+n+" {\n"+s+"\n}\n"}else"string"==typeof e[n]&&(i+=e[n]);return i}if(!Array.isArray(e))return"";var i={};for(let t=0;t<e.length;t++)for(let o=0,p;o<e[t].length;o++){if(p=e[t][o],!p.name)continue;var n=p.name.split(".");let l="interface "+n[n.length-1]+" "+p.type+"\n\n";1<n.length&&n.splice(0,1);for(var s=n.splice(n.length-1,1)[0],a=i,r=0;r<n.length;r++)a[n[r]]=a[n[r]]||{},"string"==typeof a[n[r]]&&(console.log("module is defined as type overriding the type with modue "),a[n[r]]={}),a=a[n[r]];a[s]=l}var o=t(i);return o="declare namespace sn {\n"+o+"}",console.log(o),o},e.getTypeDefsAsScopeMap=g,e.getTypeDefs=function(e,t="-1"){var n=[];for(let s in e)for(let a=0;a<e[s].length;a++)Array.isArray(e[s][a].td)&&e[s][a].id!=t&&n.push(e[s][a].td);return n},e.parseSIWithTypeChecker=f;const R="atypes.ts",V="point.js",B="node_modules/@types/snlib/index.d.ts";class U{constructor(e,t,i){this.snlib=e,this.sourceFiles={},this.outFiles={},this.updateContent(B,this.snlib),t&&this.updateContent(R,t),i&&this.updateContent(V,i)}getOutFiles(){return this.outFiles}disposeAll(){for(let e in this.sourceFiles)ts.disposeEmitNodes(this.sourceFiles[e]),this.sourceFiles[e]=null}updateContent(e,t){this.sourceFiles[e]&&(ts.disposeEmitNodes(this.sourceFiles[e]),this.sourceFiles[e]=null);var i=ts.createSourceFile(e,t,ts.ScriptTarget.ES5,!0,e.endsWith(".ts")?ts.ScriptKind.TS:ts.ScriptKind.JS);this.sourceFiles[e]=i}updateLib(e){this.updateContent(B,e)}updateAnonymousContent(e){this.updateContent(R,e)}updateTypeScriptSI(e){this.updateContent("point.ts",e)}updateSI(e){this.updateContent(V,e)}getTypeInfo(e,t,i="Point"){var n=null;return n=f(e,i,this.sourceFiles[V],t),n}getSourceFile(e){return this.sourceFiles[e]?this.sourceFiles[e]:void 0}writeFile(e,t){this.outFiles[e]=t}getDefaultLibFileName(){return"lib.d.ts"}useCaseSensitiveFileNames(){return!1}getCanonicalFileName(e){return e}getCurrentDirectory(){return""}getNewLine(){return"\r\n"}fileExists(e){return!0}readFile(e){return console.log("read file "+e),""}directoryExists(){return!0}getDirectories(){return[]}}e.MyCompilerHost=U;var J={allowNonTsExtensions:!0,target:1,allowJs:!0,sourceMap:!0,noLib:!0,noErrorTruncation:!0,types:["snlib"],linter:!1},W,K,z,G,H,q,Q,Y;e.dotWalkingTransformer=e=>t=>{function i(t){if(t=ts.visitEachChild(t,i,e),!ts.isTemplateExpression(t))return t;let n=t.getFullText(),a=s(),r=n.match(a);if(!r)return t;if(0==r.length)return t;var o=r[0].split(".");if(1>=o.length)return t;let p=function(e){let t=e.replace(a,(e,t,i,n)=>{var s=i;i.startsWith("$$")&&(i=i.substring(2,i.length)),i.startsWith("{")&&(i=i.substring(1,i.length)),i.endsWith("}")&&(i=i.substr(0,i.length-1));let a=i.split(".");return 1==a.length?s:(a.splice(0,1),t+a.join(".")+n)});return t.trim()}(n);return ts.createStringLiteral(p)}return!t.sourceFiles||(t=t.sourceFiles[0]),ts.visitNode(t,i)},e.initTypeInfoForSingleSI=E,e.generateTypeInfo=function(e,t,i,n){h(i);var s={},a=[],o={};e.forEach(e=>(e instanceof T||(e=new T(e)),"global"==e.sys_scope.value?void a.push(e):void(!o[e.sys_scope.value]&&(o[e.sys_scope.value]=[]),o[e.sys_scope.value].push(e))));var p=[];for(var l in 0<a.length&&p.push(a),o)p.push(o[l]);var d=null,c=[],u=["point.js","atypes.ts"],m=[],f=0,y="global",S;return p.forEach(i=>{i.forEach(i=>{f++;var a=(100*f/e.length).toFixed(2);if(n)try{n({name:i.api_name,percentage:a,sysId:i.sys_id})}catch(e){}i instanceof T||(i=new T(i));var o=i.getScopeAndAPIMap();if("string"!=typeof i.script)return void console.log("skipping: undefined script found for api "+i.api_name);let p=_(i.api_name,!0);if(!d){let e=_(i.api_name),n=g(Y,"-1"),s=r(n);d=new U(t+"\n\n"+e+"\n\n"+s)}if(d.updateAnonymousContent(p),d.updateSI(i.script),o.scope!=y){let e=_(i.api_name);d.updateLib(t+"\n\n"+e),y=o.scope,S=void 0}S=ts.createProgram(u,J,d,S);try{let e=d.getTypeInfo(i,S.getTypeChecker(),i.api_name);e.accessType=i.access,e.sysId=i.sys_id,e&&c.push(e),s[o.scope]||(s[o.scope]=[]);var l=e.toMinifiedInterfaceFormat();if(s[o.scope].push(l),n)try{n({name:i.api_name,percentage:a,sysId:i.sys_id,decl:l})}catch(e){}}catch(t){m.push(i.api_name)}})}),{formatterResult:s,types:c,errors:m,program:S,host:d}}})(M=t.TSChecker||(t.TSChecker={}))}),define("tsCompilerOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={allowNonTsExtensions:!0,module:0,noResolve:!0,suppressOutputPathCheck:!0,skipLibCheck:!0,skipDefaultLibCheck:!0,target:1,noImplicitAny:!1,strict:!1,strictNullChecks:!1,noImplicitThis:!1,noImplicitReturns:!1,experimentalDecorators:!1,noUnusedLocals:!1,noUnusedParameters:!1,declaration:!0,sourceMap:!0,jsx:2,jsxFactory:"createElement",noEmitHelpers:!1,isolatedModules:!1,noEmitOnError:!1,stripInternal:!1,allowJs:!0,checkJs:!1,noFallthroughCasesInSwitch:!1,allowUnreachableCode:!1,linter:!1,inlineSourceMap:!1,inlineSources:!1}}),define("recordWatcher",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e){return"string"==typeof e?(e=e.replace(/\^EQ/g,"").replace(/\^ORDERBY(?:DESC)?[^^]*/g,"").replace(/^GOTO/,""),btoa(e).replace(/=/g,"-")):""}function t(e){return d.getChannel(e)}function i(i,n){var s="/rw/default/"+i+"/"+e(n||"");return d.getChannel(s)}function n(e,t,i="sys_idISNOTEMPTY"){if(e){var n="";return n=t?"sys_id="+t:i,n||(n="sys_idISNOTEMPTY"),r(e,n)}}function s(e,t){if(e)return t=t||"sys_idISNOTEMPTY",r(e,t)}function a(e,t){t&&t.unsubscribe();var i=e.toString();return r("task","sys_idIN"+i)}function r(e,t="sys_idISNOTEMPTY"){return l(e)?(p("Blocked from watching",e),null):(p(">>> init "+e+"?"+t),c=i(e,t),c.subscribe(o),d.connect(),c)}function o(e){var t=e.data,i=e.channel;p(t)}function p(...e){console.log(e.join("s"))}function l(e){return"sys_amb_message"==e||e.startsWith("sys_rw")}let d;if("undefined"==typeof g_ambClient?window.top.g_ambClient&&(d=window.top.g_ambClient):d=g_ambClient,!!d){var c;return{getChannel:t,initTaskList:a,initChannel:r,init:function(e,t,i=""){n(e,t,i)},initList:s,initRecord:function(e,t){n(e,t,"")}}}}}),define("siDeclEmittor",["require","exports","constants","siParser","tsCompilerOptions","recordWatcher"],function(e,t,i,n,s,a){"use strict";var j=Math.max;function r(){return"undefined"!=typeof window}function o(){return!r()}function l(){return!!o()||d()&&window.recordConfig.canWrite}function d(){return!!o()||window.recordConfig.canRead}function c(e){l()&&e&&(G=new K(e),self.yln={dispatcher:G},G.sendMsg({cmd:J.THREAD_INITIALIZED}))}function u(e=!1){var t=window.ylnWorker}function g(t=Object.assign({},b(v().isJavascript()))){if(!l())return Promise.reject("Unable to write Script Include");let i=Object.assign({},Se);if(i.script="",i.typedeclaration="",i.typesourcemap="",!H){let t={cmd:J.UPDATE_LIBS,lib:e("vs/language/typescript/lib/lib").lib_es5_dts,typeDecl:Te,siRecord:i,isScriptRunner:S()};G.sendMsg(t).then(function(){H=!0})}let n={cmd:J.SINGLE_SCRIPT_INCLUDE_REQUEST,siRecord:i,options:t},s=G.sendMsg(n);return u(),s.then(()=>{clearTimeout(Q),Q=-1,q--},()=>{clearTimeout(Q),Q=-1,q--}),q++,s}function m(t){if(!l())return Promise.reject("Unable to write Script Include");var i=e("vs/language/typescript/lib/lib").lib_es5_dts;t.forEach(e=>{Y[e.sys_id]={record:e},e.parseReturnType=!0,"undefined"!=typeof X[e.sys_id]&&(!X[e.sys_id]&&console.log("skipping return type for "+e.api_name),e.parseReturnType=X[e.sys_id])}),u();var n=G.sendMsg({cmd:J.SCRIPT_INCLUDE_REQUEST,typeDecl:Te,lib:i,siRecords:t});return n}function f(){let e=Se.getScopeAndAPIMap().scope;var t=monaco.languages.typescript.typescriptDefaults;(0==w.length||w!=e)&&(0!=w.length&&R.dispose(),R=e==i.GLOBAL_SOCPE?t.addExtraLib(ce,"yln_"+Z+i.JAVA_GLOBAL_API):t.addExtraLib(ue,"yln_"+Z+i.JAVA_SCOPE_API)),w=e}function y(){Z++,f();let e=new n.DefinitionEmittor(he);var t={};Se.isNew()||(t[Se.sys_id]=!0),me=e.emit(Se.getScopeAndAPIMap().scope,t)+O.newline+fe,B&&(B.dispose(),B=null);var s="yln_"+Z+i.JS_API;B=monaco.languages.typescript.typescriptDefaults.addExtraLib(me,s),U&&U.dispose(),U=null;let a=n.TSChecker.getTypeDefsAsScopeMap(he,Se.sys_id),r=n.TSChecker.generateTypedefDeclFromScopemap(a);var o="yln_"+Z+i.TYPE_DEFS;U=monaco.languages.typescript.typescriptDefaults.addExtraLib(r,o),H=!1}function h(e){if(!e)return void y();if(e.id==Se.sys_id)return;if(!e.sc)return void console.warn("scope name not found in record watcher "+JSON.stringify(e));he[e.sc]||(he[e.sc]=[]);let t=-1,s=he[e.sc];for(let n=0;n<s.length;n++)if(s[n].id==e.id){t=n;break}let a=n.SITSFormat.expandMinifiedFormat(e,e.sc,n.SITSFormat.isTypescript(e.f));-1==t?he[e.sc].push(a):"delete"==e.op?he[e.sc].splice(t,1):he[e.sc][t]=a,y()}function T(){return!!window.g_ck}function S(){return!!window.recordConfig&&window.recordConfig.isFromScriptRunner&&"undefined"==typeof g_form}function b(e,t=!1){let i={};if(e){var n=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();return n.target=s.default.target,n.allowJs=s.default.allowJs,n.checkJs=s.default.checkJs,n.strict=s.default.strict,n.jsx=s.default.jsx,n.jsxFactory=s.default.jsxFactory,n.noImplicitAny=s.default.noImplicitAny,n.strictNullChecks=s.default.strictNullChecks,(s.default.target>ae.ES2015||S())&&(n.sourceMap=s.default.sourceMap),n.noImplicitThis=s.default.noImplicitThis,n.noImplicitReturns=s.default.noImplicitReturns,n.noUnusedParameters=s.default.noUnusedParameters,n.noUnusedLocals=s.default.noUnusedLocals,n.noFallthroughCasesInSwitch=s.default.noFallthroughCasesInSwitch,n.linter=s.default.linter,t||(n.declaration=!1),n}return i.jsx=s.default.jsx,i.jsxFactory=s.default.jsxFactory,i.noFallthroughCasesInSwitch=s.default.noFallthroughCasesInSwitch,i.allowUnreachableCode=s.default.allowUnreachableCode,i.module=monaco.languages.typescript.ModuleKind.None,i.noResolve=s.default.noResolve,i.skipLibCheck=s.default.skipLibCheck,i.skipDefaultLibCheck=s.default.skipDefaultLibCheck,i.target=s.default.target,i.noImplicitAny=s.default.noImplicitAny,i.strictNullChecks=s.default.strictNullChecks,i.noImplicitThis=s.default.noImplicitThis,i.noImplicitReturns=s.default.noImplicitReturns,i.experimentalDecorators=s.default.experimentalDecorators,i.noUnusedLocals=s.default.noUnusedLocals,i.noUnusedParameters=s.default.noUnusedParameters,i.declaration=s.default.declaration,i.sourceMap=s.default.sourceMap,i.noEmitHelpers=s.default.noEmitHelpers,i.isolatedModules=s.default.isolatedModules,i.noEmitOnError=s.default.noEmitOnError,i.allowJs=!0,i.strict=s.default.strict,i.stripInternal=s.default.stripInternal,i.linter=s.default.linter,i}function C(){return he}function _(){return v().isGlobalScope()?ce:ue}function E(){return ge}function I(){return me}function A(){return ye}function x(){return _()+O.newline+E()+O.newline+I()+O.newline+A()}function F(){return Te}function N(e,t,s,a){Te=e;var r=i.GLOBAL_SOCPE;if(0!=t.length){var o=t.split(".");r=o[0].trim()}var p={};for(let i of Te)p[i.name]="string"==typeof i.json_value?{api:JSON.parse(i.json_value).api,customization:i.customization}:{api:i.json_value.api,customization:i.customization};for(let i in he||!p.jsAPI||(he=p.jsAPI.api),"string"==typeof he&&(he=JSON.parse(he+"")),he){let e=he[i];e.forEach((e,t,s)=>{if("undefined"!=typeof e.f){let a=n.SITSFormat.expandMinifiedFormat(e,i);a&&(s[t]=a)}})}let l=n.TSChecker.getTypeDefsAsScopeMap(he,s),d=n.TSChecker.generateTypedefDeclFromScopemap(l),c=new n.DefinitionEmittor(he);ce=p.javaGlobalAPI.api+O.newline+p.javaGlobalAPI.customization,ue=p.javaScopedAPI.api+O.newline+p.javaScopedAPI.customization,ge=p.tableAPI.api+O.newline+p.tableAPI.customization,me=c.emit(r,a)+O.newline+p.jsAPI.customization,fe=p.jsAPI.customization;var u=monaco.languages.typescript.typescriptDefaults;(0==w.length||w!=r&&r==i.GLOBAL_SOCPE)&&(0!=w.length&&R.dispose(),R=r==i.GLOBAL_SOCPE?u.addExtraLib(ce,i.JAVA_GLOBAL_API):u.addExtraLib(ue,i.JAVA_SCOPE_API)),w=r,V||(V=u.addExtraLib(ge,i.TABLE_API)),B&&B.dispose(),B=null,B=u.addExtraLib(me,i.JS_API),U&&U.dispose(),U=null,ye=d,0<d.length&&(U=u.addExtraLib(d,i.TYPE_DEFS))}function v(){return Se}function P(){return L()?"module.tsx":Se.isJavascript()?"module.js":"module.ts"}function k(e=!1,t){if(!Se.isTypescript()&&(be&&(be.dispose(),be=null),Se.canGenerateDeclaration()||S()))if(!window.recordConfig.useTypeChecker){var i=Se.generateCurrentSIDeclaration(esprima,e||!!window.recordConfig.jsdoc);be=monaco.languages.typescript.typescriptDefaults.addExtraLib(i,"current.d.ts")}else{if(!t)return;if(0<t.tf.length){let e=Se.formatCurrentSITSFormat(t);be=monaco.languages.typescript.typescriptDefaults.addExtraLib(e,"current.d.ts")}}}function D(){return window.recordConfig?window.recordConfig.libVersions.jsLibState:!!window.snMonacoConfig&&window.snMonacoConfig.libState.jsLibState}function L(){return window.recordConfig&&window.recordConfig.isSeismic}function M(){if(!Ce){Ce=!0;["node_modules/@types/react/global.d.ts","node_modules/@types/prop-types/index.d.ts","node_modules/@types/react/index.d.ts","node_modules/csstype/index.d.ts",`https://cdn.jsdelivr.net/gh/yln99517/yln-monaco@${1.6}/seismic.d.ts`].forEach(e=>{const t=e.replace("node_modules","https://www.unpkg.com/");fetch(t).then(e=>e.text()).then(t=>{monaco.languages.typescript.typescriptDefaults.addExtraLib(t,e)})}),monaco.languages.typescript.typescriptDefaults.addExtraLib(`import * as React from 'react';
	declare module 'react' {
		interface HTMLAttributes<T> extends AriaAttributes, DOMAttributes<T> {
			attrs?: { [key: string]: any }
		}
	}
	`,"react_attr.d.ts")}}Object.defineProperty(t,"__esModule",{value:!0}),i=__importStar(i),n=__importStar(n),s=__importDefault(s),a=__importDefault(a);var O=n.TokenType,w="",R,V,B,U,J;(function(e){e[e.THREAD_INITIALIZED=0]="THREAD_INITIALIZED",e[e.SCRIPT_INCLUDE_REQUEST=1]="SCRIPT_INCLUDE_REQUEST",e[e.SCRIPT_INCLUDE_RESPONSE=2]="SCRIPT_INCLUDE_RESPONSE",e[e.SINGLE_SCRIPT_INCLUDE_REQUEST=3]="SINGLE_SCRIPT_INCLUDE_REQUEST",e[e.SINGLE_SCRIPT_INCLUDE_RESPONSE=4]="SINGLE_SCRIPT_INCLUDE_RESPONSE",e[e.UPDATE_LIBS=5]="UPDATE_LIBS",e[e.PROGRESS_MSG=6]="PROGRESS_MSG"})(J||(J={}));class W{constructor(){}static getInstance(e,t,i){return null==W.instance?(W.instance=new W,W.instance.typeInfo=n.TSChecker.initTypeInfoForSingleSI(e,t,i),W.instance):(e&&t&&(W.instance.typeInfo.dispose(),W.instance.typeInfo=n.TSChecker.initTypeInfoForSingleSI(e,t,i)),W.instance)}handleRequest(e){let t=new n.ClientSIRecordData(e.siRecord);return Se=t,console.log("si reqest parser came"),Se.isNew()&&2>t.api_name.split(".").length&&(t.api_name="global.Point"),this.typeInfo.getTypeInfo(Se,e.options)}}t.SingleSIRequestHandler=W;class K{constructor(e){this.sender=e,this.pendingReplies={},this.seqNumber=0,e.onmessage=this.handleMessage.bind(this)}cancelAllExistingPromises(){for(let e in this.pendingReplies)this.pendingReplies[e].reject("Parser thread is too busy for this operation. Please try again or contact yln99517@gmail.com with your SI"),delete this.pendingReplies[e]}sendReplyMsg(e,t){this.sender.postMessage(Object.assign({seqNum:t},e))}sendMsg(e){var t=this.seqNumber++ +"",i=Object.assign({seqNum:t},e),n=new Promise((e,n)=>{this.pendingReplies[t]={resolve:e,reject:n},this.sender.postMessage(i)});return n}isSIProgressMsg(e){return e.cmd==J.PROGRESS_MSG}isSingleSIRequest(e){return e.cmd==J.SINGLE_SCRIPT_INCLUDE_REQUEST}isSIParserRequest(e){return e.cmd==J.SCRIPT_INCLUDE_REQUEST}isSIParserResp(e){return e.cmd==J.SCRIPT_INCLUDE_RESPONSE}isLibUpdateMsg(e){return e.cmd==J.UPDATE_LIBS}handleMessage(t){var e=t.data,i=this.pendingReplies[e.seqNum];if(i){delete this.pendingReplies[e.seqNum];try{e.errorMsg?i.reject(e.errorMsg):i.resolve(e)}catch(t){console.log("error on resolving thread message "+t)}return}if(this.isSIParserRequest(e)){var s=n.TSChecker.generateTypeInfo(e.siRecords,e.lib,e.typeDecl,e=>{var t={seqNum:"-1",cmd:J.PROGRESS_MSG,name:e.name,sysId:e.sysId,percentage:e.percentage,decl:e.decl};this.sendReplyMsg(t,"-1")}),a={seqNum:e.seqNum,cmd:J.SCRIPT_INCLUDE_RESPONSE,formatterResult:s.formatterResult,types:s.types,errors:s.errors};this.sendReplyMsg(a,e.seqNum)}else if(this.isSingleSIRequest(e)){let t=W.getInstance().handleRequest(e);this.sendReplyMsg(t,e.seqNum)}else this.isLibUpdateMsg(e)?(W.getInstance(e.lib,e.typeDecl,e.siRecord),self.recordConfig.isFromScriptRunner=e.isScriptRunner,this.sendReplyMsg({replayMsg:"thank you",cmd:J.SINGLE_SCRIPT_INCLUDE_RESPONSE},e.seqNum)):e.cmd==J.THREAD_INITIALIZED?z=!0:this.isSIProgressMsg(e)&&r()&&(u(!0),X[e.sysId]=!!e.decl,!e.decl&&console.log("Parser started for => "+e.name),"function"==typeof window.onSIParserProgressEvent&&window.onSIParserProgressEvent(e.name,e.percentage,e.decl))}}t.isMainThread=r,t.isWorkerThread=o,t.canWriteSI=l,t.canReadSI=d;var z=!1,G;t.onThreadInitialized=c;var H;let q=0,Q=-1;t.generateTypeDeclForSingleRecord=g;t.gotoDefintionService={open:function(){var e=arguments[0];if("string"==typeof arguments[0]&&(e=monaco.Uri.parse(arguments[0])),"code.devsnc.com"===e.authority)return void window.open(arguments[0]);let t=e.authority.split(".");var i=C();if(!i[t[0]])return void console.log("invalid scope name when opening file "+e.authority);var n=i[t[0]].find(e=>e.api==t[1]);if(!n)return void console.log("invalid scope name when opening file "+e.authority);var s=e.path.substr(1),a=`./sys_script_include.do?sys_id=${n.id}&gotoLine=${s}`;return window.open(a),console.log(JSON.stringify(arguments)),{catch:function(){console.log("eror callback")}}}};var Y={},X={};t.generateTypeDeclarations=m,t.scopeUpdated=f;var Z=0;t.apiDeclarationUpdated=y,t.siUpdated=h;var ee;if(r()&&"undefined"!=typeof BroadcastChannel){var te=a.default();if(te){var ie=te.getChannel("/yln/typedef");ie.subscribe(e=>{h(e.data)})}}t.updateSIDeclListeners=function(e){!ee||ee.postMessage(JSON.stringify(e))},t.isServiceNow=T;class ne{constructor(e="",t="",i="",n="",s,a){this.js=e,this.declaration=t,this.sourceMap=i,this.tsScript=n,this.backEndDecl=s,this.linterErrors=a}}t.TranspilerOutput=ne;const se=e=>t=>{function i(t){if(t=ts.visitEachChild(t,i,e),!ts.isTemplateExpression(t))return t;let s=t.getFullText(),a=n.getDotWalkingRegExp(),r=s.match(a);if(!r)return t;if(0==r.length)return t;var o=r[0].split(".");if(1>=o.length)return t;let p=function(e){let t=e.replace(a,(e,t,i,n)=>{var s=i;i=i.replace(/^\$\${/,""),i=i.replace(/\}$/,"");let a=i.split(".");return 1==a.length?s:(a.splice(0,1),t+a.join(".")+n)});return t.trim()}(s);return ts.createStringLiteral(p)}return ts.visitNode(t,i)};t.isScriptRunner=S;var ae;(function(e){e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES2015=2]="ES2015",e[e.ES2016=3]="ES2016",e[e.ES2017=4]="ES2017",e[e.ES2018=5]="ES2018",e[e.ESNext=6]="ESNext",e[e.JSON=100]="JSON",e[e.Latest=6]="Latest"})(ae||(ae={})),t.getCompilerOptions=b;class re{constructor(e,t,i,n=ts.ScriptTarget.ES5){this.sourceContent=e,this.libContent=t,this.snLibContent=i,this.SOURCE_PATH="module.ts",this.LIB_PATH="lib.d.ts",this.SN_LIB_PATH="node_modules/@types/snlib/index.d.ts",this.sourceFileMap={},this.fileMap={},t+="\n\n\n"+x(),this.sourceFileMap[this.LIB_PATH]=ts.createSourceFile(this.LIB_PATH,t,n);let s=Se.isJavascript()?ts.ScriptKind.JS:ts.ScriptKind.TS;Se.isJavascript()&&(this.SOURCE_PATH="module.js");const a=ts.createSourceFile(this.SOURCE_PATH,Se.tsscript,ts.ScriptTarget.ES5,!0,s);this.sourceFileMap[this.SOURCE_PATH]=a;const r=ts.transform(a,[se]),o=r.transformed[0],p=ts.createPrinter();let l=p.printFile(o);ts.disposeEmitNodes(a),r.dispose(),this.sourceFileMap[this.SOURCE_PATH]=a.update(l,{span:{start:0,length:e.length},newLength:l.length})}getFileMap(){return this.fileMap}getSourceFile(e){return this.sourceFileMap[e]}writeFile(e,t){"module.js"==e?this.fileMap.js=t:"module.d.ts"==e?this.fileMap.declaration=t:this.fileMap.sourceMap=t}getDefaultLibFileName(){return"lib.d.ts"}useCaseSensitiveFileNames(){return!1}getCanonicalFileName(e){return e}getCurrentDirectory(){return""}getNewLine(){return"\r\n"}fileExists(e){return!0}readFile(e){return""}directoryExists(){return!0}getDirectories(){return[]}static compile(t=Object.assign({},b(!1)),i=!1){let n=new ne,s=e("vs/language/typescript/lib/lib").lib_es5_dts+"\n\n\n"+x();var a=new re(v().tsscript,s,x());let r=ts.createProgram([i?"module.js":"module.ts"],t,a),o=r.emit(),l=a.getFileMap();for(var d in l)console.log(l[d]);let p=ts.getPreEmitDiagnostics(r).concat(o.diagnostics);p.forEach(e=>{if(e.file){let{line:t,character:i}=e.file.getLineAndCharacterOfPosition(e.start),n=ts.flattenDiagnosticMessageText(e.messageText,"\n");console.log(`${e.file.fileName} (${t+1},${i+1}): ${n}`)}else console.log(`${ts.flattenDiagnosticMessageText(e.messageText,"\n")}`)});let c=o.emitSkipped?1:0;if(console.log(`Process exiting with code '${c}'.`),r.getSourceFiles().forEach(e=>ts.disposeEmitNodes(e)),0!=c)return Promise.reject("Compilation Errros");n.js=l.js,n.tsScript=Se.tsscript,n.sourceMap=l.sourceMap;var u=Se.emitTSDeclaration(l.declaration);return n.declaration=Se.typedeclaration=JSON.stringify(u),Se.script=n.js,Se.typesourcemap=n.sourceMap,Promise.resolve(n)}static getModelValueAfterTransform(e){let t=re.applyTemplateTransformation(e);const i=t.transformed[0],n=ts.createPrinter();let s=n.printFile(i);return t.dispose(),s}static getSourceAfterTransform(e){let t=re.applyTemplateTransformation(e);return t.transformed[0]}static applyTemplateTransformation(e){let t="proxyModel.js",i=ts.ScriptKind.JS;Se.isTypescript()&&(t="proxyModel.ts",i=ts.ScriptKind.TS);const s=ts.createSourceFile(t,e,ts.ScriptTarget.ES5,!0,i),a=ts.transform(s,[n.TSChecker.dotWalkingTransformer]);return a}}t.TSCompilerHost=re,r()&&(window.transform=re.getModelValueAfterTransform);class oe{constructor(e,t=""){this.pathName=e,this.filter=t}fetch(){if(this.fetchPromise)return this.fetchPromise;var e=this;return this.fetchPromise=new Promise(t=>{jQuery.ajax({url:e.pathName,data:{},headers:{"X-UserToken":window.g_ck},success:function(i){e.onFetch(i);try{t(i.result)}catch(e){console.log("error on resolving promise")}console.log("received for path "+e.pathName)}})}),this.fetchPromise}onFetch(e){}}t.RecordFetcher=oe;class pe extends oe{constructor(e,t=""){super(e,t),this.pathName=e,this.isDataAvailable=!1,(!T()||D())&&(this.isDataAvailable=!0,this.cachedData="string"==typeof window.snLibContent?JSON.parse(window.snLibContent).result:window.snLibContent.result)}fetch(){return this.isDataAvailable?new Promise(e=>{e(this.cachedData)}):super.fetch()}onFetch(e){this.isDataAvailable=!0,this.cachedData=e.result}}t.CachedRecordData=pe;var le=i.DECLARATION_TABLE_PATH;r()&&!T()&&(le=i.DECLARATION_DATA_PATH);var de=null;r()&&(de=new pe(le,""),de.fetch());let ce="",ue="",ge="",me="",fe="",ye="",he;t.getSIMap=C,t.getJavaAPI=_,t.setJavaAPI=function(e){ce=e},t.getTableAPI=E,t.getJSAPI=I,t.getTypedefAPI=A,t.getAllDeclAPI=x;var Te;t.getTypeDeclarations=F,t.internalInitialize=N;let Se;t.getCurrentSI=v,t.getCurrentModuleName=P;let be;t.updateCurrentSIDeclaration=k,t.isJSCacheReady=D,t.isSeismicComponent=L;let Ce=!1;t.loadJSXIntellisense=M,t.initializeWithSIRecord=function(e){Se=e;var t=new Promise(e=>L()?e():void de.fetch().then(function(t){let i={};Se.isNew()||(i[Se.sys_id]=!0),N(t,Se.api_name,Se.sys_id,i),T()&&k(!1),e()}));return t},t.initializeTypeDeclarations=function(e=""){return e=e||"global.",new Promise(t=>{de.fetch().then(function(i){N(i,e,"-1",{}),t()})})}}),define("fileSearch",["require","exports","siDeclEmittor","siParser"],function(e,t,n,s){"use strict";var o=Math.floor,p=Math.max;function a(e,t){for(var n=-1,s=0,a=0,r=e.length,o=0,l=t.length,d=!1,c=!1,u=!0,g=null,m=null,f=null,y=0,h=[];o!=l;){var T=a==r?null:e.charAt(a),S=t.charAt(o),b=null==T?null:T.toLowerCase(),C=S.toLowerCase(),_=S.toUpperCase(),E=T&&b==C,I=g&&m==C,A=E&&g,x=g&&T&&m==b;if((A||x)&&(s+=y,h.push(f),g=null,m=null,f=null,y=0),E||I){var F=0;if(0==a){var N=p(o*-3,-9);s+=N}d&&(F+=5),u&&(F+=10),c&&S==_&&C!=_&&(F+=10),E&&++a,F>=y&&(null!=g&&(s+=n),g=S,m=g.toLowerCase(),f=o,y=F),d=!0}else v+=S,s+=n,d=!1;c=S==C&&C!=_,u="_"==S||" "==S,++o}g&&(s+=y,h.push(f));for(var v="",P=0,k=0,D;k<h.length;++k){D=h[k];let e=t.substr(P,D-P),i=t.charAt(D);v+=`<span class = "no-match">${e}</span><span class='highlight'>${i}</span>`,P=D+1}0!=t.length-P&&(v+=`<span class="no-match">${t.substr(P,t.length-P)}</span>`);var L=a==r;return[L,s,v]}function r(e,t,s){function r(){clearTimeout(l),l=null;var r=performance.now()+o,d=n.getSIMap();for(var c in d){let i=d[c];for(var u=0;u<i.length;u++){let n=i[u].api.split("."),s=n[0];2==n.length&&i[u].api.split(".")[1];let r=e(t,s);e==a&&!0!=r[0]||p.push({rank:r[1],matchStr:r[2],item:i[u]})}}return s(p),null}var o=1e3/30,p=[],l=null;this.cancel=function(){null!==l&&clearTimeout(l)},this.start=function(){r()},this.flush=function(){o=1/0,r()}}Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n);class l{constructor(e){this.domNode=e,this.id="FileSearch"}getId(){return this.id}getDomNode(){return this.domNode}getPosition(){return null}}var d="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAPCAMAAADXs89aAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABOFBMVEVCpfX///9CpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfX///8Jns0AAAAAZnRSTlMAAEx9fn98eAcsiqeURr0SAkTi+HQOmtTTz+ff0Agg6uu25jIWKCYhYSInUvV1Q1kLZD5XbvryVm1ezUkxuu38XwYw7vNjRSOTrBCp+cQ6Kp0Pw7zW/r9yThOHszaIgCQFjqWbaBXwbi/OAAAAAWJLR0QB/wIt3gAAAAd0SU1FB+MCDg4uBi7hZswAAAABb3JOVAHPoneaAAAA2klEQVQY022QaVcBcRTGb/4TlUhkUKSpUGNsMVH2Jdq0b5Rdz/f/CGYmh8nxe3Gf5/ze3HsuGRjjuFXGmNG0RrS+Yd60kIIVM7Zs23YlHDtOIt7l9uwCe163x7fvx4FwCBwRHQeCIQ44ORWDFIYUoSgfi5NGAjhTMwkHR3NSgLZHlHEupGc6M9W2CxmQLrMLmiiXLwDFUnlBE1XMVdSu/ut6QxnXwI1e397dNx98jwLwpL/k+QWwv7694yOn6U/gS81WW1Kf8B36W/PT6fa00q8PhqPxr9JWljIBIUAu3lTAeuwAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDItMTRUMTQ6NDY6MDYrMDA6MDBwkCElAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTAyLTE0VDE0OjQ2OjA2KzAwOjAwAc2ZmQAAAABJRU5ErkJggg==\" alt=\"\" />";class c{constructor(e,t){this.editor=e,this.callback=t,this.id="FileSearch",this.fileSearchWrapper="FileSearch-filesWrapper",this.fileSearchInput="FileSearch-searchInput",this.domNode=document.createElement("div"),this.domNode.setAttribute("id",this.id),this.domNode.setAttribute("class",this.id),this.filterTimerId=-1,this.nextResultTimerId=-1,this.currentIndex=0}getNode(){return this.domNode}close(){}dispose(){c.isOpen=!1,this.domNode.removeEventListener("click",this),this.domNode.removeEventListener("keydown",this),this.domNode.removeEventListener("mousewheel",this),document.removeEventListener("keydown",this),this.editor.removeOverlayWidget(this.overlayWidget),this.editor.focus()}handleEvent(t){var e=Math.ceil;if("mousewheel"==t.type)return t.stopImmediatePropagation(),void t.stopPropagation();let i,n;if("keydown"==t.type){var s=t;if(27==s.keyCode||13==s.keyCode){if(13==s.keyCode&&(i=jQuery(this.domNode).find("#FileSearch-filesWrapper"),n=i.children(),this.currentIndex<n.length)){let e=n[this.currentIndex].getAttribute("data-sysid"),t=n[this.currentIndex].getAttribute("data-apiname");this.callback({apiName:t,sysId:e})}return s.stopImmediatePropagation(),s.stopPropagation(),s.preventDefault(),void this.dispose()}if(40==s.keyCode||38==s.keyCode){t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault(),i=jQuery(this.domNode).find("#FileSearch-filesWrapper"),n=i.children();let a=this.currentIndex;40==s.keyCode?this.currentIndex++:(this.currentIndex--,0>this.currentIndex&&(this.currentIndex=n.length-1)),this.currentIndex%=n.length,0<=a&&jQuery(n[a]).removeClass("selected"),jQuery(n[this.currentIndex]).addClass("selected"),!c.itemHieght&&0<n.length&&(c.itemHieght=n[0].getBoundingClientRect().height);let r=c.itemHieght||23,p=r*this.currentIndex,l=i.height(),d=i.scrollTop();if(38==s.keyCode){if(p=o(p),p>=d&&p<l+d)return;i.scrollTop(p)}else{let t=e(p+r);if(t>=d&&t<l+d)return;i.scrollTop(t-l)}return}let r=s.keyCode;if(!(47<r&&58>r||64<r&&91>r||96<r&&123>r||8==r||13==r))return;var a=this.domNode.querySelector("#"+this.fileSearchInput);return-1!=this.filterTimerId&&(window.clearTimeout(this.filterTimerId),this.filterTimerId=-1),-1!=this.nextResultTimerId&&window.clearTimeout(this.nextResultTimerId),this.nextResultTimerId=-1,void(this.filterTimerId=window.setTimeout(()=>{this.filter(a.value)},100))}var r=t.target,p=r.closest("div.FileSearch-file");if(null!=p){let e=p.dataset.apiname,t=p.dataset.sysid;return this.dispose(),void this.callback({apiName:e,sysId:t})}null==r.closest("div#FileSearch")&&this.dispose()}open(){c.isOpen=!0,this.domNode.innerHTML=this.constructHTML(),this.domNode.addEventListener("click",this),this.domNode.addEventListener("keydown",this),this.domNode.addEventListener("mousewheel",this),document.addEventListener("keydown",this),this.overlayWidget=new l(this.domNode),this.editor.addOverlayWidget(this.overlayWidget),this.domNode.querySelector("#"+this.fileSearchInput).focus()}filter(e){var t=this.domNode.querySelector("#"+this.fileSearchWrapper);let i=this.constructItems(e);this.currentIndex=-1,!i||(t.innerHTML=i)}constructItemsUsingFuzzy(e,t=50){!this.asyncMatcher||(this.asyncMatcher.cancel(),this.asyncMatcher=void 0),this.asyncMatcher=new r(a,e,e=>{e=e.sort(function(e,t){return t.rank-e.rank});let i=0,n="",a="";for(let r of e){let e="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH4gcPDwoiWcgyPAAAAh5JREFUSMfV1U2IjWEUB/Df/aDBVVj4mHEZnwmFBVGWdthJESGEUrOSpTWRKERNYqwsSKJ8pGztrCjF1FgIibi5GMPiOdc83ebOZXb+9fae53nOec/X/zkv/zsKI23WB7pbGnRU+0c9b9YdzUEJMzEev/AOtSbVMqqYFTpvMIDBXKEVpqEPi8OgB7ey8yU4gg2hCx/wCMfxvJ2DErrigUnZ2QJcwZommwp2Yzl24nmxTRl/xXsok2Ff9vEaHuIBvsTefCxtl0ErTMS6bN2LoxHAXmzEKTz+GwcjkaCEjmz9BvWQL0Xp/pChXYlGwleJKQ0cwB6p0YP5xzuq/aM6KLTYH8QNfI/1XFzEHRxGZ0OxPtA9pgzgJk7jW6zHYS3O4i52xF5bB3kWOYvqOIb9eGL4YhWwQupFD4pjzUBE3yexZg/uG272BOkSri//7VxpyiDHe1yLsm3DCUzFdGzKM1goNSwvT34+lMmzcQjzsr0aLkfJGugqhreDUnPOSiwoYjVmhOIPfAx5C27jPM5gmdTQElZJt7iBD2VpWJ2UZs1CzMHrUK6EYj+ehbwIK0PeHPJT/AybOXH2GQ/K0gy5Ho0qhMHKLIofuBBO4Zw0ovdF5NV4cgxJTLpXiCZPkS7J9lAeL7HkZSj2GuY8aR5txa4o0eQI7ite4Gr0o1ZoYlFnNK6CT+HgrdaooFtiTEn6H7yKd2LKv/z+GhiLzf+L3xLMgT1r10J2AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA3LTE1VDEzOjEwOjM0KzAyOjAwRXld0gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wNy0xNVQxMzoxMDozNCswMjowMDQk5W4AAAAASUVORK5CYII=\" alt=\"\" />";s.SITSFormat.isTypescript(r.item.f)&&(e=d);let o=`<div class="FileSearch-file" data-apiname="${r.item.api}" data-sysId="${r.item.id}">
					${e}<span class="normName">${r.matchStr}</span></div>`;if(i>t){a+=o;continue}i++,n+=o}var r=this.domNode.querySelector("#"+this.fileSearchWrapper);this.currentIndex=-1,r.innerHTML=n;let o=jQuery(this.domNode).find("#FileSearch-filesWrapper");setTimeout(()=>{o.scrollTop(0)},0),this.appendNextResultSet(a)}),this.asyncMatcher.start()}appendNextResultSet(e){if(0!=e.length){var t=this.domNode.querySelector("#"+this.fileSearchWrapper);this.nextResultTimerId=window.setTimeout(()=>{jQuery(e).appendTo(t)},200)}}constructItems(e,t=50){if(0<e.length)return this.constructItemsUsingFuzzy(e);var a="",r=0;0>t&&(t=50),t=p(t,50);var o=new RegExp(e,"gi"),l=n.getSIMap();let c="";for(var u in l)for(var g=l[u],m=0;m<g.length;m++){var f=g[m],y=f.api.split("."),h=y[0];if(1<y.length&&(h=y[1]),!e||null!=h.match(o)){r++;var T="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH4gcPDwoiWcgyPAAAAh5JREFUSMfV1U2IjWEUB/Df/aDBVVj4mHEZnwmFBVGWdthJESGEUrOSpTWRKERNYqwsSKJ8pGztrCjF1FgIibi5GMPiOdc83ebOZXb+9fae53nOec/X/zkv/zsKI23WB7pbGnRU+0c9b9YdzUEJMzEev/AOtSbVMqqYFTpvMIDBXKEVpqEPi8OgB7ey8yU4gg2hCx/wCMfxvJ2DErrigUnZ2QJcwZommwp2Yzl24nmxTRl/xXsok2Ff9vEaHuIBvsTefCxtl0ErTMS6bN2LoxHAXmzEKTz+GwcjkaCEjmz9BvWQL0Xp/pChXYlGwleJKQ0cwB6p0YP5xzuq/aM6KLTYH8QNfI/1XFzEHRxGZ0OxPtA9pgzgJk7jW6zHYS3O4i52xF5bB3kWOYvqOIb9eGL4YhWwQupFD4pjzUBE3yexZg/uG272BOkSri//7VxpyiDHe1yLsm3DCUzFdGzKM1goNSwvT34+lMmzcQjzsr0aLkfJGugqhreDUnPOSiwoYjVmhOIPfAx5C27jPM5gmdTQElZJt7iBD2VpWJ2UZs1CzMHrUK6EYj+ehbwIK0PeHPJT/AybOXH2GQ/K0gy5Ho0qhMHKLIofuBBO4Zw0ovdF5NV4cgxJTLpXiCZPkS7J9lAeL7HkZSj2GuY8aR5txa4o0eQI7ite4Gr0o1ZoYlFnNK6CT+HgrdaooFtiTEn6H7yKd2LKv/z+GhiLzf+L3xLMgT1r10J2AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA3LTE1VDEzOjEwOjM0KzAyOjAwRXld0gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wNy0xNVQxMzoxMDozNCswMjowMDQk5W4AAAAASUVORK5CYII=\" alt=\"\" />";s.SITSFormat.isTypescript(f.f)&&(T=d);let e=`<div class="FileSearch-file" data-apiname="${f.api}" data-sysId="${f.id}">${T}<span class="normName">${h}</span></div>`;r>=t?c+=e:a+=e}}return this.appendNextResultSet(c),a}constructHTML(){var e=this.constructItems("");return`<div class="FileSearch-searchWrapper">
					<input type="text" class="FileSearch-searchInput" id="FileSearch-searchInput" autocorrect="off" autocapitalize="off" spellcheck="false" autocomplete="off">
				</div>
				<div class="FileSearch-filesWrapper" id="FileSearch-filesWrapper">
				${e}
			</div>`}}t.FileSearch=c,c.isOpen=!1}),define("monacoField",["require","exports","codenowUtils","siDeclEmittor"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n);let s=CustomEvent;var a;(function(e){e.js="javascript",e.jsx="javascript",e.ts="typescript",e.tsx="typescript",e.html="html",e.css="css",e.xml="xml",e.json="json"})(a||(a={}));var r;(function(e){e[e.set=0]="set",e[e.add=1]="add"})(r||(r={}));class o{constructor(e,t){this.el=e,this.monacoField=t;let s=t.fileName.split("."),r=a.js;this.decorationSet=new Set,this.hasTranspiler()&&(r=a[t.srcType]),0<s.length&&(r=a[s[s.length-1]]);let o=r;o===a.js||o===a.jsx||o===a.ts||o===a.tsx?o=a.ts:o===a.xml||o===a.html?o=a.html:void 0;this.oldDecorations=[],this.model=monaco.editor.createModel(t.srcValue,o,monaco.Uri.file(t.fileName)),this.editor=monaco.editor.create(e,{model:this.model,glyphMargin:!0,language:o,fontSize:16,formatOnType:!0,lineNumbersMinChars:2,formatOnPaste:!0},{openerService:n.gotoDefintionService}),this.editor.onMouseDown(t=>{t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&t.event.leftButton&&!u.isNew()&&1===t.target.position.column&&this.onDebuggerMarginClick(t.target.position.lineNumber,t.target.position.column)});const p=this;this.editor.addAction({id:"debugger",label:"Open Debugger",contextMenuGroupId:"modification",contextMenuOrder:2.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.F8],run(e){return __awaiter(this,void 0,void 0,function*(){const e=i.getFieldNameFromMonacoField(p.monacoField);c.get().startDebugger(u.getTableName(),u.getSysId(),e)})}}),this.hasTranspiler()&&(this.editor.addAction({id:"Save",label:"Save",contextMenuGroupId:"modification",contextMenuOrder:2.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],run(e){p.onSave()}}),this.editor.addAction({id:"SaveAll",label:"Save All",contextMenuGroupId:"modification",contextMenuOrder:3,keybindings:[monaco.KeyMod.Shift|monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],run(){p.onSaveAll()}})),this.editor.onDidChangeModelContent(()=>{g_form.fieldChanged(this.monacoField.ref,!0),this.onValueChanged()})}toggleDebugPoints(e,t=r.set){if(!Array.isArray(e))return;if(t===r.add){const t=new Set(e),i=this.model.getAllDecorations(),n=i.filter(e=>this.decorationSet.has(e.id)),s=new Set(n.map(e=>e.range.startLineNumber)),a=e.filter(e=>s.has(e));a.forEach(e=>{t.delete(e),s.delete(e)}),e=[...Array.from(t),...Array.from(s)]}const i=this.model.getLineCount();e=e.filter(e=>e<=i);const n=e.map(e=>{const t={range:new monaco.Range(e,1,e,1),options:{glyphMarginClassName:"dbg-breakpoint",stickiness:monaco.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges}};return t});this.oldDecorations=this.editor.deltaDecorations(this.oldDecorations,n),this.decorationSet=new Set(this.oldDecorations)}isGlideVar(){return this.monacoField.host.hostType===i.FieldType.GlideVar}onDebuggerMarginClick(e,t=1){return __awaiter(this,void 0,void 0,function*(){const t=this.isGlideVar()?this.monacoField.host.tableName:this.monacoField.tableName,i=this.isGlideVar()?this.monacoField.host.sysId:this.monacoField.sysId,n=this.isGlideVar()?this.monacoField.host.name:this.monacoField.name,s=yield u.toggleDebugPoint(t,i,n,e),a=Object.keys(s.debugpoints.BREAKPOINT).map(e=>parseInt(e));this.toggleDebugPoints(a,r.set)})}onSave(){return __awaiter(this,void 0,void 0,function*(){try{u.save((yield this.getBackendValue())),g_form.addInfoMessage("Successfully saved")}catch(t){g_form.addErrorMessage("Unable to save the value")}})}onSaveAll(){return __awaiter(this,void 0,void 0,function*(){})}hasTranspiler(){return void 0!==this.monacoField.srcType}getLanguageServiceOutput(){return new Promise((e,t)=>__awaiter(this,void 0,void 0,function*(){const i=yield monaco.languages.typescript.getTypeScriptWorker(),n=yield i(this.model.uri),s=yield n.getEmitOutput(this.model.uri.toString());return s.emitSkipped?void Promise.all([n.getSyntacticDiagnostics(this.model.uri.toString()),n.getSemanticDiagnostics(this.model.uri.toString())]).then(e=>{t({syntacticDiagnostics:e[0],semanticDiagnostics:e[1]})}):void e(s)}))}updateTranspilerOutput(){return __awaiter(this,void 0,void 0,function*(){const e=yield this.getLanguageServiceOutput();e.outputFiles.forEach(e=>{e.name.endsWith(".d.ts")?this.monacoField.declaration=e.text:e.name.endsWith(".js.map")?this.monacoField.sourcemap=e.text:e.name.endsWith(".js")&&(this.monacoField.transpiledValue=e.text)})})}onValueChanged(){return this.hasTranspiler()?void this.updateTranspilerOutput():(g_form.setValue(this.monacoField.ref,this.model.getValue()),void(this.monacoField.transpiledValue=this.model.getValue()))}getValue(){return{value:this.hasTranspiler()?this.monacoField.transpiledValue:this.model.getValue()}}getDebugPointKey(){return u.isNew()?void 0:this.isGlideVar()?`${this.monacoField.host.tableName}.${this.monacoField.host.sysId}.${this.monacoField.host.name}`:`${this.monacoField.tableName}.${this.monacoField.sysId}.${this.monacoField.name}`}getMonacoField(){return Object.assign({},this.monacoField)}getBackendValue(){return __awaiter(this,void 0,void 0,function*(){return yield this.updateTranspilerOutput(),{ref:this.monacoField.ref,host:Object.assign({},this.monacoField.host),name:this.monacoField.name,srcValue:this.model.getValue(),declaration:this.monacoField.declaration,sourcemap:this.monacoField.sourcemap,transpiledValue:this.monacoField.transpiledValue}})}}t.MonacoEditor=o;let p=!1;const l=new Map;class d extends o{constructor(e,t){super(e,t),d.loadJSXTypedefs()}static loadJSXTypedefs(){if(!p){p=!0;["node_modules/@types/react/global.d.ts","node_modules/@types/prop-types/index.d.ts","node_modules/@types/react/index.d.ts","node_modules/csstype/index.d.ts"].forEach(e=>{const t=e.replace("node_modules","https://www.unpkg.com/");fetch(t).then(e=>e.text()).then(t=>{l.set(e,t),monaco.languages.typescript.typescriptDefaults.addExtraLib(t,e)})})}}onValueChanged(){monaco.languages.typescript.getTypeScriptWorker().then(e=>{e(this.model.uri).then(e=>{let t=e.getEmitOutput(this.model.uri.toString());t.then(e=>{e.emitSkipped||(this.js=e.outputFiles[0].text,"undefined"==typeof g_form||(g_form.setValue(this.monacoField.ref,this.model.getValue()),g_form.setValue(this.monacoField.tupleName,this.js)))})})})}getValue(){return{jsx:this.js,value:this.model.getValue()}}}t.MonacoJSXEditor=d;class c{constructor(){}static get(){return c.instance||(c.instance=new c,c.sourcemap=new Map),c.instance}getJSLine(e,t=!1){if(!window.recordConfig.isES6||!this.sourcemapConsumer)return Promise.resolve(e);if(!Array.isArray(e))return Promise.resolve([]);const i=`point.${t?"ts":"js"}`;let n=[];return e.forEach(e=>{const t=this.sourcemapConsumer.generatedPositionFor({source:i,line:e,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});t||n.push(t.line)}),Promise.resolve(n)}getTSLine(e,t=!1){if(!window.recordConfig.isES6||!this.sourcemapConsumer)return Promise.resolve(e);if(!Array.isArray(e))return Promise.resolve([]);`point.${t?"ts":"js"}`;let i=[];return e.forEach(e=>{const t=this.sourcemapConsumer.originalPositionFor({line:e,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});t||i.push(t.line)}),Promise.resolve(i)}applySourceMap(t,i){return __awaiter(this,void 0,void 0,function*(){const e=i.sourcemap;if(this.sourcemapConsumer=null,"undefined"==typeof sourceMap)return Promise.resolve(void 0);if("string"!=typeof e||0===e.length)return Promise.reject(void 0);let n=null;try{n=yield new sourceMap.SourceMapConsumer(JSON.parse(e))}catch(i){this.sourcemapConsumer=null;let e=c.sourcemap.get(t.fileName);e.consumer=null,n=null}return c.sourcemap.set(t.fileName,{field:t,transpiledField:i,consumer:n}),Promise.resolve(n)})}loadAllDebugPoints(){return __awaiter(this,void 0,void 0,function*(){if(this.debugPointServerState)return Promise.resolve(this.debugPointServerState);const{result:e}=yield i.CodeNowUtils.snFetch("/api/now/js/debugger/scripts");for(const t in e)e[t].debugpoints=e[t].debugpoints||{},e[t].debugpoints.BREAKPOINT=e[t].debugpoints.BREAKPOINT||{};return this.debugPointServerState=e,Promise.resolve(e)})}getDebugLineNumbers(e){let t=this.getDebugPoints(e);return t?Object.keys(t.debugpoints.BREAKPOINT).map(e=>parseInt(e)):[]}getDebugPoints(e){return this.debugPointServerState?this.debugPointServerState[e]:null}getKey(e,t,i){return`${e}.${t}.${i}`}loadDebugPoints(e,t,n){return __awaiter(this,void 0,void 0,function*(){const{result:s}=yield i.CodeNowUtils.snFetch(`api/now/js/debugpoints/script/${e}/${t}/${n}`);return s.debugpoints=s.debugpoints||{},s.debugpoints.BREAKPOINT=s.debugpoints.BREAKPOINT||{},this.debugPointServerState=this.debugPointServerState||{},this.debugPointServerState[s.key.value]=s,Promise.resolve(s)})}toggleDebugPoint(e,t,n,s,a=1){return __awaiter(this,void 0,void 0,function*(){const a={},r=this.getKey(e,t,n);return this.debugPointServerState[r]&&!this.debugPointServerState[r].debugpoints.BREAKPOINT[s]&&(a.evaluationString=""),yield i.CodeNowUtils.snFetch(`api/now/js/debugger/breakpoint/${e}/${t}/${n}/${s}`,{method:"POST",body:JSON.stringify(a)}),this.loadDebugPoints(e,t,n)})}startDebugger(e,t,i){function n(){var n=window.innerWidth-40,s=window.innerHeight,a=window.screenX+20,r=window.screenY+20,o="width="+n+",height="+s+",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,screenX="+a+",left="+a+",screenY="+r+",top="+r,p=window.open("","sn_ScriptDebugger",o,!1),l=p.location.href,d=!1;if("about:blank"===l){try{var c=parseInt(localStorage.getItem("sn_ScriptDebugger")),u=new Date().getTime();if(c&&6e4>u-c)return p.close(),void localStorage.setItem("sn_ScriptDebuggerExist_ShowNotification",new Date().getTime()+"")}catch(t){}d=!0}var g="/$jsdebugger.do?sysparm_nostack=true";if(t&&e&&i&&(g="/$jsdebugger.do?scriptId="+t+"&scriptType="+e+"&scriptField="+i+"&sysparm_nostack=true",!d))try{localStorage.setItem("sn_ScriptDebugger_url",g)}catch(t){var m=l.slice(l.indexOf("$jsdebugger.do"));m!=g&&(d=!0)}d&&(p=window.open(g,"sn_ScriptDebugger",o,!1)),p.focus(),p.setTimeout(focus,1)}var s;if("undefined"==typeof window.top.launchScriptDebugger?window.top.opener&&window.top.opener.top.launchScriptDebugger&&(s=window.top.opener.top.launchScriptDebugger):s=window.top.launchScriptDebugger,"undefined"!=typeof s&&"undefined"!=typeof g_form)return void s(e,t);try{n()}catch(t){}}}t.BreakpointManager=c;class u{static toggleDebugPoint(e,t,i,n,s=1){return __awaiter(this,void 0,void 0,function*(){return c.get().toggleDebugPoint(e,t,i,n)})}static initMonacoForOthers(e){function t(e){let i=document.getElementById(e);return i?void i.classList.add("sn_original_editor"):void setTimeout(t,100,e)}function i(e=!0){a.fields.forEach(i=>{if(i.isEditorInitialized)return;if(!(i.canRead||i.canWrite))return void(i.isEditorInitialized=!0);let n=document.getElementById(i.ref);if(n&&0===n.offsetWidth&&0==n.offsetHeight)return;let s=document.getElementById("monaco_"+i.ref),a="element."+i.ref;if(!s){let e=document.getElementById("element."+i.ref);if(!e)return;let t=document.createElement("fieldset"),n=document.createElement("div");n.setAttribute("oncontextmenu","return elementAction(this, event)"),n.setAttribute("data-type","label"),n.setAttribute("type",i.internalType),n.setAttribute("id",`label.${i.ref}`);let r=document.createElement("legend");r.textContent=i.name,n.appendChild(r),t.appendChild(n),s=document.createElement("div"),s.classList.add("sn_monaco_editor"),s.setAttribute("file-name",i.fileName),s.setAttribute("id","monaco_"+i.ref),r.appendChild(s),a=i.ref,e.insertBefore(t,e.firstChild)}i.isEditorInitialized=!0;let p;if(p="jsx"===i.internalType||"tsx"===i.internalType?new d(s,i):new o(s,i),u.instanceMap.set(i.ref,p),e){const e=c.get().getDebugLineNumbers(p.getDebugPointKey());p.toggleDebugPoints(e,r.set)}t(a)})}const a=u.snMonacoConfig=e||{};a.fieldMap=new Map;let p="";"string"==typeof a.customDeclaration&&(p+=a.customDeclaration+"\n"),Array.isArray(a.fields)&&a.fields.forEach(e=>{"string"==typeof e.customDeclaration&&(p+=e.customDeclaration+"\n"),a.fieldMap.set(e.name,e)});var l=n.getCompilerOptions(!1);l.sourceMap=!0,l.declaration=!0,l.outDir="./out/",delete l.allowNonTsExtensions,monaco.languages.typescript.typescriptDefaults.setCompilerOptions(l),n.initializeTypeDeclarations(a.appScope+".jeffa").then(()=>__awaiter(this,void 0,void 0,function*(){i(!1);yield c.get().loadAllDebugPoints();for(let e=u.instanceMap.keys();;){let t=e.next();if(t.done)break;const i=t.value,n=u.instanceMap.get(i);let s=c.get().getDebugLineNumbers(n.getDebugPointKey());const a=u.instanceMap.get(i);a.toggleDebugPoints(s,r.set)}})),0<p.length&&monaco.languages.typescript.typescriptDefaults.addExtraLib(p,"jeffa.d.ts");const g="undefined"!=typeof s&&"undefined"!=typeof s.observe;g&&(s.observe("tabs.disable",()=>{i()}),s.observe("element_script_display_true",()=>{i()}),s.observe("tab.activated",function(){i()}))}static getTableName(){return u.snMonacoConfig.tableName}static getSysId(){return u.snMonacoConfig.sysId}static isNew(){return"-1"===u.snMonacoConfig.sysId}static save(e){return __awaiter(this,void 0,void 0,function*(){const t=`/api/now/typescript_helpers/monaco_fields_update/${u.snMonacoConfig.tableName}/${u.snMonacoConfig.sysId}`;return i.CodeNowUtils.snFetch(t,{method:"POST",body:JSON.stringify({[e.name]:e})})})}static saveAll(){return __awaiter(this,void 0,void 0,function*(){})}}t.MonacoUtils=u,u.instanceMap=new Map}),define("main",["require","exports","monacoField","siDeclEmittor","codenowUtils"],function(e,t,i,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importStar(i),n=__importStar(n);class a{constructor(e){this.name=e,this.name=e}initialize(e){this.name=e}setReadOnly(e){}isDisabled(){return!1}isReadOnly(){return!1}getValue(){if("undefined"!=typeof currentSI)return currentSI.script;const e=g_form.getElement(this.name);return e?e.value:""}setValue(e){"undefined"==typeof currentSI||e!=currentSI.script;const t=g_form.getElement(this.name);t&&(t.value=e)}isVisible(){return!0}}t.CodeMirrorNoScriptTextAreaElement=a;class r{static loadMonaco(){return __awaiter(this,void 0,void 0,function*(){return r.monacoLoaderPromise?r.monacoLoaderPromise:(r.monacoLoaderPromise=new Promise(t=>{e(["vs/editor/editor.main"],()=>{function e(){return"undefined"==typeof monaco?requestAnimationFrame(e):void t(!0)}e()})}),r.monacoLoaderPromise)})}static init(){return __awaiter(this,void 0,void 0,function*(){const e="undefined"!=typeof window;if(e){if(n.isServiceNow()&&(window.CodeMirrorNoScriptTextAreaElement=a,!!window.snMonacoConfig)){const e={tableName:window.snMonacoConfig.tableName,sysId:window.snMonacoConfig.sysId,isNew:window.snMonacoConfig.isNewRecord,fields:window.snMonacoConfig.codeNowFieldConfig.fieldNames},t=yield Promise.all([r.loadMonaco(),s.CodeNowUtils.snFetch("/api/now/typescript_helpers/monaco_fields_config",{method:"POST",body:JSON.stringify(e)})]);return window.snMonacoConfig.fields=t[1],void i.MonacoUtils.initMonacoForOthers(window.snMonacoConfig)}if(!window.recordConfig.isFromScriptRunner){function e(){n||(localStorage.setItem(t,Date.now()+""),setTimeout(e,1e3))}const t="codenow_"+window.recordConfig.sysId,i=parseInt(localStorage.getItem(t));!isNaN(i)&&4e3>Date.now()-i&&confirm("Seems like you already opened this SI, click OK to close")&&window.close();let n=!1;e(),window.addEventListener("beforeunload",()=>{n=!0,localStorage.removeItem(t)})}r.loadEditorUI()}})}static escapeText(e){for(var t=0,n=null,s=[],a=0,r=e.length,o;a<r;a++)o=e.charCodeAt(a),o===96?n="\\`":o===8?n="\\b":o===12?n="\\f":o===10?n="\\n":o===0?n="\\0":o===13?n="\\r":o===9?n="\\t":o===11?n="\\v":o===92?n="\\\\":o===34?n="\\\"":void 0,null!==n&&(s.push(e.substring(t,a)),s.push(n),t=a+1,n=null);return s.push(e.substring(t,r)),s.join("")}static getWorkerUrl(e){if(0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")){let t="ylnworker.jsdbx";return window.g_ck||(t="./ylnworker.js"),t+"?v="+e}let t=location.origin+"/";window.recordConfig.paths.app.startsWith("ylnEditorMain")?t+=window.recordConfig.paths.app:t=window.recordConfig.paths.app,window.g_ck||(t=location.origin+"/app.js");const i="'"+window.recordConfig.paths.linter+"'",n="'"+window.recordConfig.paths.vsLoader+"'",s="'"+window.recordConfig.paths.tsCompiler+"'",a=[i,n,s].join(","),r={libVersions:{appVersion:window.recordConfig.libVersions.appVersion},paths:{app:window.recordConfig.paths.app,tsCompiler:window.recordConfig.paths.tsCompiler,vsLoader:window.recordConfig.paths.vsLoader,linter:window.recordConfig.paths.linter},isES6:window.recordConfig.isES6};let o="self.recordConfig = JSON.parse('"+JSON.stringify(r)+"');\n";return o+="importScripts("+a+");",o+="require.config({baseUrl: './',urlArgs: 'sysparm_substitute=false', paths: {},ignoreDuplicateModules: []});",o+="define('typescript', [], function () {return self.ts;});",o+="importScripts('"+t+"');",o+="var siDeclName = './siDeclEmittor';require(siDeclName).onThreadInitialized(self);","data:text/javascript;charset=utf-8,"+encodeURIComponent(o)}static createParserThread(e){const t={libVersions:{appVersion:window.recordConfig.libVersions.appVersion},paths:{app:window.recordConfig.paths.app,tsCompiler:window.recordConfig.paths.tsCompiler,vsLoader:window.recordConfig.paths.vsLoader,linter:window.recordConfig.paths.linter},isES6:window.recordConfig.isES6};window.ylnWorker=new Worker(r.getWorkerUrl(window.recordConfig.libVersions.appVersion+""),{name:"ylnworker?codenowWorkerParams="+JSON.stringify(t)}),e.onThreadInitialized(window.ylnWorker)}static cacheWindowObject(){"undefined"==typeof window.g_ck||("undefined"!=typeof g_form&&(g_form.ylnWindow=window),setTimeout(r.cacheWindowObject,1e3))}static loadEditorUI(){return __awaiter(this,void 0,void 0,function*(){function t(){window.removeEventListener("visibilitychange",t),settings.initialize()}yield r.loadMonaco(),e(["vs/language/typescript/tsWorker"],()=>{define("typescript",["require"],()=>window.ts),r.cacheWindowObject(),n.canWriteSI()&&!n.isSeismicComponent()&&r.createParserThread(n),"undefined"==typeof document.hidden?settings.initialize():document.hidden?window.addEventListener("visibilitychange",t):settings.initialize()})})}}t.Main=r}),define("monacoInit",["require","exports","constants","fileSearch","recordWatcher","siDeclEmittor","siParser","tsCompilerOptions","codenowUtils"],function(e,t,i,n,s,a,r,o,p){"use strict";var d=Math.floor;function l(){var v=Math.round;function e(e){let t=new c;try{let r=a.getCurrentSI();M()&&(r.updateAPIName("global.Point"),r.updateSysId("yln"),r.updateAccessType("public"),r.updateLangType("javascript"));let o=r.getScopeAndAPIMap();var i=g();if(t.js=i.outputText,t.sourceMap=i.sourceMapText,r.updateScript(i.outputText),window.recordConfig.useTypeChecker)return t;var n=r.generateDeclaration(esprima,e||!!window.recordConfig.jsdoc).getFormat(!0),s=JSON.parse(n);s[o.scope]&&Array.isArray(s[o.scope])&&0<s[o.scope].length&&(t.declaration=JSON.stringify(s[o.scope][0]))}catch(e){console.log(e.toString())}return t}function t(){var e=new Promise((e,t)=>{let i=a.getCurrentModuleName();monaco.languages.typescript.getTypeScriptWorker().then(n=>{n(`file:///${i}`).then(i=>{i.getScriptFileNames().then(n=>{var s=!1;n.forEach(e=>{0<e.indexOf(".d.ts")||(i.getSemanticDiagnostics(e).then(()=>{s=!0}),i.getSyntacticDiagnostics(e).then(()=>{s=!0}))}),s?t(r.ERROR_MSG):e()})})})});return e}function l(t=!1){let i=a.getCurrentSI();if(!M()){let e=g_form.getValue("api_name");if(0==e.length)return Promise.reject("API Name shouldn't be empty");let t=g_form.getUniqueValue(),n=g_form.getValue("access");i.isNew()||(i.updateAPIName(e),i.updateSysId(t),i.updateAccessType(n))}const n=i.api_name;var s=new Promise((s,o)=>{let p=Date.now();if(i.isJavascript()){if(!window.recordConfig.useTypeChecker)return console.log("compilation time is "+(Date.now()-p)),void s(e(t));let l=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();return void a.generateTypeDeclForSingleRecord(l).then(e=>{console.log("compilation time is "+(Date.now()-p)),M()?i.api_name!==n&&requestAnimationFrame(()=>{O.dispatchCompilation()}):!window.recordConfig.isES6&&(e.js=i.tsscript),i.setDirtyState(!1),i.updateScript(e.js);let t=new c(e.js,"",e.sourceMap,i.tsscript,void 0,e.linterErrors),o=JSON.parse(e.declaration);if(r.SITSFormat.isES6(o.f)){let t=i.emitTSDeclaration(e.tsDeclaration,o.f);t.td=o.td,o=t}t.backEndDecl=Object.assign({sc:i.getScopeAndAPIMap().scope},o);let l=r.SITSFormat.expandMinifiedFormat(o,i.getScopeAndAPIMap().scope,r.SITSFormat.isES6(o.f));a.updateCurrentSIDeclaration(!0,l),t.declaration=JSON.stringify(l),s(t)},e=>{o(e)})}let l=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();a.generateTypeDeclForSingleRecord(l).then(e=>{console.log("compilation time is "+(Date.now()-p)),i.setDirtyState(!1),i.updateScript(e.js);let t=new c(e.js,"",e.sourceMap,i.tsscript),o=i.emitTSDeclaration(e.declaration);t.backEndDecl=Object.assign({sc:i.getScopeAndAPIMap().scope},o);let l=r.SITSFormat.expandMinifiedFormat(o,i.getScopeAndAPIMap().scope,i.isTypescript());t.declaration=JSON.stringify(l),a.updateCurrentSIDeclaration(!0,l),s(t),i.api_name!==n&&requestAnimationFrame(()=>{O.dispatchCompilation()})},e=>{o(e)})});return s}function g(){let e=a.getCurrentSI(),t=a.getCompilerOptions(e.isJavascript());t.declaration=!1;let i=e.tsscript;if(e.containsTemplateExpression()&&(i=a.TSCompilerHost.getModelValueAfterTransform(e.tsscript)),t.target<ts.ScriptTarget.ES2015&&!M())return{outputText:e.tsscript};const n=ts.transpileModule(i,{compilerOptions:t,fileName:"./module.js"});return console.log(n.outputText),n}function m(e=!1,t=!1,n=!1,s,o){var p="global.Point",d="yln",c="public";let u=a.getCurrentSI();var g=u.script_type,m=[],f="undefined"!=typeof g_form;if(f){if(m=g_form.getEditableFields(),R)return!0;p=g_form.getValue("api_name"),d=g_form.getUniqueValue(),c=g_form.getValue("access"),-1!=m.indexOf("script_type")&&(g=g_form.getValue("script_type")),-1!=m.indexOf("jsdoc")&&(e="true"==g_form.getValue("jsdoc"))}return u.updateAPIName(p),u.updateSysId(d),u.updateAccessType(c),u.updateLangType(g),u.updateJSDoc(e),l(e).then(function(e){u.setDirtyState(!1),u.updateScript(e.js),u.updateDeclaration(e.declaration),u.updateSourcemap(e.sourceMap);const p=r.ClientSIRecordData.getClassConstructorFormat(a.getCurrentSI());u.updateScript(p),f&&(g_form.setValue(i.FIELD_SCRIPT,p),g_form.setValue(i.FIELD_TS_SCRIPT,u.tsscript),g_form.setValue(i.FIELD_SOURCEMAP,u.typesourcemap),g_form.setValue(i.FIELD_DECLARATION,u.typedeclaration),(-1!=m.indexOf(i.FIELD_DECLARATION)||n)&&(R=!0),(window.recordConfig.useTypeChecker||!n||-1!=m.indexOf(i.FIELD_TS_SCRIPT))&&a.updateSIDeclListeners(JSON.parse(e.declaration)));var l=g_form.getActionName();if(t&&f&&-1==m.indexOf(i.FIELD_DECLARATION))return jQuery.ajax({url:"api/now/typescript_helpers/update_declaration",type:"post",data:JSON.stringify(e.backEndDecl),headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}}).done(e=>{console.log(e),s&&s()}).fail(()=>{o&&o()}),!1;if(n){let e=window.recordConfig;e.isNewRecord?gsftSubmit(void 0,void 0,"sysverb_insert"):gsftSubmit(void 0,void 0,l)}},function(e){g_form.addErrorMessage(e,"script_error")}),!1}function f(e=""){const t=i.emojis,n=t[v(Math.random()*(t.length-1))];return`// Avoid writing code here ${n}
(function() {

	// Write your code here 😎
	gs.info('Hi, ${e}');




})();
// Avoid writing code here ${n}`}function y(e,t=i.LangType.typescript){function n(e){if("undefined"!=typeof g_form&&(g_form.setValue(i.FIELD_SCRIPT,e.js),g_form.setValue(i.FIELD_DECLARATION,e.declaration),g_form.setValue(i.FIELD_TS_SCRIPT,e.tsScript),g_form.setValue(i.FIELD_SOURCEMAP,e.sourceMap)),!l||l.updateModelContent(e.js),o){let t="";0!=e.declaration.length&&(t=a.getCurrentSI().formatForAddLib(JSON.parse(e.declaration),d.getScopeAndAPIMap().scope)),t=t.replace(/</gi,"&lt;"),o.innerHTML=t,0!=t.length&&monaco.editor.colorizeElement(o,{theme:w})}!p||(p.innerText=e.sourceMap)}var s=document.getElementById(i.EL_TS_EDITOR),r=document.getElementById(i.EL_JS_EDITOR),o=document.getElementById(i.EL_TS_DECL),p=document.getElementById(i.EL_TS_SOURCEMAP),l;let d=a.getCurrentSI();return a.isSeismicComponent()&&(d.tsscript=localStorage.getItem(u)||`function render() {return (<div></div>);}`),O=a.isSeismicComponent()?new J(s,n,!0,d.tsscript):new U(s,n,!0,d.tsscript),r&&(l=new B(r,null,"// wating ...",!0),O.setJSInstance(l),window.jsInstnace=l),window.tsInstance=O,{dispose(){}}}function h(e){let t=0,i=0,n=0,s=0,a=0;return a=v(e%1e3),s=d(e/1e3),n=d(s/60),s%=60,i=d(n/60),n%=60,t=d(i/24),i%=24,{day:t,hour:i,minute:n,seconds:s,ms:a}}function T(){var e=localStorage.getItem("sn.codenow"),t={theme:w};if(!e)return t;var i=JSON.parse(e);return i.theme=i.theme||t.theme,M()||(i.theme=w),i}function S(e){var t=T();for(var i in e)t[i]=e[i];M()&&localStorage.setItem("sn.codenow",JSON.stringify(t))}function b(e){jQuery("#yln-standalone-editor").removeClass(w).addClass(e),w=e,monaco.editor.setTheme(w),S({theme:e}),jQuery(W).val(e)}function C(){function e(e){var t=e.split("\n"),n=[];for(let s=0;s<t.length;s++)t[s].match(/^\s*debugger;\s?/)&&(n.push(s+2),t[s]="\"debugger\";");return{dbgStatements:n,js:t.join("\n")}}if(W&&(W.onchange=function(){b(W.value)}),a.isSeismicComponent())return void jQuery("#"+i.EL_SCOPE_SELECT).hide();let t=document.getElementById(i.EL_SCOPE_SELECT);if(t){var n="",s=window.recordConfig;for(let e in s.scopes){let t=s.scopes[e];"global"!=t.sysId&&(n+=`<option value='${t.value}' scope-id='${t.sysId}'>${t.displayValue}</option>\n`)}n=`<option value='global' scope-id='global' selected>Global</option>\n`+n.trim(),t.innerHTML=n,t.onchange=function(){let e=t.value,i=a.getCurrentSI();i.updateAPIName(e+"."),a.siUpdated()}}let r=document.getElementById(i.EL_SCRIPT_RUNNER);a.isServiceNow()||a.isSeismicComponent()||jQuery(r).hide(),r&&a.isServiceNow()&&(r.onclick=function(){function n(e){return __awaiter(this,void 0,void 0,function*(){jQuery("a[href=\"#script-output\"]").tab("show");var t=jQuery("#"+i.EL_SCRIPT_OUTPUT);let n=Date.now();var s=!1,a=document.getElementById("excution-timer"),t=jQuery("#"+i.EL_SCRIPT_OUTPUT);t.html(`<div class = "script-running">
							<i class="glyphicon glyphicon-refresh spin"></i>
							</div>`);var p=()=>{let e=Date.now();var t=h(e-n);let i=t.minute+":"+t.seconds+":"+t.ms;a.innerText=i,s||window.requestAnimationFrame(p)};p();try{const t=yield I(e,o),n=new DOMParser,s=n.parseFromString(t,"text/html");jQuery("#"+i.EL_SCRIPT_OUTPUT).html(s.body.innerHTML)}catch(t){console.error(" Found error "+t)}finally{s=!0,r.disabled=!1}return Promise.resolve()})}function s(t){return __awaiter(this,void 0,void 0,function*(){function i(e=!1){return a.map(t=>{const i={data:JSON.stringify({evaluationString:""}),url:`/api/now/js/debugger/breakpoint/sys_script_include/${D}/script/${t}`,method:"POST",contentType:"application/json",headers:{"X-UserToken":window.g_ck}};return e&&delete i.data,$.ajax(i)})}const s=e(t),a=s.dbgStatements,o=s.js.split("\n");if(0<o.length&&o.splice(o.length-1,1),t=o.join("\n"),0==a.length)return yield n(t);const p={sysparm_key:"sys_script_include.1172f0210bf213008e64aabcb4673aee.script",sysparm_breakpoints:JSON.stringify(a),sysparm_processor:"BreakpointProcessor",sysparm_action:"SET_BREAKPOINTS",sysparm_express_transaction:!0,sysparm_debugger_transaction:!0},l={url:"xmlhttp.do",data:p,headers:{"X-UserToken":window.g_ck}},d={contentType:"application/json",data:JSON.stringify({script:`function ${L}(){\n${t}\n};`}),headers:{X_UserToken:window.g_ck},method:"POST",type:"POST",url:"/api/now/typescript_helpers/UpdateDebuggerScript"},c={data:JSON.stringify({evaluationString:""}),url:`/api/now/js/debugger/breakpoint/sys_script_include/${D}/script/2`,method:"POST",contentType:"application/json",headers:{"X-UserToken":window.g_ck}};jQuery.when(i(),$.ajax(d)).then((...e)=>{$.ajax(c).done(()=>__awaiter(this,void 0,void 0,function*(){n(`global.${L}()`).then(()=>{jQuery.when(i(!0)).then(()=>{})},()=>{jQuery.when(i(!0)).then(()=>{})})}))},(...e)=>{r.disabled=!1,console.log("failure to update breakpoints and scripts")})})}if(a.isServiceNow()){r.disabled=!0;let e=a.getCurrentSI();var o=t.selectedOptions[0].getAttribute("scope-id");return e.isUpToDate()?void s(e.script):void l().then(e=>{s(e.js)},e=>{alert(e),r.disabled=!1})}})}function _(){function e(){let e=jQuery(document.getElementById("sys_script_include.form_scroll")),t=e.offset();if(t){let i=jQuery("#ts_editor_container").offset();if(i){let n=i.top-t.top;0<n&&e.scrollTop(n)}}}a.isServiceNow()||(window.recordConfig.scopes=i.scopes,window.recordConfig.snippets=i.snippets),C(),b(T().theme);var t=window.recordConfig;if(!a.isServiceNow()){let e=new r.ClientSIRecordData;e.updateAPIName(t.apiName),e.updateLangType(t.langType),a.initializeWithSIRecord(e).then(()=>{y(t.apiName,t.langType||i.LangType.javascript)})}else if(t.isNewRecord){let n=new r.ClientSIRecordData(void 0,!0);n.updateLangType(window.recordConfig.langType),a.initializeWithSIRecord(n).then(()=>{y("",t.langType||i.LangType.javascript),M()||a.getCurrentSI().isNew()||e()})}else{var n=r.ClientSIRecordData.fromSIRec(window.recordConfig.siRec);r.ClientSIRecordData.convertToJSConstructor(n),a.initializeWithSIRecord(n).then(()=>{y(t.apiName,t.langType||i.LangType.javascript),M()||e()})}}function E(e="gs.info('hello yln')",t="0f6ab99a0f36060094f3c09ce1050ee8"){var i={script:e,sysparm_ck:window.g_ck,runscript:"Run script",sys_scope:t},n="",s=[];for(let n in i)s.push(encodeURIComponent(n)+"="+encodeURIComponent(i[n]));return n=s.join("&").replace(/%20/g,"+"),n}function I(e,t){return __awaiter(this,void 0,void 0,function*(){const i=yield p.CodeNowUtils.snFetch("/sys.scripts.do",{method:"POST",mode:"cors",headers:{"content-type":"application/x-www-form-urlencoded"},body:E(e,t)},!1);return(yield i).text()})}function A(e=D,t="sys_script_include",i="script"){function n(){var n=window.innerWidth-40,s=window.innerHeight,a=window.screenX+20,r=window.screenY+20,o="width="+n+",height="+s+",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,screenX="+a+",left="+a+",screenY="+r+",top="+r,p=window.open("","sn_ScriptDebugger",o,!1),l=p.location.href,d=!1;if("about:blank"===l){try{var c=parseInt(localStorage.getItem("sn_ScriptDebugger")),u=new Date().getTime();if(c&&6e4>u-c)return p.close(),void localStorage.setItem("sn_ScriptDebuggerExist_ShowNotification",new Date().getTime()+"")}catch(t){}d=!0}var g="/$jsdebugger.do?sysparm_nostack=true";if(e&&t&&i&&(g="/$jsdebugger.do?scriptId="+e+"&scriptType="+t+"&scriptField="+i+"&sysparm_nostack=true",!d))try{localStorage.setItem("sn_ScriptDebugger_url",g)}catch(t){var m=l.slice(l.indexOf("$jsdebugger.do"));m!=g&&(d=!0)}d&&(p=window.open(g,"sn_ScriptDebugger",o,!1)),p.focus(),p.setTimeout(focus,1)}if(K){K=!1;try{n()}catch(t){}K=!0}}function x(){let e=a.getCompilerOptions(a.getCurrentSI().isJavascript(),window.recordConfig.isES6);monaco.languages.typescript.typescriptDefaults.setCompilerOptions(e);var t=O;t.triggerCompilation()}function F(e,t,i){function n(){i.off("hidden.bs.modal",n),e.removeAttr("disabled"),t.addClass("hide")}i.on("hidden.bs.modal",n),i.modal()}function N(e,t,i=2500){if("undefined"==typeof GlideUI)return void alert(e);let n=document.createElement("span");n.setAttribute("data-type",t),n.setAttribute("data-text",e),n.setAttribute("data-duration",i+""),GlideUI.get().fire(new GlideUINotification({xml:n}))}var P=0;window.addEventListener("beforeunload",function(e){0<P&&(M()||"undefined"!=typeof g_form&&!g_form.submitted)&&(e.returnValue="There is a pending work. sure you want to leave")});const k=-1,D="1172f0210bf213008e64aabcb4673aee",L="TempDebugger",M=a.isScriptRunner;var j=o.default,O;let w="vs";jQuery(function(){function e(){let e=[ts.JsxEmit.None,ts.JsxEmit.Preserve,ts.JsxEmit.React,ts.JsxEmit.ReactNative],t=[ts.ScriptTarget.ES3,ts.ScriptTarget.ES5,ts.ScriptTarget.ES2015,ts.ScriptTarget.ES2016,ts.ScriptTarget.ES2018,ts.ScriptTarget.Latest],n=`<select onchange="settings.onTargetChange('target', this.value)">`,s=j.target;for(let e=0,i;e<t.length;e++)i="",s==t[e]&&(i="selected"),n+=`<option ${i} value='${t[e]}'>${ts.ScriptTarget[t[e]]}</option>`;n+="</select>";let a=`<select onchange="settings.onJSXChange('jsxTarget', this.value)">`;e.forEach((e,t)=>{let i="",n=j.jsx;t===n&&(i="selected"),a+=`<option ${i} value='${e}'>${ts.JsxEmit[e]}</option>`}),a+=`</select>`,M()||(a="");const r="glyphicon-unchecked";let p=`<div style="max-height: 300px;overflow: auto; white-space: nowrap;">
				<div class="eslint">
					<label style="margin: 8px;">
						<input onclick="javascript:settings.toggleLinter();" style="margin: 0px 8px;" type='checkbox' ${o.default.linter?"checked":""}>
						Enable ESlint
					</label>
				</div>
				<ul class="list-group checked-list-box" onclick="javascript:settings.onCompilerSettingsChange(event.target)">
					<li class="list-group-item">Target ${n}</li>
					<li class="list-group-item">JSX ${a}</li>
					<li class="list-group-item" title="Allows js to compile" data-key="allowJs">
						<span class='state-icon glyphicon ${j.allowJs?"glyphicon-check":r}'></span>
						allowJs
					</li>
					<li class="list-group-item" title="Enable type checking on JavaScript files" data-key="checkJs">
						<span class='state-icon glyphicon ${j.checkJs?"glyphicon-check":r}'></span>
						checkJs
					</li>
					<li class="list-group-item" title = "Warn on expressions and declarations with an implied 'any' type" data-key="noImplicitAny">
						<span class='state-icon glyphicon ${j.noImplicitAny?"glyphicon-check":r}'></span>
						noImplicitAny
					</li>
					<li class="list-group-item" title="Enable strict null checks" data-key="strictNullChecks">
						<span class='state-icon glyphicon ${j.strictNullChecks?"glyphicon-check":r}'></span>
						strictNullChecks
					</li>
					<li class="list-group-item" title="Raise error on 'this' expressions with an implied any type" data-key="noImplicitThis">
						<span class='state-icon glyphicon ${j.noImplicitThis?"glyphicon-check":r}'></span>
						noImplictThis
					</li>
					<li class="list-group-item" title="Report error when not all code paths in function return a value" data-key="noImplicitReturns">
						<span class='state-icon glyphicon ${j.noImplicitReturns?"glyphicon-check":r}'></span>
						noImplicitReturns
					</li>
					<li class="list-group-item" title="Do not report errors on unreachable code" data-key="allowUnreachableCode">
						<span class='state-icon glyphicon ${j.noImplicitReturns?"glyphicon-check":r}'></span>
						allowUnreachableCode
					</li>
					<li class="list-group-item" title="Report errors for fallthrough cases in switch statement" data-key="noFallthroughCasesInSwitch">
						<span class='state-icon glyphicon ${j.noImplicitReturns?"glyphicon-check":r}'></span>
						noFallthroughCasesInSwitch
					</li>
					<li class="list-group-item" title="Enable all strict type-checking options" data-key="strict">
						<span class='state-icon glyphicon ${j.strict?"glyphicon-check":r}'></span>
						strict
					</li>
					<li class="list-group-item" title="Parse in strict mode and emit 'use strict'" data-key="alwaysStrict">
						<span class='state-icon glyphicon ${j.alwaysStrict?"glyphicon-check":r}'></span>
						alwaysStrict
					</li>
					<li class="list-group-item" title="Do not generate custom helper functions like __extends in compiled output.'" data-key="noEmitHelpers">
						<span class='state-icon glyphicon ${j.noEmitHelpers?"glyphicon-check":r}'></span>
						noEmitHelpers
					</li>
					<li class="list-group-item" title="Report errors on unused parameters" data-key="noUnusedParameters">
						<span class='state-icon glyphicon ${j.noUnusedParameters?"glyphicon-check":r}'></span>
						noUnusedParameters
					</li>
					<li class="list-group-item" title="Report errors on unused locals" data-key="noUnusedLocals">
						<span class='state-icon glyphicon ${j.noUnusedLocals?"glyphicon-check":r}'></span>
						noUnusedLocals
					</li>
					<li class="list-group-item" title="strip @internal methods when generating declaration" data-key="stripInternal">
						<span class='state-icon glyphicon ${j.stripInternal?"glyphicon-check":r}'></span>
						stripInternals
					</li>
				</ul>
			</div>`;return p}jQuery("#compiler-settings").popover({html:!0,trigger:"manual",content:function(){return e()},title:"Compiler Settings"}).click(function(t){0==jQuery("#compiler-settings-container > .popover").length?jQuery(this).popover("show"):jQuery(this).popover("hide"),t.stopPropagation(),t.preventDefault()}),jQuery(document).on("click",function(t){var e=jQuery(t.target);e.data&&"undefined"==typeof e.data("original-title")&&!jQuery(t.target).parents().is(".popover.in")&&jQuery("[data-original-title]").popover("hide")})}),window.compileJS=g,window.compileTS=l;var R=!1;class V{constructor(e,t,n,s="",r="/module.ts",o=!1){function p(){if(a.isScriptRunner()){var e=jQuery("#yln-standalone-editor > .navbar-default").height();jQuery("#yln-standalone-editor > .workspace-area").css({top:e})}}function l(){u=k,this.editor&&this.editor.layout(),p()}this.isReadonly=o,this.breakPoints=[],this.existingBreakPoints=[],this.initialModelVersion=-1,this.lastModelVersion=-1,this.gotoDefLine=-1;let d=a.getCurrentSI();window.currentSI=d,s||(s=f("Welcome to ServiceNow Developement IDE! \uD83D\uDE4F"),!M()&&!a.isSeismicComponent()&&(window.recordConfig.isES6?s=d.isTypescript()?i.SAMPLE_TS_CONTENT:i.SAMPLE_JS_CONTENT:s=i.SAMPLE_STANDARD_SI_CONTENT)),0==d.tsscript.length&&M()&&!o&&d.updateTSScript(s),"function"==typeof Array.prototype.include&&(Array.prototype.include=void 0),this.model=monaco.editor.createModel(s,n,monaco.Uri.file(r)),this.model.updateOptions({trimAutoWhitespace:!0,tabSize:4,insertSpaces:!1}),this.initialModelVersion=this.model.getAlternativeVersionId(),this.modelVersion=this.model.getAlternativeVersionId();let c=a.getCurrentSI().isNew();this.editor=monaco.editor.create(e,{model:this.model,language:n,renderWhitespace:o?"none":"all",fontSize:14,formatOnType:!0,formatOnPaste:!0,glyphMargin:!c||window.recordConfig.breakpoints,readOnly:o,renderIndentGuides:!0,lineNumbersMinChars:2,suggestSelection:"recentlyUsed",scrollBeyondLastLine:!1,lightbulb:{enabled:!0},minimap:{enabled:!1},scrollbar:{useShadows:!1,verticalHasArrows:!1,horizontalHasArrows:!1,vertical:"visible",horizontal:"visible",verticalScrollbarSize:7,horizontalScrollbarSize:7,arrowSize:30}},{openerService:a.gotoDefintionService});var u=k;window.addEventListener("resize",()=>{u!=k&&window.clearTimeout(u),u=window.setTimeout(l.bind(this),2000)}),p()}onBreakpoint(e,t){a.isServiceNow()&&!M()?this.toggleBreakPointInServer(e):this.toggleBreakPoint([e])}loadBreakPointsFromServer(e){if(!a.isServiceNow())return;let t=a.getCurrentSI();if(t.canPlaceBreakPoints()){const e={url:"/api/now/js/debugger/scripts",method:"GET",headers:{"X-UserToken":window.g_ck}};jQuery.ajax(e).done(e=>{if(e&&"object"==typeof e){const n=t.sys_class_name+"."+t.sys_id+".script";var i=e.result[n];this.jsBreakPointsState=i,i&&(!i.debugpoints&&(i.debugpoints={BREAKPOINT:{}}),!i.debugpoints.BREAKPOINT&&(i.debugpoints.BREAKPOINT={}),this.updateBreakPoints(i))}})}}updateBreakPoints(e){var t=[];t=Object.keys(e.debugpoints.BREAKPOINT).map(e=>parseInt(e)),0<t.length&&this.toggleBreakPoint(t)}toggleBreakPointInServer(e,t="",i=!1){if(!a.isServiceNow())return;if(M())return;let n=a.getCurrentSI();const s="/api/now/js/debugger/breakpoint/"+n.sys_class_name+"/"+n.sys_id+"/script/"+e;let r={url:s,contentType:"application/json",method:"POST",headers:{"X-UserToken":window.g_ck}};this.jsBreakPointsState&&(this.jsBreakPointsState.debugpoints.BREAKPOINT&&!this.jsBreakPointsState.debugpoints.BREAKPOINT[e]||0<t.length||i)&&(r.data=JSON.stringify({evaluationString:t})),jQuery.ajax(r).done(()=>{this.loadBreakPointsFromServer(n.sys_class_name+".script")})}toggleBreakPoint(e){if(a.isServiceNow()&&!M())this.breakPoints=e;else{var t=this.breakPoints.indexOf(e[0]);-1==t?this.breakPoints.push(e[0]):this.breakPoints.splice(t,1)}let i=[],n=!1;const s=this.editor.getModel().getLineCount();for(let t of this.breakPoints){if(t>s)continue;const e={range:new monaco.Range(t,1,t,1),options:{glyphMarginClassName:"dbg-breakpoint",stickiness:monaco.editor.TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges}};this.gotoDefLine==t&&(n=!0,e.options.isWholeLine=!0,e.options.className="gotoLine"),i.push(e)}if(-1!=this.gotoDefLine&&this.gotoDefLine<=s&&!n){let e={range:new monaco.Range(this.gotoDefLine,1,this.gotoDefLine,1),options:{isWholeLine:!0,className:"gotoLine"}};i.push(e)}this.existingBreakPoints=this.editor.deltaDecorations(this.existingBreakPoints,i)}updateModelContent(e){this.editor.getModel().setValue(e)}}class B extends V{constructor(e,t,n="",s=!1){super(e,t,i.LangType.javascript,n,"es5Module.js",s),this.cb=t}onContentChanged(t){}}class U extends V{constructor(e,t,s=!1,r="",p="",l=!1){function d(t){if(t.target.type!=monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN)return;let e=t.target.position.lineNumber;if(!y)h=e;else if(h==e)return;h=e,y=!0;let i=t.event.browserEvent.clientX,n=t.event.browserEvent.clientY,s=S.jsBreakPointsState;S.tsBreakPointState&&(s=S.tsBreakPointState);let a=s&&s.debugpoints.BREAKPOINT&&s.debugpoints.BREAKPOINT[e],r=jQuery("#new-breakpoint-menu"),o="";a&&(o=s.debugpoints.BREAKPOINT[e].evaluationString+"");let p=document.getElementById("ts_editor");if(p){let e=p.getBoundingClientRect();n-=e.top-60,0>n&&(n=0),i+=30}r.find("#breakpoint-line-number").text(e);let l=r.find("#breakpoint-condition");l.attr("data-linenumber",e),l.val(o),r.css({display:"block",transform:`translate(${i}px, ${n}px)`}).addClass("show")}function c(){-1!=T&&(clearTimeout(T),T=-1);y&&(jQuery("#new-breakpoint-menu").removeClass("show").hide(),y=!1)}super(e,t,i.LangType.typescript,r,a.getCurrentModuleName(),!a.canWriteSI()),this.cb=t,this.autoCompile=s,this.compileTriggerTimoutID=k,this.isBreakPointsLoaded=!1,this.editorViewMap={},this.tsBreakPointState={debugpoints:{BREAKPOINT:{}}},this.tsFileIndex=1,this.jsFileIndex=1;let u=a.getCurrentSI();u.tsscript;var g;if(M()){const e=this.model.uri.path.replace("/","");this.createTab(e,!0),u.setDirtyState(!0),this.selectTab(e),a.isSeismicComponent()&&window.recordConfig.snippets.push({label:"Seismic",doc:"Creates seismic component template",text:i.SAMPLE_SEISMIC_CONTENT});let t=[];for(var m of window.recordConfig.snippets)t.push({range:void 0,label:"yln_"+m.label,kind:monaco.languages.CompletionItemKind.Snippet,documentation:m.doc,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:m.text});0<t.length&&monaco.languages.registerCompletionItemProvider("typescript",{provideCompletionItems:()=>({suggestions:t})}),this.editor.addAction({id:"Run",label:"Run",contextMenuGroupId:"modification",contextMenuOrder:3.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_R],run(e){return document.getElementById(i.EL_SCRIPT_RUNNER).click(),null}})}else a.isServiceNow()&&!u.isNew()&&this.editor.addAction({id:"Save",label:"Save",contextMenuGroupId:"modification",contextMenuOrder:2.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],run:function(){G.saveSI(null)}});a.isSeismicComponent()||this.editor.addAction({id:"FielOpen",label:"FileOpen",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_P],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){return n.FileSearch.isOpen||(g=new n.FileSearch(e,function(e){var t="./?sys_id="+e.sysId;a.isServiceNow()&&(t="./sys_script_include.do?sys_id="+e.sysId),window.open(t)}),g.open()),null}});let f=k,y=!1,h=0,T=-1,S=this;this.isReadonly||(this.editor.onDidChangeModelContent(t=>{P++,u.setDirtyState(!0),u.updateTSScript(this.editor.getModel().getValue()),f!=k&&clearTimeout(f),f=window.setTimeout(()=>{f=k,this.onContentChanged(t)},a.isSeismicComponent()?2e3:5e3)}),jQuery(document).on("keyup",t=>{27==t.keyCode&&c()}),jQuery("#ts_editor_container").on("keyup","#breakpoint-condition",t=>{if(27==t.keyCode)return void c();if(13==t.keyCode){let e=jQuery(t.target),i=parseInt(e.attr("data-linenumber")),n=e.val();this.onBreakpoint(i,1,n,!0),c()}}),(!u.isNew()||!!window.recordConfig.breakpoints)&&(this.editor.onMouseDown(t=>{t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&t.event.leftButton&&(u.isUpToDate()&&u.canPlaceBreakPoints()||!!window.recordConfig.breakpoints)&&this.onBreakpoint(t.target.position.lineNumber,1)}),!M()&&(this.editor.onContextMenu(t=>{d(t)}),this.editor.onMouseMove(t=>t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN?y?void d(t):-1==T?void(T=self.setTimeout(()=>{d(t),T=-1},500)):void 0:void(T-1&&(clearTimeout(T),T=-1)))))),this.editor.onDidFocusEditorText(()=>{console.log("focus to editor");-1==this.gotoDefLine||(this.gotoDefLine=-1,this.toggleBreakPoint(this.breakPoints))}),setTimeout(()=>{let e=0;window.recordConfig.gotoLine&&(e=parseInt(window.recordConfig.gotoLine)||0,e&&(this.gotoDefLine=e,this.editor.revealPositionInCenter({lineNumber:e,column:0}),this.toggleBreakPoint(this.breakPoints)))},10),M()?a.isSeismicComponent()&&(o.default.jsx=monaco.languages.typescript.JsxEmit.React,o.default.inlineSourceMap=!0,o.default.inlineSources=!0):o.default.declaration=window.recordConfig.isES6,monaco.languages.typescript.typescriptDefaults.setCompilerOptions(o.default),setTimeout(()=>this.triggerCompilation(),1e3)}setJSInstance(e){this.jsInstance=e}createTab(e,t=!1){const i=e.replace(".","_"),n=`${i} clickable active ${t?"home":""}`;let s=`<i class="glyphicon glyphicon-remove close-icon" onclick="javascript: settings.onRemoveTab('${e}')"></i>`;t&&(s="");var a=`<li class= '${n}' onclick='javascript: settings.onSelectTab("${e}")'>
				<a href="#">
					${e}
					${s}
				</a>
			</li>`,r=jQuery("#file-menu-container");r.find(".active").removeClass("active");var o=r.find(".add-file");o.before(a)}removeTab(e){var t=jQuery("#file-menu-container");const i=e.replace(".","_");var n=t.find("."+i);n.remove()}selectTab(e){const t=e.replace(".","_");var i=jQuery(`#file-menu-container`),n=i.find(".active");n.hasClass(t)||(n.removeClass("active"),i.find(`.${t}`).addClass("active"))}addFile(e=!0){let t=`Point${e?this.tsFileIndex+".ts":this.jsFileIndex+".js"}`,n=prompt(`Enter your file name e.g Point.${e?"ts":"js"}`,t);if("string"==typeof n&&0!==n.length){let o=n.split(".");if(2!==o.length||"ts"!==o[1]&&"js"!==o[1])return void alert("wrong file name");let p=t.split(".");(t===n||o[0]===p[0])&&(e||"ts"===o[1]?this.tsFileIndex++:this.jsFileIndex++);var s=monaco.editor.getModels().find(e=>e.uri.path==="/"+n);if(s)return void alert("Already this file is in workspace");this.createTab(n);var r=f(`"${n}" user 🙏`);let l=monaco.editor.createModel(r,i.LangType.typescript,monaco.Uri.file(n));this.editorViewMap[this.editor.getModel().uri.path]=this.editor.saveViewState(),this.editor.setModel(l);const d=a.getCurrentSI();d.updateScriptType(n),d.updateTSScript(l.getValue()),d.setDirtyState(!0);const c=jQuery("#scope-select").val();d.updateAPIName(c+"."+n),this.dispatchCompilation()}}removeFile(e){let t=monaco.editor.getModels().find(t=>t.uri.path==="/"+e);if(t){const n=t.uri.path.replace("/","").replace(".","_");var i=jQuery(`#file-menu-container`);i.find(".active").hasClass(n)&&this.selectFile(this.model.uri.path.replace("/","")),this.removeTab(e),delete this.editorViewMap[t.uri.path],t.dispose()}}selectFile(e){let t=monaco.editor.getModels().find(t=>t.uri.path==="/"+e);if(t){let i=this.editor.saveViewState();this.editorViewMap[this.editor.getModel().uri.path]=i,this.editor.setModel(t),this.editorViewMap[t.uri.path]&&this.editor.restoreViewState(this.editorViewMap[t.uri.path]),this.selectTab(e);const n=a.getCurrentSI();n.updateScriptType(e),n.updateTSScript(t.getValue()),n.setDirtyState(!0);const s=jQuery("#scope-select").val();n.updateAPIName(s+"."+e),this.dispatchCompilation()}}updateBreakPoints(e){if(!M()){var t=Object.keys(e.debugpoints.BREAKPOINT).map(e=>parseInt(e));this.convertLineNoFromJSToTS(t).then(e=>{this.toggleBreakPoint(e)})}}onBreakpoint(e,t,i="",n=!1){a.getCurrentSI();this.convertLineNoFromTStoJS([e]).then(e=>{this.jsInstance&&this.jsInstance.toggleBreakPoint(e),!a.isServiceNow()||M()?this.convertLineNoFromJSToTS(e).then(e=>{this.toggleBreakPoint(e)},e=>{console.log(e)}):this.toggleBreakPointInServer(e[0],i,n)},e=>{console.log(e)})}dispatchCompilation(){let e=a.getCurrentSI();e.setDirtyState(!0),e.updateTSScript(this.editor.getModel().getValue()),this.compileTriggerTimoutID!=k&&(clearTimeout(this.compileTriggerTimoutID),this.compileTriggerTimoutID=k);var t="undefined"!=typeof ts,i="undefined"!=typeof monaco;t&&i&&(this.compileTriggerTimoutID=window.setTimeout(this.triggerCompilation.bind(this),5000))}onContentChanged(t){this.dispatchCompilation()}triggerCompilation(){return __awaiter(this,void 0,void 0,function*(){const e=a.getCurrentSI();this.compileTriggerTimoutID=k;let t=null;try{t=yield l()}catch(t){return void console.error(t)}if(e.updateScript(t.js),e.setDirtyState(!1),e.updateDeclaration(t.declaration),e.updateSourcemap(t.sourceMap),this.sourcemapConsumer&&this.sourcemapConsumer.destroy(),this.sourcemapConsumer=void 0,this.tsOuput=t,e.isJavascript()){t.linterErrors=t.linterErrors||[];var i=t.linterErrors.map(e=>({startLineNumber:e.line,endLineNumber:e.endLine||e.line,startColumn:e.column,endColumn:e.endColumn||e.column,message:`${e.message} (${e.ruleId})`,severity:monaco.MarkerSeverity.Warning,source:"ESLint"}));monaco.editor.setModelMarkers(this.editor.getModel(),"eslint",i)}if(this.sourcemapConsumer=yield this.applySourcemap(),!!this.isBreakPointsLoaded)this.updateBreakPoints(this.jsBreakPointsState);else if(this.isBreakPointsLoaded=!0,a.getCurrentSI().canPlaceBreakPoints()&&!M()&&this.loadBreakPointsFromServer("sys_script_include.script"),a.isServiceNow()&&!e.isNew()){const t=s.default(),i="script_id="+e.sys_id;let n=-1;t.initChannel("sys_js_breakpoint",i).subscribe(()=>{-1!=n&&clearTimeout(n),n=self.setTimeout(()=>{this.loadBreakPointsFromServer("sys_script_include.script")},5e3)})}this.cb(t)})}convertLineNoFromTStoJS(e){if(!window.recordConfig.isES6)return Promise.resolve(e);if(!this.sourcemapConsumer)return Promise.resolve(e);let t=[];var i=a.getCurrentSI();let n="point.js";i.isTypescript()&&(n="point.ts");for(let i of e){let e=this.sourcemapConsumer.generatedPositionFor({source:n,line:i,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});e&&e.line&&t.push(e.line)}return Promise.resolve(t)}convertLineNoFromJSToTS(e){if(!window.recordConfig.isES6)return Promise.resolve(e);if(!this.sourcemapConsumer)return this.tsBreakPointState=this.jsBreakPointsState,Promise.resolve(e);let t=[],i={debugpoints:{BREAKPOINT:{}},key:this.jsBreakPointsState&&this.jsBreakPointsState.key};for(let n of e){let e=this.sourcemapConsumer.originalPositionFor({line:n,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});e&&e.line&&(i.debugpoints.BREAKPOINT[e.line]=this.jsBreakPointsState&&this.jsBreakPointsState.debugpoints.BREAKPOINT&&this.jsBreakPointsState.debugpoints.BREAKPOINT[n],t.push(e.line))}return this.tsBreakPointState=i,Promise.resolve(t)}applySourcemap(){if("undefined"==typeof sourceMap)return Promise.resolve(void 0);if(!this.tsOuput.sourceMap)return Promise.resolve(void 0);var e=new sourceMap.SourceMapConsumer(JSON.parse(this.tsOuput.sourceMap));return e}}class J extends U{constructor(e,t,i=!1,n="",s="",r=!1){super(e,t,i,n,s,r),this.registerForRun(),a.loadJSXIntellisense()}registerForRun(){var e=document.getElementById(i.EL_SCRIPT_RUNNER);e.addEventListener("click",()=>{this.renderOutput()})}onContentChanged(t){return this.handleJSXChanges()}triggerCompilation(){return a.isSeismicComponent()?Promise.resolve(this.handleJSXChanges()):Promise.resolve()}renderOutput(){let e=this.jsxValue;window.getComponent=function(){return e},jQuery("a[href=\"#script-output\"]").tab("show");var t=jQuery("#"+i.EL_SCRIPT_OUTPUT),n=document.createElement("iframe");n.id="seismic_host",n.style.width="100%",n.style.height="100%",n.style.border="1px solid darkgray",n.src=a.isServiceNow()?`seismic.do?cache=${Date.now()}`:"./seismic/seismic.html",t.html(n)}handleJSXChanges(){localStorage.setItem(u,this.editor.getModel().getValue()),monaco.languages.typescript.getTypeScriptWorker().then(e=>{e(this.model.uri).then(e=>{let i=e.getEmitOutput(this.model.uri.toString());i.then(e=>e.emitSkipped?void t().then(()=>{},()=>{console.log("Error while compiling")}):void e.outputFiles.forEach(e=>{e.name.endsWith(".js")&&(this.jsxValue=e.text,this.jsInstance&&this.jsInstance.updateModelContent(e.text))}))})})}}let W=document.getElementById(i.EL_THEME_SELECT);var K=!0;let z=-1;var G={startDebugger:function(){var e;return"undefined"==typeof window.top.launchScriptDebugger?window.top.opener&&window.top.opener.top.launchScriptDebugger&&(e=window.top.opener.top.launchScriptDebugger):e=window.top.launchScriptDebugger,"undefined"!=typeof e&&"undefined"!=typeof g_form?void e(g_form.getUniqueValue(),g_form.getTableName()):"undefined"==typeof g_form?void A():void A(g_form.getUniqueValue(),g_form.getTableName())},saveSI:function(e){-1==z&&e&&(z=self.setTimeout(()=>{z=-1},60000),N("You can use ` CMD/CTRL + s ` keyboard shorcut to save the script. It's pretty handy!","info",1e4)),e||(e=document.getElementById("codenow.savesi"));var t=jQuery(e),i=t.find(">i");return t.attr("disabled","disabled"),i.removeClass("hide"),l(!0).then(e=>{let n=r.ClientSIRecordData.getClassConstructorFormat(a.getCurrentSI()),s={js:n,decl:e.backEndDecl,esNext:e.tsScript,sourceMap:e.sourceMap};var o={contentType:"application/json",data:JSON.stringify(s),headers:{X_UserToken:window.g_ck},method:"POST",type:"POST",url:"/api/now/typescript_helpers/UpdateSI"};jQuery.ajax(o).done(()=>{t.removeAttr("disabled"),i.addClass("hide"),P=0,N("Updated successfully","info")}).fail(()=>{F(t,i,jQuery("#fail_modal"))})},e=>{N(e,"error"),t.removeAttr("disabled"),i.addClass("hide")}),!1},toggleLinter:function(){o.default.linter=!o.default.linter,monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:o.default.linter,noSyntaxValidation:o.default.linter}),x()},updateAllSIDeclaration:function(e,t=!1){function i(e){if(0==e.length)return void F(n,s,jQuery("#success_modal"));if(a.isServiceNow()){let i={url:"/api/now/typescript_helpers/updateMultiSIDecl",type:"POST",data:e,headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}};t&&(i.url="/api/now/table/ts_definition/b4c6d3500ba213008e64aabcb4673a6c",i.type="put",i.data=JSON.stringify({json_value:e})),jQuery.ajax(i).done(e=>{F(n,s,jQuery("#success_modal")),console.log(e)}).fail(()=>{F(n,s,jQuery("#fail_modal"))})}}var n=jQuery(e),s=n.find(">i");n.attr("disabled","disabled"),s.removeClass("hide");let o="";o=t?"/api/now/table/sys_script_include?&sysparm_query=active=true":"/api/now/typescript_helpers/getOutOfSyncSI",a.isServiceNow()||(o="/scripts/sys_script_include.json");var p=new a.RecordFetcher(o);p.fetch().then(e=>{var t=jQuery("#UpdateSI");if(0==e.length)return F(n,s,jQuery("#success_modal")),void t.text("Update Scripts");if(!window.recordConfig.useTypeChecker){var o=r.parseSI(e,esprima),p=JSON.stringify({api:JSON.parse(o.getFormat(!0))}),l=o.getParsingErrors(),d=o.getEmptyDeclarations();l.forEach(e=>{console.error("Parsing error for => "+e)}),d.forEach(e=>{console.error("empty declaration for "+e)}),i(p)}else{window.onSIParserProgressEvent=function(e,i){t.text("Updating ... "+i+" %")};let s=a.generateTypeDeclarations(e);s.then(e=>{var n=JSON.stringify({api:e.formatterResult});i(n),console.log("type checker parser results came "),e.errors&&0<e.errors.length&&e.errors.forEach(e=>{console.log("parsing error "+e)}),t.text("Update Scripts")},()=>{n.removeAttr("disabled"),t.text("Try again")}),console.log("parsing done")}},e=>{alert("unable to fetch the script include with error "+e)})},updateTableDeclarations:function(e){var t=jQuery(e),i=t.find(">i");t.attr("disabled","disabled"),i.removeClass("hide");jQuery.ajax({url:"/api/now/typescript_helpers/updatetabledefinition",type:"post",data:JSON.stringify({}),headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}}).done(e=>{F(t,i,jQuery("#success_modal")),console.log(e)}).fail(()=>{F(t,i,jQuery("#fail_modal"))})},openNewWindow:function(){window.open(location.href)},updateOnSave:function(){return window.recordConfig.isES6?("undefined"!=typeof g_form&&g_form.addErrorMessage("With ES6, save is not possible use \"CMD + s\" keyboard short cut","error_message_es6_save"),!1):m(!1,window.recordConfig.useTypeChecker,!0,function(){let e=window.recordConfig;e.isNewRecord?gsftSubmit(void 0,void 0,"sysverb_insert"):gsftSubmit(void 0,void 0,g_form.getActionName())},function(){})},updateDecl:function(e,t){var i=jQuery(e),n=i.find(">i");return i.attr("disabled","disabled"),n.removeClass("hide"),m(t,!0,!1,function(){F(i,n,jQuery("#success_modal"))},function(){F(i,n,jQuery("#fail_modal"))})},onCompilerSettingsChange(e){var t=e.closest("li");let i=t.dataset.key;i&&(j[i]=!j[i],j[i]?jQuery(t).find(".state-icon").removeClass("glyphicon-unchecked").addClass("glyphicon-check"):jQuery(t).find(".state-icon").removeClass("glyphicon-check").addClass("glyphicon-unchecked"),x())},onTargetChange:function(e,t){let i=parseInt(t);j.target=i,x()},onJSXChange:function(e,t){let i=parseInt(t);return j.jsx=i,a.loadJSXIntellisense(),x()},onAddTab:function(e=!0){O.addFile(e)},onRemoveTab:function(e){O.removeFile(e),console.log(`${e} removed`)},onSelectTab:function(e){O.selectFile(e)},initialize:function(){_()}};return G}Object.defineProperty(t,"__esModule",{value:!0}),i=__importStar(i),s=__importDefault(s),a=__importStar(a),r=__importStar(r),o=__importDefault(o);var c=a.TranspilerOutput;const u="last_monaco_script";t.initMainEditor=l,a.isMainThread()&&window.recordConfig&&(window.settings=l())});