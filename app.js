define("scripts/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e.javascript="javascript",e.typescript="typescript"})(i=t.LangType||(t.LangType={})),t.GLOBAL_SOCPE="global",t.JAVA_GLOBAL_API="JavaGlobalAPI.d.ts",t.JAVA_SCOPE_API="JavaScopeAPI.d.ts",t.TABLE_API="TableAPI.d.ts",t.JS_API="JSAPI.d.ts",t.TYPE_DEFS="sn_typedef.d.ts",t.CURRENT_API="CurrentAPI.d.ts",t.libES5Path="vs/language/typescript/lib/lib-ts",t.libES6Path="vs/language/typescript/lib/lib-es6-ts",t.TS_DECLARATION="ts_definition",t.DECLARATION_DATA_PATH="../scripts/metadata/snapi.json",t.DECLARATION_TABLE_PATH="/api/now/table/ts_definition",t.FIELD_DECLARATION="typedeclaration",t.FIELD_SOURCEMAP="typesourcemap",t.FIELD_TS_SCRIPT="tsscript",t.FIELD_SCRIPT="script",t.EL_TS_EDITOR="ts_editor",t.EL_JS_EDITOR="js_editor",t.EL_TS_DECL="ts_decl",t.EL_TS_SOURCEMAP="ts_sourcemap",t.EL_THEME_SELECT="themeselect",t.EL_SCOPE_SELECT="scope-select",t.EL_SCRIPT_RUNNER="script-runner",t.EL_SCRIPT_OUTPUT="script-output";var n;(function(e){e.sys_script_include="sys_script_include",e.ts_definition="ts_definitions"})(n=t.TableNames||(t.TableNames={}))}),define("scripts/eslintConfig",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(function(e){e[e.off=0]="off",e[e.warn=1]="warn",e[e.error=2]="error"})(i=t.ruleSetting||(t.ruleSetting={})),t.eslintConfig={parserOptions:{ecmaVersion:5,sourceType:"script",ecmaFeatures:{}},rules:{"constructor-super":2,"for-direction":2,"getter-return":2,"no-case-declarations":2,"no-class-assign":2,"no-compare-neg-zero":2,"no-cond-assign":2,"no-console":2,"no-const-assign":2,"no-constant-condition":2,"no-control-regex":2,"no-debugger":2,"no-delete-var":2,"no-dupe-args":2,"no-dupe-class-members":2,"no-dupe-keys":2,"no-duplicate-case":2,"no-empty":2,"no-empty-character-class":2,"no-empty-pattern":2,"no-ex-assign":2,"no-extra-boolean-cast":2,"no-extra-semi":2,"no-fallthrough":2,"no-func-assign":2,"no-global-assign":2,"no-inner-declarations":2,"no-invalid-regexp":2,"no-irregular-whitespace":2,"no-mixed-spaces-and-tabs":2,"no-new-symbol":2,"no-obj-calls":2,"no-octal":2,"no-redeclare":2,"no-regex-spaces":2,"no-self-assign":2,"no-sparse-arrays":2,"no-this-before-super":2,"no-unexpected-multiline":2,"no-unreachable":2,"no-unsafe-finally":2,"no-unsafe-negation":2,"no-unused-labels":2,"no-unused-vars":2,"no-useless-escape":2,"require-yield":2,"use-isnan":2,"valid-typeof":2,semi:2,"semi-spacing":2,"semi-style":2,eqeqeq:2,"eol-last":2,"default-case":2,"consistent-return":2,camelcase:2,"no-else-return":2,"no-eq-null":2,"no-eval":2,"no-extend-native":2,"no-extra-bind":2,"no-self-compare":2,"no-unused-expressions":2},env:{browser:!0}}});var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t};define("scripts/siParser",["require","exports","scripts/eslintConfig"],function(e,t,i){"use strict";function n(){var e=/\`(.*?)(\$\$\{[^\{]+(?=\})\})(.*?)\`/g;return e}function s(e,t){var i=m.declare+m.space+m.namespace+m.space+t+m.blockOpen+m.newline;return i+=e+m.newline+m.blockClose,i}function a(e,t){var i=m.interface+m.space+t+m.blockOpen+m.newline;return i+=e,i+=m.newline+m.blockClose,i}function o(e,t,n){function s(e){return!(e.type!=u.ExpressionStatement)&&!(e.expression.type!=u.AssignmentExpression)&&e.expression.left.property&&e.expression.left.property.name=="prototype"}var a=p(e,t,n,!1),r=n.split(".");n=r[r.length-1];for(var o=0,l;o<t.body.length;o++)if(l=t.body[o],l.type==u.VariableDeclaration){if(1==l.declarations.length&&l.declarations[0].id.name!=n){t.body[o]=null;continue}for(var d=0;d<l.declarations.length;d++)l.declarations[d].id.name!=n&&(l.declarations[d]=null)}else if(l.type==u.FunctionDeclaration){if(l.id.name!=n){t.body[o]=null;continue}}else if(s(l))l.expression.left.object.name!=n&&(t.body[o]=null);else if(l.type==u.ExpressionStatement&&l.expression&&l.expression.type==u.CallExpression){if(l.expression.callee&&l.expression.callee.object&&"gs"==l.expression.callee.object.name&&"include"==l.expression.callee.property.name){t.body[o]=null;continue}}else if(l.type==u.ExpressionStatement&&l.expression.type==u.AssignmentExpression){if(l.expression.left.type==u.Identifier&&l.expression.left.name==n)continue;if(l.expression.left.type!=u.MemberExpression){t.body[o]=null;continue}if(l.expression.left.object&&l.expression.left.object.name!=n){t.body[o]=null;continue}}}function p(e,t,n,s){function a(e){if(!s)return{fieldType:m.any,paramTypes:{},returnType:m.any};e="/*"+e+"*/";var t=m.any,i=m.any,n={},a=e.split("\n"),r=a.map(function(e){return e.trim()}),o;if(o=D.parse(r.join("\n")),0<o.length)for(var p=o[0],l=0,d=p.tags,c;l<d.length;l++)if(c=d[l],c.type&&0!=c.type.length){var g=c.tag;"param"==g?n[c.name]=c.optional?"?: "+c.type:": "+c.type:"returns"==g||"return"==g?i=c.type:"type"==g&&!!c.type&&(t=c.type)}return{fieldType:t,paramTypes:n,returnType:i}}function r(e){for(var t=[],n=0,r;n<e.length;n++)if(r=e[n],r.type==u.ExpressionStatement&&r.expression&&r.expression.type==u.AssignmentExpression&&"="==r.expression.operator&&r.expression.left&&r.expression.left.type==u.MemberExpression&&r.expression.left.object&&r.expression.left.object.type==u.ThisExpression){var o={fieldType:m.any,paramTypes:{},returnType:m.any};if(s&&!!r.leadingComments&&0<r.leadingComments.length){var p=r.leadingComments[0].value;o=a(p)}var l="",d=m.any;r.expression.left.property.type==u.Identifier?(l=r.expression.left.property.name,r.expression.right.type==u.Literal&&(d=typeof r.expression.right.value)):r.expression.left.property.type==u.Literal&&(l=r.expression.left.property.value,r.expression.right.type==u.Literal&&(d=typeof r.expression.right.value)),s&&o.fieldType!=m.any&&(d=o.fieldType);var c={name:l,value:d};t.push(c)}return t}void 0===s&&(s=!1);var o="",p=new I(e,n);return{getMetaInfo:function(){return p},getSimpleName:function(){var e=n.split(".");return 0==e.length?"":e[e.length-1]},isSingleFunctionExported:function(e,t,i){return!(e.type!=i||1!=t.body.length)||this.isAnonymousTypeExported(e,t,u.FunctionExpression)},isAnonymousTypeExported:function(e,t,i){var s=n.split("."),a=s[s.length-1];return!(e.type!=u.VariableDeclaration&&e.type!=u.ExpressionStatement||e.type!=u.ExpressionStatement||e.expression.type!=u.AssignmentExpression||e.expression.left.type!=u.Identifier||e.expression.left.name!=a||e.expression.right.type!=i)},anonymousDeclaration:function(t,s,r){var l=r.split("."),d=l[l.length-1],c="";if(t.type==u.VariableDeclaration||t.type==u.ExpressionStatement){if(t.type==u.ExpressionStatement&&t.expression.type==u.AssignmentExpression&&t.expression.left.type==u.Identifier&&t.expression.left.name==d){if(this.isAnonymousTypeExported(t,s,u.CallExpression)){o=d;var g=this.getBaseClassInfo();return c=m.class+m.space+d,g.name&&(c+=m.space+m.extends+m.space+g.name,p.setBaseName(g.name)),c+=m.blockOpen+m.newline,c}if(this.isAnonymousTypeExported(t,s,u.ObjectExpression));else if(this.isAnonymousTypeExported(t,s,u.FunctionExpression)){console.log("anonymous function expression");for(var f=m.function+m.space+this.getSimpleName(),y=t.expression.right.params,h=m.functionOpen,C=0;C<y.length;C++)h+=y[C].name+m.colon+m.any,C!=y.length&&(h+=m.comma);return h+=m.functionClose,p=new A(e,n,h),m.function+m.space+this.getSimpleName()+h+m.semicolon}}}else if(this.isSingleFunctionExported(t,s,u.FunctionDeclaration)){var T={fieldType:m.any,paramType:{},returnType:m.any};if(t.leadingComments&&1==t.leadingComments.length){var _=t.leadingComments[0].value;T=a(_),T.paramTypes}for(var f=m.function+m.space+t.id.name,h=m.functionOpen,S=0;S<t.params.length;S++)h+=t.params[S].name,T.paramTypes&&T.paramTypes[t.params[S].name]&&(h+=T.paramTypes[t.params[S].name]),S!=t.params.length-1&&(h+=m.comma);return h+=m.functionClose,!T.returnType||T.returnType==m.any||(h+=m.colon+m.space+T.returnType),p=new A(e,n,h),f+=h,f+=m.semicolon,f}return""},isPrototype:function(e){return!(e.type!=u.ExpressionStatement)&&!(e.expression.type!=u.AssignmentExpression)&&!!e.expression.left.object&&!!(e.expression.left.object&&e.expression.left.object.name==o)&&!!(e.expression.left.property&&"prototype"==e.expression.left.property.name)},FunctionDeclaration:function(e){var t=this.getBaseClassInfo();if(!t.name)return o=e.id.name,m.class+m.space+e.id.name+m.space+m.blockOpen},VarialbeDeclarator:function(e){return o=e.id.name,m.class+m.space+e.id.name},getBaseClassInfo:function(){for(var e=0,n;e<t.body.length;e++)if(n=t.body[e],n&&this.isPrototype(n,null)){if(n.expression.right.type==u.ObjectExpression)return{name:void 0,properties:n.expression.right.properties};if(n.expression.right.type==u.CallExpression){var s=n.expression.right.arguments[0],a="";if(s.type==u.Identifier?a=s.name:s.type==u.MemberExpression&&(a=s.object.name+"."+s.property.name),!!a){var r=n.expression.right.arguments,o=[];2<=r.length&&r[1].properties&&(o=r[1].properties);var p=a.split(".");return 1<p.length&&p[1]==m.prototype_1&&(a=p[0]),{name:a,properties:o}}}break}return{}},isObjectDeclaration:function(e){if(!e)return!1;if(e.kind!=k.var)return e.type==u.ExpressionStatement&&e.expression.right&&e.expression.right.type&&e.expression.right.type==u.ObjectExpression;for(var t=0,n;t<e.declarations.length;t++)return n=e.declarations[0],n.init.type==u.ObjectExpression},VariableDeclaration:function(t){var s=t.kind==k.var,a=this.isObjectDeclaration(t);if(t.kind!=k.var&&!a)return void console.log("not defined");if(!s&&a){var o=this.formatObjectExpression(t.expression.right.properties,!0,!1);return o=m.var+m.space+t.expression.left.name+m.colon+m.space+o,o}for(var l=0,d;l<t.declarations.length;l++){if(d=t.declarations[0],d.init.type==u.ObjectExpression){var o=this.formatObjectExpression(d.init.properties,!0,!1);return p=new b(e,n,o),o=m.var+m.space+d.id.name+m.colon+m.space+o,o}var c=this.VarialbeDeclarator(t.declarations[l],t);c+=m.space;var g=this.getBaseClassInfo();return g.name&&(c+=m.extends+m.space+g.name+m.space,p.setBaseName(g.name)),c+=m.blockOpen,c}},ExpressionStatement:function(t,i){var s=t.expression;if(s.type==u.AssignmentExpression){var a=this.isAnonymousTypeExported(t,i,u.ObjectExpression),r=this.isAnonymousTypeExported(t,i,u.FunctionExpression);if(a){var o=this.formatObjectExpression(s.right.properties,!1,!1),l=m.blockOpen+m.newline;return l+=o+m.blockClose,p=new b(e,n,l),""}if(r);return this.MemberExpression(s,t)}},AssignmentExpression:function(){console.log("assignment expression")},FunctionExpression:function(e,t){if(!(e.left.property||e.left.name))return"";var n={};t&&t.leadingComments&&0<t.leadingComments.length&&(n=a(t.leadingComments[0].value));var s="";s=e.left.property?e.left.property.name:e.left.name,s+=m.functionOpen;for(var r=0;r<e.right.params.length;r++){var o=e.right.params[r].name,p=m.any;n.paramTypes&&n.paramTypes[o]?(p=n.paramTypes[o],s+=e.right.params[r].name+p):s+=e.right.params[r].name+m.colon+p,r!=e.right.params.length-1&&(s+=m.comma)}return s+=m.functionClose,n.returnType&&n.returnType!=m.any&&(s+=m.colon+n.returnType),s+=m.semicolon,s},MemberExpression:function(e,t){var n=e.left.object&&e.left.object.name===o,s=e.left.property&&e.left.property.name,r={};t&&t.leadingComments&&0<t.leadingComments.length&&(r=a(t.leadingComments[0].value));var l="";n&&(l=m.static+m.space);var d=e.right.type==u.FunctionExpression;l+=d?this.FunctionExpression(e,t):s+m.colon;var c=m.any;if(e.right.type==u.Literal){var g=typeof e.right.value;g!=m.function&&(c=g),!r.fieldType||(c=r.fieldType)}else{if(e.right.type==u.ObjectExpression)return r.fieldType?c=r.fieldType:(c=this.formatObjectExpression(e.right.properties),!s&&(l=m.var+m.space+e.left.name+m.colon+m.space),c="{\n"+c+"}"),p.addField(s,c,n,!1),l+c+";\n";if(e.right.type==u.ArrayExpression)c="Array<any>";else{if(e.right.type==u.FunctionExpression){for(var f=e.right.params,y=m.functionOpen,h=0;h<f.length;h++)y+=f[h].name,!r.paramTypes||!r.paramTypes[f[h].name]||(y+=r.paramTypes[f[h].name]),h!=f.length-1&&(y+=m.comma);return y+=m.functionClose,r.returnType&&r.returnType!=m.any&&(y+=m.colon+r.returnType),p.addField(s,y,!0,!0),console.log("static function found"),l}if(e.right.type==u.NewExpression||e.right.type==u.CallExpression){var C={};t&&t.leadingComments&&0<t.leadingComments.length&&(C=a(t.leadingComments[0].value)),!C.fieldType||(c=C.fieldType)}else console.log("Literal not found")}}return l+=c+m.semicolon,p.addField(s,c,n,!1),l},formatObjectExpression:function(e,t,s){if(void 0===t&&(t=!1),void 0===s&&(s=!1),!e)return"";for(var o=t?"{\n":"",l=0;l<e.length;l++){var d=e[l],c=d.key.name||d.key.value,g=c;d.key.name?(o+=c,g=c):(o+=d.key.raw,g=d.key.raw);var f="initialize"==c&&s&&d.value.type==u.FunctionExpression,y="",h=m.any,C=!1,T={},_="",S=m.any,b=void 0;if(d.leadingComments&&0!=d.leadingComments.length&&(b=a(d.leadingComments[0].value),S=b.fieldType,_=b.returnType,T=b.paramTypes),d.value.type==u.NewExpression||d.value.type==u.CallExpression)h=S,o+=m.colon+m.space+S;else if(d.value.type==u.Literal){var A=typeof d.value.value;h=A,o+=m.colon+m.space+A}else if(d.value.type==u.ObjectExpression){if(S==m.any){var I=this.formatObjectExpression(d.value.properties,!0);h=I,o+=m.colon+m.space+I}else h=S,o+=m.colon+m.space+S;}else if(d.value.type==u.FunctionExpression){C=!0;for(var x=d.value.params,E=0,M;E<x.length;E++)M=x[E].name,y+=M,T[M]&&(y+=T[M]),E!=x.length-1&&(y+=m.comma);if(y=m.functionOpen+y+m.functionClose,(0<_.length&&_!=m.any||!s)&&(s?y+=m.colon+_:(y+=m.arrow,y+=_?_:m.any)),y=N[n+"."+c]||y,s?o+=y:(o+=m.colon+m.space,o+=y),f){p.setConstructor(y);for(var F=r(d.value.body.body),k=0,D=F,v;k<D.length;k++)v=D[k],p.addField(v.name,v.value,!s,!1)}h=y}else d.value.type==u.ArrayExpression?(o+=m.colon+m.space+"Array<any>",h="Array<any>",S!=m.any&&(h=S)):o+=m.colon+m.space+m.any;s?o+=m.semicolon:l!=e.length-1&&(o+=m.comma),s&&p.addField(g,h,!s,C),o+=m.newline,f&&s&&(o+="\nconstructor",o+=y,o+=";",o+=m.newline)}return t&&(o+=m.blockClose),o},prototypeExpression:function(){var e=this.getBaseClassInfo();return this.formatObjectExpression(e.properties,void 0,!0)}}}function l(e,t,n,s,a){void 0===a&&(a=!1);var l=n.split("."),d=l[l.length-1],c=s.parse(t,{attachComment:!0}),g=p(e,c,n,a),f="";o(e,c,n);for(var y=g.isObjectDeclaration(c.body[0]),h=!0,C=!1,T=0,_,S;T<c.body.length;T++)if(S=c.body[T],S){if("undefined"==typeof g[S.type]){console.log("not defined");continue}var b="";if(h&&(h=!1,b=g.anonymousDeclaration(S,c,n),C=g.isSingleFunctionExported(S,c,u.FunctionDeclaration),b)){f+=b;continue}b=g.isPrototype(S,null)?g.prototypeExpression(S,c):g[S.type](S,c),b&&(f+=b+m.newline)}return _=g.getMetaInfo(),0==f.length?console.log("empty came"):!y&&!C&&(f+=m.blockClose),{strFormat:f,metaInfo:_}}function d(e){var t="";for(var n in e){t+="declare namespace "+n+" {\n";for(var s=e[n],a="",r=0,o;r<s.length;r++)o=s[r],t+=o.declaration,t+="\n";t+="}\n",t+=a+m.newline}return t}function c(e,t,n,s){void 0===n&&(n={}),void 0===s&&(s=!1);var a=[],r={},o=[],p=[];({})["global.StorageDataSize"]=!0;for(var c=0,g;c<e.length;c++)if(g=new C(e[c]),!n[g.sys_id]&&(g.api_name=g.api_name.trim(),!(0<=f[g.api_name]))){console.log("parsing "+g.api_name);var u="",m=g.api_name.split(".");r[m[0]]||(r[m[0]]=[]);var y=r[m[0]];try{var h=l(g,g.script,g.api_name,t,s||!!g.jsdoc);u=h.strFormat,h.metaInfo.setAccessType(g.access),h.metaInfo.setSysId(g.sys_id),a.push(h.metaInfo),u||(p.push(g.api_name),console.log("Empty declaration => "+g.api_name)),y.push(new x(g.api_name,g.sys_scope.value,u,g.access,g.sys_id))}catch(t){o.push(g.api_name),console.log(" parsing error for => "+g.api_name)}}for(var T=d(r),_=new F,S=0,b=a,A;S<b.length;S++)A=b[S],_.addType(A.exportToTS());return{getFormat:function(e){return void 0===e&&(e=!1),e?_.exportJSON():_.emit()},getParsingErrors:function(){return o},getEmptyDeclarations:function(){return p}}}Object.defineProperty(t,"__esModule",{value:!0}),i=__importStar(i);var g;(function(e){e.never="never",e["var"]="var",e.fun="fun",e.cls="cls"})(g=t.JSExportedTypes||(t.JSExportedTypes={}));var f;(function(e){e[e["global.Class"]=1]="global.Class",e[e["global.PrototypeServer"]=2]="global.PrototypeServer",e[e["global.CIIdentifier"]=3]="global.CIIdentifier",e[e["global.KBProperty"]=4]="global.KBProperty",e[e["global.KBUtils"]=5]="global.KBUtils",e[e["global.Workflow"]=6]="global.Workflow",e[e["global.StorageDataSize"]=7]="global.StorageDataSize",e[e["global.DevExHelpers"]=8]="global.DevExHelpers"})(f=t.BlockedSI||(t.BlockedSI={}));var u;(function(e){e.VariableDeclaration="VariableDeclaration",e.VariableDeclarator="VariableDeclarator",e.ExpressionStatement="ExpressionStatement",e.AssignmentExpression="AssignmentExpression",e.Literal="Literal",e.Identifier="Identifier",e.FunctionDeclaration="FunctionDeclaration",e.FunctionExpression="FunctionExpression",e.ObjectExpression="ObjectExpression",e.CallExpression="CallExpression",e.MemberExpression="MemberExpression",e.ArrayExpression="ArrayExpression",e.NewExpression="NewExpression",e.ThisExpression="ThisExpression"})(u=t.ExpressionType||(t.ExpressionType={}));var m;(function(e){e.namespace="namespace",e["import"]="import",e["export"]="export",e["class"]="class",e["interface"]="interface",e.space=" ",e.startString="\"",e.endString="\"",e["new"]="new",e.prototype_1="prototype",e.newline="\n",e.tab="\t",e.blockOpen="{",e.blockClose="}",e["static"]="static",e.colon=":",e.semicolon=";",e.any="any",e.boolean="boolean",e.number="number",e.object="object",e.string="string",e.undefined="undefined",e["function"]="function",e.functionOpen="(",e.functionClose=")",e.comma=",",e.dot=".",e["extends"]="extends",e["implements"]="implements",e.constructor="new",e.typeAdd="Constructor",e["var"]="var",e.equal="=",e.declare="declare",e["const"]="const",e.arrow="=>"})(m=t.TokenType||(t.TokenType={}));var y;(function(e){e["public"]="public",e.package_private="package_private"})(y=t.SIAccessType||(t.SIAccessType={}));var h;(function(e){e.read="read",e["protected"]="protected",e.nil=""})(h=t.SISysPolicy||(t.SISysPolicy={}));t.ERROR_MSG="Errors in the source files, use 'F8' or 'shift + F8' to navigate errors in editor",t.getDotWalkingRegExp=n;var C=function(){function e(e,t){void 0===t&&(t=!1),this.isNewRecord=t,this.access=y.public,this.active=!1,this.jsdoc=!1,this.api_name="global",this.client_callable=!1,this.description="",this.name="",this.script="",this.script_type="",this.sys_class_name="",this.sys_updated_by="",this.sys_created_on="",this.sys_id="",this.sys_mod_count=0,this.sys_name="",this.sys_package={link:"",value:""},this.sys_policy=h.nil,this.sys_scope={link:"",value:""},this.sys_tags="",this.sys_update_name="",this.sys_created_by="",this.sys_updated_on="",this.tsscript="",this.typedeclaration="",this.typesourcemap="",this.parseReturnType=!0,this.isDirty=!1,this.parseReturnType=!0,!e||(!e.tsscript&&(e.tsscript=e.script),this.copy(e)),0==this.sys_id.length&&(this.sys_id="yln")}return e.prototype.canPlaceBreakPoints=function(){return!this.isNewRecord},e.prototype.isGlobalScope=function(){return"global"==this.getScopeAndAPIMap().scope},e.convertToJSConstructor=function(t){if(t.isJavascript()){var i=t.tsscript.split("\n"),n=t.getScopeAndAPIMap(),s=i.findIndex(function(e){if(0>e.indexOf("Class.create()"))return!1;var t=e.split(" "),i=t.filter(function(e){return 0<e.trim().length});return 4==i.length&&(i=i.map(function(e){return e.trim()}),"var"==i[0]&&i[1]==n.name&&"="==i[2]&&"Class.create();"==i[3])});-1==s||(e.isClsFound=!0,i[s]="function "+n.name+"() { }",t.tsscript=t.script=i.join("\n"))}},e.getClassConstructorFormat=function(t){if(t.isTypescript())return t.script;if(!e.isClsFound)return t.tsscript;var i=t.getScopeAndAPIMap(),n=t.tsscript.split("\n"),s=n.findIndex(function(e){return!!e.trim().startsWith("function "+i.name+"() { }")});return-1==s?t.tsscript:(n[s]="var "+i.name+" = Class.create();",n.join("\n"))},e.prototype.getScopeAndAPIMap=function(){var e=this.api_name.split("."),t=e[0],i=2==e.length?e[1]:"";return{scope:t,name:i}},e.prototype.isTypescriptWithJSStyle=function(){return!1},e.prototype.isJavascript=function(){return 0==this.script_type.length||"javascript"==this.script_type||"js"==this.script_type},e.prototype.isTypescript=function(){return"typescript"==this.script_type||"ts"==this.script_type},e.prototype.containsTemplateExpression=function(){var e=n();return e.test(this.tsscript)},e.prototype.generateCurrentSIDeclaration=function(e,t){if(void 0===t&&(t=!1),this.isTypescript())return"";var i=this.generateDeclaration(e,t),n=i.getFormat(!0),r=JSON.parse(n),o=this.api_name.split("."),p=o[0],l=o[1],d="\""+l+"\":"+this.api_name+"Constructor",c=a(d,"JSTypes"),g=s(r[p][0].typeFormat+"\n"+r[p][0].aliasFormat,p);return g+"\n"+c},e.prototype.formatCurrentSITSFormat=function(e){var t=this.api_name.split("."),i=s(e.tf+"\n\n"+e.af,t[0]);return i},e.prototype.generateDeclaration=function(e,t){return void 0===t&&(t=!1),this.canGenerateDeclaration()||new Error("declaration is not possible"),c([this],e,{},t)},e.prototype.updateTSScript=function(e){this.tsscript=e},e.prototype.updateScript=function(e){this.script=e},e.prototype.updateDeclaration=function(e){this.typedeclaration=e},e.prototype.updateJSDoc=function(e){this.jsdoc=e},e.prototype.updateSourcemap=function(e){this.typesourcemap=e},e.prototype.isUpToDate=function(){return!this.isDirty},e.prototype.setDirtyState=function(e){this.isDirty=e},e.prototype.canGenerateDeclaration=function(){if(this.isNew())return console.log("generating declaration without apiname not possible"),!1;if(this.isTypescript())return console.log("generating typescript is automatic"),!1;if(0==this.script.length)return console.log("declaration not possible for empty script"),!1;if(0==this.api_name.length)return!1;var e=this.api_name.split(".");return 2==e.length},e.prototype.isNew=function(){return"undefined"==typeof window?"global"==this.api_name||0!=this.api_name.length&&0==this.sys_id.length:window.recordConfig.isNewRecord},e.prototype.formatForAddLib=function(e,t){t=t||e.api.split(".")[0];var i={};i[t]=[e];var n=new M(i);return n.emit(t)},e.prototype.updateAPIName=function(e){return 0==e.length?console.log("API name should not be empty"):void(this.api_name=e)},e.prototype.updateSysId=function(e){this.sys_id=e},e.prototype.updateAccessType=function(e){this.access=e},e.prototype.updateLangType=function(e){this.script_type=e?e:"javascript"},e.prototype.emitTSDeclaration=function(e){var t=/declare class/gi,i=/declare function/gi,n=/declare enum/gi,s=/declare var/gi,a=/declare const/gi,r=0<=e.search(t),o=0<=e.search(i),p=0<=e.search(n),l=0<=e.search(s);e=e.replace(t,m.class),e=e.replace(i,m.function),e=e.replace(n,"enum"),e=e.replace(s,"var"),e=e.replace(a,"const"),e=e.replace("/// <reference types=\"snlib\" />","");var d="",c=this.getScopeAndAPIMap(),f=c.scope,u=c.name||"Point";d=this.isNew()?this.api_name+"_"+u+"":this.api_name.replace(".","_")+"";var y=m.export+m.space+m.import+m.space+u+m.space+m.equal;y+=m.space+f+m.dot+d+m.dot+u+m.semicolon;var h=m.import+m.space+u+m.space+m.equal;h+=m.space+f+m.dot+d+m.dot+u+m.semicolon,h="";var C=m.namespace+m.space+d+m.space+m.blockOpen+m.newline;C+=e+m.newline+m.blockClose+m.newline;var T=new _(u,this.sys_id,C,y,h,this.access,g.cls,0),S={api:u,id:this.sys_id,f:0,tf:C};return _.updateFlags(S,this,g.cls),S},e.fromSIRec=function(t){var i=new e(void 0,!1);for(var n in t)i[n]=t[n].value;i.active="1"==t.active.value,i.jsdoc=window.recordConfig.useTypeChecker;var s=new e(void 0,window.recordConfig.isNewRecord);return s.copy(i),s},e.prototype.copy=function(e){this.parseReturnType=e.parseReturnType,this.access=e.access,this.active="true"==e.active+"",this.api_name=e.api_name,this.jsdoc="true"==e.jsdoc+"",this.client_callable="true"==e.client_callable+"",this.description=e.description,this.name=e.name,this.script=e.script,this.script_type=e.script_type?e.script_type:"javascript",this.sys_class_name=e.sys_class_name,this.sys_updated_by=e.sys_updated_by,this.sys_created_on=e.sys_created_on,this.sys_id=e.sys_id,this.sys_mod_count=parseInt(e.sys_mod_count+""),this.sys_name=e.sys_name,this.sys_package=e.sys_package,this.sys_policy=e.sys_policy,this.sys_scope=e.sys_scope,this.sys_tags=e.sys_tags,this.sys_update_name=e.sys_update_name,this.sys_created_by=e.sys_created_by,this.sys_updated_on=e.sys_updated_by,this.sys_updated_on=e.sys_updated_on,this.typedeclaration=e.typedeclaration?e.typedeclaration:"",this.typesourcemap=e.typesourcemap?e.typesourcemap:"",this.tsscript=e.tsscript},e.isClsFound=!1,e}();t.ClientSIRecordData=C;var T;(function(e){e[e["public"]=2]="public",e[e.cls=4]="cls",e[e.fun=8]="fun",e[e.obj=16]="obj",e[e.blocked=32]="blocked",e[e.ts=64]="ts"})(T||(T={}));var _=function(){function e(e,t,i,n,s,a,r,o,p,l){this.api=e,this.id=t,this.tf=i,this.af=n,this.gf=s,this.accessType=a,this.internalType=r,this.f=o,this.td=p,this.sp=l}return e.expandMinifiedFormat=function(t,i,n){function s(e){var n=e.f.endsWith(";")?"":";";e.l=e.l||0;var s="/**\n\t\t\t\t\t * @see http://"+i+"."+t.api+"/"+e.l+"\n\t\t\t\t\t */\n\t\t\t\t\t"+e.f+n+"\n\t\t\t\t\t";return s}if(void 0===n&&(n=!1),t instanceof e)return t;if(0==t.f&&!n)return null;if(0==t.f)return null;if(n=e.isTypescript(t.f),t.df&&!n)if(e.isObject(t.f)){var a="";t.df.forEach(function(e){return Array.isArray(e)?void console.warn("invalid syntax found"):void(a+=s(e))}),t.tf=a}else if((e.isClass(t.f)||this.isFunction(t.f))&&Array.isArray(t.df)&&2==t.df.length){var r=t.df[0],o=t.df[1],p="",l="";r.forEach(function(e){p+=s(e)}),o.forEach(function(e){l+=s(e)}),t.tf=[p,l]}var d="/** @see http://"+i+"."+t.api+"/1 */\n\t\tconst "+t.api+": "+t.api+"Constructor",c="/** @see http://"+i+"."+t.api+"/1 */\n\t\tdeclare const "+t.api+": "+i+"."+t.api+"Constructor";if(n)return d="/** @see http://"+i+"."+t.api+"/1 */\n\t\t\texport import "+t.api+" = "+i+"."+i+"_"+t.api+"."+t.api,c="",t.f|=T.cls,t.af=d,t.gf=c,Array.isArray(t.tf)?t.tf=t.tf[0]:"string"!=typeof t.tf&&(t.tf=""),t;if(e.isObject(t.f))return t.df&&(t.tf="{\n\t\t\t\t\t"+t.tf+"\n\t\t\t\t}"),t.tf="interface "+t.api+" "+t.tf,t.af="const "+t.api+": "+t.api,t.gf="declare const "+t.api+": "+i+"."+t.api,t;if(e.isClass(t.f)||e.isFunction(t.f)){if(!Array.isArray(t.tf))return null;if(e.isClass(t.f)&&2!=t.tf.length)return null;if((e.isClass(t.f)&&!t.sp||e.isFunction(t.f))&&(e.isFunction(t.f)?t.tf="interface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}":t.tf="interface "+t.api+" {\n\t\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t\t}\n\t\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}"),e.isClass(t.f)&&"string"==typeof t.sp){var g=t.sp,f=t.sp.split(".");1==f.length&&(g=i+"."+t.api),t.tf="interface "+t.api+" extends "+g+" {\n\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t}\n\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t}"}return t.af=d,t.gf=c,t}return t.af=d,t.gf=c,t.tf="",t},e.expandMinifiedFormat_1=function(t,i,n){if(void 0===n&&(n=!1),t instanceof e)return t;if(0==t.f&&!n)return null;if(0==t.f)return null;n=e.isTypescript(t.f);var s="const "+t.api+": "+t.api+"Constructor",a="declare const "+t.api+": "+i+"."+t.api+"Constructor";if(n)return s="export import "+t.api+" = "+i+"."+i+"_"+t.api+"."+t.api,a="",t.f|=T.cls,t.af=s,t.gf=a,Array.isArray(t.tf)?t.tf=t.tf[0]:"string"!=typeof t.tf&&(t.tf=""),t;if(e.isObject(t.f))return t.tf="interface "+t.api+" "+t.tf,t.af="const "+t.api+": "+t.api,t.gf="declare const "+t.api+": "+i+"."+t.api,t;if(e.isClass(t.f)||e.isFunction(t.f)){if(!Array.isArray(t.tf))return null;if(e.isClass(t.f)&&2!=t.tf.length)return null;if((e.isClass(t.f)&&!t.sp||e.isFunction(t.f))&&(e.isFunction(t.f)?t.tf="interface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}":t.tf="interface "+t.api+" {\n\t\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t\t}\n\t\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t\t}"),e.isClass(t.f)&&"string"==typeof t.sp){var r=t.sp,o=t.sp.split(".");1==o.length&&(r=i+"."+t.api),t.tf="interface "+t.api+" extends "+r+" {\n\t\t\t\t\t"+t.tf[0]+"\n\t\t\t\t}\n\t\t\t\tinterface "+t.api+"Constructor {\n\t\t\t\t\t"+t.tf[1]+"\n\t\t\t\t}"}return t.af=s,t.gf=a,t}return t.af=s,t.gf=a,t.tf="",t},e.updateFlags=function(e,t,i){var n=e.f||0;t.access==y.public&&(n|=T.public),t.isTypescript()&&(n|=T.ts),i==g.cls?n|=T.cls:i==g.var?n|=T.obj:i==g.fun&&(n|=T.fun),e.f=n},e.updateFlagsMinifiy=function(e,t,i){var n=e.f||0;t.access==y.public&&(n|=T.public),t.isTypescript()&&(n|=T.ts),i==g.cls?n|=T.cls:i==g.var?n|=T.obj:i==g.fun&&(n|=T.fun),e.f=n},e.isTypescript=function(e){return(e&T.ts)==T.ts},e.isPublic=function(e){return(e&T.public)==T.public},e.isClass=function(e){return(e&T.cls)==T.cls},e.isFunction=function(e){return(e&T.fun)==T.fun},e.isObject=function(e){return(e&T.obj)==T.obj},e.isBlocked=function(e){return(e&T.blocked)==T.blocked},e}();t.SITSFormat=_;var S=function(){function e(e,t,i,n){void 0===i&&(i=""),void 0===n&&(n=""),this.currentSI=e,this.apiName=t,this.accessType=i,this.sysId=n,this.apiName=t.trim(),this.accessType="",this.sysId=""}return e.prototype.getJSName=function(){if(!this.apiName)return{};var e=this.apiName.split("."),t="",i="";return 1==e.length?t=e[0]:2==e.length&&(i=e[0],t=e[1]),{name:t,scopeName:i}},e.prototype.getInternalType=function(){return g.never},e.prototype.setAccessType=function(e){this.accessType=e},e.prototype.setSysId=function(e){this.sysId=e},e.prototype.exportAliasName=function(e){var t=m.const+m.space+this.getJSName().name+m.space+m.colon+m.space+this.apiName+m.typeAdd+m.semicolon;return e?t:m.declare+m.space+t},e}();t.TypeData=S;var b=function(e){function t(t,i,n){var s=e.call(this,t,i)||this;return s.apiName=i,s.format=n,s.format=n,s}return __extends(t,e),t.prototype.getTempInterfaceName=function(){return this.apiName},t.prototype.toInternalFormat=function(){var e=this.getJSName().name,t=this.getTempInterfaceName(),i=t.split(".");t=i[i.length-1];var n=m.interface+m.space+t+this.format;return n},t.prototype.exportToTS=function(){var e=new _(this.apiName,this.sysId,this.toInternalFormat(),this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return _.updateFlags(e,this.currentSI,this.getInternalType()),e},t.prototype.getInternalType=function(){return g.var},t.prototype.exportAliasName=function(e){var t=this.getJSName(),i=m.const+m.space;return i+=t.name+m.colon+this.getTempInterfaceName()+m.semicolon,e?i:m.declare+m.space+i},t}(S);t.TypeVarData=b;var A=function(e){function t(t,i,n,s){void 0===s&&(s=!1);var a=e.call(this,t,i)||this;return a.apiName=i,a.format=n,a.format=n,a}return __extends(t,e),t.prototype.getTypeFormat=function(){var e=this.getJSName();return m.function+m.space+e.name+this.format+m.semicolon},t.prototype.exportToTS=function(){var e=this.getJSName(),t=this.getTypeFormat(),i=new _(this.apiName,this.sysId,"",this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return _.updateFlags(i,this.currentSI,this.getInternalType()),i},t.prototype.getInternalType=function(){return g.fun},t.prototype.exportAliasName=function(e){return e?this.getTypeFormat():m.declare+m.space+this.getTypeFormat()},t}(S);t.TypeFunctionData=A;var I=function(e){function t(t,i,n,s){void 0===n&&(n=""),void 0===s&&(s="");var a=e.call(this,t,i)||this;return a.apiName=i,a.baseName=n,a.constructorFormat=s,a.fields=[],a.baseName="",a}return __extends(t,e),t.prototype.setBaseName=function(e){this.baseName=e},t.prototype.setConstructor=function(e){this.constructorFormat=e},t.prototype.addField=function(e,t,i,n){var s=!1;this.fields.every(function(t){return t.key!=e||t.isStatic!=i||(s=!0,!1)}),s||this.fields.push({key:e,value:t,isStatic:i,isMemberFunction:n})},t.prototype.getFieldFormat=function(){for(var e="",t="",n=0;n<this.fields.length;n++){var s=this.fields[n],a=s.key;s.isMemberFunction||(a+=m.colon+m.space),a+=s.value+m.semicolon,a+=m.newline,s.isStatic?t+=a:e+=a}return{staticFields:t,memberFields:e}},t.prototype.getStaticTypeFormat=function(){var e=this.getJSName(),t=m.interface+m.space+e.name+m.typeAdd+m.space+m.blockOpen+m.newline,i=this.getFieldFormat().staticFields;return this.constructorFormat||(this.constructorFormat=m.functionOpen+m.functionClose),t+=m.new+this.constructorFormat+m.colon+this.getJSName().name+m.semicolon,t+=m.newline+m.prototype_1+m.colon+m.space+e.name+m.semicolon,t+=m.newline+i,t+=m.newline+m.blockClose,t},t.prototype.getMemberTypeFormat=function(){var e=m.interface+m.space,t=this.getJSName();e+=t.name,this.baseName&&(e+=m.space+m.extends+m.space+this.baseName),e+=m.space+m.blockOpen+m.newline;var i=this.getFieldFormat().memberFields;return e+=i,e=e.trim(),e+=m.newline+m.blockClose,e+=m.newline,e},t.prototype.exportToTS=function(){var e=this.getMemberTypeFormat()+m.newline+this.getStaticTypeFormat(),t=new _(this.apiName,this.sysId,e,this.exportAliasName(!0),this.exportAliasName(!1),this.accessType,this.getInternalType(),0);return _.updateFlags(t,this.currentSI,this.getInternalType()),t},t.prototype.getInternalType=function(){return g.cls},t.prototype.exportAliasName=function(e){if("global.JSON"==this.apiName)return"";var t=m.const+m.space+this.getJSName().name+m.space+m.colon+m.space+this.apiName+m.typeAdd+m.semicolon;return e?t:m.declare+m.space+t},t}(S);t.TypeClassData=I;var x=function(){return function(e,t,i,n,s,a){void 0===a&&(a=""),this.apiName=e,this.scope=t,this.declaration=i,this.accessType=n,this.sysId=s,this.aliasFormat=a}}();t.TSClassDefinitionFormat=x,t.wrapInNamespace=s,t.wrapInInterface=a;var E={"global.XMLDocument":!0,"global.JSON":!0},M=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=!1),this.siJSData=e,this.emitForVSCode=t}return e.prototype.emit=function(e,t){void 0===t&&(t={});var i="",n="",a={};for(var r in this.siJSData)for(var o=0,p=this.siJSData[r],l;o<p.length;o++)if(l=p[o],l.sp){var d=l.sp.split(".");if(1==d.length){a[r]=a[r]||{},a[r][l.sp]=!0;continue}a[d[0]]=a[d[0]]||{},a[d[0]][d[1]]=!0}for(var r in this.siJSData){for(var c="",g=e==r||this.emitForVSCode,f="",u="",y=0,h=this.siJSData[r],l;y<h.length;y++){if(l=h[y],!l.f){console.warn("skipping declaration for => "+l.api);continue}if(!t[l.id]){var C=this.emitForVSCode||_.isPublic(l.f);(g||C||a[r]&&a[r][l.api])&&(c+=l.tf+m.newline),(C||g&&!C)&&"string"==typeof l.af&&0!=l.af.length&&(f+=l.af+m.semicolon+m.newline),g&&!E[r+"."+l.api]&&"string"==typeof l.gf&&(u+=l.gf+m.semicolon+m.newline)}}0<f.length&&(c+=m.newline+f.trim()),0<u.length&&(n+=u.trim()+m.newline);var T=s(c,r)+m.newline;i+=T}return i.trim()+m.newline+n.trim()},e.prototype.getSysIdMap=function(){var e={};for(var t in this.siJSData)for(var n=this.siJSData[t],s=0;s<n.length;s++)e[n[s].id]=n[s];return e},e}();t.DefinitionEmittor=M;var F=function(e){function t(t){void 0===t&&(t={});var i=e.call(this,t,!0)||this;return i.siJSData=t,i.interfaceFormat={},i.aliasFormat={},i.globalAliasFormat={},i.typeMapFormat={},i.allJSTypes={},i.scopeTypes={},i}return __extends(t,e),t.prototype.exportJSON=function(){return JSON.stringify(this.siJSData)},t.prototype.addType=function(e){var t=e.api.split("."),i=t[0];this.siJSData[i]=this.siJSData[i]||[],this.siJSData[i].push(e)},t.prototype.emit=function(){return e.prototype.emit.call(this,"")},t}(M);t.DefinitionEmittorForVSCode=F;var k={var:"var"};t.stripPrivateTypes=o,t.getEmittor=p,t.emitDeclarationForScope=d,t.parseSI=c;var D;(function(e){function t(e){var t=0;do if(" "!==e[t])return t;while(++t<e.length);return t}function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},s=Array.prototype.slice.call(arguments),a=0,r=s.length,o,p;a<r;a++)for(o in p=s[a],p)p.hasOwnProperty(o)&&(n[o]=p[o]);return n}function n(e,t){for(var n=e.length,s=!0,a;n--;){for(a in t)t.hasOwnProperty(a)&&(s=t[a]===e[n][a]&&s);if(s)return e[n]}return null}function s(e,t){if("string"!=typeof e||"@"!==e[0])return null;var n=t.reduce(function(e,t){var n;try{n=t(e.source,i({},e.data))}catch(i){e.data.errors=(e.data.errors||[]).concat(t.name+": "+i.message)}return n&&(e.source=e.source.slice(n.source.length),e.data=i(e.data,n.data)),e},{source:e,data:{}}).data;return n.optional=!!n.optional,n.optional&&!!n.type&&(n.type=n.type.substring(0,n.type.length-1)),n.type=void 0===n.type?"":n.type,n.name=void 0===n.name?"":n.name,n.description=void 0===n.description?"":n.description,n}function a(e,t){var i=t.trim?function(e){return e.trim()}:function(e){return e},a=e.map(function(e){return i(e.source)}).join("\n");a=i(a);var r=e[0].number;e=e.reduce(function(e,n){if(n.source=i(n.source),n.source.match(/^\s*@(\w+)/))e.push({source:[n.source],line:n.number});else{var s=e[e.length-1];if(void 0!==t.join&&!1!==t.join&&0!==t.join&&!n.startWithStar&&0<s.source.length){var a;a="string"==typeof t.join?t.join+n.source.replace(/^\s+/,""):"number"==typeof t.join?n.source:" "+n.source.replace(/^\s+/,""),s.source[s.source.length-1]+=a}else s.source.push(n.source)}return e},[{source:[]}]).map(function(e){return e.source=i(e.source.join("\n")),e});var o=e.shift();if(""===o.source&&0===e.length)return null;var p=e.reduce(function(e,i){var a=s(i.source,t.parsers);if(!a)return e;if(a.line=i.line,a.source=i.source,t.dotted_names&&-1!==a.name.indexOf(".")){for(var r=e,o=a.name.split("."),p,l;1<o.length;)p=o.shift(),l=n(r,{tag:a.tag,name:p}),l||(l={tag:a.tag,line:+a.line,name:p,type:"",description:""},r.push(l)),l.tags=l.tags||[],r=l.tags;return a.name=o[0],r.push(a),e}return e.concat(a)},[]);return{tags:p,line:r,description:o.source,source:a}}function r(e){var t=0,n=0,s;return e=i({},{trim:!0,dotted_names:!1,parsers:[o.parse_tag,o.parse_type,o.parse_name,o.parse_description]},e||{}),function(i){var r=i.indexOf("/**"),o=i.indexOf("*/"),p;if(-1!==r&&i.indexOf("/***")!==r&&(s=[],t=r+3),s){var l=t,d=!1,c=i.match(/\S/);0<s.length&&c&&("*"===c[0]?(l=c.index+2,d=!0):c.index<t&&(l=c.index)),s.push({number:n,startWithStar:d,source:i.slice(l,-1===o?i.length:o)}),-1!==o&&(p=a(s,e),s=null,t=0)}return n+=1,p}}var o={parse_tag:function(e){var t=e.match(/^\s*@(\S+)/);if(!t)throw new Error("Invalid `@tag`, missing @ symbol");return{source:t[0],data:{tag:t[1]}}},parse_type:function(e,i){if(i.errors&&i.errors.length)return null;var n=t(e),s="",a=0;if("{"!==e[n])return null;for(;n<e.length&&(a+="{"===e[n]?1:"}"===e[n]?-1:0,s+=e[n],n++,0!==a););if(0!==a)throw new Error("Invalid `{type}`, unpaired curlies");return{source:e.slice(0,n),data:{type:s.slice(1,-1)}}},parse_name:function(e,i){if(i.errors&&i.errors.length)return null;for(var n=t(e),s="",a=0;n<e.length&&(a+="["===e[n]?1:"]"===e[n]?-1:0,s+=e[n],n++,!(0===a&&/\s/.test(e[n]))););if(0!==a)throw new Error("Invalid `name`, unpaired brackets");var r={name:s,optional:!1,default:""};if(/=$/.test(i.type)&&(r.optional=!0),"["===s[0]&&"]"===s[s.length-1]&&(r.optional=!0,s=s.slice(1,-1),-1!==s.indexOf("="))){var o=s.split("=");s=o[0],r.default=o[1].replace(/^(["'])(.+)(\1)$/,"$2")}return r.name=s,{source:e.slice(0,n),data:r}},parse_description:function(e,t){if(t.errors&&t.errors.length)return null;var i=e.match(/^\s+((.|\s)+)?/);return i?{source:i[0],data:{description:void 0===i[1]?"":i[1]}}:null}};e.parse=function(e,t){for(var n=[],s=r(t),a=e.split(/\n/),o=0,p=a.length,l;o<p;o++)l=s(a.shift()),l&&n.push(l);return n}})(D||(D={}));var N={"global.PwdEmailNotificationManager._sendCodeToDevices":"(devices, code, userSysId?: string)","global.OCDHTMLXCalendarFormatter.initialize":"(groupEvents?: any)","global.OCRotationV2.initialize":"(schedulePage, formatter?: any)","global.WorkflowIconsSCR.initialize":"(ref?: any)","global.KnowledgeTypeDefaultsAjax.getValue":"(ge?: any)","global.SchedulePriorityECCJob.initialize":"(label?: any, document?: any, script?: any)","global.ClientTestRunnerBrowserInfo.initialize":"(browserName, version, osName, osVersion?: any)","global.PwdSMSNotificationManager._sendCodeToDevices":"(devices, code, userSysId?: string)","global.KBViewModelSNC.getKnowledgeRecord":"(query?: any, value?: any, stopWorkflow?: any)","global.KBMyKnowledgeSNC.initialize":"(type?: any, windowStart?: any)","global.sc_ic_RequestedItem.initialize":"(_gr, _gs, _workflow?: any)","global.StdChangeUtilsSNC.getValue":"(property?: any)","sn_schedule_pages.CMNScheduleRESTWrapper.getEvents":"(params?: any)","sn_schedule_pages.CMNScheduleRESTWrapper.updateEvent":"(params?: any)","sn_comm_management.CommunicationManagementChannelAbstractSNC.getConfig":"(sourceTable: string)"},v;(function(e){e[e.typeDefs=0]="typeDefs",e[e.callback=1]="callback"})(v=t.JSDocTypes||(t.JSDocTypes={}));var P;(function(e){function s(e){function t(t,i,n){if("<"!=e[0]&&"("!=e[0])throw"Not a function";for(var s=-1,a=0,r=!1;t<e.length;t++)if(e[t]==i&&(-1==s&&(s=t),a++),e[t]==n&&(a--,0==a)){t++,r=!0;break}return{start:s,length:r?t-s:0}}var i={template:"",paramBody:"",returnType:""},n=t(0,"<",">"),s=0;0!=n.length&&(i.template=e.substr(n.start,n.length),s=1);var a=t(s,"(",")");if(0==a.length)throw"Not a arrow function";i.paramBody=e.substr(a.start,a.length);var r=a.start+a.length,o=e.substr(r).trim();if(0==o.indexOf("=>"))o=o.replace("=>","").trim();else throw"Not a function";return i.returnType=o,i}function a(e,t,i,n){return ts.typeToDisplayParts(e,t,i,n)}function r(e){var t="";for(var i in e){var n=c(e[i],i);0<n.decl.length&&(t+="\n"+n.decl+"\n")}return t}function o(e){O[e]=!0}function p(){O={}}function l(e){R[e]=!0}function d(e){return!!(R[e]||O[e])}function c(e,t){function n(e){var t="";for(var i in e)if("object"==typeof e[i]){var s=n(e[i]);t+="namespace "+i+" {\n"+s+"\n}\n"}else"string"==typeof e[i]&&(t+=e[i]);return t}var s={decl:""};if(!Array.isArray(e))return s;for(var a={},r=0;r<e.length;r++)for(var o=0,p;o<e[r].length;o++)if(p=e[r][o],p.name){var d=p.name.split("."),c="",g=d.splice(d.length-1,1)[0];c=p.type.trim().startsWith("{")?"interface "+g+" "+p.type+"\n\n":"interface "+g+" extends "+p.type+" {}\n",l(t+"."+g);for(var f=a,u=0;u<d.length;u++)f[d[u]]=f[d[u]]||{},"string"==typeof f[d[u]]&&(console.log("module is defined as type overriding the type with modue "),f[d[u]]={}),f=f[d[u]];f[g]=c}var m=n(a);return 0==m.length?s:(m="declare namespace "+t+" {\n\t\t\t"+m+"\n\t\t}",s.decl=m,s)}function f(e,t){void 0===t&&(t="-1");var n={};for(var s in e){n[s]||(n[s]=[]);for(var a=0;a<e[s].length;a++)Array.isArray(e[s][a].td)&&e[s][a].id!=t&&n[s].push(e[s][a].td)}return n}function u(e){for(var t=0,n=[],s=0,a=0;a<e.length;a++)if(n.push(e[a]),"punctuation"==e[a].kind){if("{"==e[a].text){s++;continue}if("}"==e[a].text){s--;continue}if(0==s)continue;if(":"!=e[a].text&&"("!=e[a].text&&"<"!=e[a].text)continue;if("<"==e[a].text){if(1>a)continue;if("methodName"!=e[a-1].kind)continue}for(var r=n.length-2;1<r;){var o=n[r].kind,p=n[r].text;if(("punctuation"!=o||"."!=p)&&"propertyName"!=o&&"localName"!=o&&"methodName"!=o){r++;break}r--}n.splice(r,n.length-r-2)}t=0;var l=n.filter(function(e){return 0<t?(t--,!1):("keyword"==e.kind&&"typeof"==e.text?(t=2,e.text="any"):"functionName"==e.kind&&(e.text="Function"),!0)}),d={kind:"type",text:""};return d=l.reduce(function(e,t){return e.text+=t.text,e},{text:"",kind:"type"}),d.text.endsWith("...")?"any":d.text}function m(e,t,n,l){function c(e){return{isOptional:!1,name:e.getName(),documentation:ts.displayPartsToString(e.getDocumentationComment(l)),type:l.typeToString(l.getTypeOfSymbolAtLocation(e,e.valueDeclaration),void 0,ts.TypeFormatFlags.UseFullyQualifiedType)}}function g(e,t){void 0===t&&(t=!1);var i=e.getTypeParameters(),n=[];null!=i&&i.forEach(function(e){var t=e.getSymbol();t&&n.push(t.getName())});var s=ts.TypeFormatFlags.UseFullyQualifiedType;s|=ts.TypeFormatFlags.WriteArrayAsGenericType,s|=ts.TypeFormatFlags.NoTruncation;var r="";if(!t){var o=a(l,e.getReturnType(),void 0,s);r=u(o)}var p=ts.displayPartsToString(e.getDocumentationComment(l)),d={line:0,character:0};return 0<p.length&&(d.doc=p),{lineInfo:d,parameters:e.parameters.map(c),returnType:r,documentation:p,typeParams:n}}function f(e){var t=I.getLineAndCharacterOfPosition(e.pos);return t.line+=1,t.character+=1,{line:t.line,character:t.character}}function m(t){function i(){return-1!=t.body.getText().indexOf("return this;")||!e.parseReturnType}function n(e){if(!(ts.isFunctionExpression(e)||ts.isFunctionDeclaration(e))){if(ts.isReturnStatement(e)){if(3!=e.getChildCount())return;var t=e.getChildAt(1);if(ts.isObjectLiteralExpression(t)){var i=h(t),s=new L("temp");s.setKeysType(i);var r=s.toTypeFormat();return void(-1==o.indexOf(r)&&o.push(r))}var p=!1;if(ts.isFunctionExpression(t)&&(p=!0),"this"==t.getText())return void o.push("this");var d=l.getTypeAtLocation(t),c=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,g=a(l,d,void 0,c),f=u(g);return"any"==f||0<=o.indexOf(f)?void 0:void(p?o.unshift(f):o.push(f))}e.forEachChild(n)}}var s=f(t),o=[],p=l.getTypeAtLocation(t).getCallSignatures().map(function(e){return g(e,i())}),r=b(t);if(0<r.length&&(p[0].returnType=r),p[0].lineInfo=s,i()&&(p[0].returnType="this"),p[0].parameters.length>t.parameters.length&&p[0].parameters.splice(p[0].parameters.length-1,1),0<t.parameters.length){var d=0;t.parameters.forEach(function(e){p[0].parameters[d++].isOptional=l.isOptionalParameter(e)})}var c=ts.getJSDocReturnTag(t),m=p[0].returnType;if("Function"==m||"any"==m)try{n(t.body);var y=o.join("|");"Function"==m&&(p[0].returnType=0<y.length?y:"void")}catch(e){console.log("Return type parsing error "+e)}else if("boolean"==m&&c){var C=ts.getJSDocReturnType(t);if(C){var T=C.getText().split(" ");if(3==T.length&&"is"==T[1]){var _=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,S=a(l,l.getTypeAtLocation(t),void 0,_),A=u(S),I=C.getText();A.endsWith(I)&&(p[0].returnType=I)}}}return p}function y(e){var t=[],i=e.getChildren(n).find(ts.isBlock);if(!i)return t;var r=i.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});if(!r)return t;var o=r.getChildren(n).filter(ts.isExpressionStatement);return o.forEach(function(e){var i=f(e),r=e.getChildren(n).find(ts.isBinaryExpression);if(!r)return t;var o=r.getChildren(),p=o.find(ts.isPropertyAccessExpression);if(!p)return t;var d=p.getChildren();if(d[0].kind!=ts.SyntaxKind.ThisKeyword)return t;var c=d[d.length-1],g=c.getText(),m=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,y=o[o.length-1];i=f(y);var h="";if(ts.isNumericLiteral(y))h="number";else if(ts.isStringLiteral(y))h="string";else if(ts.isLiteralTypeNode(y))h="number";else if(ts.SyntaxKind.FalseKeyword==y.kind||ts.SyntaxKind.TrueKeyword==y.kind)h="boolean";else if(ts.SyntaxKind.FirstLiteralToken==y.kind)h="number";else{h=l.typeToString(l.getTypeAtLocation(y),n,0);var C=a(l,l.getTypeAtLocation(y),void 0,ts.TypeFormatFlags.UseFullyQualifiedType),T=u(C);h!=T&&(h=T),"Function"==h&&(h="any")}var _=!1;try{var S=s(h);_=!0,t.push(new N(g,S.paramBody,S.returnType,S.template).setLineInfo(i))}catch(t){}_||t.push(new F(g,h).setLineInfo(i).setLineInfo(i))}),t}function h(e,t){void 0===t&&(t=!1);var i={};return e.properties.forEach(function(e){var r=e.name.getText(),o=e.getChildren(),p=o.find(ts.isIdentifier),d=o.find(ts.isFunctionExpression);if(t&&d&&"initialize"==r){var c=y(d);c.forEach(function(e){i[e.name]=e})}var g=o[o.length-1],h="",C=ts.isStringLiteral(o[0]),T=f(g);if(ts.isNumericLiteral(g))i[r]=new E(r,"number").setLineInfo(T);else if(ts.isStringLiteral(g))i[r]=new M(r,"string").setLineInfo(T);else if(d){var _=m(d),S=P.create(r,_[0]);i[r]=S}else{var b=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals;h=l.typeToString(l.getTypeAtLocation(g),void 0,b);var A=l.typeToString(l.getTypeAtLocation(e),n,b);h!=A&&(console.log("different types found, overriding default one"),h=A);var I=a(l,l.getTypeAtLocation(e),void 0,b);h=u(I);var x=!1;try{var _=s(h);i[r]=new N(r,_.paramBody,_.returnType,_.template),x=!0}catch(t){}x||(i[r]=new F(r,h))}C&&i[r].setAsElement(),i[r].setLineInfo(T)}),i}function C(e,t,i){var n=f(t),a=ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,r=l.typeToString(l.getTypeAtLocation(t),void 0,a),o=!1;try{var p=s(r);o=!0,e==x?(j.addConstructorFunction(new N(e,p.paramBody,p.returnType,p.template).setLineInfo(n)),j.setAsFunction()):j.addField(new N(e,p.paramBody,p.returnType,p.template).setLineInfo(n))}catch(t){}o||j.addField(new F(e,r,i).setLineInfo(n))}function T(e){var t=e.getChildren().find(ts.isParenthesizedExpression),i;if(!t)return i;var n=t.getChildren().find(ts.isFunctionExpression);if(!n)return i;var s=n.getChildren().find(ts.isBlock);if(!s)return i;var a=s.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});return a}function _(e){var t=[],i=e.getChildCount();if(!(1<=i&&2>=i))return t;var n=e.getChildAt(0);if(!ts.isCallExpression(n))return t;var s=T(n);return s?s.getChildren():t}function S(e){var t=ts.getJSDocTags(e).filter(ts.isJSDocTypedefTag);t.forEach(function(e){var t=e.getChildren(),i=ts.getNameOfJSDocTypedef(e);if(console.log(i.getText()),3==t.length){var r=t.find(ts.isModuleDeclaration);if(r&&!R[r.getText()]){var p=t[2].getChildren();p.forEach(function(e){var t=l.getTypeAtLocation(e),i=a(l,t,n,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType);console.log(u(i))})}var d=t[2],c="any",g=d.getText().trim(),f=g;if(!r){var m=l.getSymbolAtLocation(d);if(!m)return;var y=a(l,l.getDeclaredTypeOfSymbol(m),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType);if(c=u(y),"any"==c){var h="",C=l.getDeclaredTypeOfSymbol(m),T=C.getProperties();C.getApparentProperties(),T.forEach(function(e){var t=l.typeToString(l.getTypeOfSymbolAtLocation(e,e.valueDeclaration),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType),i="";try{var n=s(t);i=n.template+n.paramBody+": "+n.returnType}catch(t){}h+=0<i.length?""+e.getEscapedName()+i+",\n":e.getEscapedName()+": "+t+",\n"}),c="{\n\t\t\t\t\t\t\t\t"+h+"\n\t\t\t\t\t\t\t}"}}else{var _=g.split(".");if(_.shift(),g=_.join("."),1>t[1].getChildCount())return;var S=l.getTypeAtLocation(t[1].getChildren()[1]),b=a(l,S,void 0,void 0);if(c=u(b),"any"==c){var A="",I=[];try{I=t[1].getChildren()[1].getChildAt(1).getChildren()}catch(t){console.log("typedef parsing error")}I.forEach(function(e){var t=e.getChildren().find(ts.isIdentifier);if(null!=t){var i=a(l,l.getTypeAtLocation(e),void 0,ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType),n=u(i),r="";try{var o=s(n);r=""+o.template+o.paramBody+": "+o.returnType}catch(t){}A+=0<r.length?""+t.getText()+r+",\n":t.getText()+": "+n+",\n"}}),A="{"+A+"}",c=A}}"any"==c?console.warn("typedef came as any "+g):(o(f),j.addTypedefData({type:c,kind:v.typeDefs,name:g}))}})}function b(e){var t=ts.getJSDocReturnTag(e);if(!t)return"";var i=ts.getJSDocReturnType(e);return i?d(i.getText())?i.getText():"":""}function A(e,t){void 0===t&&(t=!0),S(e);var i=f(e);if(ts.isVariableStatement(e)){var o=e.declarationList.declarations[0],p=o.getChildren(n);if(1==p.length)return void(O=p[0].getText().trim()==x);if(3!=p.length)return;var d=p[0],c=p[2];if(ts.isObjectLiteralExpression(c)&&(B[d.getText().trim()]=c),O)return;if(ts.isIdentifier(d)){if(d.getText().trim()!=x)return;if(ts.isCallExpression(c)){var I=c.getFullText().trim();if("Class.create()"==I)return O=!0,void j.setAsClass();var F=T(c);if(F)F.getChildren(n).forEach(function(e){A(e,!1)});else{var D=l.getTypeAtLocation(c),N=ts.TypeFormatFlags.UseTypeOfFunction|ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals,v=a(l,D,void 0,N),w=u(v);if(w.startsWith("{")&&w.endsWith("}"))O=!0,j.addField(new V(x,w).setLineInfo(i)),j.setAsObjectLiteral();else try{s(w)}catch(t){}}}else if(ts.isObjectLiteralExpression(c)){O=!0;var R=h(c),U=new L(x);U.setLineInfo(i),U.setKeysType(R),j.addField(U),j.setAsObjectLiteral()}else if(ts.isFunctionExpression(c)){O=!0,j.setAsFunction();var J=m(c);j.addConstructorFunction(P.create(x,J[0]));var W=y(c);0<W.length&&j.setAsClass(),W.forEach(function(e){return j.addField(e)})}else if(ts.isIdentifier(c)){var z=c.getText().trim();if(!B[z])return;O=!0;var R=h(B[z]),U=new L(x);U.setKeysType(R),j.addField(U),j.setAsObjectLiteral()}else if(ts.isParenthesizedExpression(c)){var G=c.getChildren().filter(ts.isFunctionExpression);if(0!=G.length){O=!0,j.setAsFunction();var J=m(G[0]);j.addConstructorFunction(P.create(x,J[0]))}else{if(1!=n.statements.length)return;var q=c.getChildren().filter(ts.isCallExpression);if(1!=q.length)return;var H=q.find(ts.isCallExpression);if(!H)return;var K=H.getChildren().find(ts.isFunctionExpression);if(!K)return;var Q=K.getChildren().find(ts.isBlock);if(!Q)return;var X=Q.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});if(!X)return;X.getChildren().forEach(function(e){A(e,!1)})}}}return}if(ts.isExpressionStatement(e)){if(!O){var Y=e.getChildren().find(ts.isBinaryExpression);if(!Y){var Z=e.getChildren();return 2==Z.length?ts.isIdentifier(Z[0])&&Z[1].kind==ts.SyntaxKind.SemicolonToken?void(O=Z[0].getText().trim()==x):void 0:void 0}var ee=Y.getChildren();if(3!=ee.length)return;var te=ee[2],ie=ee[0];if(ts.isIdentifier(ie))if(ie.getText().trim()!=x)ts.isObjectLiteralExpression(te)&&(B[ie.getText().trim()]=te);else if(ts.isCallExpression(te)){var I=te.getFullText().trim();"Class.create()"==I&&(O=!0,j.setAsClass())}else if(ts.isObjectLiteralExpression(te)){O=!0;var ne=l.getSymbolAtLocation(te),se;ne&&(se=ts.displayPartsToString(ne.getDocumentationComment(l)));var U=new L(x,se);U.setLineInfo(f(te));var ae=h(te);U.setKeysType(ae),j.addField(U),j.setAsObjectLiteral()}else if(ts.isFunctionExpression(te)){O=!0;var J=m(te);j.setAsFunction(),j.addConstructorFunction(P.create(ie.getText(),J[0]));var W=y(te);0<W.length&&j.setAsClass(),W.forEach(function(e){return j.addField(e)})}else if(ts.isIdentifier(te)){var re=te.getText().trim();if(!B[re])return;O=!0;var R=h(B[re]),U=new L(x);U.setLineInfo(f(te)),U.setKeysType(R),j.setAsObjectLiteral(),j.addField(U)}return}var oe=e.getChildren();if(1<=oe.length&&2>=oe.length&&t&&ts.isCallExpression(oe[0])){var pe=_(e);pe.forEach(function(e){A(e,!1)})}var le=oe.find(ts.isBinaryExpression);if(!le)return;var de=le.getChildren();if(3!=de.length)return;ts.isObjectLiteralExpression(de[2])&&(B[de[0].getText().trim()]=de[2]);var ce=de.find(ts.isPropertyAccessExpression),ge=void 0,fe="",ue="",me=!1;if(ce){me=!0;var ye=ce.getChildren(n).filter(ts.isIdentifier),he=ce.getText().trim(),Ce=he.split(".");if(ge=de[de.length-1],Ce[0]!=x)return;if(ts.isIdentifier(ge)&&B[ge.getText().trim()]&&(ge=B[ge.getText().trim()]),fe=Ce.join("."),3<Ce.length)return}else if(ts.isIdentifier(de[0])&&(ts.isObjectLiteralExpression(de[2])&&(B[de[0].getText()]=de[2]),de[0].getText().trim()==x&&de[1].kind==ts.SyntaxKind.FirstAssignment&&(j.clearAll(),ge=de[2],fe=x,ts.isCallExpression(ge)&&"Class.create()"==ge.getText().trim())))return j.clearAll(),void j.setAsClass();if(ge&&ts.isIdentifier(ge)&&B[ge.getText()]&&(ge=B[ge.getText()]),!ge)return;if(i=f(ge),ts.isNumericLiteral(ge))j.addField(new E(fe,"").setLineInfo(i));else if(ts.isStringLiteral(ge))j.addField(new M(fe,"").setLineInfo(i));else if(ts.isObjectLiteralExpression(ge)){var Te=h(ge,!0),_e=new L(fe,"");_e.setLineInfo(f(ge)),_e.setKeysType(Te),j.addField(_e),me||j.setAsObjectLiteral()}else if(ts.isFunctionExpression(ge)){var ae=m(ge);me?j.addField(P.create(fe,ae[0])):(j.addConstructorFunction(P.create(x,ae[0])),j.setAsFunction())}else if(fe==x+".prototype"&&ts.isCallExpression(ge)){var Se=ge.getChildren().find(ts.isPropertyAccessExpression);if(Se&&"Object.extendsObject"==Se.getText()){var X=ge.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList}),be=X.getChildCount();if(3!=be)return;var Ae=X.getChildAt(0,n);if(ts.isIdentifier(Ae)||(Ae=void 0),Ae||(Ae=X.getChildren().find(ts.isPropertyAccessExpression)),!Ae)return void console.log("unable to find the base class information");j.setAsClass();var Ie=Ae.getText();1==Ie.split(".").length&&(Ie=k+"."+Ie),j.setBaseType(Ie);var xe=X.getChildren().find(ts.isObjectLiteralExpression);if(!xe){var Ee=X.getChildren(),Me=Ee[Ee.length-1];if(ts.isIdentifier(Me)){var Fe=Me.getText().trim();xe=B[Fe]}}if(xe){var ae=h(xe,!0),ke=new L(fe);ke.setLineInfo(i),ke.setKeysType(ae),j.addField(ke)}else{var N=ts.TypeFormatFlags.NoTruncation|ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.MultilineObjectLiterals;ue=l.typeToString(l.getTypeAtLocation(X.getChildAt(be-1)),void 0,N),-1==ue.indexOf("typeof")&&C(fe,X.getChildAt(be-1),"")}}else{var X=T(ge),pe=[];X&&(pe=X.getChildren(n)),pe.forEach(function(e){A(e,!1)});var De=pe.filter(ts.isReturnStatement);if(0<De.length){1<De.length&&console.warn("Found multiple return statements in prototype assignment");var Ne=De[De.length-1].getChildren()[1],xe=void 0;if(ts.isIdentifier(Ne))xe=B[Ne.getText()];else if(ts.isObjectLiteralExpression(Ne))xe=Ne;else if(ts.isCallExpression(Ne)){var ve=Ne.getChildren();if(4!==ve.length)return;var Pe=ve[0];if(!ts.isPropertyAccessExpression(Pe))return;if("Object.extendsObject"!==Pe.getText())return;var Ve=Ne.getChildren().find(function(e){return e.kind==ts.SyntaxKind.SyntaxList});if(!Ve)return;var Le=Ve.getChildren();if(3!=Le.length)return;var Ae=Le[0];if(!ts.isPropertyAccessExpression(Ae))return;var _e=Le[2];if(!ts.isObjectLiteralExpression(_e))return;j.setAsClass();var Ie=Ae.getText();1==Ie.split(".").length&&(Ie=k+"."+Ie),j.setBaseType(Ie),xe=_e}if(xe){var ae=h(xe,!0),ke=new L(fe);return ke.setLineInfo(i),ke.setKeysType(ae),void j.addField(ke)}}C(fe,ge,"")}}else C(fe,ge,"")}else if(ts.isFunctionDeclaration(e)){var je=e.name.getText();if(je!=x)return;O=!0;var ne=l.getSymbolAtLocation(e.name),we=l.getTypeOfSymbolAtLocation(ne,ne.valueDeclaration),Oe=we.getCallSignatures().map(function(e){return g(e)}),Re=b(e);if(0<Re.length&&(Oe[0].returnType=Re),0<e.parameters.length){var Be=0;e.parameters.forEach(function(e){Oe[0].parameters[Be++].isOptional=l.isOptionalParameter(e)})}j.setAsFunction(),j.addConstructorFunction(P.create(je,Oe[0]));var W=y(e);0<W.length&&j.setAsClass(),W.forEach(function(e){j.addField(e)});var Ue=ts.getJSDocAugmentsTag(e);if(!Ue)return;var Je=Ue.getChildren();if(2!=Je.length)return;var We=Je[0];if(!We)return;var ze=l.getTypeAtLocation(Je[1]);if(!ze)return;var Ge=a(l,ze,void 0,ts.TypeFormatFlags.UseFullyQualifiedType|ts.TypeFormatFlags.NoTruncation),qe=u(Ge);0<qe.length&&"any"!=qe&&j.setBaseType(qe)}else if(ts.isClassDeclaration(e));}p();var I=n,x="",k="",D=t.split(".");1==D.length?x=t:(x=D[1],k=D[0]);var j=new w(e,t,"","12345"),O=!1,R={};(function(e){function t(e){if(e){if(ts.isJSDocTypedefTag(e)){var i=ts.getNameOfJSDocTypedef(e);console.log(i.getText());var n=e.getChildren(),s=n.find(ts.isModuleDeclaration);if(!s)return;if(2<=n.length){var r=s.getText(),o=r.split(".");if(2>o.length)return void console.warn("typedef should start with 'sn' namespace");if("sn"!=o[0])return void console.warn("typedef should start with 'sn' namespace");R[r]=!0}}else if(ts.isTypeReferenceNode(e)){var p=e.getFullText();if(!R[p])return;var d=e.typeName.getChildren();if(0==d.length)return void console.log("type children must exists "+e.getFullText());var c=l.getSymbolAtLocation(d[d.length-1]);if(!c)return;var g=a(l,l.getDeclaredTypeOfSymbol(c),void 0,8388608),f=u(g);j.addTypedefData({type:f,kind:v.typeDefs,name:p})}var m=e.getChildren();0<m.length&&m.forEach(function(e){return t(e)})}}t(e)})(n);for(var B={},U=0,r;n&&U<n.statements.length;U++)r=n.statements[U],A(r);return j}function h(e){e.forEach(function(e){"javaGlobalAPI"==e.name?z=e:"tableAPI"==e.name?q=e:"javaScopedAPI"==e.name?G=e:"jsAPI"==e.name&&(H=e)}),K="string"==typeof z.json_value?JSON.parse(z.json_value).api+"\n\n"+z.customization:z.json_value.api+"\n\n"+z.customization,Q="string"==typeof G.json_value?JSON.parse(G.json_value).api+"\n\n"+z.customization:G.json_value.api+"\n\n"+G.customization,X="string"==typeof q.json_value?JSON.parse(q.json_value).api+"\n\n"+q.customization+"\n\n"+H.customization:q.json_value.api+"\n\n"+q.customization,Y="string"==typeof H.json_value?JSON.parse(H.json_value).api:H.json_value.api}function b(e,t){void 0===t&&(t=!1);var i=e.split("."),n=i[0],s=i[1],a="";if(t)return Y[n]?(Y[n].forEach(function(e){var t=e.api.split(".");t[1]!=s&&"string"==typeof e.gf&&(a+=e.gf+";\n")}),a):(console.log("Unable to find the scope falling back to default one "+e),"");var r={},o=function(e){var t=Y[e];t.forEach(function(t){if(t.sp){var i=t.sp.split(".");return 1==i.length?(r[e]=r[e]||{},void(r[e][t.sp]=!0)):void(r[i[0]]=r[i[0]]||{},r[i[0]][i[1]]=!0)}})};for(var p in Y)o(p);var l=function(e){var t=Y[e];a+="declare namespace "+e+" {",t.forEach(function(t){if("string"==typeof t.gf&&(_.isPublic(t.f)||e==n))a+="\n"+t.tf+"\n"+t.af+"\n";else{if(!r[e])return;r[e][t.api]&&(a+="\n"+t.tf+"\n")}}),a+="}\n"};for(var p in Y)l(p);return"global"==n?K+X+a:Q+X+a}function A(n,s,a){h(s);var o="point.js",p=f(Y,a.sys_id),l=r(p),d=new eslint.Linter,c,g,u;return{dispose:function(){c&&(c.disposeAll(),c=null),g&&(g=null)},getTypeInfo:function(s,a){if(s.api_name||(s.api_name="global.point"),u||(u=s.api_name),!c||u!=s.api_name){var r=0;s.access==y.public&&(r|=T.public),r|=T.cls;var p=s.getScopeAndAPIMap(),f=new _(s.api_name,s.sys_id,"export class "+p.name+" { prop: number; }","","",s.access,"",r),h=s.formatCurrentSITSFormat(f),C=n+"\n\n"+b(s.api_name)+"\n\n\n"+b(s.api_name,!0);C+="\n\n"+h+"\n\n"+l+"\n\n"+H.customization+"",c||(c=new J(C)),u!=s.api_name&&(u=s.api_name,c.updateLib(C))}var S={js:"",declaration:"",sourceMap:"",afterDotWalK:"",errorMsg:t.ERROR_MSG,linterErrors:[]},A="pointOut.js";s.isJavascript()?(a.allowJs=!0,a.declaration=!1,a.noEmitOnError=!0,a.outFile=A,c.updateSI(s.tsscript)):(a.allowJs=!1,a.declaration=!0,c.updateTypeScriptSI(s.tsscript),o="point.ts"),a.noLib=!0,a.types=["snlib"],ts.defaultMaximumTruncationLength=1e4,a.noResolve=!1,a.skipLibCheck=!0,g=ts.createProgram([o],a,c,g);var I=g.emit(g.getSourceFile(o),void 0,void 0,void 0,{before:[e.dotWalkingTransformer]}),x=ts.getPreEmitDiagnostics(g).concat(I.diagnostics);if(x.forEach(function(e){if(e.file){var t=e.file.getLineAndCharacterOfPosition(e.start),i=t.line,n=t.character,s=ts.flattenDiagnosticMessageText(e.messageText,"\n");console.log(e.file.fileName+" ("+(i+1)+","+(n+1)+"): "+s)}else console.log(""+ts.flattenDiagnosticMessageText(e.messageText,"\n"))}),I.emitSkipped)return S;var E=c.getOutFiles();if(s.isTypescript()?(S.js=E["point.js"],S.sourceMap=E["point.js.map"]):(S.js=E[A],S.sourceMap=E[A+".map"]),S.afterDotWalK=s.tsscript,S.errorMsg="",s.isTypescript())return S.declaration=E["point.d.ts"],S;var M;try{M=m(s,s.api_name,g.getSourceFile(o),g.getTypeChecker()),M.sysId=s.sys_id,M.accessType=s.access;var F=M.toMinifiedInterfaceFormat();S.declaration=JSON.stringify(F),S.afterDotWalK=s.tsscript,a.linter&&(S.linterErrors=d.verify(s.tsscript,i.eslintConfig))}catch(t){S.errorMsg=JSON.stringify({error:t+"",id:1})}return S}}}var I;(function(e){e[e.NumericLiteral=0]="NumericLiteral",e[e.StringLiteral=1]="StringLiteral",e[e.StringType=2]="StringType",e[e.FunctionType=3]="FunctionType",e[e.ObjectLiteral=4]="ObjectLiteral",e[e.AnonymouseStringLiteral=5]="AnonymouseStringLiteral"})(I=e.LiteralType||(e.LiteralType={}));var x=function(){function e(e,t,i,n){void 0===n&&(n=!1),this.name=e,this.type=t,this.doc=i,this.isStringPropertyElement=n}return e.prototype.setLineInfo=function(e){return this.lineInfo=e,this},e.prototype.toJSONDecl=function(){var e={};return e.f=this.toTypeFormat(),this.lineInfo&&(e.l=this.lineInfo.line,this.lineInfo.doc&&(e.d=this.lineInfo.doc)),e},e.prototype.setDoc=function(e){this.doc=e},e.prototype.setAsElement=function(){this.isStringPropertyElement=!0},e.isNumericType=function(t){return t instanceof e&&t.type==I.NumericLiteral},e.isStringLiteral=function(t){return t instanceof e&&t.type==I.StringLiteral},e.isStringType=function(t){return t instanceof e},e.isParamType=function(e){return e instanceof k},e.isFunctionType=function(t){return t instanceof e&&t.type==I.FunctionType},e.isRawFunctionType=function(e){return e instanceof N},e.isObjectLiteral=function(t){return t instanceof e&&t.type==I.ObjectLiteral},e.isAnonymousStringType=function(t){return t instanceof e&&t.type==I.AnonymouseStringLiteral},e.prototype.getPropertyName=function(){if(this.isStringPropertyElement)return this.name;var e=this.name.split(".");return e[e.length-1]},e.prototype.isStatic=function(){var e=this.name.split(".");return!(2>e.length)&&"prototype"!=e[1]},e}();e.RawFieldType=x;var E=function(e){function t(t,i){return e.call(this,t,I.NumericLiteral,i)||this}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.getPropertyName()+": number"},t}(x);e.NumericLiteralType=E;var M=function(e){function t(t,i){return e.call(this,t,I.StringLiteral,i)||this}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.getPropertyName()+": string"},t}(x);e.StringLiteralType=M;var F=function(e){function t(t,i,n){var s=e.call(this,t,I.StringType,n)||this;return("true"==i||"false"==i)&&(i="boolean"),i=i.replace(/undefined\[\]/g,"Array<any>"),s.rawType=i,s}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.getPropertyName()+": "+this.rawType},t}(x);e.StringType=F;var k=function(e){function t(t,i,n,s){void 0===n&&(n=!1);var a=e.call(this,t,i,s)||this;return a.isOpt=n,a}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.isOpt?this.name+(this.isOpt?"?: ":": ")+this.rawType:"any"==this.rawType?this.name:this.name+": "+this.rawType},t}(F);e.ParamInfoType=k;var D=function(e){function t(t,i){return e.call(this,"",t,i)||this}return __extends(t,e),t.prototype.toTypeFormat=function(){return"any"==this.rawType?"":this.rawType},t}(F);e.AnonymousStringType=D;var N=function(e){function t(t,i,n,s,a){var r=e.call(this,t,i,a)||this;return r.returnType=n,r.templateBody=s,r}return __extends(t,e),t.prototype.getParts=function(){var e="";!this.templateBody||(e=this.templateBody),e+=this.rawType;var t;return this.returnType&&"any"!=this.returnType&&(t=this.returnType),{name:this.getPropertyName(),body:e,returnType:t}},t.prototype.getParamsFormat=function(){var e=this.getParts();return e.body},t.prototype.getClsFunctionFormat=function(){var e=this.getParts();return e.returnType?e.body:e.body+": "+e.returnType},t.prototype.toTypeFormat=function(){var e="",t=this.getParts();return e=t.name+t.body,!t.returnType||(e+=": "+t.returnType),e},t}(F);e.RawFunctionType=N;var P=function(e){function t(t,i){return e.call(this,t,I.FunctionType,i)||this}return __extends(t,e),t.prototype.getParts=function(){var e=this.getPropertyName(),t="";if(Array.isArray(this.typeParams)&&0<this.typeParams.length&&(t="<"+this.typeParams.join(", ")+">"),Array.isArray(this.params)&&0<this.params.length){var i=[];this.params.map(function(e){i.push(e.toTypeFormat())}),t+="("+i.join(",")+")"}else t="()";var n;return this.returnType&&"any"!=this.returnType&&(n=this.returnType),{name:e,body:t,returnType:n}},t.prototype.getParamsFormat=function(){var e=this.getParts();return e.body},t.prototype.getClsFunctionFormat=function(){var e=this.getParts();return e.returnType&&(!e.returnType||"any"!=e.returnType)?e.body+": "+e.returnType:e.body},t.prototype.toTypeFormat=function(){var e=this.getParts();return e.returnType&&(!e.returnType||"any"!=e.returnType)?e.name+e.body+": "+e.returnType:e.name+e.body},t.prototype.addParam=function(e,t,i,n){void 0===i&&(i=!1),Array.isArray(this.params)||(this.params=[]),this.params.push(new k(e,t,i,n))},t.prototype.setReturnType=function(e,t){this.returnType=e,this.returnDoc=t},t.prototype.setTypeParams=function(e){Array.isArray(e)&&0<e.length&&(this.typeParams=e)},t.create=function(e,i){var n=new t(e,i.documentation);return i.parameters.forEach(function(e){n.addParam(e.name,e.type,e.isOptional,e.documentation)}),i.lineInfo&&n.setLineInfo(i.lineInfo),n.setReturnType(i.returnType),n.setTypeParams(i.typeParams),n},t}(x);e.FunctionType=P;var V=function(e){function t(t,i){var n=e.call(this,t,I.StringType)||this;return n.typeFormat=i,n}return __extends(t,e),t.prototype.toTypeFormat=function(){return this.typeFormat},t.prototype.toJSONDecl=function(){var e=this.toTypeFormat().trim();return e.startsWith("{")&&(e=e.substring(1)),e.endsWith("}")&&(e=e.substr(0,e.length-1)),e=e.trim(),{l:0,f:e}},t}(x);e.RawStringObjectLiteralType=V;var L=function(e){function t(t,i){return e.call(this,t,I.ObjectLiteral,i)||this}return __extends(t,e),t.prototype.addField=function(e){this.keys[e.name]=e},t.prototype.setKeysType=function(e){this.keys=e},t.prototype.getPartsWithLineInfo=function(){var e=[];for(var t in this.keys){var i={};i.f=this.keys[t].toTypeFormat(),this.keys[t].lineInfo&&(i.l=this.keys[t].lineInfo.line,this.keys[t].lineInfo.doc&&(i.d=this.keys[t].lineInfo.doc)),e.push(i)}return e},t.prototype.getParts=function(){var e=[];for(var t in this.keys)e.push(this.keys[t].toTypeFormat());return e},t.prototype.toTypeFormat=function(){var e="{\n",t=this.getParts();return e+=t.join(";\n"),e+="\n}",e},t}(x);e.ObjectLiteraltype=L;var j;(function(e){e[e.obj=1]="obj",e[e.fun=2]="fun",e[e.cls=4]="cls"})(j||(j={}));var w=function(e){function t(t,i,n,s){var a=e.call(this,t,i,n,s)||this;return a.fields={},a.flags=0,a}return __extends(t,e),t.prototype.getInternalType=function(){return this.isClass()||this.isSubClass()?g.cls:this.isFunctionType()?g.fun:this.isObjectLiteral()?g.var:g.never},t.prototype.clearAll=function(){this.fields={}},t.prototype.exportToTS=function(){var e;return e},t.prototype.addConstructorFunction=function(e){this.constFun=e},t.prototype.addField=function(e){var t=e.name.split(".");if(1<t.length&&"prototype"==t[1])this.setAsClass();else if(this.isObjectLiteral()){var i=e.name.split("."),n=this.fields[i[0]];return void(n instanceof L&&2==i.length&&(e.name=i[1],n.addField(e)))}this.fields[e.name]=e},t.prototype.exportAliasName=function(){return""},t.prototype.isSubClass=function(){return!!this.baseName},t.prototype.setBaseType=function(e){this.baseName=e},t.prototype.setAsFunction=function(){this.resetState(),this.flags|=j.fun},t.prototype.isFunctionType=function(){return!!(this.flags&j.fun)},t.prototype.setAsObjectLiteral=function(){this.resetState(),this.flags|=j.obj},t.prototype.isObjectLiteral=function(){return!!(this.flags&j.obj)},t.prototype.resetState=function(){this.flags=0},t.prototype.setAsClass=function(){this.resetState(),this.flags|=j.cls},t.prototype.isClass=function(){return!!(this.flags&j.cls)},t.prototype.addTypedefData=function(e){this.typeDefs||(this.typeDefs=[]),this.typeDefs.push(e)},t.prototype.toMinifiedInterfaceFormat_1=function(){var e=this,t=this.apiName.split("."),i=t[0],n=t[1],s="",a="",r=Object.keys(this.fields),o="",p;if(0==this.flags&&1==Object.keys(this.fields).length)this.fields[n];if(this.isObjectLiteral()){var l="";for(var d in this.fields)this.fields[d]instanceof L?l+=this.fields[d].toTypeFormat():this.fields[d]instanceof V&&(l+=this.fields[d].toTypeFormat());var c={api:n,id:this.sysId,tf:l,f:0};return _.updateFlags(c,this.currentSI,this.getInternalType()),c}if(r.forEach(function(t){var i=e.fields[t],r="";if(t!=n+".prototype")r=i.toTypeFormat()+";\n",i.isStatic()?x.isObjectLiteral(i)?a+=i.getPropertyName()+": "+r:a+=r:x.isObjectLiteral(i)?s+=i.getPropertyName()+": "+r:s+=r;else if(x.isObjectLiteral(i)){r=i.getParts().join(";\n"),0<r.length&&(s+=r+";\n");var l=i.keys.initialize;l&&x.isFunctionType(l)&&(p=l)}else x.isStringType(i)&&(o=i.rawType,"{"==o[0]&&o[o.length-1]||(o=""))}),this.isClass()){var g="new";p=p||this.constFun,g+=p?p.getParamsFormat()+": "+this.apiName:"(): "+this.apiName,a=g+";\nprototype: "+this.apiName+";\n"+a}this.isFunctionType()&&!!this.constFun&&(this.constFun instanceof P?a=this.constFun.getClsFunctionFormat()+";\n"+a:this.constFun instanceof N&&(a=this.constFun.rawType+": "+this.constFun.returnType+";\n"+a)),0<o.length&&(o=o.substring(1),o=o.substr(0,o.length-1),s+="\n"+o);var f=[];f.push(s.trim()),f.push(a.trim());var u={api:n,id:this.sysId,f:0,tf:f};return this.isSubClass()&&(u.sp=this.baseName),!this.typeDefs||(u.td=this.typeDefs),_.updateFlags(u,this.currentSI,this.getInternalType()),u},t.prototype.toMinifiedInterfaceFormat=function(){var e=this,t=this.apiName.split("."),i=t[0],n=t[1],s="",a="",r=Object.keys(this.fields),o="",p;if(0==this.flags&&1==Object.keys(this.fields).length)this.fields[n];if(this.isObjectLiteral()){var l="",d=[];for(var c in this.fields)this.fields[c]instanceof L?l+=this.fields[c].toTypeFormat():this.fields[c]instanceof V&&(l+=this.fields[c].toTypeFormat(),d.push(this.fields[c].toJSONDecl()));var g=this.fields[n];if(g.keys)for(var c in g.keys)d.push(g.keys[c].toJSONDecl());var f={api:n,id:this.sysId,df:d,f:0};return _.updateFlags(f,this.currentSI,this.getInternalType()),f}var u=[],m=[];if(r.forEach(function(t){var i=e.fields[t],r="";if(t!=n+".prototype"){r=i.toTypeFormat()+";\n";var l=i.lineInfo,d={};d.l=l.line,l.doc&&(d.d=l.doc),i.isStatic()?(m.push(d),x.isObjectLiteral(i)?(d.f=i.getPropertyName()+": "+i.toTypeFormat(),a+=i.getPropertyName()+": "+r):(d.f=i.toTypeFormat(),a+=r)):(u.push(d),x.isObjectLiteral(i)?(d.f=i.getPropertyName()+": "+i.toTypeFormat(),s+=i.getPropertyName()+": "+r):(d.f=i.toTypeFormat(),s+=r))}else if(x.isObjectLiteral(i)){u=i.getPartsWithLineInfo(),r=i.getParts().join(";\n"),0<r.length&&(s+=r+";\n");var c=i.keys.initialize;c&&x.isFunctionType(c)&&(p=c)}else x.isStringType(i)&&(o=i.rawType,"{"==o[0]&&o[o.length-1]||(o=""))}),this.isClass()){var y="new";p=p||this.constFun;var h={};m.push(h),p?(y+=p.getParamsFormat()+": "+this.apiName,h.f=y,p.lineInfo&&(h.l=p.lineInfo.line,p.doc&&(h.d=p.doc))):(y+="(): "+this.apiName,h.f=y,h.l=0);var C={};C.f="prototype: "+this.apiName,C.l=0,m.push(C),a=y+";\nprototype: "+this.apiName+";\n"+a}if(this.isFunctionType()&&!!this.constFun){var T={};T.l=0,T.f="",m.push(T),this.constFun instanceof P?(a=this.constFun.getClsFunctionFormat()+";\n"+a,T.f=this.constFun.getClsFunctionFormat()):this.constFun instanceof N&&(a=this.constFun.rawType+": "+this.constFun.returnType+";\n"+a,T.f=this.constFun.rawType+": "+this.constFun.returnType)}0<o.length&&(console.warn("fix this extra user case"),o=o.substring(1),o=o.substr(0,o.length-1),s+="\n"+o);var S=[];S.push(s.trim()),S.push(a.trim());var b={api:n,id:this.sysId,f:0,df:[u,m]};return this.isSubClass()&&(b.sp=this.baseName),!this.typeDefs||(b.td=this.typeDefs),_.updateFlags(b,this.currentSI,this.getInternalType()),b},t.prototype.toInterfaceFormat=function(){var e=this,t=this.apiName.split("."),i=t[0],n=t[1],s="",a="",r=Object.keys(this.fields),o="",p;if(0==this.flags&&1==Object.keys(this.fields).length){this.fields[n];console.log("unknown type")}if(this.isObjectLiteral()){var l="interface "+n+" ";for(var d in this.fields)l+=this.fields[d].toTypeFormat();var c="declare const "+n+": "+this.apiName+";",f=new _(this.apiName,this.sysId,l,"const "+n+": "+n+";",c,this.accessType,g.var,0,this.typeDefs);return _.updateFlags(f,this.currentSI,this.getInternalType()),f}if(r.forEach(function(t){var i=e.fields[t],r="";if(t!=n+".prototype")r=i.toTypeFormat()+";\n",i.isStatic()?x.isObjectLiteral(i)?a+=i.getPropertyName()+": "+r:a+=r:s+=r;else if(x.isObjectLiteral(i)){r=i.getParts().join(";\n"),s+=r+";\n";var l=i.keys.initialize;l&&x.isFunctionType(l)&&(p=l)}else x.isStringType(i)&&(o=i.rawType,"{"==o[0]&&o[o.length-1]||(o=""))}),this.isClass()){var u="new";u+=p?p.getParamsFormat()+": "+this.apiName:"(): "+this.apiName,a=u+";\nprototype: "+this.apiName+";\n"+a}this.isFunctionType()&&!!this.constFun&&(this.constFun instanceof P?a=this.constFun.getClsFunctionFormat()+";\n"+a:this.constFun instanceof N&&(a=this.constFun.rawType+": "+this.constFun.returnType+";\n"+a)),0<o.length&&(o=o.substring(1),o=o.substr(0,o.length-1),s+="\n"+o);var m="interface "+n;this.isSubClass()&&(m+=" extends "+this.baseName),s=s.trim(),m+=" {\n"+s+"\n}";var y="interface "+n+"Constructor {\n";a=a.trim(),y+=a+"\n}";var h=m+"\n"+y,C="declare const "+n+": "+this.apiName+"Constructor;",T=new _(this.apiName,this.sysId,h,"const "+n+": "+n+"Constructor;",C,this.accessType,g.cls,0,this.typeDefs);return _.updateFlags(T,this.currentSI,this.getInternalType()),T},t}(S);e.TSTypeExporter=w,e.generateTypedefDeclFromScopemap=r;var O={};e.addToThisSITypedefMap=o,e.clearThisSITypedefMap=p;var R={};e.addToTypeDefMap=l,e.isTypedefType=d,e.generateTypedefDeclFromScopeName=c,e.generateTypedefDecl=function(e){function t(e){var i="";for(var n in e)if("object"==typeof e[n]){var s=t(e[n]);i+="namespace "+n+" {\n"+s+"\n}\n"}else"string"==typeof e[n]&&(i+=e[n]);return i}if(!Array.isArray(e))return"";for(var n={},s=0;s<e.length;s++)for(var a=0,r;a<e[s].length;a++)if(r=e[s][a],r.name){var o=r.name.split("."),p="interface "+o[o.length-1]+" "+r.type+"\n\n";1<o.length&&o.splice(0,1);for(var l=o.splice(o.length-1,1)[0],d=n,c=0;c<o.length;c++)d[o[c]]=d[o[c]]||{},"string"==typeof d[o[c]]&&(console.log("module is defined as type overriding the type with modue "),d[o[c]]={}),d=d[o[c]];d[l]=p}var g=t(n);return g="declare namespace sn {\n"+g+"}",console.log(g),g},e.getTypeDefsAsScopeMap=f,e.getTypeDefs=function(e,t){void 0===t&&(t="-1");var n=[];for(var s in e)for(var a=0;a<e[s].length;a++)Array.isArray(e[s][a].td)&&e[s][a].id!=t&&n.push(e[s][a].td);return n},e.parseSIWithTypeChecker=m;var B="point.js",U="node_modules/@types/snlib/index.d.ts",J=function(){function e(e,t,i){this.snlib=e,this.sourceFiles={},this.outFiles={},this.updateContent(U,this.snlib),t&&this.updateContent("atypes.ts",t),i&&this.updateContent(B,i)}return e.prototype.getOutFiles=function(){return this.outFiles},e.prototype.disposeAll=function(){for(var e in this.sourceFiles)ts.disposeEmitNodes(this.sourceFiles[e]),this.sourceFiles[e]=null},e.prototype.updateContent=function(e,t){this.sourceFiles[e]&&(ts.disposeEmitNodes(this.sourceFiles[e]),this.sourceFiles[e]=null);var i=ts.createSourceFile(e,t,ts.ScriptTarget.ES5,!0,e.endsWith(".ts")?ts.ScriptKind.TS:ts.ScriptKind.JS);this.sourceFiles[e]=i},e.prototype.updateLib=function(e){this.updateContent(U,e)},e.prototype.updateAnonymousContent=function(e){this.updateContent("atypes.ts",e)},e.prototype.updateTypeScriptSI=function(e){this.updateContent("point.ts",e)},e.prototype.updateSI=function(e){this.updateContent(B,e)},e.prototype.getTypeInfo=function(e,t,i){void 0===i&&(i="Point");var n=null;return n=m(e,i,this.sourceFiles[B],t),n},e.prototype.getSourceFile=function(e){return this.sourceFiles[e]?this.sourceFiles[e]:void 0},e.prototype.writeFile=function(e,t){this.outFiles[e]=t},e.prototype.getDefaultLibFileName=function(){return"lib.d.ts"},e.prototype.useCaseSensitiveFileNames=function(){return!1},e.prototype.getCanonicalFileName=function(e){return e},e.prototype.getCurrentDirectory=function(){return""},e.prototype.getNewLine=function(){return"\r\n"},e.prototype.fileExists=function(){return!0},e.prototype.readFile=function(e){return console.log("read file "+e),""},e.prototype.directoryExists=function(){return!0},e.prototype.getDirectories=function(){return[]},e}();e.MyCompilerHost=J;var W={allowNonTsExtensions:!0,target:1,allowJs:!0,sourceMap:!0,noLib:!0,noErrorTruncation:!0,types:["snlib"],linter:!1},z,G,q,H,K,Q,X,Y;e.dotWalkingTransformer=function(e){return function(t){function i(t){if(t=ts.visitEachChild(t,i,e),!ts.isTemplateExpression(t))return t;var s=t.getFullText(),a=n(),r=s.match(a);if(!r)return t;if(0==r.length)return t;var o=r[0].split(".");if(1>=o.length)return t;var p=function(e){var t=e.replace(a,function(e,t,i,n){var s=i;i.startsWith("$$")&&(i=i.substring(2,i.length)),i.startsWith("{")&&(i=i.substring(1,i.length)),i.endsWith("}")&&(i=i.substr(0,i.length-1));var a=i.split(".");return 1==a.length?s:(a.splice(0,1),t+a.join(".")+n)});return t.trim()}(s);return ts.createStringLiteral(p)}return!t.sourceFiles||(t=t.sourceFiles[0]),ts.visitNode(t,i)}},e.initTypeInfoForSingleSI=A,e.generateTypeInfo=function(e,t,i,n){h(i);var s={},a=[],o={};e.forEach(function(e){return e instanceof C||(e=new C(e)),"global"==e.sys_scope.value?void a.push(e):void(!o[e.sys_scope.value]&&(o[e.sys_scope.value]=[]),o[e.sys_scope.value].push(e))});var p=[];for(var l in 0<a.length&&p.push(a),o)p.push(o[l]);var d=null,c=[],g=["point.js","atypes.ts"],u=[],m=0,y="global",T;return p.forEach(function(i){i.forEach(function(i){m++;var a=(100*m/e.length).toFixed(2);if(n)try{n({name:i.api_name,percentage:a,sysId:i.sys_id})}catch(e){}i instanceof C||(i=new C(i));var o=i.getScopeAndAPIMap();if("string"!=typeof i.script)return void console.log("skipping: undefined script found for api "+i.api_name);var p=b(i.api_name,!0);if(!d){var l=b(i.api_name),h=f(Y,"-1"),_=r(h);d=new J(t+"\n\n"+l+"\n\n"+_)}if(d.updateAnonymousContent(p),d.updateSI(i.script),o.scope!=y){var l=b(i.api_name);d.updateLib(t+"\n\n"+l),y=o.scope,T=void 0}T=ts.createProgram(g,W,d,T);try{var S=d.getTypeInfo(i,T.getTypeChecker(),i.api_name);S.accessType=i.access,S.sysId=i.sys_id,S&&c.push(S),s[o.scope]||(s[o.scope]=[]);var A=S.toMinifiedInterfaceFormat();if(s[o.scope].push(A),n)try{n({name:i.api_name,percentage:a,sysId:i.sys_id,decl:A})}catch(e){}}catch(t){u.push(i.api_name)}})}),{formatterResult:s,types:c,errors:u,program:T,host:d}}})(P=t.TSChecker||(t.TSChecker={}))}),define("scripts/tsCompilerOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={allowNonTsExtensions:!0,module:0,noResolve:!0,suppressOutputPathCheck:!0,skipLibCheck:!0,skipDefaultLibCheck:!0,target:1,noImplicitAny:!1,strict:!1,strictNullChecks:!1,noImplicitThis:!1,noImplicitReturns:!1,experimentalDecorators:!1,noUnusedLocals:!1,noUnusedParameters:!1,declaration:!1,sourceMap:!0,jsx:2,jsxFactory:"createElement",noEmitHelpers:!1,isolatedModules:!1,noEmitOnError:!0,stripInternal:!1,types:["snlib"],allowJs:!0,checkJs:!1,noFallthroughCasesInSwitch:!1,allowUnreachableCode:!1,linter:!1,inlineSourceMap:!1,inlineSources:!1}}),define("scripts/recordWatcher",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){function e(e){return"string"==typeof e?(e=e.replace(/\^EQ/g,"").replace(/\^ORDERBY(?:DESC)?[^^]*/g,"").replace(/^GOTO/,""),btoa(e).replace(/=/g,"-")):""}function t(e){return d.getChannel(e)}function i(i,n){var s="/rw/default/"+i+"/"+e(n||"");return d.getChannel(s)}function n(e,t,i){if(void 0===i&&(i="sys_idISNOTEMPTY"),!!e){var n="";return n=t?"sys_id="+t:i,n||(n="sys_idISNOTEMPTY"),r(e,n)}}function s(e,t){if(e)return t=t||"sys_idISNOTEMPTY",r(e,t)}function a(e,t){t&&t.unsubscribe();var i=e.toString();return r("task","sys_idIN"+i)}function r(e,t){return(void 0===t&&(t="sys_idISNOTEMPTY"),l(e))?(p("Blocked from watching",e),null):(p(">>> init "+e+"?"+t),c=i(e,t),c.subscribe(o),d.connect(),c)}function o(e){var t=e.data,i=e.channel;p(t)}function p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log(e.join("s"))}function l(e){return"sys_amb_message"==e||e.startsWith("sys_rw")}var d;if("undefined"==typeof g_ambClient?window.top.g_ambClient&&(d=window.top.g_ambClient):d=g_ambClient,!!d){var c;return{getChannel:t,initTaskList:a,initChannel:r,init:function(e,t,i){void 0===i&&(i=""),n(e,t,i)},initList:s,initRecord:function(e,t){n(e,t,"")}}}}});var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t=1,a=arguments.length,n;t<a;t++)for(var r in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},__assign.apply(this,arguments)},__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("scripts/SIDeclEmittor",["require","exports","scripts/constants","scripts/siParser","scripts/tsCompilerOptions","scripts/recordWatcher"],function(e,t,i,n,s,a){"use strict";function r(){return"undefined"!=typeof window}function o(){return!r()}function l(){return!!o()||d()&&window.recordConfig.canWrite}function d(){return!!o()||window.recordConfig.canRead}function c(e){l()&&e&&(G=new W(e),self.yln={dispatcher:G},G.sendMsg({cmd:U.THREAD_INITIALIZED}))}function g(e){return void(void 0===e&&(e=!1));var t=window.ylnWorker}function f(t){if(void 0===t&&(t=__assign({},_(k().isJavascript()))),!l())return Promise.reject("Unable to write Script Include");var i=__assign({},Ce);if(i.script="",i.typedeclaration="",i.typesourcemap="",!K){var n={cmd:U.UPDATE_LIBS,lib:e("vs/language/typescript/lib/lib").lib_es5_dts,typeDecl:he,siRecord:i};G.sendMsg(n).then(function(){K=!0})}var s={cmd:U.SINGLE_SCRIPT_INCLUDE_REQUEST,siRecord:i,options:t},a=G.sendMsg(s);return g(),a.then(function(){clearTimeout(H),H=-1,q--},function(){clearTimeout(H),H=-1,q--}),q++,a}function u(t){if(!l())return Promise.reject("Unable to write Script Include");var i=e("vs/language/typescript/lib/lib").lib_es5_dts;t.forEach(function(e){Q[e.sys_id]={record:e},e.parseReturnType=!0,"undefined"!=typeof X[e.sys_id]&&(!X[e.sys_id]&&console.log("skipping return type for "+e.api_name),e.parseReturnType=X[e.sys_id])}),g();var n=G.sendMsg({cmd:U.SCRIPT_INCLUDE_REQUEST,typeDecl:he,lib:i,siRecords:t});return n}function m(){var e=Ce.getScopeAndAPIMap().scope,t=monaco.languages.typescript.typescriptDefaults;(0==j.length||j!=e)&&(0!=j.length&&w.dispose(),w=e==i.GLOBAL_SOCPE?t.addExtraLib(de,"yln_"+Y+i.JAVA_GLOBAL_API):t.addExtraLib(ce,"yln_"+Y+i.JAVA_SCOPE_API)),j=e}function y(){Y++,m();var e=new n.DefinitionEmittor(ye),t={};Ce.isNew()||(t[Ce.sys_id]=!0),fe=e.emit(Ce.getScopeAndAPIMap().scope,t)+L.newline+ue,R&&(R.dispose(),R=null);var s="yln_"+Y+i.JS_API;R=monaco.languages.typescript.typescriptDefaults.addExtraLib(fe,s),B&&B.dispose(),B=null;var a=n.TSChecker.getTypeDefsAsScopeMap(ye,Ce.sys_id),r=n.TSChecker.generateTypedefDeclFromScopemap(a),o="yln_"+Y+i.TYPE_DEFS;B=monaco.languages.typescript.typescriptDefaults.addExtraLib(r,o),K=!1}function h(e){if(!e)return void y();if(e.id!=Ce.sys_id){if(!e.sc)return void console.warn("scope name not found in record watcher "+JSON.stringify(e));ye[e.sc]||(ye[e.sc]=[]);for(var t=-1,s=ye[e.sc],a=0;a<s.length;a++)if(s[a].id==e.id){t=a;break}var r=n.SITSFormat.expandMinifiedFormat(e,e.sc,n.SITSFormat.isTypescript(e.f));-1==t?ye[e.sc].push(r):"delete"==e.op?ye[e.sc].splice(t,1):ye[e.sc][t]=r,y()}}function C(){return!!window.g_ck}function T(){return!!window.recordConfig&&window.recordConfig.isFromScriptRunner&&"undefined"==typeof g_form}function _(e){var t={};if(e){var i=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();return i.target=s.default.target,i.allowJs=s.default.allowJs,i.checkJs=s.default.checkJs,i.strict=s.default.strict,i.jsx=s.default.jsx,i.jsxFactory=s.default.jsxFactory,i.noImplicitAny=s.default.noImplicitAny,i.strictNullChecks=s.default.strictNullChecks,(s.default.target>se.ES2015||T())&&(i.sourceMap=s.default.sourceMap),i.noImplicitThis=s.default.noImplicitThis,i.noImplicitReturns=s.default.noImplicitReturns,i.noUnusedParameters=s.default.noUnusedParameters,i.noUnusedLocals=s.default.noUnusedLocals,i.noFallthroughCasesInSwitch=s.default.noFallthroughCasesInSwitch,i.linter=s.default.linter,i}return t.jsx=s.default.jsx,t.jsxFactory=s.default.jsxFactory,t.noFallthroughCasesInSwitch=s.default.noFallthroughCasesInSwitch,t.allowUnreachableCode=s.default.allowUnreachableCode,t.module=monaco.languages.typescript.ModuleKind.None,t.noResolve=s.default.noResolve,t.skipLibCheck=s.default.skipLibCheck,t.skipDefaultLibCheck=s.default.skipDefaultLibCheck,t.target=s.default.target,t.noImplicitAny=s.default.noImplicitAny,t.strictNullChecks=s.default.strictNullChecks,t.noImplicitThis=s.default.noImplicitThis,t.noImplicitReturns=s.default.noImplicitReturns,t.experimentalDecorators=s.default.experimentalDecorators,t.noUnusedLocals=s.default.noUnusedLocals,t.noUnusedParameters=s.default.noUnusedParameters,t.declaration=s.default.declaration,t.sourceMap=s.default.sourceMap,t.noEmitHelpers=s.default.noEmitHelpers,t.isolatedModules=s.default.isolatedModules,t.noEmitOnError=s.default.noEmitOnError,t.strict=s.default.strict,t.stripInternal=s.default.stripInternal,t.linter=s.default.linter,t}function S(){return ye}function b(){return k().isGlobalScope()?de:ce}function A(){return ge}function I(){return fe}function x(){return me}function E(){return b()+L.newline+A()+L.newline+I()+L.newline+x()}function M(){return he}function F(e,t,s,a){he=e;var r=i.GLOBAL_SOCPE;if(0!=t.length){var o=t.split(".");r=o[0].trim()}for(var p={},l=0,d=he,c;l<d.length;l++)c=d[l],p[c.name]="string"==typeof c.json_value?{api:JSON.parse(c.json_value).api,customization:c.customization}:{api:c.json_value.api,customization:c.customization};ye||!p.jsAPI||(ye=p.jsAPI.api),"string"==typeof ye&&(ye=JSON.parse(ye+""));var g=function(e){var t=ye[e];t.forEach(function(t,i,s){if("undefined"!=typeof t.f){var a=n.SITSFormat.expandMinifiedFormat(t,e);a&&(s[i]=a)}})};for(var f in ye)g(f);var u=n.TSChecker.getTypeDefsAsScopeMap(ye,s),m=n.TSChecker.generateTypedefDeclFromScopemap(u),y=new n.DefinitionEmittor(ye);de=p.javaGlobalAPI.api+L.newline+p.javaGlobalAPI.customization,ce=p.javaScopedAPI.api+L.newline+p.javaScopedAPI.customization,ge=p.tableAPI.api+L.newline+p.tableAPI.customization,fe=y.emit(r,a)+L.newline+p.jsAPI.customization,ue=p.jsAPI.customization;var h=monaco.languages.typescript.typescriptDefaults;(0==j.length||j!=r&&r==i.GLOBAL_SOCPE)&&(0!=j.length&&w.dispose(),w=r==i.GLOBAL_SOCPE?h.addExtraLib(de,i.JAVA_GLOBAL_API):h.addExtraLib(ce,i.JAVA_SCOPE_API)),j=r,O||(O=h.addExtraLib(ge,i.TABLE_API)),R&&R.dispose(),R=null,R=h.addExtraLib(fe,i.JS_API),B&&B.dispose(),B=null,me=m,0<m.length&&(B=h.addExtraLib(m,i.TYPE_DEFS))}function k(){return Ce}function D(){return P()?"module.tsx":Ce.isJavascript()?"module.js":"module.ts"}function N(e,t){if((void 0===e&&(e=!1),!Ce.isTypescript())&&(Te&&(Te.dispose(),Te=null),Ce.canGenerateDeclaration()||T()))if(!window.recordConfig.useTypeChecker){var i=Ce.generateCurrentSIDeclaration(esprima,e||!!window.recordConfig.jsdoc);Te=monaco.languages.typescript.typescriptDefaults.addExtraLib(i,"current.d.ts")}else{if(!t)return;if(0<t.tf.length){var n=Ce.formatCurrentSITSFormat(t);Te=monaco.languages.typescript.typescriptDefaults.addExtraLib(n,"current.d.ts")}}}function v(){return window.recordConfig?window.recordConfig.libVersions.jsLibState:!!window.snMonacoConfig&&window.snMonacoConfig.libState.jsLibState}function P(){return window.recordConfig&&window.recordConfig.isSeismic}function V(){if(!_e){_e=!0;["node_modules/@types/react/global.d.ts","node_modules/@types/prop-types/index.d.ts","node_modules/@types/react/index.d.ts","node_modules/csstype/index.d.ts","https://cdn.jsdelivr.net/gh/yln99517/yln-monaco/seismic_v1.d.ts"].forEach(function(e){var t=e.replace("node_modules","https://www.unpkg.com/");fetch(t).then(function(e){return e.text()}).then(function(t){monaco.languages.typescript.typescriptDefaults.addExtraLib(t,e)})})}}Object.defineProperty(t,"__esModule",{value:!0}),i=__importStar(i),n=__importStar(n),s=__importDefault(s),a=__importDefault(a);var L=n.TokenType,j="",w,O,R,B,U;(function(e){e[e.THREAD_INITIALIZED=0]="THREAD_INITIALIZED",e[e.SCRIPT_INCLUDE_REQUEST=1]="SCRIPT_INCLUDE_REQUEST",e[e.SCRIPT_INCLUDE_RESPONSE=2]="SCRIPT_INCLUDE_RESPONSE",e[e.SINGLE_SCRIPT_INCLUDE_REQUEST=3]="SINGLE_SCRIPT_INCLUDE_REQUEST",e[e.SINGLE_SCRIPT_INCLUDE_RESPONSE=4]="SINGLE_SCRIPT_INCLUDE_RESPONSE",e[e.UPDATE_LIBS=5]="UPDATE_LIBS",e[e.PROGRESS_MSG=6]="PROGRESS_MSG"})(U||(U={}));var J=function(){function e(){}return e.getInstance=function(t,i,s){return null==e.instance?(e.instance=new e,e.instance.typeInfo=n.TSChecker.initTypeInfoForSingleSI(t,i,s),e.instance):(t&&i&&(e.instance.typeInfo.dispose(),e.instance.typeInfo=n.TSChecker.initTypeInfoForSingleSI(t,i,s)),e.instance)},e.prototype.handleRequest=function(e){var t=new n.ClientSIRecordData(e.siRecord);return Ce=t,console.log("si reqest parser came"),Ce.isNew()&&2>t.api_name.split(".").length&&(t.api_name="global.Point"),this.typeInfo.getTypeInfo(Ce,e.options)},e}();t.SingleSIRequestHandler=J;var W=function(){function e(e){this.sender=e,this.pendingReplies={},this.seqNumber=0,e.onmessage=this.handleMessage.bind(this)}return e.prototype.cancelAllExistingPromises=function(){for(var e in this.pendingReplies)this.pendingReplies[e].reject("Parser thread is too busy for this operation. Please try again or contact yln99517@gmail.com with your SI"),delete this.pendingReplies[e]},e.prototype.sendReplyMsg=function(e,t){this.sender.postMessage(__assign({seqNum:t},e))},e.prototype.sendMsg=function(e){var t=this,i=this.seqNumber++ +"",n=__assign({seqNum:i},e),s=new Promise(function(e,s){t.pendingReplies[i]={resolve:e,reject:s},t.sender.postMessage(n)});return s},e.prototype.isSIProgressMsg=function(e){return e.cmd==U.PROGRESS_MSG},e.prototype.isSingleSIRequest=function(e){return e.cmd==U.SINGLE_SCRIPT_INCLUDE_REQUEST},e.prototype.isSIParserRequest=function(e){return e.cmd==U.SCRIPT_INCLUDE_REQUEST},e.prototype.isSIParserResp=function(e){return e.cmd==U.SCRIPT_INCLUDE_RESPONSE},e.prototype.isLibUpdateMsg=function(e){return e.cmd==U.UPDATE_LIBS},e.prototype.handleMessage=function(t){var e=this,i=t.data,s=this.pendingReplies[i.seqNum];if(s){delete this.pendingReplies[i.seqNum];try{i.errorMsg?s.reject(i.errorMsg):s.resolve(i)}catch(t){console.log("error on resolving thread message "+t)}return}if(this.isSIParserRequest(i)){var a=n.TSChecker.generateTypeInfo(i.siRecords,i.lib,i.typeDecl,function(t){var i={seqNum:"-1",cmd:U.PROGRESS_MSG,name:t.name,sysId:t.sysId,percentage:t.percentage,decl:t.decl};e.sendReplyMsg(i,"-1")}),o={seqNum:i.seqNum,cmd:U.SCRIPT_INCLUDE_RESPONSE,formatterResult:a.formatterResult,types:a.types,errors:a.errors};this.sendReplyMsg(o,i.seqNum)}else if(this.isSingleSIRequest(i)){var p=J.getInstance().handleRequest(i);this.sendReplyMsg(p,i.seqNum)}else this.isLibUpdateMsg(i)?(J.getInstance(i.lib,i.typeDecl,i.siRecord),this.sendReplyMsg({replayMsg:"thank you",cmd:U.SINGLE_SCRIPT_INCLUDE_RESPONSE},i.seqNum)):i.cmd==U.THREAD_INITIALIZED?z=!0:this.isSIProgressMsg(i)&&r()&&(g(!0),X[i.sysId]=!!i.decl,!i.decl&&console.log("Parser started for => "+i.name),"function"==typeof window.onSIParserProgressEvent&&window.onSIParserProgressEvent(i.name,i.percentage,i.decl))},e}();t.isMainThread=r,t.isWorkerThread=o,t.canWriteSI=l,t.canReadSI=d;var z=!1,G;t.onThreadInitialized=c;var q=0,H=-1,K;t.generateTypeDeclForSingleRecord=f;t.gotoDefintionService={open:function(){var e=arguments[0],t=e.authority.split("."),i=S();if(!i[t[0]])return void console.log("invalid scope name when opening file "+e.authority);var n=i[t[0]].find(function(e){return e.api==t[1]});if(!n)return void console.log("invalid scope name when opening file "+e.authority);var s=e.path.substr(1),a="./sys_script_include.do?sys_id="+n.id+"&gotoLine="+s;return window.open(a),console.log(JSON.stringify(arguments)),{catch:function(){console.log("eror callback")}}}};var Q={},X={};t.generateTypeDeclarations=u,t.scopeUpdated=m;var Y=0;t.apiDeclarationUpdated=y,t.siUpdated=h;var Z;if(r()&&"undefined"!=typeof BroadcastChannel){var ee=a.default();if(ee){var te=ee.getChannel("/yln/typedef");te.subscribe(function(e){h(e.data)})}}t.updateSIDeclListeners=function(e){!Z||Z.postMessage(JSON.stringify(e))},t.isServiceNow=C;var ie=function(){return function(e,t,i,n,s,a){void 0===e&&(e=""),void 0===t&&(t=""),void 0===i&&(i=""),void 0===n&&(n=""),this.js=e,this.declaration=t,this.sourceMap=i,this.tsScript=n,this.backEndDecl=s,this.linterErrors=a}}();t.TranspilerOutput=ie;var ne=function(e){return function(t){function i(t){if(t=ts.visitEachChild(t,i,e),!ts.isTemplateExpression(t))return t;var s=t.getFullText(),a=n.getDotWalkingRegExp(),r=s.match(a);if(!r)return t;if(0==r.length)return t;var o=r[0].split(".");if(1>=o.length)return t;var p=function(e){var t=e.replace(a,function(e,t,i,n){var s=i;i=i.replace(/^\$\${/,""),i=i.replace(/\}$/,"");var a=i.split(".");return 1==a.length?s:(a.splice(0,1),t+a.join(".")+n)});return t.trim()}(s);return ts.createStringLiteral(p)}return ts.visitNode(t,i)}};t.isScriptRunner=T;var se;(function(e){e[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES2015=2]="ES2015",e[e.ES2016=3]="ES2016",e[e.ES2017=4]="ES2017",e[e.ES2018=5]="ES2018",e[e.ESNext=6]="ESNext",e[e.JSON=100]="JSON",e[e.Latest=6]="Latest"})(se||(se={})),t.getCompilerOptions=_;var ae=function(){function t(e,t,i,n){void 0===n&&(n=ts.ScriptTarget.ES5),this.sourceContent=e,this.libContent=t,this.snLibContent=i,this.SOURCE_PATH="module.ts",this.LIB_PATH="lib.d.ts",this.SN_LIB_PATH="node_modules/@types/snlib/index.d.ts",this.sourceFileMap={},this.fileMap={},t+="\n\n\n"+E(),this.sourceFileMap[this.LIB_PATH]=ts.createSourceFile(this.LIB_PATH,t,n);var s=Ce.isJavascript()?ts.ScriptKind.JS:ts.ScriptKind.TS;Ce.isJavascript()&&(this.SOURCE_PATH="module.js");var a=ts.createSourceFile(this.SOURCE_PATH,Ce.tsscript,ts.ScriptTarget.ES5,!0,s);this.sourceFileMap[this.SOURCE_PATH]=a;var r=ts.transform(a,[ne]),o=r.transformed[0],p=ts.createPrinter(),l=p.printFile(o);ts.disposeEmitNodes(a),r.dispose(),this.sourceFileMap[this.SOURCE_PATH]=a.update(l,{span:{start:0,length:e.length},newLength:l.length})}return t.prototype.getFileMap=function(){return this.fileMap},t.prototype.getSourceFile=function(e){return this.sourceFileMap[e]},t.prototype.writeFile=function(e,t){"module.js"==e?this.fileMap.js=t:"module.d.ts"==e?this.fileMap.declaration=t:this.fileMap.sourceMap=t},t.prototype.getDefaultLibFileName=function(){return"lib.d.ts"},t.prototype.useCaseSensitiveFileNames=function(){return!1},t.prototype.getCanonicalFileName=function(e){return e},t.prototype.getCurrentDirectory=function(){return""},t.prototype.getNewLine=function(){return"\r\n"},t.prototype.fileExists=function(){return!0},t.prototype.readFile=function(){return""},t.prototype.directoryExists=function(){return!0},t.prototype.getDirectories=function(){return[]},t.compile=function(i,n){void 0===i&&(i=__assign({},_(!1))),void 0===n&&(n=!1);var s=new ie,a=e("vs/language/typescript/lib/lib").lib_es5_dts+"\n\n\n"+E(),r=new t(k().tsscript,a,E()),o=ts.createProgram([n?"module.js":"module.ts"],i,r),l=o.emit(),d=r.getFileMap();for(var c in d)console.log(d[c]);var p=ts.getPreEmitDiagnostics(o).concat(l.diagnostics);p.forEach(function(e){if(e.file){var t=e.file.getLineAndCharacterOfPosition(e.start),i=t.line,n=t.character,s=ts.flattenDiagnosticMessageText(e.messageText,"\n");console.log(e.file.fileName+" ("+(i+1)+","+(n+1)+"): "+s)}else console.log(""+ts.flattenDiagnosticMessageText(e.messageText,"\n"))});var g=l.emitSkipped?1:0;if(console.log("Process exiting with code '"+g+"'."),o.getSourceFiles().forEach(function(e){return ts.disposeEmitNodes(e)}),0!=g)return Promise.reject("Compilation Errros");s.js=d.js,s.tsScript=Ce.tsscript,s.sourceMap=d.sourceMap;var f=Ce.emitTSDeclaration(d.declaration);return s.declaration=Ce.typedeclaration=JSON.stringify(f),Ce.script=s.js,Ce.typesourcemap=s.sourceMap,Promise.resolve(s)},t.getModelValueAfterTransform=function(e){var i=t.applyTemplateTransformation(e),n=i.transformed[0],s=ts.createPrinter(),a=s.printFile(n);return i.dispose(),a},t.getSourceAfterTransform=function(e){var i=t.applyTemplateTransformation(e);return i.transformed[0]},t.applyTemplateTransformation=function(e){var t="proxyModel.js",i=ts.ScriptKind.JS;Ce.isTypescript()&&(t="proxyModel.ts",i=ts.ScriptKind.TS);var s=ts.createSourceFile(t,e,ts.ScriptTarget.ES5,!0,i),a=ts.transform(s,[n.TSChecker.dotWalkingTransformer]);return a},t}();t.TSCompilerHost=ae,r()&&(window.transform=ae.getModelValueAfterTransform);var re=function(){function e(e,t){void 0===t&&(t=""),this.pathName=e,this.filter=t}return e.prototype.fetch=function(){if(this.fetchPromise)return this.fetchPromise;var e=this;return this.fetchPromise=new Promise(function(t){jQuery.ajax({url:e.pathName,data:{},headers:{"X-UserToken":window.g_ck},success:function(i){e.onFetch(i);try{t(i.result)}catch(e){console.log("error on resolving promise")}console.log("received for path "+e.pathName)}})}),this.fetchPromise},e.prototype.onFetch=function(){},e}();t.RecordFetcher=re;var oe=function(e){function t(t,i){void 0===i&&(i="");var n=e.call(this,t,i)||this;return n.pathName=t,n.isDataAvailable=!1,(!C()||v())&&(n.isDataAvailable=!0,n.cachedData="string"==typeof window.snLibContent?JSON.parse(window.snLibContent).result:window.snLibContent.result),n}return __extends(t,e),t.prototype.fetch=function(){var t=this;return this.isDataAvailable?new Promise(function(e){e(t.cachedData)}):e.prototype.fetch.call(this)},t.prototype.onFetch=function(e){this.isDataAvailable=!0,this.cachedData=e.result},t}(re);t.CachedRecordData=oe;var pe=i.DECLARATION_TABLE_PATH;r()&&!C()&&(pe=i.DECLARATION_DATA_PATH);var le=null;r()&&(le=new oe(pe,""),le.fetch());var de="",ce="",ge="",fe="",ue="",me="",ye;t.getSIMap=S,t.getJavaAPI=b,t.setJavaAPI=function(e){de=e},t.getTableAPI=A,t.getJSAPI=I,t.getTypedefAPI=x,t.getAllDeclAPI=E;var he;t.getTypeDeclarations=M,t.internalInitialize=F;var Ce;t.getCurrentSI=k,t.getCurrentModuleName=D;var Te;t.updateCurrentSIDeclaration=N,t.isJSCacheReady=v,t.isSeismicComponent=P;var _e=!1;t.loadJSXIntellisense=V,t.initializeWithSIRecord=function(e){Ce=e;var t=new Promise(function(e){return P()?e():void le.fetch().then(function(t){var i={};Ce.isNew()||(i[Ce.sys_id]=!0),F(t,Ce.api_name,"",i),C()&&N(!1),e()})});return t},t.initializeTypeDeclarations=function(e){return void 0===e&&(e=""),e=e||"global.",new Promise(function(t){le.fetch().then(function(i){F(i,e,"-1",{}),t()})})}});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t};define("scripts/fileSearch",["require","exports","scripts/SIDeclEmittor","scripts/siParser"],function(e,t,n,s){"use strict";var o=Math.ceil,p=Math.floor,l=Math.max;function a(e,t){for(var n=-1,s=0,a=0,r=e.length,o=0,p=t.length,d=!1,c=!1,g=!0,f=null,u=null,m=null,y=0,h=[];o!=p;){var C=a==r?null:e.charAt(a),T=t.charAt(o),_=null==C?null:C.toLowerCase(),S=T.toLowerCase(),b=T.toUpperCase(),A=C&&_==S,I=f&&u==S,x=A&&f,E=f&&C&&u==_;if((x||E)&&(s+=y,h.push(m),f=null,u=null,m=null,y=0),A||I){var M=0;if(0==a){var F=l(o*-3,-9);s+=F}d&&(M+=5),g&&(M+=10),c&&T==b&&S!=b&&(M+=10),A&&++a,M>=y&&(null!=f&&(s+=n),f=T,u=f.toLowerCase(),m=o,y=M),d=!0}else k+=T,s+=n,d=!1;c=T==S&&S!=b,g="_"==T||" "==T,++o}f&&(s+=y,h.push(m));for(var k="",D=0,N=0;N<h.length;++N){var v=h[N],P=t.substr(D,v-D),V=t.charAt(v);k+="<span class = \"no-match\">"+P+"</span><span class='highlight'>"+V+"</span>",D=v+1}0!=t.length-D&&(k+="<span class=\"no-match\">"+t.substr(D,t.length-D)+"</span>");var L=a==r;return[L,s,k]}function r(e,t,s){function r(){clearTimeout(l),l=null;var r=performance.now()+o,d=n.getSIMap();for(var c in d)for(var g=d[c],f=0;f<g.length;f++){var u=g[f].api.split("."),m=u[0];2==u.length&&g[f].api.split(".")[1];var y=e(t,m);e==a&&!0!=y[0]||p.push({rank:y[1],matchStr:y[2],item:g[f]})}return s(p),null}var o=1e3/30,p=[],l=null;this.cancel=function(){null!==l&&clearTimeout(l)},this.start=function(){r()},this.flush=function(){o=1/0,r()}}Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n);var d=function(){function e(e){this.domNode=e,this.id="FileSearch"}return e.prototype.getId=function(){return this.id},e.prototype.getDomNode=function(){return this.domNode},e.prototype.getPosition=function(){return null},e}(),c=function(){function e(e){this.name=e}return e.prototype.update=function(){},e}(),g="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH4gcPDwoiWcgyPAAAAh5JREFUSMfV1U2IjWEUB/Df/aDBVVj4mHEZnwmFBVGWdthJESGEUrOSpTWRKERNYqwsSKJ8pGztrCjF1FgIibi5GMPiOdc83ebOZXb+9fae53nOec/X/zkv/zsKI23WB7pbGnRU+0c9b9YdzUEJMzEev/AOtSbVMqqYFTpvMIDBXKEVpqEPi8OgB7ey8yU4gg2hCx/wCMfxvJ2DErrigUnZ2QJcwZommwp2Yzl24nmxTRl/xXsok2Ff9vEaHuIBvsTefCxtl0ErTMS6bN2LoxHAXmzEKTz+GwcjkaCEjmz9BvWQL0Xp/pChXYlGwleJKQ0cwB6p0YP5xzuq/aM6KLTYH8QNfI/1XFzEHRxGZ0OxPtA9pgzgJk7jW6zHYS3O4i52xF5bB3kWOYvqOIb9eGL4YhWwQupFD4pjzUBE3yexZg/uG272BOkSri//7VxpyiDHe1yLsm3DCUzFdGzKM1goNSwvT34+lMmzcQjzsr0aLkfJGugqhreDUnPOSiwoYjVmhOIPfAx5C27jPM5gmdTQElZJt7iBD2VpWJ2UZs1CzMHrUK6EYj+ehbwIK0PeHPJT/AybOXH2GQ/K0gy5Ho0qhMHKLIofuBBO4Zw0ovdF5NV4cgxJTLpXiCZPkS7J9lAeL7HkZSj2GuY8aR5txa4o0eQI7ite4Gr0o1ZoYlFnNK6CT+HgrdaooFtiTEn6H7yKd2LKv/z+GhiLzf+L3xLMgT1r10J2AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA3LTE1VDEzOjEwOjM0KzAyOjAwRXld0gAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wNy0xNVQxMzoxMDozNCswMjowMDQk5W4AAAAASUVORK5CYII=\" alt=\"\" />",f="<img  src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAD6CAMAAAC/MqoPAAACtVBMVEVHcEwChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdMChdOSyISIAAAA5nRSTlMADp7WvNdD8g2AymLxKI/4+Z25Bpzu31C99FPvusICIRnrrAoI1UWb/XA1Ec4aG+cLA+ROrUQmByqptPM+S3FI3L4z8MDY+tn2meLgDA8gsJ9Sc0Yw/PWkQt7Uu8hmFYuRCcnbT4dvW2cnin9++5eDNjjE5sPhBU2yJR8ulmzRdow7rxYyoKLjVoFlxxI0pa4p0Ct3hVGIdZq4fagE2iOzYaPta7cQ3ZQUhPeQWgHsLGimF12TWZhBlcxfL40dy78eiRxyqsVVYOUTpxh0THstMdJ5tml4XCIkgs1tR+nq/qs8wT9kOT1MaxsAAAb7SURBVHja7d2Dl+XYHsXxfV2XZdvVXXa1OW3btu0e27bnjZ9t27ax/41nz0lubmmS3zmfaPms71KcwDAMwzAMwzAMwzAML0jeWB5xgZKlGHez6A7LMe5K6Q45XRhv2XSHbB/GW4TuEMlyd7pJN+km3aSbdJNu0k26STfpJt2km/Qp45++lu6Q48N4+zXdoagb4+2DdIfHMO66v5UKZmxWgjZKY8EM5R3vhVf43kcrU/a/DNHW0MplCPcHWmiDdNNoYS+km7iWag9BusEE1aKQbklE2/Qsk27STbpJT8ukm3STbtJNuknP6giH49G/ueL3Pxr9m7Jw+KYs0eldnyg7nheLtFAhOxIK+qNl4Q5x6fX9r68oKWd6LaGKFdsnfMQnJL1jQl0tM5N4qtj76cWpL7VwOIr6pg94OP3z18/nSKw/6c301q3Lj3KkKnZ6MP29hRwNs7yW3rp3PkfJGm+l7yvkqDnvpfSVpziKwh5K30Hqmd7/PWqa/hKpZ3p+LnVNz6Om6Z/aQk3T8xdR0/Snd1HX9Dzqmv46nWgJBe/1X4n+l0f9/r5gKOLh9JVML3b96g6rwW+I+2PeTPdFaK9w/fSfII1k/FiJ99IraWv+S61wZmDVJm+lT6ed+76CTJzcscVD6bQRmI2MlVV4Jf1NWqo9gGHpXV/qhfSDtJR3N4arfZIH0i/QyqsYid773J6e/xta+CNG6MSNZLGL0/fSwmGM3Hu23+ze9IajVEuJv79+gGq7IT69jWr3iE/3ZVPpGMSnF1Mp8S756QVU+iLkp5+l0sflp1+i0ruXyE+PU6kC8tObqfQFDdI/Q6UNGqRXUiXnoAbp11BlTre26Qt8GqSHqNJZr236r7q0TS8d1Df9NQ3SZ1LpTxqkf5pK0zVIL6HSGQ3SF1LpjaXy039BtVXy009QrVJ++uCLVJsoPd36htvH5Kc/TwtPansdnjlLpKdjES00ik9vppVbpae309LjwtMxmZYWCk9fRmuPy07HYlp7QXZ6GW08s0ZyOippo6VXcnoNbT0hOB19tNXWLze9oZP21r8mNR03MI3yXqnpeJjp/HyP0HRsYVqTlslMR4BprX3uhMj0+xN0YMfLAtNR8yIdKCxol5eO3yXoRGn0a+LSUdNDRxIFa6Sl42AnHcp9Vlg66uvo0NqCalnpQC6dyoluk5WO/S10qrTgoqh0fOcBOrevW1I6kKJzi6I+Sel4Zzmd+2qTpHTc/SozsGmGoHTg9k5mYNI3BKWj/g5mYF1Bt5x0YHYjM7B7hqB04JcBZmBytaB0IDqPzuWcl5SO9iPMwOYBQenAxVw6t+DLktKB2ZnEf32npHQgvJmOLR4SlQ5Mq6BT2RNkpQO3B+jUt4WlA/t30aHl9cLSgesK6UxgUFo6Wq8G6Mj8i55Nt3ZdDp3oWSYvHZcOF9KB7Gny0oHWQ3Ti/QLTgeSbTO+VAYnpwP0XmNZZmenAI31M5zmh6cC+OUxjodR0bDvENJqkpgOzi2jraJfYdOQ/RlvvkJsOrC6ine8KTkfDrbSx+2nB6cBW2jgsOh3nF9BSuex0LCunpT2y0/HTa2klJDwd52hphvB0rKaVPOnp+DEtzBGfjlO0MFV8egctfFR8On5EtZny07GYapfkp2+n2gH56TdTLSU/HSEqTdYg/QiV2jRIv4dKMzVIryqkyib56VZHdLU6pE+iygId0j9MlYgO6X6qTNEhPZcq63RIb6bKRh3Sl1OlUYf0M1QJaJB+rpAqlRqkD1HpCQ3SV1HpkAbpbVT6kPz0JNWq5affQaWzkJ9eSaUCF6bvCY7qK/gTqVbswvQAmfM8Rs21VFrnc2F6EUnm7Rzjhysa3fvzk8VX8zEKGt6g2sNu/hdE0QyM3FxaqHFzOvnbRzBCK2jhB3B3OnmmCSPRTCtJ16eTv1/ZjuHKpZVF8EA6Oe+WJgzH6mdo6QNvW/rnMkknedfVy8jQwM9oLYCxtpQWvmmfrrLRX3wOjp3MpZ3PYqwNdlJtqn26hdN18ctLkd6zKye/7U9G48G6nshbxZqXpE+3MOWu6NQuWLupLBViGut8GA9VWW8FeyGmUT4rFd8wVJ1V9T/jVA9tmHAsls30psKtQnQm0hMMBuui0ei9f932ROjUJ+Hp9BEoga7pJdA1/fQ2XdMDPmiaPrcemqa/AJd7hWPkCNxuI8dE0US43vc5Fq7kwwMWctTNHYI3PBTiqJr5JLxjWgVHTVEc3tK04jaOhtiqfHhOVdNT8zgy81IPwqNqfth3G4fr9Nw7a+BlVck7NyeYscQtxfkQwNcfrWispVO1u5r7fRCkIVl2PC8Woa1ILBVPNkCkrGR4QtQfLGkMhWoj/zbnmtADwbpofGIWhDEMwzAMwzAMwzAM4y/wP4iuedx40wAAAABJRU5ErkJggg==\" >";f="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAMAAAAolt3jAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB6VBMVEUAAABCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfX///+B2un8AAAAonRSTlMAAAAAAAAAAAAAAAAAAAUPEREREQ8CAA8WBgAAPq24t7e4pBk6rMWFFwA4mKXk66ePK7/PoclBAAIHFbPDGAUm3agnHwcAAAANs8IRAAqR78dsEgAADrPCEgAADmG875YXAA6zwhIAGVQfH7nvTAAOtsUSAEvfv5rjtycACoSODgAJVrXHmSgAAAENDQEAAAEQFwoAAAAAAAAAAAAAAAAAAACWgQ7oAAAAAWJLR0SisN3fjAAAAAd0SU1FB+MCDg4gM+bRj2EAAADDSURBVAjXY2BABYxMzCysbOwcnFzcPLwMDHz8AoJCwiKiYuISklLSDDKycvIKikrKKqpq6hqaDFraOrp6+gaGRsYmpmbmDBaWVtY2tnb2Do5Ozi6uDG7uHp5e3j6+fv4BgUHBDAwhoWHhEZFR0TGxcfEJDAyJSckpqWnpGZlZ2Tm5DAx5+QWFRcUlpWXlFZVVDAzVNbV19Q2NTc0trW3tDAwdnV3dPb19/RMmTpo8hYFh6rTpM2bOmj1n7rz5Cxai+QAAKY8y8qwS6uQAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDItMTRUMTQ6MzI6NTErMDA6MDDdB6Q2AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTAyLTE0VDE0OjMyOjUxKzAwOjAwrFocigAAAABJRU5ErkJggg==\" alt=\"\" />",f="<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAPCAMAAADXs89aAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABOFBMVEVCpfX///9CpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfVCpfX///8Jns0AAAAAZnRSTlMAAEx9fn98eAcsiqeURr0SAkTi+HQOmtTTz+ff0Agg6uu25jIWKCYhYSInUvV1Q1kLZD5XbvryVm1ezUkxuu38XwYw7vNjRSOTrBCp+cQ6Kp0Pw7zW/r9yThOHszaIgCQFjqWbaBXwbi/OAAAAAWJLR0QB/wIt3gAAAAd0SU1FB+MCDg4uBi7hZswAAAABb3JOVAHPoneaAAAA2klEQVQY022QaVcBcRTGb/4TlUhkUKSpUGNsMVH2Jdq0b5Rdz/f/CGYmh8nxe3Gf5/ze3HsuGRjjuFXGmNG0RrS+Yd60kIIVM7Zs23YlHDtOIt7l9uwCe163x7fvx4FwCBwRHQeCIQ44ORWDFIYUoSgfi5NGAjhTMwkHR3NSgLZHlHEupGc6M9W2CxmQLrMLmiiXLwDFUnlBE1XMVdSu/ut6QxnXwI1e397dNx98jwLwpL/k+QWwv7694yOn6U/gS81WW1Kf8B36W/PT6fa00q8PhqPxr9JWljIBIUAu3lTAeuwAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTktMDItMTRUMTQ6NDY6MDYrMDA6MDBwkCElAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE5LTAyLTE0VDE0OjQ2OjA2KzAwOjAwAc2ZmQAAAABJRU5ErkJggg==\" alt=\"\" />";var u=function(){function t(e,t){this.editor=e,this.callback=t,this.id="FileSearch",this.fileSearchWrapper="FileSearch-filesWrapper",this.fileSearchInput="FileSearch-searchInput",this.domNode=document.createElement("div"),this.domNode.setAttribute("id",this.id),this.domNode.setAttribute("class",this.id),this.filterTimerId=-1,this.nextResultTimerId=-1,this.currentIndex=0}return t.prototype.getNode=function(){return this.domNode},t.prototype.close=function(){},t.prototype.dispose=function(){t.isOpen=!1,this.domNode.removeEventListener("click",this),this.domNode.removeEventListener("keydown",this),this.domNode.removeEventListener("mousewheel",this),document.removeEventListener("keydown",this),this.editor.removeOverlayWidget(this.overlayWidget),this.editor.focus()},t.prototype.handleEvent=function(i){var e=this;if("mousewheel"==i.type)return i.stopImmediatePropagation(),void i.stopPropagation();var n,s;if("keydown"==i.type){var a=i;if(27==a.keyCode||13==a.keyCode){if(13==a.keyCode&&(n=jQuery(this.domNode).find("#FileSearch-filesWrapper"),s=n.children(),this.currentIndex<s.length)){var r=s[this.currentIndex].getAttribute("data-sysid"),l=s[this.currentIndex].getAttribute("data-apiname");this.callback({apiName:l,sysId:r})}return a.stopImmediatePropagation(),a.stopPropagation(),a.preventDefault(),void this.dispose()}if(40==a.keyCode||38==a.keyCode){i.stopImmediatePropagation(),i.stopPropagation(),i.preventDefault(),n=jQuery(this.domNode).find("#FileSearch-filesWrapper"),s=n.children();var d=this.currentIndex;40==a.keyCode?this.currentIndex++:(this.currentIndex--,0>this.currentIndex&&(this.currentIndex=s.length-1)),this.currentIndex%=s.length,0<=d&&jQuery(s[d]).removeClass("selected"),jQuery(s[this.currentIndex]).addClass("selected"),!t.itemHieght&&0<s.length&&(t.itemHieght=s[0].getBoundingClientRect().height);var c=t.itemHieght||23,g=c*this.currentIndex,f=n.height(),u=n.scrollTop();if(38==a.keyCode){if(g=p(g),g>=u&&g<f+u)return;n.scrollTop(g)}else{var m=o(g+c);if(m>=u&&m<f+u)return;n.scrollTop(m-f)}return}var y=a.keyCode;if(!(47<y&&58>y||64<y&&91>y||96<y&&123>y||8==y||13==y))return;var h=this.domNode.querySelector("#"+this.fileSearchInput);return-1!=this.filterTimerId&&(window.clearTimeout(this.filterTimerId),this.filterTimerId=-1),-1!=this.nextResultTimerId&&window.clearTimeout(this.nextResultTimerId),this.nextResultTimerId=-1,void(this.filterTimerId=window.setTimeout(function(){e.filter(h.value)},100))}var C=i.target,T=C.closest("div.FileSearch-file");if(null!=T){var l=T.dataset.apiname,r=T.dataset.sysid;return this.dispose(),void this.callback({apiName:l,sysId:r})}null==C.closest("div#FileSearch")&&this.dispose()},t.prototype.open=function(){t.isOpen=!0,this.domNode.innerHTML=this.constructHTML(),this.domNode.addEventListener("click",this),this.domNode.addEventListener("keydown",this),this.domNode.addEventListener("mousewheel",this),document.addEventListener("keydown",this),this.overlayWidget=new d(this.domNode),this.editor.addOverlayWidget(this.overlayWidget),this.domNode.querySelector("#"+this.fileSearchInput).focus()},t.prototype.filter=function(e){var t=this.domNode.querySelector("#"+this.fileSearchWrapper),i=this.constructItems(e);this.currentIndex=-1,!i||(t.innerHTML=i)},t.prototype.constructItemsUsingFuzzy=function(e,t){var i=this;void 0===t&&(t=50),!this.asyncMatcher||(this.asyncMatcher.cancel(),this.asyncMatcher=void 0),this.asyncMatcher=new r(a,e,function(e){e=e.sort(function(e,t){return t.rank-e.rank});for(var n=0,a="",r="",o=0,p=e;o<p.length;o++){var l=p[o],d=g;s.SITSFormat.isTypescript(l.item.f)&&(d=f);var c="<div class=\"FileSearch-file\" data-apiname=\""+l.item.api+"\" data-sysId=\""+l.item.id+"\">\n\t\t\t\t\t"+d+"<span class=\"normName\">"+l.matchStr+"</span></div>";if(n>t){r+=c;continue}n++,a+=c}var u=i.domNode.querySelector("#"+i.fileSearchWrapper);i.currentIndex=-1,u.innerHTML=a;var m=jQuery(i.domNode).find("#FileSearch-filesWrapper");setTimeout(function(){m.scrollTop(0)},0),i.appendNextResultSet(r)}),this.asyncMatcher.start()},t.prototype.appendNextResultSet=function(e){if(0!=e.length){var t=this.domNode.querySelector("#"+this.fileSearchWrapper);this.nextResultTimerId=window.setTimeout(function(){jQuery(e).appendTo(t)},200)}},t.prototype.constructItems=function(e,t){if(void 0===t&&(t=50),0<e.length)return this.constructItemsUsingFuzzy(e);var a="",r=0;0>t&&(t=50),t=l(t,50);var o=new RegExp(e,"gi"),p=n.getSIMap(),d="";for(var c in p)for(var u=p[c],m=0;m<u.length;m++){var y=u[m],h=y.api.split("."),C=h[0];if(1<h.length&&(C=h[1]),!e||null!=C.match(o)){r++;var T=g;s.SITSFormat.isTypescript(y.f)&&(T=f);var _="<div class=\"FileSearch-file\" data-apiname=\""+y.api+"\" data-sysId=\""+y.id+"\">"+T+"<span class=\"normName\">"+C+"</span></div>";r>=t?d+=_:a+=_}}return this.appendNextResultSet(d),a},t.prototype.constructHTML=function(){var e=this.constructItems("");return"<div class=\"FileSearch-searchWrapper\">\n\t\t\t\t\t<input type=\"text\" class=\"FileSearch-searchInput\" id=\"FileSearch-searchInput\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" autocomplete=\"off\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"FileSearch-filesWrapper\" id=\"FileSearch-filesWrapper\">\n\t\t\t\t"+e+"\n\t\t\t</div>"},t.isOpen=!1,t}();t.FileSearch=u});var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t};define("scripts/newMonaco",["require","exports","scripts/SIDeclEmittor"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importStar(i);var n;(function(e){e.js="javascript",e.jsx="javascript",e.ts="typescript",e.tsx="typescript",e.html="html",e.css="css",e.xml="xml",e.json="json"})(n||(n={}));var s=function(){function e(e,t){this.el=e,this.monacoField=t;var i=t.fileName.split("."),s=n.js;"undefined"!=typeof g_form&&(t.value=g_form.getValue(t.name)),0<i.length&&(s=n[i[i.length-1]]);var a=s;a===n.js||a===n.jsx||a===n.ts||a===n.tsx?a=n.ts:a===n.xml||a===n.html?a=n.html:void 0,this.model=monaco.editor.createModel(t.value,a,monaco.Uri.file(t.fileName)),this.editor=monaco.editor.create(e,{model:this.model,language:a,fontSize:16,formatOnType:!0,formatOnPaste:!0}),this.editor.onDidChangeModelContent(this.onValueChanged.bind(this))}return e.prototype.onValueChanged=function(){"undefined"==typeof g_form||g_form.setValue(this.monacoField.name,this.model.getValue())},e.prototype.getValue=function(){return{value:this.model.getValue()}},e}();t.MonacoEditor=s;var a=function(e){function t(t,i){return e.call(this,t,i)||this}return __extends(t,e),t.prototype.onValueChanged=function(){var e=this;monaco.languages.typescript.getTypeScriptWorker().then(function(t){t(e.model.uri).then(function(t){var i=t.getEmitOutput(e.model.uri.toString());i.then(function(t){t.emitSkipped||(e.js=t.outputFiles[0].text,"undefined"==typeof g_form||(g_form.setValue(e.monacoField.name,e.model.getValue()),g_form.setValue(e.monacoField.tupleName,e.js)))})})})},t.prototype.getValue=function(){return{jsx:this.js,value:this.model.getValue()}},t}(s);t.MonacoJSXEditor=a});var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(e){for(var t=1,a=arguments.length,n;t<a;t++)for(var r in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},__assign.apply(this,arguments)},__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("scripts/monacoInit",["require","exports","scripts/SIDeclEmittor","scripts/tsCompilerOptions","scripts/fileSearch","scripts/constants","scripts/siParser","scripts/recordWatcher","scripts/newMonaco"],function(e,t,n,s,a,r,o,p,l){"use strict";var c=Math.floor,g=Math.max;function d(){function e(e){var t=new f;try{var i=n.getCurrentSI();D()&&(i.updateAPIName("global.Point"),i.updateSysId("yln"),i.updateAccessType("public"),i.updateLangType("javascript"));var s=i.getScopeAndAPIMap(),a=l();if(t.js=a.outputText,t.sourceMap=a.sourceMapText,i.updateScript(a.outputText),window.recordConfig.useTypeChecker)return t;var r=i.generateDeclaration(esprima,e||!!window.recordConfig.jsdoc).getFormat(!0),o=JSON.parse(r);o[s.scope]&&Array.isArray(o[s.scope])&&0<o[s.scope].length&&(t.declaration=JSON.stringify(o[s.scope][0]))}catch(e){console.log(e.toString())}return t}function t(){var e=new Promise(function(e,t){var i=n.getCurrentModuleName();monaco.languages.typescript.getTypeScriptWorker().then(function(n){n("file:///"+i).then(function(i){i.getScriptFileNames().then(function(n){var s=!1;n.forEach(function(e){0<e.indexOf(".d.ts")||(i.getSemanticDiagnostics(e).then(function(){s=!0}),i.getSyntacticDiagnostics(e).then(function(){s=!0}))}),s?t(o.ERROR_MSG):e()})})})});return e}function i(t){void 0===t&&(t=!1);var s=n.getCurrentSI();if(!D()){var a=g_form.getValue("api_name");if(0==a.length)return Promise.reject("API Name shouldn't be empty");var r=g_form.getUniqueValue(),p=g_form.getValue("access");s.isNew()||(s.updateAPIName(a),s.updateSysId(r),s.updateAccessType(p))}var l=monaco.Uri.file(s.isTypescript()?"/module.ts":"/module.js"),d=new Promise(function(a,r){var p=Date.now();if(s.isJavascript()){if(!window.recordConfig.useTypeChecker)return console.log("compilation time is "+(Date.now()-p)),void a(e(t));var d=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();return void n.generateTypeDeclForSingleRecord(d).then(function(e){console.log("compilation time is "+(Date.now()-p)),D()||(e.js=s.tsscript),s.setDirtyState(!1),s.updateScript(e.js);var t=new f(e.js,"",e.sourceMap,s.tsscript,void 0,e.linterErrors),i=JSON.parse(e.declaration);t.backEndDecl=__assign({sc:s.getScopeAndAPIMap().scope},i);var r=o.SITSFormat.expandMinifiedFormat(i,s.getScopeAndAPIMap().scope);n.updateCurrentSIDeclaration(!0,r),t.declaration=JSON.stringify(r),a(t)},function(e){r(e)})}if(s.containsTemplateExpression()){var d=monaco.languages.typescript.typescriptDefaults.getCompilerOptions();return void n.generateTypeDeclForSingleRecord(d).then(function(e){console.log("compilation time is "+(Date.now()-p)),s.setDirtyState(!1),s.updateScript(e.js);var t=new f(e.js,"",e.sourceMap,s.tsscript),i=s.emitTSDeclaration(e.declaration);t.backEndDecl=__assign({sc:s.getScopeAndAPIMap().scope},i);var r=o.SITSFormat.expandMinifiedFormat(i,s.getScopeAndAPIMap().scope,s.isTypescript());t.declaration=JSON.stringify(r),n.updateCurrentSIDeclaration(!0,r),a(t)},function(e){r(e)})}monaco.languages.typescript.getTypeScriptWorker().then(function(e){e(l).then(function(e){e.getEmitOutput(l.toString()).then(function(e){console.log("compilation time is "+(Date.now()-p));var t=new f("","","",s.tsscript);if(e.emitSkipped)return console.log("emittor skipped"),void r(o.ERROR_MSG);for(var l=0;l<e.outputFiles.length;l++)switch(e.outputFiles[l].name){case"file:///module.d.ts":t.declaration=e.outputFiles[l].text||"//waiting...";break;case"file:///module.js":t.js=e.outputFiles[l].text;break;case"file:///module.js.map":t.sourceMap=e.outputFiles[l].text;}console.log(e),s.setDirtyState(!1),s.updateScript(t.js);var d=s.emitTSDeclaration(t.declaration);t.backEndDecl=__assign({sc:s.getScopeAndAPIMap().scope},d);var c=o.SITSFormat.expandMinifiedFormat(d,s.getScopeAndAPIMap().scope,s.isTypescript());t.declaration=JSON.stringify(c),n.updateCurrentSIDeclaration(!0,c),a(t)})})})});return d}function l(){var e=n.getCurrentSI(),t=n.getCompilerOptions(e.isJavascript());t.declaration=!1;var i=e.tsscript;if(e.containsTemplateExpression()&&(i=n.TSCompilerHost.getModelValueAfterTransform(e.tsscript)),t.target<ts.ScriptTarget.ES2015&&!D())return{outputText:e.tsscript};var s=ts.transpileModule(i,{compilerOptions:t,fileName:"./module.js"});return console.log(s.outputText),s}function d(e,t,s,a,p){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===s&&(s=!1);var l="global.Point",d="yln",c="public",g=n.getCurrentSI(),f=g.script_type,u=[],m="undefined"!=typeof g_form;if(m){if(u=g_form.getEditableFields(),V)return!0;l=g_form.getValue("api_name"),d=g_form.getUniqueValue(),c=g_form.getValue("access"),-1!=u.indexOf("script_type")&&(f=g_form.getValue("script_type")),-1!=u.indexOf("jsdoc")&&(e="true"==g_form.getValue("jsdoc"))}return g.updateAPIName(l),g.updateSysId(d),g.updateAccessType(c),g.updateLangType(f),g.updateJSDoc(e),i(e).then(function(e){g.setDirtyState(!1),g.updateScript(e.js),g.updateDeclaration(e.declaration),g.updateSourcemap(e.sourceMap),m&&(g_form.setValue(r.FIELD_SCRIPT,o.ClientSIRecordData.getClassConstructorFormat(g)),g_form.setValue(r.FIELD_TS_SCRIPT,g.tsscript),g_form.setValue(r.FIELD_SOURCEMAP,g.typesourcemap),g_form.setValue(r.FIELD_DECLARATION,g.typedeclaration),(-1!=u.indexOf(r.FIELD_DECLARATION)||s)&&(V=!0),(window.recordConfig.useTypeChecker||!s||-1!=u.indexOf(r.FIELD_TS_SCRIPT))&&n.updateSIDeclListeners(JSON.parse(e.declaration)));var i=g_form.getActionName();if(t&&m&&-1==u.indexOf(r.FIELD_DECLARATION))return jQuery.ajax({url:"api/now/typescript_helpers/update_declaration",type:"post",data:JSON.stringify(e.backEndDecl),headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}}).done(function(e){console.log(e),a&&a()}).fail(function(){p&&p()}),!1;if(s){var l=window.recordConfig;l.isNewRecord?gsftSubmit(void 0,void 0,"sysverb_insert"):gsftSubmit(void 0,void 0,i)}},function(e){g_form.addErrorMessage(e,"script_error")}),!1}function m(e,t){function i(e){if("undefined"!=typeof g_form&&(g_form.setValue(r.FIELD_SCRIPT,e.js),g_form.setValue(r.FIELD_DECLARATION,e.declaration),g_form.setValue(r.FIELD_TS_SCRIPT,e.tsScript),g_form.setValue(r.FIELD_SOURCEMAP,e.sourceMap)),!d||d.updateModelContent(e.js),o){var t="";0!=e.declaration.length&&(t=n.getCurrentSI().formatForAddLib(JSON.parse(e.declaration),l.getScopeAndAPIMap().scope)),t=t.replace(/</gi,"&lt;"),o.innerHTML=t,0!=t.length&&monaco.editor.colorizeElement(o,{theme:v})}!p||(p.innerText=e.sourceMap)}void 0===t&&(t=r.LangType.typescript);var s=document.getElementById(r.EL_TS_EDITOR),a=document.getElementById(r.EL_JS_EDITOR),o=document.getElementById(r.EL_TS_DECL),p=document.getElementById(r.EL_TS_SOURCEMAP),l=n.getCurrentSI(),d;return n.isSeismicComponent()&&(l.tsscript=localStorage.getItem("last_monaco_script")||"function render() {return (<div></div>);}"),P=n.isSeismicComponent()?new O(s,i,!0,l.tsscript):new w(s,i,!0,l.tsscript),a&&(d=new j(a,null,"// wating ...",!0),P.setJSInstance(d),window.jsInstnace=d),window.tsInstance=P,{dispose:function(){}}}function y(e){var t=Math.round,i,n,s,a,r;return r=t(e%1e3),a=c(e/1e3),s=c(a/60),a%=60,n=c(s/60),s%=60,i=c(n/24),n%=24,{day:i,hour:n,minute:s,seconds:a,ms:r}}function h(){var e=localStorage.getItem("sn.codenow"),t={theme:v};if(!e)return t;var i=JSON.parse(e);return i.theme=i.theme||t.theme,D()||(i.theme=v),i}function C(e){var t=h();for(var i in e)t[i]=e[i];D()&&localStorage.setItem("sn.codenow",JSON.stringify(t))}function T(e){jQuery("#yln-standalone-editor").removeClass(v).addClass(e),v=e,monaco.editor.setTheme(v),C({theme:e}),jQuery(R).val(e)}function _(){function e(e){for(var t=e.split("\n"),n=[],s=0;s<t.length;s++)t[s].match(/^\s*debugger;\s?/)&&(n.push(s+2),t[s]="\"debugger\";");return{dbgStatements:n,js:t.join("\n")}}R&&(R.onchange=function(){T(R.value)});var t=document.getElementById(r.EL_SCOPE_SELECT);if(t){var s="",a=window.recordConfig;for(var o in a.scopes){var p=a.scopes[o];"global"!=p.sysId&&(s+="<option value='"+p.value+"' scope-id='"+p.sysId+"'>"+p.displayValue+"</option>\n")}s="<option value='global' scope-id='global' selected>Global</option>\n"+s.trim(),t.innerHTML=s,t.onchange=function(){var e=t.value,i=n.getCurrentSI();i.updateAPIName(e+"."),n.siUpdated()}}var l=document.getElementById(r.EL_SCRIPT_RUNNER);n.isServiceNow()||n.isSeismicComponent()||jQuery(l).hide(),l&&n.isServiceNow()&&(l.onclick=function(){function s(e){jQuery("a[href=\"#script-output\"]").tab("show");var t=jQuery("#"+r.EL_SCRIPT_OUTPUT),i=Date.now(),n=!1,s=document.getElementById("excution-timer"),t=jQuery("#"+r.EL_SCRIPT_OUTPUT);t.html("<div class = \"script-running\">\n\t\t\t\t\t\t\t<i class=\"glyphicon glyphicon-refresh spin\"></i>\n\t\t\t\t\t\t\t</div>");var a=function(){var e=Date.now(),t=y(e-i),r=t.minute+":"+t.seconds+":"+t.ms;s.innerText=r,n||window.requestAnimationFrame(a)};a(),A(e,p).then(function(e){l.disabled=!1,n=!0;var t=new DOMParser,i=t.parseFromString(e,"text/html");jQuery("#"+r.EL_SCRIPT_OUTPUT).html(i.body.innerHTML)},function(){n=!0,l.disabled=!1})}function a(t){var i=e(t),n=i.dbgStatements;if(t=i.js,0==n.length)return s(t);var a={sysparm_key:"sys_script_include.1172f0210bf213008e64aabcb4673aee.script",sysparm_breakpoints:JSON.stringify(n),sysparm_processor:"BreakpointProcessor",sysparm_action:"SET_BREAKPOINTS",sysparm_express_transaction:!0,sysparm_debugger_transaction:!0},r={url:"xmlhttp.do",data:a,headers:{"X-UserToken":window.g_ck}},o={contentType:"application/json",data:JSON.stringify({script:"function TempDebugger(){\n"+t+"\n};"}),headers:{X_UserToken:window.g_ck},method:"POST",type:"POST",url:"/api/now/typescript_helpers/UpdateDebuggerScript"},p={url:"/api/now/js/debugger/scripts",method:"GET",headers:{"X-UserToken":window.g_ck}};$.when($.ajax(r),$.ajax(o)).then(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s("global.TempDebugger()")},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];l.disabled=!1,console.log("failure to update breakpoints and scripts")})}if(n.isServiceNow()){l.disabled=!0;var o=n.getCurrentSI(),p=t.selectedOptions[0].getAttribute("scope-id");return o.isUpToDate()?void a(o.script):void i().then(function(e){a(e.js)},function(e){alert(e),l.disabled=!1})}})}function S(){function e(){var e=jQuery(document.getElementById("sys_script_include.form_scroll")),t=e.offset();if(t){var i=jQuery("#ts_editor_container").offset();if(i){var n=i.top-t.top;0<n&&e.scrollTop(n)}}}n.isServiceNow()||(window.recordConfig.scopes={"3ad18693db92220004997878f0b8f516":{sysId:"3ad18693db92220004997878f0b8f516",displayValue:"Benchmark Client",value:"sn_bm_client"},"1bc6c2d3db92220004997878f0b8f571":{sysId:"1bc6c2d3db92220004997878f0b8f571",displayValue:"Benchmark Common",value:"sn_bm_common"},de0be0e15bb00300514d484c11f91a4b:{sysId:"de0be0e15bb00300514d484c11f91a4b",displayValue:"Benchmarks Spoke",value:"sn_bm_spoke"},"18351d53eb32120034d1eeea1206fe79":{sysId:"18351d53eb32120034d1eeea1206fe79",displayValue:"Change Management - CAB Workbench",value:"sn_change_cab"},cdcf033467020300b410afa00585ef2b:{sysId:"cdcf033467020300b410afa00585ef2b",displayValue:"Change Management - Change Schedule",value:"sn_chg_soc"},"1ae06f355710130034d169202d94f92e":{sysId:"1ae06f355710130034d169202d94f92e",displayValue:"Change Management - Color Picker",value:"sn_chg_soc_cp"},f9752f20d7120200b6bddb0c8252032e:{sysId:"f9752f20d7120200b6bddb0c8252032e",displayValue:"Code Search",value:"sn_codesearch"},"116703c19f200300af7196fcc67fcf17":{sysId:"116703c19f200300af7196fcc67fcf17",displayValue:"Connect Spoke",value:"sn_connect_ah"},"1ae3c8a3c3221200f25d174292d3aea3":{sysId:"1ae3c8a3c3221200f25d174292d3aea3",displayValue:"Delegated Dev User Administration",value:"sn_dd_user_admin"},dc1fcaa2c3032200f7d1ca3adfba8f1a:{sysId:"dc1fcaa2c3032200f7d1ca3adfba8f1a",displayValue:"Enhanced Global Search UI",value:"sn_global_searchui"},"801cef500b312200c438ee6537673a04":{sysId:"801cef500b312200c438ee6537673a04",displayValue:"Flow-Action Designer",value:"sn_flow_designer"},global:{sysId:"global",displayValue:"Global",value:"global"},"5f4ef4ed9f401200b18a7feea57fcfbe":{sysId:"5f4ef4ed9f401200b18a7feea57fcfbe",displayValue:"Guided Setup",value:"sn_guided_setup"},"7f1c13c0731103005e7d234ffff6a7da":{sysId:"7f1c13c0731103005e7d234ffff6a7da",displayValue:"ITSM Spoke",value:"sn_itsm_spoke"},dd9d31505f221200c438ef50ff4666de:{sysId:"dd9d31505f221200c438ef50ff4666de",displayValue:"JavaScript Debugger",value:"sn_jsdebugger"},"2efa4be5db0003004d27b31be0b8f5e9":{sysId:"2efa4be5db0003004d27b31be0b8f5e9",displayValue:"Major Incident Management",value:"sn_major_inc_mgmt"},fae90fb35f6b03006ae6a184ff46667a:{sysId:"fae90fb35f6b03006ae6a184ff46667a",displayValue:"Major workbench components",value:"sn_major_workbench"},b2881e900b3003001e684ac3b6673a93:{sysId:"b2881e900b3003001e684ac3b6673a93",displayValue:"Performance Analytics - Diagnostics",value:"sn_pa_diagnostics"},"1c3f9f936741030032468aaad485efda":{sysId:"1c3f9f936741030032468aaad485efda",displayValue:"Performance Analytics - Enhanced UI",value:"sn_pa_ui"},"9a31657653373200e8960ef5d5dc34d5":{sysId:"9a31657653373200e8960ef5d5dc34d5",displayValue:"Schedule Pages",value:"sn_schedule_pages"},"893ea311d71321004f6a0eca5e6103e6":{sysId:"893ea311d71321004f6a0eca5e6103e6",displayValue:"Scoped App Author",value:"sn_appauthor"},"781f36a96fef21005be8883e6b3ee43d":{sysId:"781f36a96fef21005be8883e6b3ee43d",displayValue:"Scoped App Client",value:"sn_appclient"},"0aa1393093213100ae6e941e867ffb40":{sysId:"0aa1393093213100ae6e941e867ffb40",displayValue:"Scoped App Creator",value:"sn_appcreator"},"6e70d1f5c32302006f333b0ac3d3ae7b":{sysId:"6e70d1f5c32302006f333b0ac3d3ae7b",displayValue:"Service Catalog REST API",value:"sn_sc"},"6c11c4f357201300ff01ac11ac94f982":{sysId:"6c11c4f357201300ff01ac11ac94f982",displayValue:"Service Level Management - Breakdowns",value:"sn_sla_brkdwn"},"67ac5062db10220035417878f0b8f5c4":{sysId:"67ac5062db10220035417878f0b8f5c4",displayValue:"Service Portal Surveys",value:"sn_portal_surveys"},"97515a49134b5200ed373d62f244b04a":{sysId:"97515a49134b5200ed373d62f244b04a",displayValue:"ServiceNow Guided Tour Designer",value:"sn_tourbuilder"},"11722b01473231007f47563dbb9a7154":{sysId:"11722b01473231007f47563dbb9a7154",displayValue:"Social Knowledge",value:"sn_kb_social_qa"},"5d9789f3eb51310007e48c1cf106fe9e":{sysId:"5d9789f3eb51310007e48c1cf106fe9e",displayValue:"Studio",value:"sn_devstudio"},"0fdd6483d72302004f1e82285e61033a":{sysId:"0fdd6483d72302004f1e82285e61033a",displayValue:"Targeted Communications",value:"sn_publications"},"8dfe92d95373030029200ef5d5dc348a":{sysId:"8dfe92d95373030029200ef5d5dc348a",displayValue:"Task Communications Management",value:"sn_comm_management"},"46aa60c2ff10020014ecffffffffffa5":{sysId:"46aa60c2ff10020014ecffffffffffa5",displayValue:"Twilio Driver",value:"sn_twilio_driver"},"9353f56fb33332000abf86d256a8dce9":{sysId:"9353f56fb33332000abf86d256a8dce9",displayValue:"Visual Task Board (VTB) Spoke",value:"sn_vtb_ah"},"0f6ab99a0f36060094f3c09ce1050ee8":{sysId:"0f6ab99a0f36060094f3c09ce1050ee8",displayValue:"[ws] Xplore: Developer Toolkit",value:"global"}},window.recordConfig.snippets=[{label:"doc",doc:"Documentation Header ",text:"/**\r \n* Description: $0\r \n* Parameters: \r \n* Returns:\r\n*/\r "},{label:"for",doc:"Standard loop for arrays",text:"for (var i=0; i< myArray.length; i++) {\r\n //myArray[i];\r \n}\r\n\r "},{label:"vargror",doc:"Example GlideRecord Or Query",text:"var gr = new GlideRecord('${1:tableName}');\r \nvar qc = gr.addQuery('${2:columnName}', 'value1');\r \nqc.addOrCondition('${0:columnName}', 'value2');\r\ngr.query();\r \nwhile (gr.next()) {\r\n\r \n}\r\n\r "},{label:"info",doc:"",text:"gs.addInfoMessage(gs.getMessage(\"$0\"));"},{label:"method",doc:"Standard JavaScript Class Method",text:"/*_________________________________________________________________\r\n   * Description:\r\n   * Parameters:\r\n   * Returns:\r\n   ________________________________________________________________*/\r\n   $0: function() {\r\n   \r\n   },\r\n"},{label:"vargr",doc:"A common pattern of creating and querying a GlideRecord",text:"var gr = new GlideRecord(\"$0\");\r\ngr.addQuery(\"name\", \"value\");\r\ngr.query();\r\nif (gr.next()) {\r\n   \r\n}\r\n"}]),_(),T(h().theme);var t=window.recordConfig;if(!n.isServiceNow()){var i=new o.ClientSIRecordData;i.updateAPIName(t.apiName),i.updateLangType(t.langType),n.initializeWithSIRecord(i).then(function(){m(t.apiName,t.langType||r.LangType.javascript)})}else if(t.isNewRecord){var i=new o.ClientSIRecordData(void 0,!0);i.updateLangType(window.recordConfig.langType),n.initializeWithSIRecord(i).then(function(){m("",t.langType||r.LangType.javascript),D()||n.getCurrentSI().isNew()||e()})}else{var s=o.ClientSIRecordData.fromSIRec(window.recordConfig.siRec);o.ClientSIRecordData.convertToJSConstructor(s),n.initializeWithSIRecord(s).then(function(){m(t.apiName,t.langType||r.LangType.javascript),D()||e()})}}function b(e,t){void 0===e&&(e="gs.info('hello yln')"),void 0===t&&(t="0f6ab99a0f36060094f3c09ce1050ee8");var i={script:e,sysparm_ck:window.g_ck,runscript:"Run script",sys_scope:t},n="",s=[];for(var a in i)s.push(encodeURIComponent(a)+"="+encodeURIComponent(i[a]));return n=s.join("&").replace(/%20/g,"+"),n}function A(e,t){return jQuery.ajax({url:"/sys.scripts.do",data:b(e,t),cache:!1,contentType:"application/x-www-form-urlencoded",processData:!1,method:"POST",type:"POST",headers:{"X-UserToken":window.g_ck},success:function(e){console.log(e)},error:function(e){console.log(e)}})}function I(e,t,i){function n(){var n=window.innerWidth-40,s=window.innerHeight,a=window.screenX+20,r=window.screenY+20,o="width="+n+",height="+s+",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,screenX="+a+",left="+a+",screenY="+r+",top="+r,p=window.open("","sn_ScriptDebugger",o,!1),l=p.location.href,d=!1;if("about:blank"===l){try{var c=parseInt(localStorage.getItem("sn_ScriptDebugger")),g=new Date().getTime();if(c&&6e4>g-c)return p.close(),void localStorage.setItem("sn_ScriptDebuggerExist_ShowNotification",new Date().getTime()+"")}catch(t){}d=!0}var f="/$jsdebugger.do?sysparm_nostack=true";if(e&&t&&i&&(f="/$jsdebugger.do?scriptId="+e+"&scriptType="+t+"&scriptField="+i+"&sysparm_nostack=true",!d))try{localStorage.setItem("sn_ScriptDebugger_url",f)}catch(t){var u=l.slice(l.indexOf("$jsdebugger.do"));u!=f&&(d=!0)}d&&(p=window.open(f,"sn_ScriptDebugger",o,!1)),p.focus(),p.setTimeout(focus,1)}if(void 0===e&&(e="1172f0210bf213008e64aabcb4673aee"),void 0===t&&(t="sys_script_include"),void 0===i&&(i="script"),B){B=!1;try{n()}catch(t){}B=!0}}function x(){var e=n.getCompilerOptions(n.getCurrentSI().isJavascript());monaco.languages.typescript.typescriptDefaults.setCompilerOptions(e);var t=P;t.triggerCompilation()}function E(e,t,i){function n(){i.off("hidden.bs.modal",n),e.removeAttr("disabled"),t.addClass("hide")}i.on("hidden.bs.modal",n),i.modal()}function M(e,t,i){if(void 0===i&&(i=2500),"undefined"==typeof GlideUI)return void alert(e);var n=document.createElement("span");n.setAttribute("data-type",t),n.setAttribute("data-text",e),n.setAttribute("data-duration",i+""),GlideUI.get().fire(new GlideUINotification({xml:n}))}var F=0,k="";window.addEventListener("beforeunload",function(e){0<F&&(D()||"undefined"!=typeof g_form&&!g_form.submitted)&&(e.returnValue="There is a pending work. sure you want to leave")});var D=n.isScriptRunner,N=s.default,v="vs",P;jQuery(function(){function e(){for(var e=[ts.JsxEmit.None,ts.JsxEmit.Preserve,ts.JsxEmit.React,ts.JsxEmit.ReactNative],t=[ts.ScriptTarget.ES3,ts.ScriptTarget.ES5,ts.ScriptTarget.ES2015,ts.ScriptTarget.ES2016,ts.ScriptTarget.ES2018,ts.ScriptTarget.Latest],n="<select onchange=\"settings.onTargetChange('target', this.value)\">",a=N.target,r=0,o;r<t.length;r++)o="",a==t[r]&&(o="selected"),n+="<option "+o+" value='"+t[r]+"'>"+ts.ScriptTarget[t[r]]+"</option>";n+="</select>";var p="<select onchange=\"settings.onJSXChange('jsxTarget', this.value)\">";e.forEach(function(e,t){var i="",n=N.jsx;t===n&&(i="selected"),p+="<option "+i+" value='"+e+"'>"+ts.JsxEmit[e]+"</option>"}),p+="</select>",D()||(p="");var l="glyphicon-unchecked",d="<div style=\"max-height: 300px;overflow: auto; white-space: nowrap;\">\n\t\t\t\t<div class=\"eslint\">\n\t\t\t\t\t<label style=\"margin: 8px;\">\n\t\t\t\t\t\t<input onclick=\"javascript:settings.toggleLinter();\" style=\"margin: 0px 8px;\" type='checkbox' "+(s.default.linter?"checked":"")+">\n\t\t\t\t\t\tEnable ESlint\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t<ul class=\"list-group checked-list-box\" onclick=\"javascript:settings.onCompilerSettingsChange(event.target)\">\n\t\t\t\t\t<li class=\"list-group-item\">Target "+n+"</li>\n\t\t\t\t\t<li class=\"list-group-item\">JSX "+p+"</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Allows js to compile\" data-key=\"allowJs\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.allowJs?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tallowJs\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Enable type checking on JavaScript files\" data-key=\"checkJs\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.checkJs?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tcheckJs\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title = \"Warn on expressions and declarations with an implied 'any' type\" data-key=\"noImplicitAny\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noImplicitAny?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoImplicitAny\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Enable strict null checks\" data-key=\"strictNullChecks\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.strictNullChecks?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tstrictNullChecks\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Raise error on 'this' expressions with an implied any type\" data-key=\"noImplicitThis\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noImplicitThis?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoImplictThis\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report error when not all code paths in function return a value\" data-key=\"noImplicitReturns\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noImplicitReturns?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoImplicitReturns\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Do not report errors on unreachable code\" data-key=\"allowUnreachableCode\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noImplicitReturns?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tallowUnreachableCode\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report errors for fallthrough cases in switch statement\" data-key=\"noFallthroughCasesInSwitch\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noImplicitReturns?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoFallthroughCasesInSwitch\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Enable all strict type-checking options\" data-key=\"strict\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.strict?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tstrict\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Parse in strict mode and emit 'use strict'\" data-key=\"alwaysStrict\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.alwaysStrict?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\talwaysStrict\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Do not generate custom helper functions like __extends in compiled output.'\" data-key=\"noEmitHelpers\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noEmitHelpers?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoEmitHelpers\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report errors on unused parameters\" data-key=\"noUnusedParameters\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noUnusedParameters?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoUnusedParameters\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"Report errors on unused locals\" data-key=\"noUnusedLocals\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.noUnusedLocals?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tnoUnusedLocals\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class=\"list-group-item\" title=\"strip @internal methods when generating declaration\" data-key=\"stripInternal\">\n\t\t\t\t\t\t<span class='state-icon glyphicon "+(N.stripInternal?"glyphicon-check":l)+"'></span>\n\t\t\t\t\t\tstripInternals\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>";return d}jQuery("#compiler-settings").popover({html:!0,trigger:"manual",content:function(){return e()},title:"Compiler Settings"}).click(function(t){0==jQuery("#compiler-settings-container > .popover").length?jQuery(this).popover("show"):jQuery(this).popover("hide"),t.stopPropagation(),t.preventDefault()}),jQuery(document).on("click",function(t){var e=jQuery(t.target);e.data&&"undefined"==typeof e.data("original-title")&&!jQuery(t.target).parents().is(".popover.in")&&jQuery("[data-original-title]").popover("hide")})}),window.compileJS=l,window.compileTS=i;var V=!1,L=function(){function e(e,t,i,s,a,r){function o(){if(n.isScriptRunner()){var e=jQuery("#yln-standalone-editor > .navbar-default").height();jQuery("#yln-standalone-editor > .workspace-area").css({top:e})}}function p(){g=-1,this.editor&&this.editor.layout(),o()}void 0===s&&(s=""),void 0===a&&(a="/module.ts"),void 0===r&&(r=!1);var l=this;this.isReadonly=r,this.breakPoints=[],this.existingBreakPoints=[],this.initialModelVersion=-1,this.lastModelVersion=-1,this.gotoDefLine=-1;var d=n.getCurrentSI();window.currentSI=d,s||(d.isTypescript()?s="function getIncidentRec(sysId: string) {\n\tvar gr = new GlideRecord('incident');\n\tgr.get(sysId);\n\treturn gr;\n}":s="function getIncidentRec(sysId) {\n\tvar gr = new GlideRecord('incident');\n\tgr.get(sysId);\n\treturn gr;\n}"),0==d.tsscript.length&&D()&&!r&&d.updateTSScript(s),"function"==typeof Array.prototype.include&&(Array.prototype.include=void 0),this.model=monaco.editor.createModel(s,i,monaco.Uri.file(a)),this.model.updateOptions({trimAutoWhitespace:!0,tabSize:4,insertSpaces:!1}),this.initialModelVersion=this.model.getAlternativeVersionId(),this.modelVersion=this.model.getAlternativeVersionId();var c=n.getCurrentSI().isNew();this.editor=monaco.editor.create(e,{model:this.model,language:i,renderWhitespace:r?"none":"all",fontSize:14,formatOnType:!0,formatOnPaste:!0,glyphMargin:!c||window.recordConfig.breakpoints,readOnly:r,renderIndentGuides:!0,lineNumbersMinChars:2,suggestSelection:"recentlyUsed",scrollBeyondLastLine:!1,lightbulb:{enabled:!0},minimap:{enabled:!1},scrollbar:{useShadows:!1,verticalHasArrows:!1,horizontalHasArrows:!1,vertical:"visible",horizontal:"visible",verticalScrollbarSize:7,horizontalScrollbarSize:7,arrowSize:30}},{openerService:n.gotoDefintionService});var g=-1;window.addEventListener("resize",function(){-1!=g&&window.clearTimeout(g),g=window.setTimeout(p.bind(l),2000)}),o()}return e.prototype.onBreakpoint=function(e){n.isServiceNow()&&!D()?this.toggleBreakPointInServer(e):this.toggleBreakPoint([e])},e.prototype.loadBreakPointsFromServer=function(){var e=this;if(n.isServiceNow()){var t=n.getCurrentSI();if(t.canPlaceBreakPoints()){var i={url:"/api/now/js/debugger/scripts",method:"GET",headers:{"X-UserToken":window.g_ck}};jQuery.ajax(i).done(function(i){if(i&&"object"==typeof i){var n=t.sys_class_name+"."+t.sys_id+".script",s=i.result[n];e.jsBreakPointsState=s,s&&e.updateBreakPoints(s)}})}}},e.prototype.updateBreakPoints=function(e){var t=[];t=Array.isArray(e.breakpoints)?e.breakpoints:Object.keys(e).map(function(e){return parseInt(e)}),0<t.length&&this.toggleBreakPoint(t)},e.prototype.toggleBreakPointInServer=function(e,t,i){var s=this;if((void 0===t&&(t=""),void 0===i&&(i=!1),!!n.isServiceNow())&&!D()){var a=n.getCurrentSI(),r="/api/now/js/debugger/breakpoint/"+a.sys_class_name+"/"+a.sys_id+"/script/"+e,o={breakpointCondition:t},p={url:r,contentType:"application/json",method:"POST",headers:{"X-UserToken":window.g_ck}};this.jsBreakPointsState&&(!this.jsBreakPointsState.breakpoints[e]||0<t.length||i)&&(p.data=JSON.stringify(o)),jQuery.ajax(p).done(function(){s.loadBreakPointsFromServer(a.sys_class_name+".script")})}},e.prototype.toggleBreakPoint=function(e){if(n.isServiceNow()&&!D())this.breakPoints=e;else{var t=this.breakPoints.indexOf(e[0]);-1==t?this.breakPoints.push(e[0]):this.breakPoints.splice(t,1)}for(var i=[],s=!1,a=0,r=this.breakPoints;a<r.length;a++){var o=r[a],p={range:new monaco.Range(o,1,o,1),options:{glyphMarginClassName:"dbg-breakpoint"}};this.gotoDefLine==o&&(s=!0,p.options.isWholeLine=!0,p.options.className="gotoLine"),i.push(p)}if(-1!=this.gotoDefLine&&!s){var l={range:new monaco.Range(this.gotoDefLine,1,this.gotoDefLine,1),options:{isWholeLine:!0,className:"gotoLine"}};i.push(l)}this.existingBreakPoints=this.editor.deltaDecorations(this.existingBreakPoints,i)},e.prototype.updateModelContent=function(e){this.model.setValue(e)},e}(),j=function(e){function t(t,i,n,s){void 0===n&&(n=""),void 0===s&&(s=!1);var a=e.call(this,t,i,r.LangType.javascript,n,"es5Module.js",s)||this;return a.cb=i,a}return __extends(t,e),t.prototype.onContentChanged=function(){},t}(L),w=function(e){function t(t,i,o,p,l,d){function c(t){if(t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN){var e=t.target.position.lineNumber;if(!S)b=e;else if(b==e)return;b=e,S=!0;var i=t.event.browserEvent.clientX,n=t.event.browserEvent.clientY,s=I.jsBreakPointsState;I.tsBreakPointState&&(s=I.tsBreakPointState);var a=s&&s.breakpoints&&s.breakpoints[e],r=jQuery("#new-breakpoint-menu"),o="";a&&(o=s.breakpoints[e].condition);var p=document.getElementById("ts_editor");if(p){var l=p.getBoundingClientRect();n-=l.top-60,0>n&&(n=0),i+=30}r.find("#breakpoint-line-number").text(e);var d=r.find("#breakpoint-condition");d.attr("data-linenumber",e),d.val(o),r.css({display:"block",transform:"translate("+i+"px, "+n+"px)"}).addClass("show")}}function g(){-1!=A&&(clearTimeout(A),A=-1),S&&(jQuery("#new-breakpoint-menu").removeClass("show").hide(),S=!1)}void 0===o&&(o=!1),void 0===p&&(p=""),void 0===l&&(l=""),void 0===d&&(d=!1);var f=e.call(this,t,i,r.LangType.typescript,p,n.getCurrentModuleName(),!n.canWriteSI())||this;f.cb=i,f.autoCompile=o,f.compileTriggerTimoutID=-1,f.isBreakPointsLoaded=!1,f.tsBreakPointState={};var u=n.getCurrentSI();f.dmp=new diff_match_patch,k=u.tsscript;var m;if(D()){for(var y=[],h=0,C=window.recordConfig.snippets,T;h<C.length;h++)T=C[h],y.push({range:void 0,label:"yln_"+T.label,kind:monaco.languages.CompletionItemKind.Snippet,documentation:T.doc,insertTextRules:monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet,insertText:T.text});0<y.length&&monaco.languages.registerCompletionItemProvider("typescript",{provideCompletionItems:function(){return{suggestions:y}}}),f.editor.addAction({id:"Run",label:"Run",contextMenuGroupId:"modification",contextMenuOrder:3.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_R],run:function(){return document.getElementById(r.EL_SCRIPT_RUNNER).click(),null}})}else n.isServiceNow()&&!u.isNew()&&f.editor.addAction({id:"Save",label:"Save",contextMenuGroupId:"modification",contextMenuOrder:2.5,keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],run:function(){J.saveSI(null)}});f.editor.addAction({id:"FielOpen",label:"FileOpen",keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_P],contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){return a.FileSearch.isOpen||(m=new a.FileSearch(e,function(e){var t="./?sys_id="+e.sysId;n.isServiceNow()&&(t="./sys_script_include.do?sys_id="+e.sysId),window.open(t)}),m.open()),null}});var _=-1,S=!1,b=0,A=-1,I=f;return f.isReadonly||(f.editor.onDidChangeModelContent(function(t){F++,u.setDirtyState(!0),u.updateTSScript(f.model.getValue()),-1!=_&&clearTimeout(_),_=window.setTimeout(function(){_=-1,f.onContentChanged(t)},n.isSeismicComponent()?2e3:5e3)}),jQuery(document).on("keyup",function(t){27==t.keyCode&&g()}),jQuery("#ts_editor_container").on("keyup","#breakpoint-condition",function(t){if(27==t.keyCode)return void g();if(13==t.keyCode){var e=jQuery(t.target),i=parseInt(e.attr("data-linenumber")),n=e.val();f.onBreakpoint(i,1,n,!0),g()}}),(!u.isNew()||!!window.recordConfig.breakpoints)&&(f.editor.onMouseDown(function(t){t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN&&t.event.leftButton&&(u.isUpToDate()&&u.canPlaceBreakPoints()||!!window.recordConfig.breakpoints)&&f.onBreakpoint(t.target.position.lineNumber,1)}),!D()&&(f.editor.onContextMenu(function(t){c(t)}),f.editor.onMouseMove(function(t){return t.target.type==monaco.editor.MouseTargetType.GUTTER_GLYPH_MARGIN?S?void c(t):-1==A?void(A=self.setTimeout(function(){c(t),A=-1},500)):void 0:void(A-1&&(clearTimeout(A),A=-1))})))),f.editor.onDidFocusEditorText(function(){console.log("focus to editor"),-1==f.gotoDefLine||(f.gotoDefLine=-1,f.toggleBreakPoint(f.breakPoints))}),setTimeout(function(){var e=0;window.recordConfig.gotoLine&&(e=parseInt(window.recordConfig.gotoLine)||0,e&&(f.gotoDefLine=e,f.editor.revealPositionInCenter({lineNumber:e,column:0}),f.toggleBreakPoint(f.breakPoints)))},10),D()&&n.isSeismicComponent()&&(s.default.jsx=monaco.languages.typescript.JsxEmit.React,s.default.noEmitOnError=!1,delete s.default.types,s.default.sourceMap=!1,s.default.inlineSourceMap=!0,s.default.inlineSources=!0),monaco.languages.typescript.typescriptDefaults.setCompilerOptions(s.default),setTimeout(function(){return f.triggerCompilation()},1e3),f}return __extends(t,e),t.prototype.setJSInstance=function(e){this.jsInstance=e},t.prototype.updateBreakPoints=function(e){var t=this,i=Object.keys(e.breakpoints).map(function(e){return parseInt(e)});this.convertLineNoFromJSToTS(i).then(function(e){t.toggleBreakPoint(e)})},t.prototype.onBreakpoint=function(e,t,i,s){var a=this;void 0===i&&(i=""),void 0===s&&(s=!1);n.getCurrentSI();this.convertLineNoFromTStoJS([e]).then(function(e){a.jsInstance&&a.jsInstance.toggleBreakPoint(e),!n.isServiceNow||D()?a.convertLineNoFromJSToTS(e).then(function(e){a.toggleBreakPoint(e)},function(e){console.log(e)}):a.toggleBreakPointInServer(e[0],i,s)},function(e){console.log(e)})},t.prototype.onContentChanged=function(){var e=n.getCurrentSI();e.setDirtyState(!0),e.updateTSScript(this.model.getValue()),-1!=this.compileTriggerTimoutID&&(clearTimeout(this.compileTriggerTimoutID),this.compileTriggerTimoutID=-1);var t="undefined"!=typeof ts,i="undefined"!=typeof monaco;t&&i&&(this.compileTriggerTimoutID=window.setTimeout(this.triggerCompilation.bind(this),5000))},t.prototype.triggerCompilation=function(){var e=this,t=n.getCurrentSI();this.compileTriggerTimoutID=-1,i().then(function(s){t.updateScript(s.js),t.setDirtyState(!1),t.updateDeclaration(s.declaration),t.updateSourcemap(s.sourceMap),e.sourcemapConsumer&&e.sourcemapConsumer.destroy(),e.sourcemapConsumer=void 0,e.tsOuput=s;var r=e.dmp.diff_linesToChars_(k,t.tsscript),a=r.chars1,o=r.chars2,l=r.lineArray,d=e.dmp.diff_main(a,o,!0);e.dmp.diff_charsToLines_(d,l),e.dmp.diff_cleanupSemantic(d);for(var c=[],f=1,m=function(e){var t=d[e];if(t[0]==u.DIFF_EQUAL)return h=t[1].split("\n").length,f+=h-1,"continue";if(t[0]==u.DIFF_DELETE){var i=t[1].split("\n").length;return 2<=i&&(i-=2),c.push({start:f,length:i,changeType:u.DIFF_DELETE}),"continue"}if(t[0]==u.DIFF_INSERT){if(0==t[1].length)return"continue";var n=t[1].split("\n"),s=0;n.forEach(function(){s++}),0==n[n.length-1].length&&(s-=1,s=g(0,s)),c.push({start:f,length:s,changeType:u.DIFF_INSERT}),f+=s}},y=0,h;y<d.length;y++)m(y);if(c.forEach(function(e){console.log(u[e.changeType]+" "+e.start+" => "+(e.start+e.length))}),t.isJavascript()){s.linterErrors=s.linterErrors||[];var C=s.linterErrors.map(function(e){return{startLineNumber:e.line,endLineNumber:e.endLine||e.line,startColumn:e.column,endColumn:e.endColumn||e.column,message:e.message+" ("+e.ruleId+")",severity:monaco.MarkerSeverity.Warning,source:"ESLint"}});monaco.editor.setModelMarkers(e.model,"eslint",C)}e.applySourcemap().then(function(i){if(e.sourcemapConsumer=i,!e.isBreakPointsLoaded&&(e.isBreakPointsLoaded=!0,n.getCurrentSI().canPlaceBreakPoints()&&!D()&&e.loadBreakPointsFromServer("sys_script_include.script"),n.isServiceNow()&&!t.isNew())){var s=p.default(),a="script_id="+t.sys_id,r=-1;s.initChannel("sys_js_breakpoint",a).subscribe(function(){-1!=r&&clearTimeout(r),r=self.setTimeout(function(){e.loadBreakPointsFromServer("sys_script_include.script")},5e3)})}}),e.cb(s)},function(e){console.log(e)})},t.prototype.convertLineNoFromTStoJS=function(e){if(!this.sourcemapConsumer)return Promise.resolve(e);var t=[],i=n.getCurrentSI(),s="point.js";i.isTypescript()&&(s="module.ts",i.containsTemplateExpression()&&(s="point.ts"));for(var a=0,r=e;a<r.length;a++){var o=r[a],p=this.sourcemapConsumer.generatedPositionFor({source:s,line:o,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});t.push(p.line)}return Promise.resolve(t)},t.prototype.convertLineNoFromJSToTS=function(e){if(!this.sourcemapConsumer)return this.tsBreakPointState=this.jsBreakPointsState,Promise.resolve(e);for(var t=[],i={breakpoints:{},key:this.jsBreakPointsState&&this.jsBreakPointsState.key},n=0,s=e;n<s.length;n++){var a=s[n],r=this.sourcemapConsumer.originalPositionFor({line:a,column:1,bias:sourceMap.SourceMapConsumer.LEAST_UPPER_BOUND});r&&r.line&&(i.breakpoints[r.line]=this.jsBreakPointsState&&this.jsBreakPointsState.breakpoints&&this.jsBreakPointsState.breakpoints[a],t.push(r.line))}return this.tsBreakPointState=i,Promise.resolve(t)},t.prototype.applySourcemap=function(){if("undefined"==typeof sourceMap)return Promise.resolve(void 0);if(!this.tsOuput.sourceMap)return Promise.resolve(void 0);var e=new sourceMap.SourceMapConsumer(JSON.parse(this.tsOuput.sourceMap));return e},t}(L),O=function(e){function i(t,i,s,a,r,o){void 0===s&&(s=!1),void 0===a&&(a=""),void 0===r&&(r=""),void 0===o&&(o=!1);var p=e.call(this,t,i,s,a,r,o)||this;return p.registerForRun(),n.loadJSXIntellisense(),p}return __extends(i,e),i.prototype.registerForRun=function(){var e=this,t=document.getElementById(r.EL_SCRIPT_RUNNER);t.addEventListener("click",function(){e.renderOutput()})},i.prototype.onContentChanged=function(){return this.handleJSXChanges()},i.prototype.triggerCompilation=function(){if(n.isSeismicComponent())return this.handleJSXChanges()},i.prototype.renderOutput=function(){var e=this.jsxValue;window.getComponent=function(){return e},jQuery("a[href=\"#script-output\"]").tab("show");var t=jQuery("#"+r.EL_SCRIPT_OUTPUT),i=document.createElement("iframe");i.id="seismic_host",i.style.width="100%",i.style.height="100%",i.style.border="1px solid darkgray",i.src="./seismic."+(n.isServiceNow()?"do":"html")+"?cache="+Date.now(),t.html(i)},i.prototype.handleJSXChanges=function(){var e=this;localStorage.setItem("last_monaco_script",this.model.getValue()),monaco.languages.typescript.getTypeScriptWorker().then(function(i){i(e.model.uri).then(function(i){var n=i.getEmitOutput(e.model.uri.toString());n.then(function(i){return i.emitSkipped?void t().then(function(){},function(){console.log("Error while compiling")}):void i.outputFiles.forEach(function(t){t.name.endsWith(".js")&&(e.jsxValue=t.text,e.jsInstance&&e.jsInstance.updateModelContent(t.text))})})})})},i}(w),R=document.getElementById(r.EL_THEME_SELECT),B=!0;var U=-1,J={startDebugger:function(){var e;return"undefined"==typeof window.top.launchScriptDebugger?window.top.opener&&window.top.opener.top.launchScriptDebugger&&(e=window.top.opener.top.launchScriptDebugger):e=window.top.launchScriptDebugger,"undefined"!=typeof e&&"undefined"!=typeof g_form?void e(g_form.getUniqueValue(),g_form.getTableName()):"undefined"==typeof g_form?void I():void I(g_form.getUniqueValue(),g_form.getTableName())},saveSI:function(e){-1==U&&e&&(U=self.setTimeout(function(){U=-1},60000),M("You can use ` CMD/CTRL + s ` keyboard shorcut to save the script. It's pretty handy!","info",1e4)),e||(e=document.getElementById("codenow.savesi"));var t=jQuery(e),s=t.find(">i");return t.attr("disabled","disabled"),s.removeClass("hide"),i(!0).then(function(e){var i=o.ClientSIRecordData.getClassConstructorFormat(n.getCurrentSI()),a={js:i,decl:e.backEndDecl,esNext:e.tsScript,sourceMap:e.sourceMap},r={contentType:"application/json",data:JSON.stringify(a),headers:{X_UserToken:window.g_ck},method:"POST",type:"POST",url:"/api/now/typescript_helpers/UpdateSI"};jQuery.ajax(r).done(function(){t.removeAttr("disabled"),s.addClass("hide"),F=0,M("Updated successfully","info")}).fail(function(){E(t,s,jQuery("#fail_modal"))})},function(e){M(e,"error"),t.removeAttr("disabled"),s.addClass("hide")}),!1},toggleLinter:function(){s.default.linter=!s.default.linter,monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:s.default.linter,noSyntaxValidation:s.default.linter}),x()},updateAllSIDeclaration:function(e,t){function i(e){if(0==e.length)return void E(s,a,jQuery("#success_modal"));if(n.isServiceNow()){var i={url:"/api/now/typescript_helpers/updateMultiSIDecl",type:"POST",data:e,headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}};t&&(i.url="/api/now/table/ts_definition/b4c6d3500ba213008e64aabcb4673a6c",i.type="put",i.data=JSON.stringify({json_value:e})),jQuery.ajax(i).done(function(e){E(s,a,jQuery("#success_modal")),console.log(e)}).fail(function(){E(s,a,jQuery("#fail_modal"))})}}void 0===t&&(t=!1);var s=jQuery(e),a=s.find(">i");s.attr("disabled","disabled"),a.removeClass("hide");var r="";r=t?"/api/now/table/sys_script_include?&sysparm_query=active=true":"/api/now/typescript_helpers/getOutOfSyncSI",n.isServiceNow()||(r="/scripts/sys_script_include.json");var p=new n.RecordFetcher(r);p.fetch().then(function(e){var t=jQuery("#UpdateSI");if(0==e.length)return E(s,a,jQuery("#success_modal")),void t.text("Update Scripts");if(!window.recordConfig.useTypeChecker){var r=o.parseSI(e,esprima),l=JSON.stringify({api:JSON.parse(r.getFormat(!0))}),d=r.getParsingErrors(),c=r.getEmptyDeclarations();d.forEach(function(e){console.error("Parsing error for => "+e)}),c.forEach(function(e){console.error("empty declaration for "+e)}),i(l)}else{window.onSIParserProgressEvent=function(e,i){t.text("Updating ... "+i+" %")};var g=n.generateTypeDeclarations(e);g.then(function(e){var n=JSON.stringify({api:e.formatterResult});i(n),console.log("type checker parser results came "),e.errors&&0<e.errors.length&&e.errors.forEach(function(e){console.log("parsing error "+e)}),t.text("Update Scripts")},function(){s.removeAttr("disabled"),t.text("Try again")}),console.log("parsing done")}},function(e){alert("unable to fetch the script include with error "+e)})},updateTableDeclarations:function(e){var t=jQuery(e),i=t.find(">i");t.attr("disabled","disabled"),i.removeClass("hide");jQuery.ajax({url:"/api/now/typescript_helpers/updatetabledefinition",type:"post",data:JSON.stringify({}),headers:{"X-UserToken":window.g_ck},contentType:"application/json",success:function(e){console.log(e)}}).done(function(e){E(t,i,jQuery("#success_modal")),console.log(e)}).fail(function(){E(t,i,jQuery("#fail_modal"))})},openNewWindow:function(){window.open(location.href)},updateOnSave:function(){return d(!1,window.recordConfig.useTypeChecker,!0,function(){var e=window.recordConfig;e.isNewRecord?gsftSubmit(void 0,void 0,"sysverb_insert"):gsftSubmit(void 0,void 0,g_form.getActionName())},function(){})},updateDecl:function(e,t){var i=jQuery(e),n=i.find(">i");return i.attr("disabled","disabled"),n.removeClass("hide"),d(t,!0,!1,function(){E(i,n,jQuery("#success_modal"))},function(){E(i,n,jQuery("#fail_modal"))})},onCompilerSettingsChange:function(e){var t=e.closest("li"),i=t.dataset.key;i&&(N[i]=!N[i],N[i]?jQuery(t).find(".state-icon").removeClass("glyphicon-unchecked").addClass("glyphicon-check"):jQuery(t).find(".state-icon").removeClass("glyphicon-check").addClass("glyphicon-unchecked"),x())},onTargetChange:function(e,t){var i=parseInt(t);N.target=i,x()},onJSXChange:function(e,t){var i=parseInt(t);return N.jsx=i,n.loadJSXIntellisense(),x()},initialize:function(){S()}};return J}Object.defineProperty(t,"__esModule",{value:!0}),n=__importStar(n),s=__importDefault(s),r=__importStar(r),o=__importStar(o),p=__importDefault(p),l=__importStar(l);var f=n.TranspilerOutput,u;(function(e){e[e.DIFF_DELETE=-1]="DIFF_DELETE",e[e.DIFF_INSERT=1]="DIFF_INSERT",e[e.DIFF_EQUAL=0]="DIFF_EQUAL"})(u||(u={}));n.isMainThread()&&window.recordConfig&&(window.settings=d())});function getWorkerUrl(e){if(0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")){var t="ylnworker.jsdbx";return window.g_ck||(t="ylnworker.js"),t+"?v="+e}var i=location.origin+"/";window.recordConfig.paths.app.startsWith("ylnEditorMain")?i+=window.recordConfig.paths.app:i=window.recordConfig.paths.app,window.g_ck||(i=location.origin+"/app.js");var n="'"+window.recordConfig.paths.linter+"'",s="'"+window.recordConfig.paths.vsLoader+"'",a="'"+window.recordConfig.paths.tsCompiler+"'",r=[n,s,a].join(","),o={libVersions:{appVersion:window.recordConfig.libVersions.appVersion},paths:{app:window.recordConfig.paths.app,tsCompiler:window.recordConfig.paths.tsCompiler,vsLoader:window.recordConfig.paths.vsLoader,linter:window.recordConfig.paths.linter}},p="self.recordConfig = JSON.parse('"+JSON.stringify(o)+"');\n";p+="importScripts("+r+");",p+="require.config({baseUrl: './',urlArgs: 'sysparm_substitute=false', paths: {},ignoreDuplicateModules: []});",p+="define('typescript', [], function () {return self.ts;});",p+="importScripts('"+i+"');",p+="var siDeclName = 'scripts/SIDeclEmittor';require(siDeclName).onThreadInitialized(self);";var l="data:text/javascript;charset=utf-8,"+encodeURIComponent(p);return l}function loadWorkerThread(){var e={app:window.g_ck?location.origin+"/ylnEditorMain.jsdbx":location.origin+"/app.js",loaderVersion:recordConfig.tsVersion,tsVersion:"3.2.2"};(function(e,t){var i="("+e+")(";return"string"==typeof t&&(i+=t),i+=")",new Worker(URL.createObjectURL(new Blob([i])))})(function(e){console.log(e);var t=e||JSON.parse(e),i=t.loaderVersion||"0.15.6",n=t.tsVersion||"3.2.2";importScripts("https://cdn.jsdelivr.net/npm/monaco-editor@"+i+"/min/vs/loader.js","https://cdnjs.cloudflare.com/ajax/libs/typescript/"+n+"/typescript.min.js"),console.log("cdn scripts loaded"),require.config({baseUrl:"./",urlArgs:"sysparm_substitute=false",paths:{},ignoreDuplicateModules:[]}),define("typescript",[],function(){return self.ts}),importScripts(t.app),console.log("app loaded"),require("scripts/SIDeclEmittor").onThreadInitialized(self),console.log("messages registered successfully")},JSON.stringify(e))}function escapeText(e){for(var t=0,n=null,s=[],a=0,r=e.length,o;a<r;a++)o=e.charCodeAt(a),o===96?n="\\`":o===8?n="\\b":o===12?n="\\f":o===10?n="\\n":o===0?n="\\0":o===13?n="\\r":o===9?n="\\t":o===11?n="\\v":o===92?n="\\\\":o===34?n="\\\"":void 0,null!==n&&(s.push(e.substring(t,a)),s.push(n),t=a+1,n=null);return s.push(e.substring(t,r)),s.join("")}function CodeMirrorNoScriptTextAreaElementForSI(e){this.name=e}CodeMirrorNoScriptTextAreaElementForSI.prototype.initialize=function(e){this.name=e},CodeMirrorNoScriptTextAreaElementForSI.prototype.setReadOnly=function(){},CodeMirrorNoScriptTextAreaElementForSI.prototype.isDisabled=function(){return!1},CodeMirrorNoScriptTextAreaElementForSI.prototype.isReadOnly=function(){return!1},CodeMirrorNoScriptTextAreaElementForSI.prototype.getValue=function(){return currentSI.script},CodeMirrorNoScriptTextAreaElementForSI.prototype.setValue=function(){document.getElementById(this.name).value=currentSI.script},CodeMirrorNoScriptTextAreaElementForSI.prototype.isVisible=function(){return!0};function createParserThread(e){var t={libVersions:{appVersion:window.recordConfig.libVersions.appVersion},paths:{app:window.recordConfig.paths.app,tsCompiler:window.recordConfig.paths.tsCompiler,vsLoader:window.recordConfig.paths.vsLoader,linter:window.recordConfig.paths.linter}},i=new Worker(getWorkerUrl(window.recordConfig.libVersions.appVersion),{name:"ylnworker?codenowWorkerParams="+JSON.stringify(t)});window.ylnWorker=i,e.onThreadInitialized(i)}function loadEditorUI(){function e(){window.removeEventListener("visibilitychange",e),console.log("initialyzing monaco editor on visibility change event"),settings.initialize()}var t=require||t;t.config({urlArgs:"sysparm_substitute=false",paths:{vs:window.recordConfig.paths.vsSource},ignoreDuplicateModules:["vs/basic-languages/typescript/typescript","vs/editor/editor.main"]});window.recordConfig.useDev||(window.MonacoEnvironment={getWorkerUrl:function(){var e="self.MonacoEnvironment = {";return e+="baseUrl: '"+window.recordConfig.paths.monacoBase+"'",e+="}\nimportScripts('"+window.recordConfig.paths.monacoWorker+"')","data:text/javascript;charset=utf-8,"+encodeURIComponent(e)}}),t(["vs/editor/editor.main"],function(){t(["vs/language/typescript/tsWorker"],function(){define("typescript",["require"],function(){"use strict";return window.ts}),t(["scripts/monacoInit","scripts/SIDeclEmittor"],function(t,i){i.canWriteSI()&&!i.isSeismicComponent()&&createParserThread(i),function t(){return"undefined"==typeof monaco?void setTimeout(t,1e3):void("undefined"==typeof document.hidden?settings.initialize():document.hidden?window.addEventListener("visibilitychange",e):settings.initialize())}()})})}),function e(){return window.g_ck?"undefined"==typeof g_form?void setTimeout(e,1e3):void(g_form.ylnWindow=window):void 0}()}if("undefined"!=typeof window&&window.recordConfig){window.CodeMirrorNoScriptTextAreaElement=CodeMirrorNoScriptTextAreaElementForSI;var keyName="codenow_"+window.recordConfig.sysId,thisStorage=localStorage.getItem(keyName);if(!window.recordConfig.isFromScriptRunner){if(thisStorage){var lastActiveTime=parseInt(thisStorage);!isNaN(lastActiveTime)&&4e3>Date.now()-lastActiveTime&&confirm("Seems like you already opened this SI, click OK to close")&&window.close()}setInterval(function(){localStorage.setItem(keyName,Date.now())},1e3),window.addEventListener("beforeunload",function(){localStorage.removeItem(keyName)})}loadEditorUI()}define("scripts/loaderMain.js",function(){});var diff_match_patch=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;diff_match_patch.Diff=function(e,t){this[0]=e,this[1]=t},diff_match_patch.Diff.prototype.length=2,diff_match_patch.Diff.prototype.toString=function(){return this[0]+","+this[1]},diff_match_patch.prototype.diff_main=function(e,t,i,n){var s=Number.MAX_VALUE;"undefined"==typeof n&&(0>=this.Diff_Timeout?n=s:n=new Date().getTime()+1e3*this.Diff_Timeout);var a=n;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new diff_match_patch.Diff(DIFF_EQUAL,e)]:[];"undefined"==typeof i&&(i=!0);var r=i,o=this.diff_commonPrefix(e,t),p=e.substring(0,o);e=e.substring(o),t=t.substring(o),o=this.diff_commonSuffix(e,t);var l=e.substring(e.length-o);e=e.substring(0,e.length-o),t=t.substring(0,t.length-o);var d=this.diff_compute_(e,t,r,a);return p&&d.unshift(new diff_match_patch.Diff(DIFF_EQUAL,p)),l&&d.push(new diff_match_patch.Diff(DIFF_EQUAL,l)),this.diff_cleanupMerge(d),d},diff_match_patch.prototype.diff_compute_=function(e,t,n,s){var a;if(!e)return[new diff_match_patch.Diff(DIFF_INSERT,t)];if(!t)return[new diff_match_patch.Diff(DIFF_DELETE,e)];var r=e.length>t.length?e:t,o=e.length>t.length?t:e,p=r.indexOf(o);if(-1!=p)return a=[new diff_match_patch.Diff(DIFF_INSERT,r.substring(0,p)),new diff_match_patch.Diff(DIFF_EQUAL,o),new diff_match_patch.Diff(DIFF_INSERT,r.substring(p+o.length))],e.length>t.length&&(a[0][0]=a[2][0]=DIFF_DELETE),a;if(1==o.length)return[new diff_match_patch.Diff(DIFF_DELETE,e),new diff_match_patch.Diff(DIFF_INSERT,t)];var i=this.diff_halfMatch_(e,t);if(i){var l=i[0],d=i[1],c=i[2],g=i[3],f=i[4],u=this.diff_main(l,c,n,s),m=this.diff_main(d,g,n,s);return u.concat([new diff_match_patch.Diff(DIFF_EQUAL,f)],m)}return n&&100<e.length&&100<t.length?this.diff_lineMode_(e,t,s):this.diff_bisect_(e,t,s)},diff_match_patch.prototype.diff_lineMode_=function(e,t,i){var n=this.diff_linesToChars_(e,t);e=n.chars1,t=n.chars2;var s=n.lineArray,a=this.diff_main(e,t,!1,i);this.diff_charsToLines_(a,s),this.diff_cleanupSemantic(a),a.push(new diff_match_patch.Diff(DIFF_EQUAL,""));for(var r=0,o=0,p=0,l="",d="";r<a.length;){switch(a[r][0]){case DIFF_INSERT:p++,d+=a[r][1];break;case DIFF_DELETE:o++,l+=a[r][1];break;case DIFF_EQUAL:if(1<=o&&1<=p){a.splice(r-o-p,o+p),r=r-o-p;for(var c=this.diff_main(l,d,!1,i),g=c.length-1;0<=g;g--)a.splice(r,0,c[g]);r+=c.length}p=0,o=0,l="",d="";}r++}return a.pop(),a},diff_match_patch.prototype.diff_bisect_=function(e,t,i){for(var n=e.length,s=t.length,a=Math.ceil((n+s)/2),r=a,o=2*a,p=Array(o),l=Array(o),c=0;c<o;c++)p[c]=-1,l[c]=-1;p[r+1]=0,l[r+1]=0;for(var g=n-s,f=0!=g%2,u=0,m=0,y=0,h=0,C=0;C<a&&!(new Date().getTime()>i);C++){for(var T=-C+u;T<=C-m;T+=2){var _=r+T,S;S=T==-C||T!=C&&p[_-1]<p[_+1]?p[_+1]:p[_-1]+1;for(var b=S-T;S<n&&b<s&&e.charAt(S)==t.charAt(b);)S++,b++;if(p[_]=S,S>n)m+=2;else if(b>s)u+=2;else if(f){var A=r+g-T;if(0<=A&&A<o&&-1!=l[A]){var I=n-l[A];if(S>=I)return this.diff_bisectSplit_(e,t,S,b,i)}}}for(var E=-C+y;E<=C-h;E+=2){var A=r+E,I;I=E==-C||E!=C&&l[A-1]<l[A+1]?l[A+1]:l[A-1]+1;for(var M=I-E;I<n&&M<s&&e.charAt(n-I-1)==t.charAt(s-M-1);)I++,M++;if(l[A]=I,I>n)h+=2;else if(M>s)y+=2;else if(!f){var _=r+g-E;if(0<=_&&_<o&&-1!=p[_]){var S=p[_],b=r+S-_;if(I=n-I,S>=I)return this.diff_bisectSplit_(e,t,S,b,i)}}}}return[new diff_match_patch.Diff(DIFF_DELETE,e),new diff_match_patch.Diff(DIFF_INSERT,t)]},diff_match_patch.prototype.diff_bisectSplit_=function(e,t,i,n,s){var a=e.substring(0,i),r=t.substring(0,n),o=e.substring(i),p=t.substring(n),l=this.diff_main(a,r,!1,s),d=this.diff_main(o,p,!1,s);return l.concat(d)},diff_match_patch.prototype.diff_linesToChars_=function(e,t){var n=String.fromCharCode;function i(e){for(var t="",i=0,o=-1,p=s.length;o<e.length-1;){o=e.indexOf("\n",i),-1==o&&(o=e.length-1);var l=e.substring(i,o+1);(a.hasOwnProperty?a.hasOwnProperty(l):a[l]!==void 0)?t+=n(a[l]):(p==r&&(l=e.substring(i),o=e.length),t+=n(p),a[l]=p,s[p++]=l),i=o+1}return t}var s=[],a={};s[0]="";var r=4e4,o=i(e);r=65535;var p=i(t);return{chars1:o,chars2:p,lineArray:s}},diff_match_patch.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var s=e[n][1],a=[],r=0;r<s.length;r++)a[r]=t[s.charCodeAt(r)];e[n][1]=a.join("")}},diff_match_patch.prototype.diff_commonPrefix=function(e,t){var i=Math.min,n=Math.floor;if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var s=0,a=i(e.length,t.length),r=a,o=0;s<r;)e.substring(o,r)==t.substring(o,r)?(s=r,o=s):a=r,r=n((a-s)/2+s);return r},diff_match_patch.prototype.diff_commonSuffix=function(e,t){var i=Math.min,n=Math.floor;if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var s=0,a=i(e.length,t.length),r=a,o=0;s<r;)e.substring(e.length-r,e.length-o)==t.substring(t.length-r,t.length-o)?(s=r,o=s):a=r,r=n((a-s)/2+s);return r},diff_match_patch.prototype.diff_commonOverlap_=function(e,t){var i=e.length,n=t.length;if(0==i||0==n)return 0;i>n?e=e.substring(i-n):i<n&&(t=t.substring(0,i));var s=Math.min(i,n);if(e==t)return s;for(var a=0,r=1;;){var o=e.substring(s-r),p=t.indexOf(o);if(-1==p)return a;r+=p,(0==p||e.substring(s-r)==t.substring(0,r))&&(a=r,r++)}},diff_match_patch.prototype.diff_halfMatch_=function(e,t){var n=Math.ceil,s=Math.floor;function i(e,t,n){for(var i=e.substring(n,n+s(e.length/4)),a=-1,r="",p,l,d,c;-1!=(a=t.indexOf(i,a+1));){var g=o.diff_commonPrefix(e.substring(n),t.substring(a)),f=o.diff_commonSuffix(e.substring(0,n),t.substring(0,a));r.length<f+g&&(r=t.substring(a-f,a)+t.substring(a,a+g),p=e.substring(0,n-f),l=e.substring(n+g),d=t.substring(0,a-f),c=t.substring(a+g))}return 2*r.length>=e.length?[p,l,d,c,r]:null}if(0>=this.Diff_Timeout)return null;var a=e.length>t.length?e:t,r=e.length>t.length?t:e;if(4>a.length||2*r.length<a.length)return null;var o=this,p=i(a,r,n(a.length/4)),l=i(a,r,n(a.length/2)),d;if(!p&&!l)return null;d=l?p?p[4].length>l[4].length?p:l:l:p;var c,g,f,u;e.length>t.length?(c=d[0],g=d[1],f=d[2],u=d[3]):(f=d[0],u=d[1],c=d[2],g=d[3]);var m=d[4];return[c,g,f,u,m]},diff_match_patch.prototype.diff_cleanupSemantic=function(e){for(var t=Math.max,i=!1,n=[],s=0,a=null,r=0,o=0,p=0,l=0,d=0;r<e.length;)e[r][0]==DIFF_EQUAL?(n[s++]=r,o=l,p=d,l=0,d=0,a=e[r][1]):(e[r][0]==DIFF_INSERT?l+=e[r][1].length:d+=e[r][1].length,a&&a.length<=t(o,p)&&a.length<=t(l,d)&&(e.splice(n[s-1],0,new diff_match_patch.Diff(DIFF_DELETE,a)),e[n[s-1]+1][0]=DIFF_INSERT,s--,s--,r=0<s?n[s-1]:-1,o=0,p=0,l=0,d=0,a=null,i=!0)),r++;for(i&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),r=1;r<e.length;){if(e[r-1][0]==DIFF_DELETE&&e[r][0]==DIFF_INSERT){var c=e[r-1][1],g=e[r][1],f=this.diff_commonOverlap_(c,g),u=this.diff_commonOverlap_(g,c);f>=u?(f>=c.length/2||f>=g.length/2)&&(e.splice(r,0,new diff_match_patch.Diff(DIFF_EQUAL,g.substring(0,f))),e[r-1][1]=c.substring(0,c.length-f),e[r+1][1]=g.substring(f),r++):(u>=c.length/2||u>=g.length/2)&&(e.splice(r,0,new diff_match_patch.Diff(DIFF_EQUAL,c.substring(0,u))),e[r-1][0]=DIFF_INSERT,e[r-1][1]=g.substring(0,g.length-u),e[r+1][0]=DIFF_DELETE,e[r+1][1]=c.substring(u),r++),r++}r++}},diff_match_patch.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var i=e.charAt(e.length-1),n=t.charAt(0),s=i.match(diff_match_patch.nonAlphaNumericRegex_),a=n.match(diff_match_patch.nonAlphaNumericRegex_),r=s&&i.match(diff_match_patch.whitespaceRegex_),o=a&&n.match(diff_match_patch.whitespaceRegex_),p=r&&i.match(diff_match_patch.linebreakRegex_),l=o&&n.match(diff_match_patch.linebreakRegex_),d=p&&e.match(diff_match_patch.blanklineEndRegex_),c=l&&t.match(diff_match_patch.blanklineStartRegex_);if(d||c)return 5;return p||l?4:s&&!r&&o?3:r||o?2:s||a?1:0}for(var i=1;i<e.length-1;){if(e[i-1][0]==DIFF_EQUAL&&e[i+1][0]==DIFF_EQUAL){var n=e[i-1][1],s=e[i][1],a=e[i+1][1],r=this.diff_commonSuffix(n,s);if(r){var o=s.substring(s.length-r);n=n.substring(0,n.length-r),s=o+s.substring(0,s.length-r),a=o+a}for(var p=n,l=s,d=a,c=t(n,s)+t(s,a);s.charAt(0)===a.charAt(0);){n+=s.charAt(0),s=s.substring(1)+a.charAt(0),a=a.substring(1);var g=t(n,s)+t(s,a);g>=c&&(c=g,p=n,l=s,d=a)}e[i-1][1]!=p&&(p?e[i-1][1]=p:(e.splice(i-1,1),i--),e[i][1]=l,d?e[i+1][1]=d:(e.splice(i+1,1),i--))}i++}},diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,diff_match_patch.whitespaceRegex_=/\s/,diff_match_patch.linebreakRegex_=/[\r\n]/,diff_match_patch.blanklineEndRegex_=/\n\r?\n$/,diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/,diff_match_patch.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,i=[],n=0,s=null,a=0,r=!1,o=!1,p=!1,l=!1;a<e.length;)e[a][0]==DIFF_EQUAL?(e[a][1].length<this.Diff_EditCost&&(p||l)?(i[n++]=a,r=p,o=l,s=e[a][1]):(n=0,s=null),p=l=!1):(e[a][0]==DIFF_DELETE?l=!0:p=!0,s&&(r&&o&&p&&l||s.length<this.Diff_EditCost/2&&3==r+o+p+l)&&(e.splice(i[n-1],0,new diff_match_patch.Diff(DIFF_DELETE,s)),e[i[n-1]+1][0]=DIFF_INSERT,n--,s=null,r&&o?(p=l=!0,n=0):(n--,a=0<n?i[n-1]:-1,p=l=!1),t=!0)),a++;t&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_cleanupMerge=function(e){e.push(new diff_match_patch.Diff(DIFF_EQUAL,""));for(var t=0,i=0,n=0,s="",a="",r;t<e.length;)switch(e[t][0]){case DIFF_INSERT:n++,a+=e[t][1],t++;break;case DIFF_DELETE:i++,s+=e[t][1],t++;break;case DIFF_EQUAL:1<i+n?(0!==i&&0!==n&&(r=this.diff_commonPrefix(a,s),0!==r&&(0<t-i-n&&e[t-i-n-1][0]==DIFF_EQUAL?e[t-i-n-1][1]+=a.substring(0,r):(e.splice(0,0,new diff_match_patch.Diff(DIFF_EQUAL,a.substring(0,r))),t++),a=a.substring(r),s=s.substring(r)),r=this.diff_commonSuffix(a,s),0!==r&&(e[t][1]=a.substring(a.length-r)+e[t][1],a=a.substring(0,a.length-r),s=s.substring(0,s.length-r))),t-=i+n,e.splice(t,i+n),s.length&&(e.splice(t,0,new diff_match_patch.Diff(DIFF_DELETE,s)),t++),a.length&&(e.splice(t,0,new diff_match_patch.Diff(DIFF_INSERT,a)),t++),t++):0!==t&&e[t-1][0]==DIFF_EQUAL?(e[t-1][1]+=e[t][1],e.splice(t,1)):t++,n=0,i=0,s="",a="";}""===e[e.length-1][1]&&e.pop();var o=!1;for(t=1;t<e.length-1;)e[t-1][0]==DIFF_EQUAL&&e[t+1][0]==DIFF_EQUAL&&(e[t][1].substring(e[t][1].length-e[t-1][1].length)==e[t-1][1]?(e[t][1]=e[t-1][1]+e[t][1].substring(0,e[t][1].length-e[t-1][1].length),e[t+1][1]=e[t-1][1]+e[t+1][1],e.splice(t-1,1),o=!0):e[t][1].substring(0,e[t+1][1].length)==e[t+1][1]&&(e[t-1][1]+=e[t+1][1],e[t][1]=e[t][1].substring(e[t+1][1].length)+e[t+1][1],e.splice(t+1,1),o=!0)),t++;o&&this.diff_cleanupMerge(e)},diff_match_patch.prototype.diff_xIndex=function(e,t){var i=0,n=0,s=0,a=0,r;for(r=0;r<e.length&&(e[r][0]!==DIFF_INSERT&&(i+=e[r][1].length),e[r][0]!==DIFF_DELETE&&(n+=e[r][1].length),!(i>t));r++)s=i,a=n;return e.length!=r&&e[r][0]===DIFF_DELETE?a:a+(t-s)},diff_match_patch.prototype.diff_prettyHtml=function(e){for(var t=[],i=/&/g,n=/</g,s=/>/g,a=/\n/g,r=0;r<e.length;r++){var o=e[r][0],p=e[r][1],l=p.replace(i,"&amp;").replace(n,"&lt;").replace(s,"&gt;").replace(a,"&para;<br>");o===DIFF_INSERT?t[r]="<ins style=\"background:#e6ffe6;\">"+l+"</ins>":o===DIFF_DELETE?t[r]="<del style=\"background:#ffe6e6;\">"+l+"</del>":o===DIFF_EQUAL?t[r]="<span>"+l+"</span>":void 0}return t.join("")},diff_match_patch.prototype.diff_text1=function(e){for(var t=[],i=0;i<e.length;i++)e[i][0]!==DIFF_INSERT&&(t[i]=e[i][1]);return t.join("")},diff_match_patch.prototype.diff_text2=function(e){for(var t=[],i=0;i<e.length;i++)e[i][0]!==DIFF_DELETE&&(t[i]=e[i][1]);return t.join("")},diff_match_patch.prototype.diff_levenshtein=function(e){for(var t=Math.max,i=0,n=0,s=0,a=0;a<e.length;a++){var r=e[a][0],o=e[a][1];r===DIFF_INSERT?n+=o.length:r===DIFF_DELETE?s+=o.length:r===DIFF_EQUAL?(i+=t(n,s),n=0,s=0):void 0}return i+=t(n,s),i},diff_match_patch.prototype.diff_toDelta=function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i][0]){case DIFF_INSERT:t[i]="+"+encodeURI(e[i][1]);break;case DIFF_DELETE:t[i]="-"+e[i][1].length;break;case DIFF_EQUAL:t[i]="="+e[i][1].length;}return t.join("\t").replace(/%20/g," ")},diff_match_patch.prototype.diff_fromDelta=function(e,t){for(var i=[],s=0,a=0,r=t.split(/\t/g),o=0,p;o<r.length;o++)switch(p=r[o].substring(1),r[o].charAt(0)){case"+":try{i[s++]=new diff_match_patch.Diff(DIFF_INSERT,decodeURI(p))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+p)}break;case"-":case"=":var l=parseInt(p,10);if(isNaN(l)||0>l)throw new Error("Invalid number in diff_fromDelta: "+p);var n=e.substring(a,a+=l);i[s++]="="==r[o].charAt(0)?new diff_match_patch.Diff(DIFF_EQUAL,n):new diff_match_patch.Diff(DIFF_DELETE,n);break;default:if(r[o])throw new Error("Invalid diff operation in diff_fromDelta: "+r[o]);}if(a!=e.length)throw new Error("Delta length ("+a+") does not equal source text length ("+e.length+").");return i},diff_match_patch.prototype.match_main=function(e,t,i){var n=Math.min,s=Math.max;if(null==e||null==t||null==i)throw new Error("Null input. (match_main)");return i=s(0,n(i,e.length)),e==t?0:e.length?e.substring(i,i+t.length)==t?i:this.match_bitap_(e,t,i):-1},diff_match_patch.prototype.match_bitap_=function(e,t,i){var a=Math.min,r=Math.floor,o=Math.max;function n(n,e){var a=n/t.length,r=Math.abs(i-e);return s.Match_Distance?a+r/s.Match_Distance:r?1:a}if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var p=this.match_alphabet_(t),s=this,l=this.Match_Threshold,c=e.indexOf(t,i);-1!=c&&(l=a(n(0,c),l),c=e.lastIndexOf(t,i+t.length),-1!=c&&(l=a(n(0,c),l)));var g=1<<t.length-1;c=-1;for(var f=t.length+e.length,u=0,m,y,h;u<t.length;u++){for(m=0,y=f;m<y;)n(u,i+y)<=l?m=y:f=y,y=r((f-m)/2+m);f=y;var C=o(1,i-y+1),T=a(i+y,e.length)+t.length,_=Array(T+2);_[T+1]=(1<<u)-1;for(var S=T,b;S>=C;S--)if(b=p[e.charAt(S-1)],_[S]=0==u?(1|_[S+1]<<1)&b:(1|_[S+1]<<1)&b|(1|(h[S+1]|h[S])<<1)|h[S+1],_[S]&g){var A=n(u,S-1);if(A<=l)if(l=A,c=S-1,c>i)C=o(1,2*i-c);else break}if(n(u+1,i)>l)break;h=_}return c},diff_match_patch.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(var n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},diff_match_patch.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var i=t.substring(e.start2,e.start2+e.length1),n=0;t.indexOf(i)!=t.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,i=t.substring(e.start2-n,e.start2+e.length1+n);n+=this.Patch_Margin;var s=t.substring(e.start2-n,e.start2);s&&e.diffs.unshift(new diff_match_patch.Diff(DIFF_EQUAL,s));var a=t.substring(e.start2+e.length1,e.start2+e.length1+n);a&&e.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,a)),e.start1-=s.length,e.start2-=s.length,e.length1+=s.length+a.length,e.length2+=s.length+a.length}},diff_match_patch.prototype.patch_make=function(e,t,i){var n,s;if("string"==typeof e&&"string"==typeof t&&"undefined"==typeof i)n=e,s=this.diff_main(n,t,!0),2<s.length&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s));else if(e&&"object"==typeof e&&"undefined"==typeof t&&"undefined"==typeof i)s=e,n=this.diff_text1(s);else if("string"==typeof e&&t&&"object"==typeof t&&"undefined"==typeof i)n=e,s=t;else if("string"==typeof e&&"string"==typeof t&&i&&"object"==typeof i)n=e,s=i;else throw new Error("Unknown call format to patch_make.");if(0===s.length)return[];for(var a=[],r=new diff_match_patch.patch_obj,o=0,p=0,l=0,d=n,c=n,g=0;g<s.length;g++){var f=s[g][0],u=s[g][1];o||f===DIFF_EQUAL||(r.start1=p,r.start2=l),f===DIFF_INSERT?(r.diffs[o++]=s[g],r.length2+=u.length,c=c.substring(0,l)+u+c.substring(l)):f===DIFF_DELETE?(r.length1+=u.length,r.diffs[o++]=s[g],c=c.substring(0,l)+c.substring(l+u.length)):f===DIFF_EQUAL?u.length<=2*this.Patch_Margin&&o&&s.length!=g+1?(r.diffs[o++]=s[g],r.length1+=u.length,r.length2+=u.length):u.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(r,d),a.push(r),r=new diff_match_patch.patch_obj,o=0,d=c,p=l):void 0,f!==DIFF_INSERT&&(p+=u.length),f!==DIFF_DELETE&&(l+=u.length)}return o&&(this.patch_addContext_(r,d),a.push(r)),a},diff_match_patch.prototype.patch_deepCopy=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i],s=new diff_match_patch.patch_obj;s.diffs=[];for(var a=0;a<n.diffs.length;a++)s.diffs[a]=new diff_match_patch.Diff(n.diffs[a][0],n.diffs[a][1]);s.start1=n.start1,s.start2=n.start2,s.length1=n.length1,s.length2=n.length2,t[i]=s}return t},diff_match_patch.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var i=this.patch_addPadding(e);t=i+t+i,this.patch_splitMax(e);for(var n=0,s=[],a=0;a<e.length;a++){var r=e[a].start2+n,o=this.diff_text1(e[a].diffs),p=-1,l;if(o.length>this.Match_MaxBits?(l=this.match_main(t,o.substring(0,this.Match_MaxBits),r),-1!=l&&(p=this.match_main(t,o.substring(o.length-this.Match_MaxBits),r+o.length-this.Match_MaxBits),(-1==p||l>=p)&&(l=-1))):l=this.match_main(t,o,r),-1==l)s[a]=!1,n-=e[a].length2-e[a].length1;else{s[a]=!0,n=l-r;var d;if(d=-1==p?t.substring(l,l+o.length):t.substring(l,p+this.Match_MaxBits),o==d)t=t.substring(0,l)+this.diff_text2(e[a].diffs)+t.substring(l+o.length);else{var c=this.diff_main(o,d,!1);if(o.length>this.Match_MaxBits&&this.diff_levenshtein(c)/o.length>this.Patch_DeleteThreshold)s[a]=!1;else{this.diff_cleanupSemanticLossless(c);for(var g=0,f=0,u,m;f<e[a].diffs.length;f++)m=e[a].diffs[f],m[0]!==DIFF_EQUAL&&(u=this.diff_xIndex(c,g)),m[0]===DIFF_INSERT?t=t.substring(0,l+u)+m[1]+t.substring(l+u):m[0]===DIFF_DELETE&&(t=t.substring(0,l+u)+t.substring(l+this.diff_xIndex(c,g+m[1].length))),m[0]!==DIFF_DELETE&&(g+=m[1].length)}}}}return t=t.substring(i.length,t.length-i.length),[t,s]},diff_match_patch.prototype.patch_addPadding=function(e){for(var t=String.fromCharCode,i=this.Patch_Margin,n="",s=1;s<=i;s++)n+=t(s);for(var s=0;s<e.length;s++)e[s].start1+=i,e[s].start2+=i;var a=e[0],r=a.diffs;if(0==r.length||r[0][0]!=DIFF_EQUAL)r.unshift(new diff_match_patch.Diff(DIFF_EQUAL,n)),a.start1-=i,a.start2-=i,a.length1+=i,a.length2+=i;else if(i>r[0][1].length){var o=i-r[0][1].length;r[0][1]=n.substring(r[0][1].length)+r[0][1],a.start1-=o,a.start2-=o,a.length1+=o,a.length2+=o}if(a=e[e.length-1],r=a.diffs,0==r.length||r[r.length-1][0]!=DIFF_EQUAL)r.push(new diff_match_patch.Diff(DIFF_EQUAL,n)),a.length1+=i,a.length2+=i;else if(i>r[r.length-1][1].length){var o=i-r[r.length-1][1].length;r[r.length-1][1]+=n.substring(0,o),a.length1+=o,a.length2+=o}return n},diff_match_patch.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,i=0;i<e.length;i++)if(!(e[i].length1<=t)){var n=e[i];e.splice(i--,1);for(var s=n.start1,a=n.start2,r="";0!==n.diffs.length;){var o=new diff_match_patch.patch_obj,p=!0;for(o.start1=s-r.length,o.start2=a-r.length,""!==r&&(o.length1=o.length2=r.length,o.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,r)));0!==n.diffs.length&&o.length1<t-this.Patch_Margin;){var l=n.diffs[0][0],d=n.diffs[0][1];l===DIFF_INSERT?(o.length2+=d.length,a+=d.length,o.diffs.push(n.diffs.shift()),p=!1):l===DIFF_DELETE&&1==o.diffs.length&&o.diffs[0][0]==DIFF_EQUAL&&d.length>2*t?(o.length1+=d.length,s+=d.length,p=!1,o.diffs.push(new diff_match_patch.Diff(l,d)),n.diffs.shift()):(d=d.substring(0,t-o.length1-this.Patch_Margin),o.length1+=d.length,s+=d.length,l===DIFF_EQUAL?(o.length2+=d.length,a+=d.length):p=!1,o.diffs.push(new diff_match_patch.Diff(l,d)),d==n.diffs[0][1]?n.diffs.shift():n.diffs[0][1]=n.diffs[0][1].substring(d.length))}r=this.diff_text2(o.diffs),r=r.substring(r.length-this.Patch_Margin);var c=this.diff_text1(n.diffs).substring(0,this.Patch_Margin);""!==c&&(o.length1+=c.length,o.length2+=c.length,0!==o.diffs.length&&o.diffs[o.diffs.length-1][0]===DIFF_EQUAL?o.diffs[o.diffs.length-1][1]+=c:o.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,c))),p||e.splice(++i,0,o)}}},diff_match_patch.prototype.patch_toText=function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i];return t.join("")},diff_match_patch.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var i=e.split("\n"),n=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;n<i.length;){var a=i[n].match(s);if(!a)throw new Error("Invalid patch string: "+i[n]);var r=new diff_match_patch.patch_obj;for(t.push(r),r.start1=parseInt(a[1],10),""===a[2]?(r.start1--,r.length1=1):"0"==a[2]?r.length1=0:(r.start1--,r.length1=parseInt(a[2],10)),r.start2=parseInt(a[3],10),""===a[4]?(r.start2--,r.length2=1):"0"==a[4]?r.length2=0:(r.start2--,r.length2=parseInt(a[4],10)),n++;n<i.length;){var o=i[n].charAt(0);try{var p=decodeURI(i[n].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+p)}if("-"==o)r.diffs.push(new diff_match_patch.Diff(DIFF_DELETE,p));else if("+"==o)r.diffs.push(new diff_match_patch.Diff(DIFF_INSERT,p));else if(" "==o)r.diffs.push(new diff_match_patch.Diff(DIFF_EQUAL,p));else if("@"==o)break;else if(""===o);else throw new Error("Invalid patch mode \""+o+"\" in: "+p);n++}}return t},diff_match_patch.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},diff_match_patch.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var i=["@@ -"+e+" +"+t+" @@\n"],n=0,s;n<this.diffs.length;n++){switch(this.diffs[n][0]){case DIFF_INSERT:s="+";break;case DIFF_DELETE:s="-";break;case DIFF_EQUAL:s=" ";}i[n+1]=s+encodeURI(this.diffs[n][1])+"\n"}return i.join("").replace(/%20/g," ")},this.diff_match_patch=diff_match_patch,this.DIFF_DELETE=DIFF_DELETE,this.DIFF_INSERT=DIFF_INSERT,this.DIFF_EQUAL=DIFF_EQUAL,define("scripts/diff/diffMatch.js",function(){});const requirejs=require,monacoVersion="0.18.1",defaultPaths={vsLoader:"./scripts/"+monacoVersion+"/dev/vs/loader.js",vsSource:"./scripts/"+monacoVersion+"/dev/vs",tsCompiler:"./scripts/tscompiler/3.6.3/typescript.min.js",monacoBase:"./scripts/"+monacoVersion+"/dev/",monacoWorker:"./vs/base/worker/workerMain.js",linter:"./scripts/eslint/eslint.js",app:"./app.js"};"function"==typeof Array.prototype.include&&(Array.prototype.include=void 0);function newMonacoInitializer(){function e(t){let i=document.getElementById(t);return i?void i.classList.add("sn_original_editor"):void setTimeout(e,100,t)}function t(){requirejs(["scripts/newMonaco"],t=>{n.fields.forEach(i=>{if(i.isEditorInitialized)return;if(!(i.canRead||i.canWrite))return void(i.isEditorInitialized=!0);let n=document.getElementById(i.ref);if(n&&0===n.offsetWidth&&0==n.offsetHeight)return;let s=document.getElementById("monaco_"+i.ref),a="element."+i.ref;if(!s){let e=document.getElementById("element."+i.ref);if(!e)return;let t=document.createElement("fieldset"),n=document.createElement("legend");n.textContent=i.name,t.appendChild(n),s=document.createElement("div"),s.classList.add("sn_monaco_editor"),s.setAttribute("file-name",i.fileName),s.setAttribute("id","monaco_"+i.ref),n.appendChild(s),a=i.ref,e.insertBefore(t,e.firstChild)}i.isEditorInitialized=!0;let o;o="jsx"===i.internalType||"tsx"===i.internalType?new t.MonacoJSXEditor(s,i):new t.MonacoEditor(s,i),r.set(i.name,o),e(a)})})}function i(e){let t=e.split("."),i="";if(1>t.length)return null;i=t[t.length-1];const s=n.fieldMap.get(i);return r.get(s.name)}let n=window.snMonacoConfig;n||(n={});const s=n&&n.paths;let a=defaultPaths;n.paths&&(a=n.paths);let r=new Map;n.fieldMap=new Map;let o="";return n.customDeclaration&&(o+=n.customDeclaration+"\n"),Array.isArray(n.fields)&&n.fields.forEach(e=>{e.customDeclaration&&(o+=e.customDeclaration+"\n"),n.fieldMap.set(e.name,e)}),{initialize:function(){let e=new Map,i=["node_modules/@types/react/global.d.ts","node_modules/@types/prop-types/index.d.ts","node_modules/@types/react/index.d.ts","node_modules/csstype/index.d.ts"];requirejs.config({urlArgs:"sysparm_substitute=false",paths:{vs:a.vsSource},ignoreDuplicateModules:["vs/basic-languages/typescript/typescript","vs/editor/editor.main"]});s&&(window.MonacoEnvironment={getWorkerUrl:function(){var e="self.MonacoEnvironment = {";return e+="baseUrl: '"+a.monacoBase+"'",e+="}\nimportScripts('"+a.monacoWorker+"')","data:text/javascript;charset=utf-8,"+encodeURIComponent(e)}}),requirejs(["vs/editor/editor.main"],()=>{requirejs(["vs/language/typescript/tsWorker"],()=>{define("typescript",["require"],()=>window.ts),requirejs(["scripts/SIDeclEmittor"],s=>{function a(){if("undefined"==typeof monaco)return void window.setTimeout(a,1e3);let r=s.getCompilerOptions(!0);monaco.languages.typescript.typescriptDefaults.setCompilerOptions(r),s.initializeTypeDeclarations(n.appScope+".jeffa").then(()=>{t()}),i.forEach(t=>{const i=t.replace("node_modules","https://www.unpkg.com/");fetch(i).then(e=>e.text()).then(i=>{e.set(t,i),monaco.languages.typescript.typescriptDefaults.addExtraLib(i,t)})}),0<o.length&&monaco.languages.typescript.typescriptDefaults.addExtraLib(o),console.log("monaco is ready")}"undefined"!=typeof CustomEvent&&"undefined"!=typeof CustomEvent.observe&&(CustomEvent.observe("tabs.disable",function(){t()}),CustomEvent.observe("element_script_display_true",function(){t()}),CustomEvent.observe("tab.activated",function(){t()})),a()})})})},getValue:function(e){let t=i(e);return t.getValue().value},getConfig:function(){return n}}}let monacoProvider;function CodeMirrorNoScriptTextAreaElementForOthers(e){this.name=e,this.textEl=document.getElementById(e)}CodeMirrorNoScriptTextAreaElementForOthers.prototype.initialize=function(e){this.name=e},CodeMirrorNoScriptTextAreaElementForOthers.prototype.setReadOnly=function(){},CodeMirrorNoScriptTextAreaElementForOthers.prototype.isDisabled=function(){return!1},CodeMirrorNoScriptTextAreaElementForOthers.prototype.isReadOnly=function(){return!1},CodeMirrorNoScriptTextAreaElementForOthers.prototype.getValue=function(){return this.textEl||(this.textEl=document.getElementById(name)),this.textEl?this.textEl.value:""},CodeMirrorNoScriptTextAreaElementForOthers.prototype.setValue=function(e){this.textEl||(this.textEl=document.getElementById(name)),this.textEl&&(this.textEl.value=e)},CodeMirrorNoScriptTextAreaElementForOthers.prototype.isVisible=function(){return!0},"undefined"==typeof window||window.recordConfig||(window.CodeMirrorNoScriptTextAreaElement=CodeMirrorNoScriptTextAreaElementForOthers),"undefined"==typeof window||window.recordConfig||(monacoProvider=newMonacoInitializer(),monacoProvider.initialize());define("scripts/allElements.js",function(){});